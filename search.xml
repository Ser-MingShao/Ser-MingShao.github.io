<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Git的基本使用</title>
      <link href="/posts/372934289/"/>
      <url>/posts/372934289/</url>
      
        <content type="html"><![CDATA[<div class="tip home"><p>前言:写的不是很完整,但基本操作就这些,句句重点,全程无废话~</p></div><h2 id="git拉取仓库"><a class="markdownIt-Anchor" href="#git拉取仓库"></a> git拉取仓库</h2><blockquote><ol><li><p>复制远程仓库链接(<span class='p green'>注意是HTTP的</span>)</p><p><img src="https://unpkg.com/serms-assets/imgs/image-20220719184655736.png" alt="" /></p></li><li><p>随便找个地方右键Git Bash</p><p><img src="https://unpkg.com/serms-assets/imgs/image-20220719184747747.png" alt="" /></p></li><li><p>输入 git clone (<span class='p green'>这里填刚刚复制的HTTP链接</span>),然后坐等就已经拉取下来了</p><p><img src="https://unpkg.com/serms-assets/imgs/image-20220719184843215.png" alt="" /></p><p><img src="https://unpkg.com/serms-assets/imgs/image-20220719184903555.png" alt="" /></p></li></ol></blockquote><h2 id="git推送至仓库"><a class="markdownIt-Anchor" href="#git推送至仓库"></a> git推送至仓库</h2><blockquote><p>在仓库中输入下面这行代码即可,如果不行,就分开执行,有报错请在下方留言</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git add . &amp;&amp; git commit -m &#x27;update&#x27; &amp;&amp; git push origin master</span><br></pre></td></tr></table></figure><p><img src="https://unpkg.com/serms-assets/imgs/image-20220719215427076.png" alt="image-20220719215427076" /></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> git </category>
          
      </categories>
      
      
        <tags>
            
            <tag> git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>阿里云部署项目</title>
      <link href="/posts/32277b7/"/>
      <url>/posts/32277b7/</url>
      
        <content type="html"><![CDATA[<div class="tip home"><p>前言:<br />学校近期实训周做项目,我想着能不能把项目直接部署在云上,刚好阿里云有ECS服务器免费试用活动,不嫖白补票,因此记录本项目的所有部署流程,从申请服务器到部署项目,完整的流程<br />本次采用的是两台阿里云ECS的服务器,因为我项目采用数据库是主从复制的架构,所以需要两台服务器,刚好我也想把前台部署到第二台服务器上去,第一台服务器部署主要后台代码</p></div><hr /><table><thead><tr><th style="text-align:center">主库服务器</th><th style="text-align:center">从库服务器</th></tr></thead><tbody><tr><td style="text-align:center">后台代码</td><td style="text-align:center">前台代码</td></tr><tr><td style="text-align:center">mysql5.0主库部署</td><td style="text-align:center">mysql5.0从库部署</td></tr><tr><td style="text-align:center">redis部署</td><td style="text-align:center">Nginx配置</td></tr><tr><td style="text-align:center">JDK环境配置</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">tomcat配置</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">Maven环境配置</td><td style="text-align:center"></td></tr></tbody></table><hr /><h2 id="阿里云服务器申请"><a class="markdownIt-Anchor" href="#阿里云服务器申请"></a> 阿里云服务器申请</h2><p>首先去阿里云申请两台服务器,可免费使用1个月<p class='p red'>如果不用了记得提前退订</p></p><div class="tabs" id="ecs申请"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#ecs申请-1">主库SerMsMaster</button></li><li class="tab"><button type="button" data-href="#ecs申请-2">从库SerMsSlave</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="ecs申请-1"><p><img src="https://unpkg.com/serms-assets@1.0.29/imgs/image-20220616160142652.png" alt="" /></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="ecs申请-2"><p><img src="https://unpkg.com/serms-assets@1.0.29/imgs/image-20220616222532022.png" alt="" /></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><hr /><h2 id="主库配置"><a class="markdownIt-Anchor" href="#主库配置"></a> 主库配置</h2><blockquote><p>通过本地连接阿里云ECS主库</p></blockquote><h2 id="网卡设置"><a class="markdownIt-Anchor" href="#网卡设置"></a> 网卡设置</h2><blockquote><p>这里不做介绍,自行百度Linux配置网卡</p></blockquote><h2 id="安装软件"><a class="markdownIt-Anchor" href="#安装软件"></a> 安装软件</h2><h3 id="vim文本工具"><a class="markdownIt-Anchor" href="#vim文本工具"></a> vim文本工具</h3><blockquote><p>yum install vim</p></blockquote><h3 id="安装jdk"><a class="markdownIt-Anchor" href="#安装jdk"></a> 安装JDK</h3><blockquote><ol><li><p>去[oracle][<a href="https://www.oracle.com/java/technologies/downloads/archive/">https://www.oracle.com/java/technologies/downloads/archive/</a>]官网下载对应操作系统的JDK</p></li><li><p>把下载好的JDK传入Linux</p></li><li><p>执行解压命令: tar -zxvf 改成你自己上传的包名 -C /usr/local</p><p><img src="https://unpkg.com/serms-assets@1.0.29/imgs/image-20220616164103639.png" alt="" /></p></li><li><p>修改系统环境变量:</p><ol><li><p>vim /etc/profile</p></li><li><p>插入以下代码,注意路径修改</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">export JAVA_HOME=/usr/local/jdk1.8.0_331  (注意路径)</span><br><span class="line">export JRE_HOME=/usr/local/jdk1.8.0_331/jre ((注意路径))</span><br><span class="line">export CLASSPATH=.:$JAVA_HOME/lib:$JRE_HOME/lib:$CLASSPATH</span><br><span class="line">export PATH=$JAVA_HOME/bin:$JRE_HOME/bin:$PATH</span><br></pre></td></tr></table></figure><p><img src="C:%5CUsers%5C18399%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20220616164702404.png" alt="image-20220616164702404" /></p></li><li><p>修改完后:wq退出</p></li><li><p>执行 source /etc/profile 刷新环境变量</p></li><li><p>执行 java -version 或 javac 查看是否安装成功</p><p><img src="https://unpkg.com/serms-assets@1.0.29/imgs/image-20220616165121907.png" alt="" /></p><p>看到显示版本号即安装成功</p></li></ol></li></ol></blockquote><h3 id="安装tomcat"><a class="markdownIt-Anchor" href="#安装tomcat"></a> 安装Tomcat</h3><blockquote><ol><li><p><a href="https://tomcat.apache.org/download-90.cgi">官网下载</a>对应系统版本的tomcat安装包</p></li><li><p>并上传至Linux内</p></li><li><p>执行解压命令</p></li><li><p>tar -zxvf apache-tomcat-9.0.62.tar.gz -C /usr/local</p></li><li><p>进入到tomcat的bin目录下执行 sh <a href="http://startup.sh">startup.sh</a></p></li></ol><p><img src="https://unpkg.com/serms-assets@1.0.29/imgs/image-20220616170832755.png" alt="" /></p><ol start="5"><li>这个时候我还需要去阿里云ECS控制台设置一下安全组规则,把8080端口开打</li></ol><p><img src="https://unpkg.com/serms-assets@1.0.29/imgs/image-20220616171251694.png" alt="" /></p><ol start="6"><li>再去浏览器访问 服务器ip+端口号8080 比如我的是<code>http://47.99.194.162:8080/</code> (本人是把防火墙直接关闭了,所以能访问)</li></ol><p><img src="https://unpkg.com/serms-assets@1.0.29/imgs/image-20220616171342487.png" alt="" /></p><ol start="7"><li><p>如果还访问不到,那就得改一下防火墙的设置,设置防火墙开放8080端口</p></li><li><p>设置防火墙开机启动:<code>chkconfig firewalld on</code></p></li><li><p>开启防火墙: <code>systemctl start firewalld</code>(执行完之后,再去访问就访问不到了,所以我们需要开发8080端口)</p></li><li><p>查询8080端口是否开启: <code>firewall-cmd --query-port=8080/tcp</code></p><p><img src="https://unpkg.com/serms-assets@1.0.29/imgs/image-20220616172135805.png" alt="" /></p></li><li><p>开启8080端口</p><ol><li><code>firewall-cmd --zone=public --add-port=80/tcp --permanent</code>（–permanent永久生效，没有此参数重启后失效）</li></ol></li><li><p>重启防火墙</p><ol><li>firewall-cmd --reload</li></ol></li><li><p>查看8080端口是否开启成功</p><ol><li>firewall-cmd --zone=public --query-port=8080/tcp</li></ol></li><li><p>当然还可以删除指定端口</p><ol><li>firewall-cmd --zone=public --remove-port=端口号/tcp --permanent</li></ol></li><li><p>再去刷新一下页面,就又可以访问了</p><p><img src="https://unpkg.com/serms-assets@1.0.29/imgs/image-20220616172712137.png" alt="" /></p></li><li><p>查看已开放的所有端口</p><ol><li>firewall-cmd --zone=public --list-ports</li></ol></li><li><p>索性在这里一并开放3306 / 6379 / 8888 端口 后期也会用到</p><p><img src="https://unpkg.com/serms-assets@1.0.29/imgs/image-20220616174156782.png" alt="" /></p></li><li><p>其余操作</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">停止Tomcat服务</span><br><span class="line">sh shutdown.sh</span><br></pre></td></tr></table></figure></li></ol><p>安全提醒:防火墙不建议关闭,已经阿里云服务器安全组也不建议设置全部端口打开,会有一些黑客或者不正当的人入侵服务器,拿你服务器干坏事,本人就是因为此件事搞得我服务器,需要重新配置,索性也就写了这篇文章,真的不要随意打开任何一个端口!!!</p></blockquote><h3 id="安装mysql"><a class="markdownIt-Anchor" href="#安装mysql"></a> 安装MySQL</h3><blockquote><ol><li><p>一样的去官网下载对应系统版本的安装包,并上传到Linux</p></li><li><p>解压MySql安装包之后会得到以下几个文件</p></li></ol><p><img src="https://unpkg.com/serms-assets@1.0.29/imgs/image-20220616202538594.png" alt="" /></p><ol start="3"><li><p>接下来需要按照以下顺序一一安装,按照顺序必须跟我一样</p></li><li><p>安装顺序如下</p></li></ol>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">rpm -ivh mysql-community-common-5.7.25-1.el7.x86_64.rpm</span><br><span class="line">rpm -ivh mysql-community-libs-5.7.25-1.el7.x86_64.rpm</span><br><span class="line">rpm -ivh mysql-community-devel-5.7.25-1.el7.x86_64.rpm</span><br><span class="line">rpm -ivh mysql-community-libs-5.7.25-1.el7.x86_64.rpm</span><br><span class="line">rpm -ivh mysql-community-client-5.7.25-1.el7.x86_64.rpm</span><br><span class="line">安装到这的时候需要安装一个依赖: net-tools,在执行最后一个安装包,直接执行则会报缺少net-tools依赖</span><br><span class="line">rpm -ivh mysql-community-server-5.7.25-1.el7.x86_64.rpm</span><br></pre></td></tr></table></figure><ol start="2"><li><p>安装完后执行内核更新:</p><ol><li>yum update</li></ol></li><li><p>启动mysql</p></li><li><p>systemctl status mysqld   查看mysql服务状态</p></li><li><p>systemctl start mysqld        启动mysql服务</p></li><li><p>设置为开机启动</p></li><li><p>systemctl enable mysqld</p></li><li><p>netstat -tunlp     查看已启动的服务</p></li><li><p>ps - ef|grep mysql    查看mysql进程</p></li><li><p>登录mysql</p></li><li><p>查阅临时密码:  cat /var/log/mysqld.log  | grep password</p><p><img src="https://unpkg.com/serms-assets@1.0.29/imgs/image-20220616204308979.png" alt="" /></p></li><li><p>登录mysql,并修改密码,开放访问权限</p><ol><li><p>mysql -uroot -p   (输入查出来的临时密码)</p></li><li><p>修改密码以及访问权限</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">set global validate_password_length=4;设置密码长度最低位数</span><br><span class="line">set global validate_password_policy=LOW;设置密码安全等级低,便于密码可以修改成root</span><br><span class="line">set password = password(&#x27;root&#x27;);设置密码为root</span><br><span class="line">grant all on *.* to &#x27;root&#x27;@&#x27;%&#x27; identified by &#x27;root&#x27;;开启访问权限</span><br><span class="line">flush privileges;刷新权限</span><br></pre></td></tr></table></figure><p><img src="https://unpkg.com/serms-assets@1.0.29/imgs/image-20220616204910291.png" alt="" /></p></li></ol></li><li><p>到此就可以用Navicat进行外部连接了</p></li></ol></blockquote><h3 id="安装redis"><a class="markdownIt-Anchor" href="#安装redis"></a> 安装Redis</h3><blockquote><ol><li><p>官网下载对应系统版本的安装包,并上传至Linux系统和解压安装,在此不做阐述</p></li><li><p>安装Redis的依赖环境gcc, 执行:   yum install gcc-c++</p></li><li><p>进入安装redis软件目录,进行编译,执行:  make</p></li><li><p>在进入redis软件目录下的src执行: make install</p></li><li><p>redis启动与停止</p></li><li><p>在redis/src下执行: ./redis-server</p></li></ol><p><img src="C:%5CUsers%5C18399%5CDesktop%5Cimage-20220616210708814.png" alt="image-20220616210708814" /></p><ol start="6"><li><p>进入redis根目录,修改配置文件</p></li><li><p>vim redis.conf</p></li><li><p>找到daemonize,修改为 yes  允许后台启动</p><p><img src="https://unpkg.com/serms-assets@1.0.29/imgs/image-20220616211256462.png" alt="" /></p></li><li><p>修改配置文件,将 bind 注释 即可实现外部访问</p></li></ol><p><img src="https://unpkg.com/serms-assets@1.0.29/imgs/image-20220616211638029.png" alt="" /></p><ol start="4"><li><p>将protected-mode 改为 no</p></li><li><p>启动Redis</p></li><li><p>src/redis-server ./redis.conf</p></li><li><p>外部进行连接</p><p><img src="https://unpkg.com/serms-assets@1.0.29/imgs/image-20220616212406655.png" alt="" /></p></li><li><p>设置为开机启动</p></li><li><p>网上有很多教程这里就不多阐述了 <a href="https://blog.csdn.net/qq_28041113/article/details/122291622">点我查看教程</a></p></li><li><p>快捷操作</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">打开redis命令:service redis start</span><br><span class="line">                         </span><br><span class="line">关闭redis命令:service redis stop</span><br><span class="line">                         </span><br><span class="line">设为开机启动:chkconfig redis on</span><br><span class="line">                         </span><br><span class="line">设为开机关闭:chkconfig redis off</span><br></pre></td></tr></table></figure></li></ol></blockquote><h3 id="安装git"><a class="markdownIt-Anchor" href="#安装git"></a> 安装Git</h3><blockquote><p>执行: yum install git</p><p>查看git版本: git --version</p></blockquote><p>安装Mavne</p><blockquote><p>自行百度</p></blockquote><h2 id="后端部署"><a class="markdownIt-Anchor" href="#后端部署"></a> 后端部署</h2><blockquote><ol><li><p>拉取git项目到本地 git clone xxxxx</p></li><li><p>在项目根目录编写启动脚本</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line"><span class="built_in">echo</span> =================================</span><br><span class="line"><span class="built_in">echo</span>  自动化部《湘约楼》署脚本启动 </span><br><span class="line"><span class="built_in">echo</span> =================================</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> 停止原来运行中的工程</span><br><span class="line">APP_NAME=xyl_take_out</span><br><span class="line"></span><br><span class="line">tpid=`ps -ef|grep <span class="variable">$APP_NAME</span>|grep -v grep|grep -v <span class="built_in">kill</span>|awk <span class="string">&#x27;&#123;print $2&#125;&#x27;</span>`</span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$&#123;tpid&#125;</span> ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&#x27;Stop Process...&#x27;</span></span><br><span class="line">    <span class="built_in">kill</span> -15 <span class="variable">$tpid</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="built_in">sleep</span> 2</span><br><span class="line">tpid=`ps -ef|grep <span class="variable">$APP_NAME</span>|grep -v grep|grep -v <span class="built_in">kill</span>|awk <span class="string">&#x27;&#123;print $2&#125;&#x27;</span>`</span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$&#123;tpid&#125;</span> ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&#x27;Kill Process!&#x27;</span></span><br><span class="line">    <span class="built_in">kill</span> -9 <span class="variable">$tpid</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&#x27;Stop Success!&#x27;</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> 准备从Git仓库拉取最新代码</span><br><span class="line"><span class="built_in">cd</span> /usr/local/javaapp/xyl_ms_km</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> 开始从Git仓库拉取最新代码</span><br><span class="line">git pull</span><br><span class="line"><span class="built_in">echo</span> 代码拉取完成</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> 开始打包</span><br><span class="line">output=`mvn clean package -Dmaven.test.skip=<span class="literal">true</span>`</span><br><span class="line"></span><br><span class="line"><span class="built_in">cd</span> target</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> 启动项目</span><br><span class="line"><span class="built_in">nohup</span> java -jar xyl_take_out-1.0-SNAPSHOT.jar &amp;&gt; xyl_take_out.log &amp;</span><br><span class="line"><span class="built_in">echo</span> 项目启动完成</span><br></pre></td></tr></table></figure></li><li><p>赋予脚本最高权限,然后执行, sh <a href="http://xyl.sh">xyl.sh</a></p><p><img src="https://unpkg.com/serms-assets@1.0.29/imgs/image-20220616221445525.png" alt="" /></p><p>稍等片刻,将会打包完成</p><p>这里呢启动之后肯定是访问不到的,因为从库的sql还没配置,所以先配置从库的数据库和前端页面在来启动</p></li></ol></blockquote><h2 id="从库配置"><a class="markdownIt-Anchor" href="#从库配置"></a> 从库配置</h2><h3 id="安装vim"><a class="markdownIt-Anchor" href="#安装vim"></a> 安装vim</h3><blockquote><p>上面有教程,这边不做阐述</p></blockquote><h3 id="安装nginx"><a class="markdownIt-Anchor" href="#安装nginx"></a> 安装Nginx</h3><ol><li>前期准备</li></ol><blockquote><p>安装依赖包<br />yum -y install gcc pcre-devel zlib-devel openssl openssl-devel<br />下载Nginx安装包<br />wget  <a href="http://nginx.org/download/nginx-1.22.0.tar.gz">http://nginx.org/download/nginx-1.22.0.tar.gz</a><br />解压 tar -zxvf nginx-1.22.0.tar.gz<br />创建文件夹 mkdir -p /usr/local/nginx<br />执行安装命令: ./configure --prefix=/usr/local/nginx<br />执行编译: make &amp;&amp; make install<br />导入静态页面到html目录</p><p>配置反向代理<br />修改nginx.conf文件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">location / &#123;</span><br><span class="line">    root   html/dist;</span><br><span class="line">    index  index.html;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#反向代理配置</span><br><span class="line">location ^~ /api/ &#123;</span><br><span class="line">    rewrite ^/api/(.*)$ /$1 break;</span><br><span class="line">    proxy_pass http://47.99.194.162:8888/</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></blockquote><ol start="2"><li><p>配置Nginx环境</p><ol><li>编辑 vim /etc/profile</li><li>export PATH=/usr/local/nginx/sbin:$PATH</li><li>执行 source /etc/profile 刷新环境变量</li></ol></li><li><p>配置开机启动</p><blockquote><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br></pre></td><td class="code"><pre><span class="line"> &gt;<span class="comment">#!/bin/sh</span></span><br><span class="line"> &gt;<span class="comment">#</span></span><br><span class="line"> &gt;<span class="comment"># nginx - this script starts and stops the nginx daemon</span></span><br><span class="line"> &gt;<span class="comment">#</span></span><br><span class="line"> &gt;<span class="comment"># chkconfig:   - 85 15</span></span><br><span class="line"> &gt;<span class="comment"># description:  NGINX is an HTTP(S) server, HTTP(S) reverse \</span></span><br><span class="line"> &gt;<span class="comment">#               proxy and IMAP/POP3 proxy server</span></span><br><span class="line"> &gt;<span class="comment"># processname: nginx</span></span><br><span class="line"> &gt;<span class="comment"># config:      /etc/nginx/nginx.conf</span></span><br><span class="line"> &gt;<span class="comment"># config:      /etc/sysconfig/nginx</span></span><br><span class="line"> &gt;<span class="comment"># pidfile:     /var/run/nginx.pid</span></span><br><span class="line"></span><br><span class="line"> &gt;<span class="comment"># Source function library.</span></span><br><span class="line"> &gt;. /etc/rc.d/init.d/functions</span><br><span class="line"></span><br><span class="line"> &gt;<span class="comment"># Source networking configuration.</span></span><br><span class="line"> &gt;. /etc/sysconfig/network</span><br><span class="line"></span><br><span class="line"> &gt;<span class="comment"># Check that networking is up.</span></span><br><span class="line"> &gt;[ <span class="string">&quot;<span class="variable">$NETWORKING</span>&quot;</span> = <span class="string">&quot;no&quot;</span> ] &amp;&amp; <span class="built_in">exit</span> 0</span><br><span class="line"></span><br><span class="line"> &gt;nginx=<span class="string">&quot;/usr/local/nginx/sbin/nginx&quot;</span></span><br><span class="line"> &gt;prog=$(<span class="built_in">basename</span> <span class="variable">$nginx</span>)</span><br><span class="line"></span><br><span class="line"> &gt;NGINX_CONF_FILE=<span class="string">&quot;/usr/local/nginx/conf/nginx.conf&quot;</span></span><br><span class="line"></span><br><span class="line"> &gt;[ -f /etc/sysconfig/nginx ] &amp;&amp; . /etc/sysconfig/nginx</span><br><span class="line"></span><br><span class="line"> &gt;lockfile=/var/lock/subsys/nginx</span><br><span class="line"></span><br><span class="line"> &gt;<span class="function"><span class="title">make_dirs</span></span>() &#123;</span><br><span class="line"> <span class="comment"># make required directories</span></span><br><span class="line"> user=`<span class="variable">$nginx</span> -V 2&gt;&amp;1 | grep <span class="string">&quot;configure arguments:.*--user=&quot;</span> | sed <span class="string">&#x27;s/[^*]*--user=\([^ ]*\).*/\1/g&#x27;</span> -`</span><br><span class="line"> <span class="keyword">if</span> [ -n <span class="string">&quot;<span class="variable">$user</span>&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">    <span class="keyword">if</span> [ -z <span class="string">&quot;`grep <span class="variable">$user</span> /etc/passwd`&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">       useradd -M -s /bin/nologin <span class="variable">$user</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">    options=`<span class="variable">$nginx</span> -V 2&gt;&amp;1 | grep <span class="string">&#x27;configure arguments:&#x27;</span>`</span><br><span class="line">    <span class="keyword">for</span> opt <span class="keyword">in</span> <span class="variable">$options</span>; <span class="keyword">do</span></span><br><span class="line">        <span class="keyword">if</span> [ `<span class="built_in">echo</span> <span class="variable">$opt</span> | grep <span class="string">&#x27;.*-temp-path&#x27;</span>` ]; <span class="keyword">then</span></span><br><span class="line">            value=`<span class="built_in">echo</span> <span class="variable">$opt</span> | <span class="built_in">cut</span> -d <span class="string">&quot;=&quot;</span> -f 2`</span><br><span class="line">            <span class="keyword">if</span> [ ! -d <span class="string">&quot;<span class="variable">$value</span>&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">                <span class="comment"># echo &quot;creating&quot; $value</span></span><br><span class="line">                <span class="built_in">mkdir</span> -p <span class="variable">$value</span> &amp;&amp; <span class="built_in">chown</span> -R <span class="variable">$user</span> <span class="variable">$value</span></span><br><span class="line">            <span class="keyword">fi</span></span><br><span class="line">        <span class="keyword">fi</span></span><br><span class="line">     <span class="keyword">done</span></span><br><span class="line">  <span class="keyword">fi</span></span><br><span class="line"> &gt;&#125;</span><br><span class="line"></span><br><span class="line"> &gt;<span class="function"><span class="title">start</span></span>() &#123;</span><br><span class="line">  [ -x <span class="variable">$nginx</span> ] || <span class="built_in">exit</span> 5</span><br><span class="line">  [ -f <span class="variable">$NGINX_CONF_FILE</span> ] || <span class="built_in">exit</span> 6</span><br><span class="line">  make_dirs</span><br><span class="line">  <span class="built_in">echo</span> -n $<span class="string">&quot;Starting <span class="variable">$prog</span>: &quot;</span></span><br><span class="line">  daemon <span class="variable">$nginx</span> -c <span class="variable">$NGINX_CONF_FILE</span></span><br><span class="line">  retval=$?</span><br><span class="line">  <span class="built_in">echo</span></span><br><span class="line">  [ <span class="variable">$retval</span> -eq 0 ] &amp;&amp; <span class="built_in">touch</span> <span class="variable">$lockfile</span></span><br><span class="line">  <span class="built_in">return</span> <span class="variable">$retval</span></span><br><span class="line"> &gt;&#125;</span><br><span class="line"></span><br><span class="line"> &gt;<span class="function"><span class="title">stop</span></span>() &#123;</span><br><span class="line">  <span class="built_in">echo</span> -n $<span class="string">&quot;Stopping <span class="variable">$prog</span>: &quot;</span></span><br><span class="line">  killproc <span class="variable">$prog</span> -QUIT</span><br><span class="line">  retval=$?</span><br><span class="line">  <span class="built_in">echo</span></span><br><span class="line">  [ <span class="variable">$retval</span> -eq 0 ] &amp;&amp; <span class="built_in">rm</span> -f <span class="variable">$lockfile</span></span><br><span class="line">  <span class="built_in">return</span> <span class="variable">$retval</span></span><br><span class="line"> &gt;&#125;</span><br><span class="line"></span><br><span class="line"> &gt;<span class="function"><span class="title">restart</span></span>() &#123;</span><br><span class="line">  configtest || <span class="built_in">return</span> $?</span><br><span class="line">  stop</span><br><span class="line">  <span class="built_in">sleep</span> 1</span><br><span class="line">  start</span><br><span class="line"> &gt;&#125;</span><br><span class="line"></span><br><span class="line"> &gt;<span class="function"><span class="title">reload</span></span>() &#123;</span><br><span class="line">  configtest || <span class="built_in">return</span> $?</span><br><span class="line">  <span class="built_in">echo</span> -n $<span class="string">&quot;Reloading <span class="variable">$prog</span>: &quot;</span></span><br><span class="line">  killproc <span class="variable">$prog</span> -HUP</span><br><span class="line">  retval=$?</span><br><span class="line">  <span class="built_in">echo</span></span><br><span class="line"> &gt;&#125;</span><br><span class="line"></span><br><span class="line"> &gt;<span class="function"><span class="title">force_reload</span></span>() &#123;</span><br><span class="line">  restart</span><br><span class="line"> &gt;&#125;</span><br><span class="line"></span><br><span class="line"> &gt;<span class="function"><span class="title">configtest</span></span>() &#123;</span><br><span class="line"><span class="variable">$nginx</span> -t -c <span class="variable">$NGINX_CONF_FILE</span></span><br><span class="line"> &gt;&#125;</span><br><span class="line"></span><br><span class="line"> &gt;<span class="function"><span class="title">rh_status</span></span>() &#123;</span><br><span class="line">  status <span class="variable">$prog</span></span><br><span class="line"> &gt;&#125;</span><br><span class="line"></span><br><span class="line"> &gt;<span class="function"><span class="title">rh_status_q</span></span>() &#123;</span><br><span class="line">  rh_status &gt;/dev/null 2&gt;&amp;1</span><br><span class="line"> &gt;&#125;</span><br><span class="line"></span><br><span class="line"> &gt;<span class="keyword">case</span> <span class="string">&quot;<span class="variable">$1</span>&quot;</span> <span class="keyword">in</span></span><br><span class="line">  start)</span><br><span class="line">      rh_status_q &amp;&amp; <span class="built_in">exit</span> 0</span><br><span class="line">      <span class="variable">$1</span></span><br><span class="line">      ;;</span><br><span class="line">  stop)</span><br><span class="line">      rh_status_q || <span class="built_in">exit</span> 0</span><br><span class="line">      <span class="variable">$1</span></span><br><span class="line">      ;;</span><br><span class="line">  restart|configtest)</span><br><span class="line">      <span class="variable">$1</span></span><br><span class="line">      ;;</span><br><span class="line">  reload)</span><br><span class="line">      rh_status_q || <span class="built_in">exit</span> 7</span><br><span class="line">      <span class="variable">$1</span></span><br><span class="line">      ;;</span><br><span class="line">  force-reload)</span><br><span class="line">      force_reload</span><br><span class="line">      ;;</span><br><span class="line">  status)</span><br><span class="line">      rh_status</span><br><span class="line">      ;;</span><br><span class="line">  condrestart|try-restart)</span><br><span class="line">      rh_status_q || <span class="built_in">exit</span> 0</span><br><span class="line">          ;;</span><br><span class="line">  *)</span><br><span class="line">      <span class="built_in">echo</span> $<span class="string">&quot;Usage: <span class="variable">$0</span> &#123;start|stop|status|restart|condrestart|try-restart|reload|force-reload|configtest&#125;&quot;</span></span><br><span class="line">      <span class="built_in">exit</span> 2</span><br><span class="line"> &gt;<span class="keyword">esac</span></span><br></pre></td></tr></table></figure><p>这段代码是官方提供的,并不是我自己写的,里面有两行Nginx的路径需要改成你自己的安装路径</p></blockquote></li><li><p>编写完毕之后在/etc/init.d下创建nginx文件,把上面的代码复制进去,并给予最高执行权限</p></li><li><p>使用chkconfig管理</p><ol><li><p><strong>将nginx服务加入chkconfig管理列表</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># chkconfig --add /etc/init.d/nginx</span></span><br></pre></td></tr></table></figure></li><li><p><strong>使用service管理服务</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># service nginx start    启动服务   </span></span><br><span class="line"><span class="comment"># service nginx stop     停止服务</span></span><br><span class="line"><span class="comment"># service nginx restart  重启服务</span></span><br><span class="line"><span class="comment"># service nginx status   查询服务的状态</span></span><br><span class="line"><span class="comment"># service nginx relaod   刷新配置文</span></span><br></pre></td></tr></table></figure></li><li><p><strong>设置终端模式开机启动</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># chkconfig nginx on</span></span><br></pre></td></tr></table></figure></li></ol></li></ol><h3 id="安装mysql-2"><a class="markdownIt-Anchor" href="#安装mysql-2"></a> 安装MySql</h3><blockquote><p>上述已经讲到,这里不做阐述</p></blockquote><h2 id="配置主从复制"><a class="markdownIt-Anchor" href="#配置主从复制"></a> 配置主从复制</h2><h3 id="配置主库"><a class="markdownIt-Anchor" href="#配置主库"></a> 配置主库</h3><blockquote><p>修改 vim /etc/my.nf<br />[mysql]<br />log-bin = mysql-bin#[必须]启用二进制日志<br />server-id=100服务器唯一ID</p><p>重启mysql服务<br />systemctl restart mysqld</p><p>登录到主库中执行代码<br />GRANT REPLICATION SLAVE ON <em>.</em> to ‘serms’@’%’ identified by ‘Root@123456’;<br />上面SQL的作用是创建一个用户serms,密码为Root@123456,并且给serms用户授予 REPLICATION SLAVE权限,常用于建立复制时所需要用到的用户权限,也就是说slave必须被master授权具有权限的用户,才能提供该用户复制</p><p>执行SQL,查看FIle和Position的值<br />show master status;</p><p><img src="https://unpkg.com/serms-assets@1.0.29/imgs/image-20220616235947262.png" alt="" /></p><p>至此不需要在动主库的mysql了</p></blockquote><h3 id="配置从库"><a class="markdownIt-Anchor" href="#配置从库"></a> 配置从库</h3><blockquote><p>修改mysql数据库配置文件<br />server-id=100<br />刷新数据库</p><p>执行SQL</p><p>change master to master_host=‘47.99.194.162’,master_user=‘serms’,master_password=‘Root@123456’,master_log_file=‘mysql-bin.000001’,master_log_pos=438;</p><p>start slave;</p><p>查看数据库状态</p><p>show slave status;</p></blockquote><p>到此呢主库和从库的配置就已经结束啦~</p><p>有些地方写的不是很好, 有不明白的地方请在下方留言</p><h2 id="️sponsor"><a class="markdownIt-Anchor" href="#️sponsor"></a> ❤️Sponsor</h2><p>您的支持是我不断前进的动力，如果您恰巧财力雄厚，又感觉本文对您有所帮助的话，可以考虑打赏一下本文，用以维持本博客的运营费用，拒绝白嫖，从你我做起！🥰🥰🥰</p><table><thead><tr><th style="text-align:center">支付宝</th><th>微信</th></tr></thead><tbody><tr><td style="text-align:center"><img src="https://unpkg.com/serms-assets@1.0.25/serms/img/alipay.png" alt="" /></td><td><img src="https://unpkg.com/serms-assets@1.0.25/serms/img/wechat.png" alt="" /></td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> 阿里云 </category>
          
          <category> 项目部署 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 阿里云ECS </tag>
            
            <tag> 项目部署 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>都22世纪了你还不会科学上网??</title>
      <link href="/posts/13e760ef/"/>
      <url>/posts/13e760ef/</url>
      
        <content type="html"><![CDATA[<h2 id="前言"><a class="markdownIt-Anchor" href="#前言"></a> 前言</h2><div class="tip home"><p>现在科学上网可能是每个青年的必备技巧了,就比如我想去看看国外的…啊呸,我怎么会这样想呢…<img no-lazy class="inline" src="https://inews.gtimg.com/newsapp_match/0/14380690994/0" style="height:40px;"/>, 比如在你敲代码的时候想访问一下<a href="https://spring.io/">Spring</a>或者是<a href="http://github.com/">Github</a>有时候甚至都需要借助科学上网…</p><p>多的不说进入正题</p></div><p>科学上网的方式有很多种,比如反代,开VPN…</p><p>可能你说这不都要钱吗???</p><p>确实,但是我怎么可能让你们花钱呢??能白嫖绝不氪金😁😁😁</p><p><img src="https://unpkg.com/serms-assets@1.0.28/imgs/image-20220523092300757.png" alt="油管轻轻松松上" /></p><p>我已经帮大家整理好了,大家直接下载就行</p><div class="tag link"><a class="link-card" title="" href="https://pan.baidu.com/s/1Z-0ZEMBnWHrb-m6VfmJuxg&pwd:ms88"><div class="left"><img src="https://pan.baidu.com/box-static/disk-theme/theme/white/img/logo@2x.png"/></div><div class="right"><p class="text"></p><p class="url">https://pan.baidu.com/s/1Z-0ZEMBnWHrb-m6VfmJuxg&pwd:ms88</p></div></a></div>]]></content>
      
      
      <categories>
          
          <category> 奇怪的知识 </category>
          
          <category> 怎样科学上网 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 怎样科学上网 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NavigationDuplicated异常警告!!!</title>
      <link href="/posts/86aff880/"/>
      <url>/posts/86aff880/</url>
      
        <content type="html"><![CDATA[<h2 id="问题"><a class="markdownIt-Anchor" href="#问题"></a> 问题</h2><p>Vue路由当你重复传相同参数时,控制台就会报:<span class='p red'>NavigationDuplicated</span></p><p><img src="https://unpkg.com/serms-assets@1.0.25/imgs/image-20220522204757177.png" alt="" /></p><hr /><h2 id="原因"><a class="markdownIt-Anchor" href="#原因"></a> 原因:</h2><p>最新的vue-router引入了promise</p><hr /><h2 id="解决方法"><a class="markdownIt-Anchor" href="#解决方法"></a> 解决方法</h2><blockquote><p>通过给push方法传递相应的成功,失败的回调,可以捕获当前错误,可以解决问题</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">this.$router.push(&#123;</span><br><span class="line">name: &#x27;search&#x27;,</span><br><span class="line">query: &#123;</span><br><span class="line">k: this.keyword.toUpperCase(),</span><br><span class="line">&#125;,</span><br><span class="line">params: &#123;</span><br><span class="line">keyword: this.keyword,</span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line">&#125;,</span><br><span class="line">() =&gt; &#123; &#125;,//函数传入成功</span><br><span class="line">() =&gt; &#123; &#125;//函数传入失败</span><br><span class="line">);</span><br></pre></td></tr></table></figure><div class="tip success"><p><span class='p red'>但是这种方法治标不治本!!!</span></p></div><hr /><blockquote><p>重写Router原型对象上的push方法和replace方法</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//配置路由的主文件</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Vue</span> <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Router</span> <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//使用插件</span></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">use</span>(<span class="title class_">Router</span>);</span><br><span class="line"><span class="comment">//打印路由原型</span></span><br><span class="line"><span class="comment">// console.log(Router.prototype);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//备份Router原型对象的push方法</span></span><br><span class="line"><span class="keyword">let</span> originPush = <span class="title class_">Router</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">push</span>;</span><br><span class="line"><span class="comment">// console.log(originPush);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//备份Router原型对象的replace方法</span></span><br><span class="line"><span class="keyword">let</span> originReplace = <span class="title class_">Router</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">replace</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//重写push和replace方法</span></span><br><span class="line"><span class="comment">//第一个参数:路由路径以及传递的参数</span></span><br><span class="line"><span class="comment">//第二个参数:成功的回调</span></span><br><span class="line"><span class="comment">//第三个参数:失败的回调</span></span><br><span class="line"><span class="comment">//this:当前的路由对象(当前组件实例对象)</span></span><br><span class="line"><span class="comment">//call和apply的区别:都是改变this指向,但是call和apply的区别是:call是把参数传递给函数,apply是把参数传递给函数的数组</span></span><br><span class="line"><span class="title class_">Router</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">push</span> = <span class="keyword">function</span> (<span class="params">location, resolve, reject</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (resolve &amp;&amp; reject) &#123;</span><br><span class="line">        <span class="keyword">return</span> originPush.<span class="title function_">call</span>(<span class="variable language_">this</span>, location, resolve, reject);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> originPush.<span class="title function_">call</span>(<span class="variable language_">this</span>, location, <span class="function">() =&gt;</span> &#123; &#125;, <span class="function">() =&gt;</span> &#123; &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title class_">Router</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">replace</span> = <span class="keyword">function</span> (<span class="params">location, resolve, reject</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (resolve &amp;&amp; reject) &#123;</span><br><span class="line">        <span class="keyword">return</span> originReplace.<span class="title function_">call</span>(<span class="variable language_">this</span>, location, resolve, reject);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> originReplace.<span class="title function_">call</span>(<span class="variable language_">this</span>, location, <span class="function">() =&gt;</span> &#123; &#125;, <span class="function">() =&gt;</span> &#123; &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//配置路由</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> <span class="title class_">Router</span>(&#123;</span><br><span class="line">    <span class="comment">//配置路由</span></span><br><span class="line">    <span class="attr">routes</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">path</span>: <span class="string">&#x27;/home&#x27;</span>,</span><br><span class="line">            <span class="attr">component</span>: <span class="title class_">Home</span>,</span><br><span class="line">            <span class="attr">meta</span>: &#123; <span class="attr">show</span>: <span class="literal">true</span> &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">    ]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>至此push和replace重复提交问题以全部解决</p><hr /><h2 id="️sponsor"><a class="markdownIt-Anchor" href="#️sponsor"></a> ❤️Sponsor</h2><p>您的支持是我不断前进的动力，如果您恰巧财力雄厚，又感觉本文对您有所帮助的话，可以考虑打赏一下本文，用以维持本博客的运营费用，拒绝白嫖，从你我做起！🥰🥰🥰</p><table><thead><tr><th style="text-align:center">支付宝</th><th>微信</th></tr></thead><tbody><tr><td style="text-align:center"><img src="https://unpkg.com/serms-assets@1.0.25/serms/img/alipay.png" alt="" /></td><td><img src="https://unpkg.com/serms-assets@1.0.25/serms/img/wechat.png" alt="" /></td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> Vue </category>
          
          <category> Vue-NavigationDuplicated异常 </category>
          
          <category> 编程笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
            <tag> NavigationDuplicated异常 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vue路由传参的三种方式</title>
      <link href="/posts/da904ab5/"/>
      <url>/posts/da904ab5/</url>
      
        <content type="html"><![CDATA[<h2 id="前言"><a class="markdownIt-Anchor" href="#前言"></a> 前言</h2><div class="tip home"><p><strong>vue</strong> 路由传参的使用场景一般都是应用在父路由跳转到子路由时，携带参数跳转。传参方式可划分为 <code>params</code> 传参和 <code>query</code> 传参，而 <code>params</code> 传参又可分为在 <strong>url</strong> 中显示参数和不显示参数两种方式，这就是vue路由传参的三种方式。</p></div><h2 id="方式一params-传参显示参数"><a class="markdownIt-Anchor" href="#方式一params-传参显示参数"></a> 方式一：<code>params</code> 传参（显示参数）</h2><span class='p red'>params</span> 传参（显示参数）又可分为 声明式 和 编程式 两种方式<blockquote><p>1、声明式 <code>router-link</code></p></blockquote><p>该方式是通过 <code>router-link</code> 组件的 <code>to</code> 属性实现，该方法的参数可以是一个字符串路径，或者一个描述地址的对象。使用该方式传值的时候，需要子路由提前配置好参数，例如：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">//子路由配置</span><br><span class="line">&#123;</span><br><span class="line">path: &#x27;/child/:id&#x27;,</span><br><span class="line">component: Child</span><br><span class="line">&#125;</span><br><span class="line">//父路由组件</span><br><span class="line"><span class="tag">&lt;<span class="name">router-link</span> <span class="attr">:to</span>=<span class="string">&quot;/child/123&quot;</span>&gt;</span>进入Child路由<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>2、编程式 <code>this.$router.push</code></p></blockquote><p>使用该方式传值的时候，同样需要子路由提前配置好参数，例如：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">//子路由配置</span><br><span class="line">&#123;</span><br><span class="line">path: &#x27;/child/:id&#x27;,</span><br><span class="line">component: Child</span><br><span class="line">&#125;</span><br><span class="line">//父路由编程式传参(一般通过事件触发)</span><br><span class="line">this.$router.push(&#123;</span><br><span class="line">path:&#x27;/child/$&#123;id&#125;&#x27;,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>在子路由中可以通过下面代码来获取传递的参数值</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">this.$route.params.id</span><br></pre></td></tr></table></figure><h2 id="方式二params-传参不显示参数"><a class="markdownIt-Anchor" href="#方式二params-传参不显示参数"></a> 方式二：<code>params</code> 传参（不显示参数）</h2><p><code>params</code> 传参（不显示参数）也可分为 声明式 和 编程式 两种方式，与方式一不同的是，这里是通过路由的别名 <code>name</code> 进行传值的</p><p>1、声明式 <code>router-link</code></p><p>该方式也是通过 <code>router-link</code> 组件的 <code>to</code> 属性实现，例如：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;router-link :to=&quot;&#123;name:&#x27;Child&#x27;,params:&#123;id:123&#125;&#125;&quot;&gt;进入Child路由&lt;/router-link&gt;</span><br></pre></td></tr></table></figure><p>2、编程式 <code>this.$router.push</code></p><p>使用该方式传值的时候，同样需要子路由提前配置好参数，不过不能再使用 <code>:/id</code> 来传递参数了，因为父路由中，已经使用 <code>params</code> 来携带参数了，例如：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">//子路由配置</span><br><span class="line">&#123;</span><br><span class="line">  path: &#x27;/child,</span><br><span class="line">  name: &#x27;Child&#x27;,</span><br><span class="line">  component: Child</span><br><span class="line">&#125;</span><br><span class="line">//父路由编程式传参(一般通过事件触发)</span><br><span class="line">this.$router.push(&#123;</span><br><span class="line">    name:&#x27;Child&#x27;,</span><br><span class="line">    params:&#123;</span><br><span class="line">    id:123</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>在子路由中可以通过下面代码来获取传递的参数值</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">this.$route.params.id</span><br></pre></td></tr></table></figure><p><strong>注意：上述这种利用 <code>params</code> 不显示 <code>url</code> 传参的方式会导致在刷新页面的时候，传递的值会丢失</strong></p><h2 id="方式三query-传参显示参数"><a class="markdownIt-Anchor" href="#方式三query-传参显示参数"></a> 方式三：<code>query</code> 传参（显示参数）</h2><p><code>query</code> 传参（显示参数）也可分为 声明式 和 编程式 两种方式</p><blockquote><p>1、声明式 <code>router-link</code></p></blockquote><p>该方式也是通过 <code>router-link</code> 组件的 <code>to</code> 属性实现，不过使用该方式传值的时候，需要子路由提前配置好路由别名（<code>name</code> 属性），例如：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">//子路由配置</span><br><span class="line">&#123;</span><br><span class="line">  path: &#x27;/child,</span><br><span class="line">  name: &#x27;Child&#x27;,</span><br><span class="line">  component: Child</span><br><span class="line">&#125;</span><br><span class="line">//父路由组件</span><br><span class="line">&lt;router-link :to=&quot;&#123;name:&#x27;Child&#x27;,query:&#123;id:123&#125;&#125;&quot;&gt;进入Child路由&lt;/router-link&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>2、编程式 <code>this.$router.push</code></p></blockquote><p>使用该方式传值的时候，同样需要子路由提前配置好路由别名（<code>name</code> 属性），例如：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">//子路由配置</span><br><span class="line">&#123;</span><br><span class="line">  path: &#x27;/child,</span><br><span class="line">  name: &#x27;Child&#x27;,</span><br><span class="line">  component: Child</span><br><span class="line">&#125;</span><br><span class="line">//父路由编程式传参(一般通过事件触发)</span><br><span class="line">this.$router.push(&#123;</span><br><span class="line">    name:&#x27;Child&#x27;,</span><br><span class="line">    query:&#123;</span><br><span class="line">    id:123</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>在子路由中可以通过下面代码来获取传递的参数值</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">this.$route.query.id</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Vue </category>
          
          <category> Vue路由三种传参方式 </category>
          
          <category> 编程笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
            <tag> Vue路由传参的三种方式 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vue(尚硅谷天禹老师)</title>
      <link href="/posts/75ce1e02/"/>
      <url>/posts/75ce1e02/</url>
      
        <content type="html"><![CDATA[<div class="tip home"><p>📝学习资料：<a href="https://www.bilibili.com/video/BV1Zy4y1K7SH">尚硅谷天禹Vue</a><br />🚩时间安排：预计5天更新完<br />🎯开始时间：05-21<br />🎉结束时间：05-xx</p></div><h2 id="vue-简介"><a class="markdownIt-Anchor" href="#vue-简介"></a> Vue 简介</h2><h3 id="官网"><a class="markdownIt-Anchor" href="#官网"></a> 官网</h3><ol><li><a href="https://vuejs.org/">英文官网</a></li><li><a href="https://cn.vuejs.org/">中文官网</a></li></ol><h3 id="介绍与描述"><a class="markdownIt-Anchor" href="#介绍与描述"></a> 介绍与描述</h3><ol><li>动态构建用户界面的 渐进式 JavaScript框架</li><li>作者:尤雨溪</li></ol><h3 id="vue-的特点"><a class="markdownIt-Anchor" href="#vue-的特点"></a> Vue 的特点</h3><ol><li>遵循 MVVM 模式</li><li>编码简洁,体积小,运行效率高,适合移动/PC 端开发</li><li>它本身只关注 UI,也可以引入其它第三方库开发项目</li></ol><h3 id="与其它-js-框架的关联"><a class="markdownIt-Anchor" href="#与其它-js-框架的关联"></a> 与其它 JS 框架的关联</h3><ol><li>借鉴Angular的 模板 和 数据绑定 技术</li><li>借鉴React的 组件化 和 虚拟DOM 技术</li></ol><h3 id="vue-周边库"><a class="markdownIt-Anchor" href="#vue-周边库"></a> Vue 周边库</h3><ol><li>vue-cli:vue脚手架</li><li>vue-resource</li><li>axios</li><li>vue-router:路由</li><li>vuex:状态管理</li><li>element-ui:基于vue的UI组件库(PC端)</li></ol><h2 id="初识-vue"><a class="markdownIt-Anchor" href="#初识-vue"></a> 初识 Vue</h2><h3 id="模板"><a class="markdownIt-Anchor" href="#模板"></a> 模板</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>初识vue<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 引入Vue --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;../js/vue.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 准备好一个容器 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;root&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello！&#123;&#123;name&#125;&#125;!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="title class_">Vue</span>.<span class="property">config</span>.<span class="property">productionTip</span> = <span class="literal">false</span> <span class="comment">// 阻止vue在启动时生成生产提示</span></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">el</span>:<span class="string">&#x27;#root&#x27;</span>, <span class="comment">//el用于指定当前Vue实例为哪个容器服务，值通常为css选择器字符串</span></span></span><br><span class="line"><span class="language-javascript">                <span class="attr">data</span>:&#123; <span class="comment">//data用于存储数据，数据共el所指定的容器去使用</span></span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">name</span>:<span class="string">&#x27;JOJO&#x27;</span></span></span><br><span class="line"><span class="language-javascript">                &#125;</span></span><br><span class="line"><span class="language-javascript">            &#125;)</span></span><br><span class="line"><span class="language-javascript">        </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="效果"><a class="markdownIt-Anchor" href="#效果"></a> 效果</h3><p><img src="https://img-blog.csdnimg.cn/img_convert/9ab2f21a5134c5d3c8bbf86495d3d031.png" alt="img" /></p><blockquote><p>注意:</p><ol><li>想让Vue工作，就必须创建一个Vue实例，且要传入一个配置对象</li><li>root容器里的代码依然符合html规范，只不过混入了一些特殊的Vue语法</li><li>root容器里的代码被称为Vue模板</li><li>Vue实例与容器是一一对应的</li><li>真实开发中只有一个Vue实例，并且会配合着组件一起使用</li><li>中的xxx要写js表达式，且xxx可以自动读取到data中的所有属性</li><li>一旦data中的数据发生变化，那么模板中用到该数据的地方也会自动更新</li></ol></blockquote><h3 id="模板语法"><a class="markdownIt-Anchor" href="#模板语法"></a> 模板语法</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>vue模板语法<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;../js/vue.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;root&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">h1</span>&gt;</span>插值语法<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">h3</span>&gt;</span>你好，&#123;&#123;name&#125;&#125;!<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">h1</span>&gt;</span>指令语法<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">v-bind:href</span>=<span class="string">&quot;url&quot;</span>&gt;</span>快去看新番！<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">:href</span>=<span class="string">&quot;url&quot;</span>&gt;</span>快去看新番！<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="title class_">Vue</span>.<span class="property">config</span>.<span class="property">productionTip</span> = <span class="literal">false</span> </span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">el</span>:<span class="string">&#x27;#root&#x27;</span>, </span></span><br><span class="line"><span class="language-javascript">                <span class="attr">data</span>:&#123; </span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">name</span>:<span class="string">&#x27;JOJO&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">url</span>:<span class="string">&#x27;https://www.bilibili.com/&#x27;</span></span></span><br><span class="line"><span class="language-javascript">                &#125;</span></span><br><span class="line"><span class="language-javascript">            &#125;)</span></span><br><span class="line"><span class="language-javascript">        </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>效果:</p><p><img src="https://img-blog.csdnimg.cn/img_convert/5064db5c00a8878b26bcd486fa51a853.png" alt="img" /></p><p>html 中包含了一些 JS 语法代码，语法分为两种，分别为：</p><ol><li>插值语法（双大括号表达式）</li><li>指令（以 v-开头）</li></ol><h4 id="总结"><a class="markdownIt-Anchor" href="#总结"></a> 总结:</h4><h5 id="插值语法"><a class="markdownIt-Anchor" href="#插值语法"></a> 插值语法</h5><ol><li><p>功能:用于解析标签体内容</p></li><li><p>语法:，xxxx会作为js表达式解析</p></li></ol><h5 id="指令语法"><a class="markdownIt-Anchor" href="#指令语法"></a> 指令语法</h5><ol><li><p>功能:解析标签属性、解析标签体内容、绑定事件</p></li><li><p>举例：v-bind:href=‘xxxx’，xxxx会作为js表达式被解析</p></li><li><p>说明：Vue中有有很多的指令，此处只是用v-bind举个例子</p></li></ol><h3 id="数据绑定"><a class="markdownIt-Anchor" href="#数据绑定"></a> 数据绑定</h3><h4 id="模板-2"><a class="markdownIt-Anchor" href="#模板-2"></a> 模板</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>数据绑定<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;../js/vue.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;root&quot;</span>&gt;</span></span><br><span class="line">            单向数据绑定：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">v-bind:value</span>=<span class="string">&quot;name&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">            双向数据绑定：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">v-model:value</span>=<span class="string">&quot;name&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="title class_">Vue</span>.<span class="property">config</span>.<span class="property">productionTip</span> = <span class="literal">false</span> </span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">el</span>:<span class="string">&#x27;#root&#x27;</span>, </span></span><br><span class="line"><span class="language-javascript">                <span class="attr">data</span>:&#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">name</span>:<span class="string">&#x27;JOJO&#x27;</span></span></span><br><span class="line"><span class="language-javascript">                &#125;</span></span><br><span class="line"><span class="language-javascript">            &#125;)</span></span><br><span class="line"><span class="language-javascript">        </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="效果-2"><a class="markdownIt-Anchor" href="#效果-2"></a> 效果</h4><p><img src="https://img-blog.csdnimg.cn/img_convert/094b060391528a0185e12f1287645cbe.png" alt="" /></p><h4 id="总结-2"><a class="markdownIt-Anchor" href="#总结-2"></a> <strong>总结：</strong></h4><ul><li>Vue中有2种数据绑定的方式：<ul><li>单向绑定（<code>v-bind</code>）：数据只能从data流向页面</li><li>双向绑定（<code>v-model</code>）：数据不仅能从data流向页面，还可以从页面流向data</li></ul></li></ul><h3 id="el与data的两种写法"><a class="markdownIt-Anchor" href="#el与data的两种写法"></a> el与data的两种写法</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>el与data的两种写法<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;../js/vue.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;root&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello,&#123;&#123;name&#125;&#125;!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="title class_">Vue</span>.<span class="property">config</span>.<span class="property">productionTip</span> = <span class="literal">false</span> </span></span><br><span class="line"><span class="language-javascript">            <span class="comment">//el的两种写法：</span></span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// const vm = new Vue(&#123;</span></span></span><br><span class="line"><span class="language-javascript">            <span class="comment">//     // el:&#x27;#root&#x27;, //第一种写法</span></span></span><br><span class="line"><span class="language-javascript">            <span class="comment">//     data:&#123;</span></span></span><br><span class="line"><span class="language-javascript">            <span class="comment">//         name:&#x27;JOJO&#x27;</span></span></span><br><span class="line"><span class="language-javascript">            <span class="comment">//     &#125;</span></span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// &#125;)</span></span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// vm.$mount(&#x27;#root&#x27;)//第二种写法</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="comment">//data的两种写法：</span></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">el</span>:<span class="string">&#x27;#root&#x27;</span>, </span></span><br><span class="line"><span class="language-javascript">                <span class="comment">//data的第一种写法：对象式</span></span></span><br><span class="line"><span class="language-javascript">                <span class="comment">// data:&#123;</span></span></span><br><span class="line"><span class="language-javascript">                <span class="comment">//     name:&#x27;JOJO&#x27;</span></span></span><br><span class="line"><span class="language-javascript">                <span class="comment">// &#125;</span></span></span><br><span class="line"><span class="language-javascript">                <span class="comment">//data的第二种写法：函数式</span></span></span><br><span class="line"><span class="language-javascript">                <span class="title function_">data</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="keyword">return</span>&#123;</span></span><br><span class="line"><span class="language-javascript">                        <span class="attr">name</span>:<span class="string">&#x27;JOJO&#x27;</span></span></span><br><span class="line"><span class="language-javascript">                    &#125;</span></span><br><span class="line"><span class="language-javascript">                &#125;</span></span><br><span class="line"><span class="language-javascript">            &#125;)</span></span><br><span class="line"><span class="language-javascript">        </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="总结-3"><a class="markdownIt-Anchor" href="#总结-3"></a> 总结：</h4><p>el有2种写法：</p><ol><li>创建Vue实例对象的时候配置el属性</li><li>先创建Vue实例，随后再通过<code>vm.$mount('#root')</code>指定el的值</li></ol><p>data有2种写法：</p><ol><li>对象式</li><li>函数式</li></ol><ul><li>如何选择：目前哪种写法都可以，以后学到组件时，data必须使用函数，否则会报错</li></ul><blockquote><p>由Vue管理的函数，一定不要写箭头函数，否则this就不再是Vue实例了</p></blockquote><h3 id="mvvm-模型"><a class="markdownIt-Anchor" href="#mvvm-模型"></a> MVVM 模型</h3><p><img src="https://img-blog.csdnimg.cn/img_convert/ac43527b06defd324a702aea4f7940a0.png" alt="img" /></p><ul><li>MVVM模型:<ul><li>M：模型(Model)：对应data中的数据</li><li>V：视图(View)：模板</li><li>VM：视图模型(ViewModel)：Vue实例对象</li></ul></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>mvvm<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;../js/vue.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;root&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">h2</span>&gt;</span>名称：&#123;&#123;name&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">h2</span>&gt;</span>战队：&#123;&#123;rank&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">h2</span>&gt;</span>测试：&#123;&#123;$options&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="title class_">Vue</span>.<span class="property">config</span>.<span class="property">productionTip</span> = <span class="literal">false</span></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">el</span>:<span class="string">&#x27;#root&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">data</span>:&#123; </span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">name</span>:<span class="string">&#x27;uzi&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">rank</span>:<span class="string">&#x27;RNG&#x27;</span></span></span><br><span class="line"><span class="language-javascript">                &#125;</span></span><br><span class="line"><span class="language-javascript">            &#125;)</span></span><br><span class="line"><span class="language-javascript">        </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>效果：</strong></p><p><img src="https://img-blog.csdnimg.cn/img_convert/94ba0684daa6f21dbb14873a29d9c67a.png" alt="img" /></p><p><strong>总结：</strong></p><ul><li>data中所有的属性，最后都出现在了vm身上</li><li>vm身上所有的属性 及 Vue原型身上所有的属性，在Vue模板中都可以直接使用</li></ul><h3 id="vue中的数据代理"><a class="markdownIt-Anchor" href="#vue中的数据代理"></a> Vue中的数据代理</h3><p><img src="https://img-blog.csdnimg.cn/img_convert/1fbebd52e39fa5a97210ee65d0a58069.png" alt="img" /></p><p><strong>总结：</strong></p><ol><li>Vue中的数据代理通过vm对象来代理data对象中属性的操作（读/写）</li><li>Vue中数据代理的好处：更加方便的操作data中的数据</li><li>基本原理：<ul><li>通过<code>object.defineProperty()</code>把data对象中所有属性添加到vm上。</li><li>为每一个添加到vm上的属性，都指定一个getter/setter。</li><li>在getter/setter内部去操作（读/写）data中对应的属性。</li></ul></li></ol><h3 id="事件处理"><a class="markdownIt-Anchor" href="#事件处理"></a> 事件处理</h3><h4 id="事件的基本用法"><a class="markdownIt-Anchor" href="#事件的基本用法"></a> 事件的基本用法</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>事件的基本用法<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;../js/vue.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;root&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">h2</span>&gt;</span>hello,&#123;&#123;name&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">v-on:click</span>=<span class="string">&quot;showInfo1&quot;</span>&gt;</span>点我提示信息1<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;showInfo2($event,66)&quot;</span>&gt;</span>点我提示信息2<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="title class_">Vue</span>.<span class="property">config</span>.<span class="property">productionTip</span> = <span class="literal">false</span> </span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">el</span>:<span class="string">&#x27;#root&#x27;</span>, </span></span><br><span class="line"><span class="language-javascript">                <span class="attr">data</span>:&#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">name</span>:<span class="string">&#x27;JOJO&#x27;</span></span></span><br><span class="line"><span class="language-javascript">                &#125;,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">methods</span>:&#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="title function_">showInfo1</span>(<span class="params">event</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">                        <span class="variable language_">console</span>.<span class="title function_">log</span>(event)</span></span><br><span class="line"><span class="language-javascript">                    &#125;,</span></span><br><span class="line"><span class="language-javascript">                    <span class="title function_">showInfo2</span>(<span class="params">evnet,num</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">                        <span class="variable language_">console</span>.<span class="title function_">log</span>(event,num)</span></span><br><span class="line"><span class="language-javascript">                    &#125;</span></span><br><span class="line"><span class="language-javascript">                &#125;</span></span><br><span class="line"><span class="language-javascript">            &#125;)</span></span><br><span class="line"><span class="language-javascript">        </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="效果-3"><a class="markdownIt-Anchor" href="#效果-3"></a> 效果</h4><p><img src="https://img-blog.csdnimg.cn/img_convert/a3463fb07e6ae6d6acc288aaf19b0f8b.png" alt="img" /></p><p><strong>总结：</strong></p><ol><li>使用<code>v-on:xxx</code>或<code>@xxx</code>绑定事件，其中xxx是事件名</li><li>事件的回调需要配置在methods对象中，最终会在vm上</li><li>methods中配置的函数，==不要用箭头函数！==否则this就不是vm了</li><li>methods中配置的函数，都是被Vue所管理的函数，this的指向是vm或组件实例对象</li><li><code>@click=&quot;demo</code>和<code>@click=&quot;demo($event)&quot;</code>效果一致，但后者可以传参</li></ol><h4 id="1-6-3-事件修饰符"><a class="markdownIt-Anchor" href="#1-6-3-事件修饰符"></a> 1. 6. 3 .事件修饰符</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1 ..prevent:阻止事件的默认行为event.preventDefault()</span><br><span class="line">2 ..stop:停止事件冒泡event.stopPropagation()</span><br></pre></td></tr></table></figure><h4 id="1-6-4-按键修饰符"><a class="markdownIt-Anchor" href="#1-6-4-按键修饰符"></a> 1. 6. 4 .按键修饰符</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1 .keycode:操作的是某个keycode值的键</span><br><span class="line">2 ..keyName:操作的某个按键名的键(少部分)</span><br></pre></td></tr></table></figure><h3 id="1-7-计算属性与监视"><a class="markdownIt-Anchor" href="#1-7-计算属性与监视"></a> 1. 7 .计算属性与监视</h3><h4 id="1-7-1-效果"><a class="markdownIt-Anchor" href="#1-7-1-效果"></a> 1. 7. 1 .效果</h4><h4 id="1-7-2-计算属性-computed"><a class="markdownIt-Anchor" href="#1-7-2-计算属性-computed"></a> 1. 7. 2 .计算属性-computed</h4><h6 id="1-要显示的数据不存在要通过计算得来"><a class="markdownIt-Anchor" href="#1-要显示的数据不存在要通过计算得来"></a> 1. 要显示的数据不存在，要通过计算得来。</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">2. 在computed对象中定义计算属性。</span><br><span class="line">3. 在页面中使用&#123;&#123;方法名&#125;&#125;来显示计算的结果。</span><br></pre></td></tr></table></figure><h4 id="1-7-3-监视属性-watch"><a class="markdownIt-Anchor" href="#1-7-3-监视属性-watch"></a> 1. 7. 3 .监视属性-watch</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1. 通过通过vm对象的$watch()或watch配置来监视指定的属性</span><br><span class="line">2. 当属性变化时,回调函数自动调用,在函数内部进行计算</span><br></pre></td></tr></table></figure><h3 id="1-8-class-与-style-绑定"><a class="markdownIt-Anchor" href="#1-8-class-与-style-绑定"></a> 1. 8 .class 与 style 绑定</h3><h4 id="1-8-1-理解"><a class="markdownIt-Anchor" href="#1-8-1-理解"></a> 1. 8. 1 .理解</h4><h6 id="1-在应用界面中某个些元素的样式是变化的"><a class="markdownIt-Anchor" href="#1-在应用界面中某个些元素的样式是变化的"></a> 1. 在应用界面中,某个(些)元素的样式是变化的</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2. class/style绑定就是专门用来实现动态样式效果的技术</span><br></pre></td></tr></table></figure><h4 id="1-8-2-class-绑定"><a class="markdownIt-Anchor" href="#1-8-2-class-绑定"></a> 1. 8. 2 .class 绑定</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1. :class=&#x27;xxx&#x27;</span><br><span class="line">2. 表达式是字符串:&#x27;classA&#x27;</span><br><span class="line">3. 表达式是对象:&#123;classA:isA,classB:isB&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">4. 表达式是数组:[&#x27;classA&#x27;,&#x27;classB&#x27;]</span><br></pre></td></tr></table></figure><h4 id="1-8-3-style-绑定"><a class="markdownIt-Anchor" href="#1-8-3-style-绑定"></a> 1. 8. 3 .style 绑定</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1. :style=&quot;&#123;color:activeColor,fontSize:fontSize+&#x27;px&#x27;&#125;&quot;</span><br><span class="line">2. 其中activeColor/fontSize是data属性</span><br></pre></td></tr></table></figure><h3 id="1-9-条件渲染"><a class="markdownIt-Anchor" href="#1-9-条件渲染"></a> 1. 9 .条件渲染</h3><h4 id="1-9-1-条件渲染指令"><a class="markdownIt-Anchor" href="#1-9-1-条件渲染指令"></a> 1. 9. 1 .条件渲染指令</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1. v-if与v-else</span><br><span class="line">2. v-show</span><br></pre></td></tr></table></figure><h4 id="1-9-2-比较-v-if-与-v-show"><a class="markdownIt-Anchor" href="#1-9-2-比较-v-if-与-v-show"></a> 1. 9. 2 .比较 v-if 与 v-show</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1. 如果需要频繁切换v-show较好</span><br><span class="line">2. 当条件不成立时,v-if的所有子节点不会解析(项目中使用)</span><br></pre></td></tr></table></figure><h3 id="1-10-列表渲染"><a class="markdownIt-Anchor" href="#1-10-列表渲染"></a> 1. 10 .列表渲染</h3><h4 id="1-10-1-效果"><a class="markdownIt-Anchor" href="#1-10-1-效果"></a> 1. 10. 1 .效果</h4><h4 id="1-10-2-列表显示指令"><a class="markdownIt-Anchor" href="#1-10-2-列表显示指令"></a> 1. 10. 2 .列表显示指令</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">遍历数组:v-for/index</span><br><span class="line">遍历对象:v-for/key</span><br></pre></td></tr></table></figure><h3 id="1-11-收集表单数据"><a class="markdownIt-Anchor" href="#1-11-收集表单数据"></a> 1. 11 .收集表单数据</h3><h3 id="1-12-过滤器"><a class="markdownIt-Anchor" href="#1-12-过滤器"></a> 1. 12 .过滤器</h3><h4 id="1-12-1-效果"><a class="markdownIt-Anchor" href="#1-12-1-效果"></a> 1. 12. 1 .效果</h4><h4 id="1-12-2-理解过滤器"><a class="markdownIt-Anchor" href="#1-12-2-理解过滤器"></a> 1. 12. 2 .理解过滤器</h4><h6 id="1-功能对要显示的数据进行特定格式化后再显示"><a class="markdownIt-Anchor" href="#1-功能对要显示的数据进行特定格式化后再显示"></a> 1. 功能:对要显示的数据进行特定格式化后再显示</h6><h6 id="2-注意并没有改变原本的数据是产生新的对应的数据"><a class="markdownIt-Anchor" href="#2-注意并没有改变原本的数据是产生新的对应的数据"></a> 2. 注意:并没有改变原本的数据,是产生新的对应的数据</h6><h3 id="1-13-内置指令与自定义指令"><a class="markdownIt-Anchor" href="#1-13-内置指令与自定义指令"></a> 1. 13 .内置指令与自定义指令</h3><h4 id="1-13-1-常用内置指令"><a class="markdownIt-Anchor" href="#1-13-1-常用内置指令"></a> 1. 13. 1 .常用内置指令</h4><p>1 .v-text:更新元素的 textContent<br />2 .v-html:更新元素的 innerHTML<br />3 .v-if:如果为 true,当前标签才会输出到页面<br />4 .v-else:如果为 false,当前标签才会输出到页面<br />5 .v-show:通过控制 display 样式来控制显示/隐藏<br />6 .v-for:遍历数组/对象<br />7 .v-on:绑定事件监听,一般简写为@<br />8 .v-bind:绑定解析表达式,可以省略 v-bind<br />9 .v-model:双向数据绑定<br />10 .v-cloak:防止闪现,与 css 配合:[v-cloak]{display:none}</p><h4 id="1-13-2-自定义指令"><a class="markdownIt-Anchor" href="#1-13-2-自定义指令"></a> 1. 13. 2 .自定义指令</h4><h6 id="1-注册全局指令"><a class="markdownIt-Anchor" href="#1-注册全局指令"></a> 1. 注册全局指令</h6><p>Vue.directive(‘my-directive’,function(el,binding){<br />el.innerHTML=binding.value.toupperCase()<br />})<br /><strong>2. 注册局部指令</strong><br />directives:{<br />‘my-directive’:{<br />bind(el,binding){<br />el.innerHTML=binding.value.toupperCase()<br />}<br />}<br />}<br />1 ) 使用指令<br />v-my-directive=‘xxx’</p><h3 id="1-14-vue-实例生命周期"><a class="markdownIt-Anchor" href="#1-14-vue-实例生命周期"></a> 1. 14 .Vue 实例生命周期</h3><h4 id="1-14-1-效果"><a class="markdownIt-Anchor" href="#1-14-1-效果"></a> 1. 14. 1 .效果</h4><h4 id="1-14-2-生命周期流程图"><a class="markdownIt-Anchor" href="#1-14-2-生命周期流程图"></a> 1. 14. 2 .生命周期流程图</h4><h4 id="1-14-3-vue-生命周期分析"><a class="markdownIt-Anchor" href="#1-14-3-vue-生命周期分析"></a> 1. 14. 3 .vue 生命周期分析</h4><h6 id="1-初始化显示"><a class="markdownIt-Anchor" href="#1-初始化显示"></a> 1 ) 初始化显示</h6><h5 id="beforecreate"><a class="markdownIt-Anchor" href="#beforecreate"></a> *beforeCreate()</h5><h5 id="created"><a class="markdownIt-Anchor" href="#created"></a> *created()</h5><h5 id="beforemount"><a class="markdownIt-Anchor" href="#beforemount"></a> *beforeMount()</h5><h5 id="mounted"><a class="markdownIt-Anchor" href="#mounted"></a> *mounted()</h5><p>2 ) 更新状态:this.xxx=value</p><h5 id="beforeupdate"><a class="markdownIt-Anchor" href="#beforeupdate"></a> *beforeUpdate()</h5><h5 id="updated"><a class="markdownIt-Anchor" href="#updated"></a> *updated()</h5><p>3 ) 销毁 vue 实例:vm.$destory()</p><h5 id="beforedestory"><a class="markdownIt-Anchor" href="#beforedestory"></a> *beforeDestory()</h5><h5 id="destoryed"><a class="markdownIt-Anchor" href="#destoryed"></a> *destoryed()</h5><h4 id="1-14-4-常用的生命周期方法"><a class="markdownIt-Anchor" href="#1-14-4-常用的生命周期方法"></a> 1. 14. 4 .常用的生命周期方法</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1. mounted():发送ajax请求,启动定时器等异步任务</span><br><span class="line">2. beforeDestory():做收尾工作,如:清除定时器</span><br></pre></td></tr></table></figure><h2 id="第-2-章vue-组件化编程"><a class="markdownIt-Anchor" href="#第-2-章vue-组件化编程"></a> 第 2 章：Vue 组件化编程</h2><h3 id="2-1-模块与组件-模块化与组件化"><a class="markdownIt-Anchor" href="#2-1-模块与组件-模块化与组件化"></a> 2. 1 模块与组件、模块化与组件化</h3><h4 id="2-1-1-模块"><a class="markdownIt-Anchor" href="#2-1-1-模块"></a> 2. 1. 1 .模块</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1. 理解:向外提供特定功能的js程序,一般就是一个js文件</span><br><span class="line">2. 为什么: js文件很多很复杂</span><br><span class="line">3. 作用:复用js,简化js的编写,提高js运行效率</span><br></pre></td></tr></table></figure><h4 id="2-1-2-组件"><a class="markdownIt-Anchor" href="#2-1-2-组件"></a> 2. 1. 2 .组件</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1. 理解:用来实现局部(特定)功能效果的代码集合(html/css/js/image.....)</span><br><span class="line">2. 为什么:一个界面的功能很复杂</span><br></pre></td></tr></table></figure><h6 id="3-作用复用编码简化项目编码提高运行效率"><a class="markdownIt-Anchor" href="#3-作用复用编码简化项目编码提高运行效率"></a> 3. 作用:复用编码,简化项目编码,提高运行效率</h6><h4 id="2-1-3-模块化"><a class="markdownIt-Anchor" href="#2-1-3-模块化"></a> 2. 1. 3 .模块化</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">当应用中的js都以模块来编写的,那这个应用就是一个模块化的应用。</span><br></pre></td></tr></table></figure><h4 id="2-1-4-组件化"><a class="markdownIt-Anchor" href="#2-1-4-组件化"></a> 2. 1. 4 .组件化</h4><h6 id="当应用中的功能都是多组件的方式来编写的那这个应用就是一个组件化的应用"><a class="markdownIt-Anchor" href="#当应用中的功能都是多组件的方式来编写的那这个应用就是一个组件化的应用"></a> 当应用中的功能都是多组件的方式来编写的,那这个应用就是一个组件化的应用,。</h6><h3 id="2-2-非单文件组件"><a class="markdownIt-Anchor" href="#2-2-非单文件组件"></a> 2. 2 .非单文件组件</h3><h6 id="1-模板编写没有提示"><a class="markdownIt-Anchor" href="#1-模板编写没有提示"></a> 1. 模板编写没有提示</h6><h6 id="2-没有构建过程无法将-es-6-转换成-es-5"><a class="markdownIt-Anchor" href="#2-没有构建过程无法将-es-6-转换成-es-5"></a> 2. 没有构建过程,无法将 ES 6 转换成 ES 5</h6><h6 id="3-不支持组件的-css"><a class="markdownIt-Anchor" href="#3-不支持组件的-css"></a> 3. 不支持组件的 CSS</h6><h6 id="4-真正开发中几乎不用"><a class="markdownIt-Anchor" href="#4-真正开发中几乎不用"></a> 4. 真正开发中几乎不用</h6><h3 id="2-3-单文件组件"><a class="markdownIt-Anchor" href="#2-3-单文件组件"></a> 2. 3 .单文件组件</h3><h4 id="2-3-1-一个vue-文件的组成-3-个部分"><a class="markdownIt-Anchor" href="#2-3-1-一个vue-文件的组成-3-个部分"></a> 2. 3. 1 .一个.vue 文件的组成( 3 个部分)</h4><h6 id="1-模板页面"><a class="markdownIt-Anchor" href="#1-模板页面"></a> 1. 模板页面</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">页面模板</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure><h6 id="2-js-模块对象"><a class="markdownIt-Anchor" href="#2-js-模块对象"></a> 2. JS 模块对象</h6><script>exportdefault{data(){return{}},methods:{},computed:{},components:{}}</script><p><strong>3. 样式</strong></p><style>样式定义</style><h4 id="2-3-2-基本使用"><a class="markdownIt-Anchor" href="#2-3-2-基本使用"></a> 2. 3. 2 .基本使用</h4><h6 id="1-引入组件"><a class="markdownIt-Anchor" href="#1-引入组件"></a> 1. 引入组件</h6><h6 id="2-映射成标签"><a class="markdownIt-Anchor" href="#2-映射成标签"></a> 2. 映射成标签</h6><h6 id="3-使用组件标签"><a class="markdownIt-Anchor" href="#3-使用组件标签"></a> 3. 使用组件标签</h6><h2 id="第-3-章使用-vue-脚手架"><a class="markdownIt-Anchor" href="#第-3-章使用-vue-脚手架"></a> 第 3 章：使用 Vue 脚手架</h2><h3 id="3-1-初始化脚手架"><a class="markdownIt-Anchor" href="#3-1-初始化脚手架"></a> 3. 1 初始化脚手架</h3><h4 id="3-1-1-说明"><a class="markdownIt-Anchor" href="#3-1-1-说明"></a> 3. 1. 1 说明</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1. Vue脚手架是Vue官方提供的标准化开发工具（开发平台）。</span><br><span class="line">2. 最新的版本是 4 .x。</span><br><span class="line">3. 文档:https://cli.vuejs.org/zh/。</span><br></pre></td></tr></table></figure><h3 id="3-1-2-具体步骤"><a class="markdownIt-Anchor" href="#3-1-2-具体步骤"></a> 3. 1. 2 具体步骤</h3><p>第一步（仅第一次执行）：全局安装@vue/cli。<br />npminstall-g@vue/cli<br />第二步： <strong>切换到你要创建项目的目录</strong> ，然后使用命令创建项目<br />vuecreatexxxx<br />第三步：启动项目<br />npmrunserve<br />备注：</p><ol><li><p>如 ht 出 tp 现 s:/下/re 载 g 缓 ist 慢 ry 请.n 配 pm 置.tanopbmao 淘.o 宝 rg 镜像：npmconfigsetregistry</p></li><li><p>Vue 脚手架隐藏了所有 webpack 相关的配置，若想查看具体的 webpakc 配置，<br />请执行：vueinspect&gt;output.js</p></li></ol><h4 id="3-1-3-模板项目的结构"><a class="markdownIt-Anchor" href="#3-1-3-模板项目的结构"></a> 3. 1. 3 模板项目的结构</h4><h5 id="node_modules"><a class="markdownIt-Anchor" href="#node_modules"></a> ├──node_modules</h5><h5 id="public"><a class="markdownIt-Anchor" href="#public"></a> ├──public</h5><h5 id="faviconico页签图标"><a class="markdownIt-Anchor" href="#faviconico页签图标"></a> │ ├──favicon.ico:页签图标</h5><h5 id="indexhtml主页面"><a class="markdownIt-Anchor" href="#indexhtml主页面"></a> │ └──index.html:主页面</h5><h5 id="src"><a class="markdownIt-Anchor" href="#src"></a> ├──src</h5><h5 id="assets存放静态资源"><a class="markdownIt-Anchor" href="#assets存放静态资源"></a> │ ├──assets:存放静态资源</h5><h5 id="logopng"><a class="markdownIt-Anchor" href="#logopng"></a> │ │ └──logo.png</h5><h5 id="component存放组件"><a class="markdownIt-Anchor" href="#component存放组件"></a> │ │──component:存放组件</h5><h5 id="helloworldvue"><a class="markdownIt-Anchor" href="#helloworldvue"></a> │ │ └──HelloWorld.vue</h5><h5 id="appvue汇总所有组件"><a class="markdownIt-Anchor" href="#appvue汇总所有组件"></a> │ │──App.vue:汇总所有组件</h5><h5 id="mainjs入口文件"><a class="markdownIt-Anchor" href="#mainjs入口文件"></a> │ │──main.js:入口文件</h5><h5 id="gitignoregit-版本管制忽略的配置"><a class="markdownIt-Anchor" href="#gitignoregit-版本管制忽略的配置"></a> ├──.gitignore:git 版本管制忽略的配置</h5><h5 id="babelconfigjsbabel-的配置文件"><a class="markdownIt-Anchor" href="#babelconfigjsbabel-的配置文件"></a> ├──babel.config.js:babel 的配置文件</h5><h5 id="packagejson应用包配置文件"><a class="markdownIt-Anchor" href="#packagejson应用包配置文件"></a> ├──package.json:应用包配置文件</h5><h5 id="readmemd"><a class="markdownIt-Anchor" href="#readmemd"></a> <a href="http://xn--README-2n7ca4w.md">├──README.md</a>:应用描述文件</h5><h5 id="package-lockjson包版本控制文件"><a class="markdownIt-Anchor" href="#package-lockjson包版本控制文件"></a> ├──package-lock.json：包版本控制文件</h5><h3 id="3-2-ref-与-props"><a class="markdownIt-Anchor" href="#3-2-ref-与-props"></a> 3. 2 ref 与 props</h3><h3 id="ref"><a class="markdownIt-Anchor" href="#ref"></a> ref</h3><h6 id="1-作用-用于给节点打标识"><a class="markdownIt-Anchor" href="#1-作用-用于给节点打标识"></a> 1 .作用： 用于给节点打标识</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2 .读取方式： this.$refs.xxxxxx</span><br></pre></td></tr></table></figure><h3 id="props"><a class="markdownIt-Anchor" href="#props"></a> props</h3><h6 id="1-作用-用于父组件给子组件传递数据"><a class="markdownIt-Anchor" href="#1-作用-用于父组件给子组件传递数据"></a> 1. 作用： 用于父组件给子组件传递数据</h6><h6 id="2-读取方式一只指定名称"><a class="markdownIt-Anchor" href="#2-读取方式一只指定名称"></a> 2. 读取方式一:只指定名称</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">props:[&#x27;name&#x27;,&#x27;age&#x27;,&#x27;setName&#x27;]</span><br><span class="line">3. 读取方式二:指定名称和类型</span><br><span class="line">props:&#123;</span><br><span class="line">name:String,</span><br><span class="line">age:Number,</span><br><span class="line">setNmae:Function</span><br><span class="line">&#125;</span><br><span class="line">4. 读取方式三:指定名称/类型/必要性/默认值</span><br><span class="line">props:&#123;</span><br><span class="line">name:&#123;type:String,required:true,default:xxx&#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-3-混入"><a class="markdownIt-Anchor" href="#3-3-混入"></a> 3. 3 混入</h3><ol><li><p>Vue 插件是一个包含 install 方法的对象</p></li><li><p>通过 install 方法给 Vue 或 Vue 实例添加方法,定义全局指令等</p></li></ol><h3 id="3-4-插件"><a class="markdownIt-Anchor" href="#3-4-插件"></a> 3. 4 插件</h3><ol><li>Vue 插件是一个包含 install 方法的对象</li><li>通过 install 方法给 Vue 或 Vue 实例添加方法,定义全局指令等</li></ol><h3 id="3-5-todo-list-案例"><a class="markdownIt-Anchor" href="#3-5-todo-list-案例"></a> 3. 5 Todo-list 案例</h3><h4 id="组件化编码流程通用"><a class="markdownIt-Anchor" href="#组件化编码流程通用"></a> 组件化编码流程（通用）</h4><h6 id="1-实现静态组件抽取组件使用组件实现静态页面效果"><a class="markdownIt-Anchor" href="#1-实现静态组件抽取组件使用组件实现静态页面效果"></a> 1 .实现静态组件：抽取组件，使用组件实现静态页面效果</h6><h6 id="2-展示动态数据"><a class="markdownIt-Anchor" href="#2-展示动态数据"></a> 2 .展示动态数据：</h6><h6 id="2-1-数据的类型-名称是什么"><a class="markdownIt-Anchor" href="#2-1-数据的类型-名称是什么"></a> 2. 1 .数据的类型、名称是什么？</h6><h6 id="2-2-数据保存在哪个组件"><a class="markdownIt-Anchor" href="#2-2-数据保存在哪个组件"></a> 2. 2 .数据保存在哪个组件？</h6><h6 id="3-交互从绑定事件监听开始"><a class="markdownIt-Anchor" href="#3-交互从绑定事件监听开始"></a> 3 .交互——从绑定事件监听开始</h6><h3 id="3-6-vue-中的自定义事件"><a class="markdownIt-Anchor" href="#3-6-vue-中的自定义事件"></a> 3. 6 Vue 中的自定义事件</h3><h4 id="绑定事件监听"><a class="markdownIt-Anchor" href="#绑定事件监听"></a> 绑定事件监听</h4><p>&lt; <strong>Header@addTodo=&quot;</strong> addTodo <strong>&quot;</strong> /&gt;<br />或者<br />&lt; <strong>tHheiasd</strong>. <strong>e$rrerfesf</strong>. <strong>=</strong> h <strong>&quot;</strong> e <strong>h</strong> a <strong>e</strong> d <strong>a</strong> e <strong>d</strong> r <strong>e</strong>. <strong>r</strong> $ <strong>&quot;</strong> o/n&gt;( <strong>‘addTodo’</strong> , <strong>this</strong> .addTodo)</p><h4 id="触发事件"><a class="markdownIt-Anchor" href="#触发事件"></a> 触发事件</h4><p><strong>this</strong> .$emit( <strong>‘addTodo’</strong> , todo)</p><h3 id="3-7-全局事件总线"><a class="markdownIt-Anchor" href="#3-7-全局事件总线"></a> 3. 7 全局事件总线</h3><h4 id="3-7-1-理解"><a class="markdownIt-Anchor" href="#3-7-1-理解"></a> 3. 7. 1 理解</h4><ol><li>Vue 原型对象上包含事件处理的方法<br />1 ) $on(eventName,listener):绑定自定义事件监听<br />2 ) $emit(eventName,data):分发自定义事件<br />3 ) $off(eventName):解绑自定义事件监听<br />4 ) $once(eventName,listener):绑定事件监听,但只能处理一次</li><li>所有组件实例对象的原型对象的原型对象就是 Vue 的原型对象</li></ol><p>1 ) 所有组件对象都能看到 Vue 原型对象上的属性和方法<br />2 ) Vue.prototype.<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>b</mi><mi>u</mi><mi>s</mi><mo>=</mo><mi>n</mi><mi>e</mi><mi>w</mi><mi>V</mi><mi>u</mi><mi>e</mi><mo stretchy="false">(</mo><mo stretchy="false">)</mo><mo separator="true">,</mo><mi mathvariant="normal">所</mi><mi mathvariant="normal">有</mi><mi mathvariant="normal">的</mi><mi mathvariant="normal">组</mi><mi mathvariant="normal">件</mi><mi mathvariant="normal">对</mi><mi mathvariant="normal">象</mi><mi mathvariant="normal">都</mi><mi mathvariant="normal">能</mi><mi mathvariant="normal">看</mi><mi mathvariant="normal">到</mi></mrow><annotation encoding="application/x-tex">bus=newVue(),所有的组件对象都能看到</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">b</span><span class="mord mathdefault">u</span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">n</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="mord mathdefault">u</span><span class="mord mathdefault">e</span><span class="mopen">(</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord cjk_fallback">所</span><span class="mord cjk_fallback">有</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">组</span><span class="mord cjk_fallback">件</span><span class="mord cjk_fallback">对</span><span class="mord cjk_fallback">象</span><span class="mord cjk_fallback">都</span><span class="mord cjk_fallback">能</span><span class="mord cjk_fallback">看</span><span class="mord cjk_fallback">到</span></span></span></span>bus 这个属性<br />对象 3. 全局事件总线<br />1 ) 包含事件处理相关方法的对象(只有一个)<br />2 ) 所有的组件都可以得到</p><h4 id="3-7-2-指定事件总线对象"><a class="markdownIt-Anchor" href="#3-7-2-指定事件总线对象"></a> 3. 7. 2 指定事件总线对象</h4><p><strong>new</strong> beVfuoer(e{Create () { <em>//</em> 尽量早的执行挂载全局事件总线对象的操作</p><p>},Vue. <strong>prototype</strong>. **<span class='katex-error' title='ParseError: KaTeX parse error: Expected &#039;EOF&#039;, got &#039;}&#039; at position 29: …s** = **this**}̲).'>globalEventBus** = **this**}).</span>mount( <strong>‘#root’</strong> )</p><h4 id="3-7-3-绑定事件"><a class="markdownIt-Anchor" href="#3-7-3-绑定事件"></a> 3. 7. 3 绑定事件</h4><p><strong>this</strong>. **<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>g</mi><mi>l</mi><mi>o</mi><mi>b</mi><mi>a</mi><mi>l</mi><mi>E</mi><mi>v</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>B</mi><mi>u</mi><mi>s</mi><mo>∗</mo><mo>∗</mo><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">globalEventBus** .</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault">b</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mord mathdefault">u</span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord">∗</span><span class="mord">.</span></span></span></span>on( <strong>‘deleteTodo’</strong> , <strong>this</strong> .deleteTodo)</p><h4 id="3-7-4-分发事件"><a class="markdownIt-Anchor" href="#3-7-4-分发事件"></a> 3. 7. 4 分发事件</h4><p><strong>this</strong>. **<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>g</mi><mi>l</mi><mi>o</mi><mi>b</mi><mi>a</mi><mi>l</mi><mi>E</mi><mi>v</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>B</mi><mi>u</mi><mi>s</mi><mo>∗</mo><mo>∗</mo><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">globalEventBus** .</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault">b</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mord mathdefault">u</span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord">∗</span><span class="mord">.</span></span></span></span>emit( <strong>‘deleteTodo’</strong> , <strong>this</strong>. <strong>index</strong> )</p><h4 id="3-7-5-解绑事件"><a class="markdownIt-Anchor" href="#3-7-5-解绑事件"></a> 3. 7. 5 解绑事件</h4><p><strong>this</strong>. **<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>g</mi><mi>l</mi><mi>o</mi><mi>b</mi><mi>a</mi><mi>l</mi><mi>E</mi><mi>v</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>B</mi><mi>u</mi><mi>s</mi><mo>∗</mo><mo>∗</mo><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">globalEventBus** .</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault">b</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mord mathdefault">u</span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord">∗</span><span class="mord">.</span></span></span></span>off( <strong>‘deleteTodo’</strong> )</p><h3 id="3-8-消息订阅与发布"><a class="markdownIt-Anchor" href="#3-8-消息订阅与发布"></a> 3. 8 消息订阅与发布</h3><h4 id="3-8-1-理解"><a class="markdownIt-Anchor" href="#3-8-1-理解"></a> 3. 8. 1 理解</h4><h6 id="1-这种方式的思想与全局事件总线很相似"><a class="markdownIt-Anchor" href="#1-这种方式的思想与全局事件总线很相似"></a> 1 .这种方式的思想与全局事件总线很相似</h6><h6 id="2-它包含以下操作"><a class="markdownIt-Anchor" href="#2-它包含以下操作"></a> 2 .它包含以下操作:</h6><h6 id="1-订阅消息对应绑定事件监听"><a class="markdownIt-Anchor" href="#1-订阅消息对应绑定事件监听"></a> ( 1 ) 订阅消息–对应绑定事件监听</h6><h6 id="2-发布消息分发事件"><a class="markdownIt-Anchor" href="#2-发布消息分发事件"></a> ( 2 ) 发布消息–分发事件</h6><h6 id="3-取消消息订阅解绑事件监听"><a class="markdownIt-Anchor" href="#3-取消消息订阅解绑事件监听"></a> ( 3 ) 取消消息订阅–解绑事件监听</h6><p>3 .需要引入一个消息订阅与发布的第三方实现库: <strong>PubSubJS</strong></p><h4 id="3-8-2-使用-pubsubjs"><a class="markdownIt-Anchor" href="#3-8-2-使用-pubsubjs"></a> 3. 8. 2 使用 PubSubJS</h4><h5 id="1-在线文档httpsgithubcommroderickpubsubjs"><a class="markdownIt-Anchor" href="#1-在线文档httpsgithubcommroderickpubsubjs"></a> 1 .在线文档:<a href="https://github.com/mroderick/PubSubJS">https://github.com/mroderick/PubSubJS</a></h5><p>2 .下载:npminstall-Spubsub-js<br />3 .相关语法<br />( 1 ) importPubSubfrom’pubsub-js’ //引入<br />( 2 ) PubSub.subscribe(‘msgName’,functon(msgName,data){})<br />( 3 ) PubSub.publish(‘msgName’,data):发布消息,触发订阅的回调函数调用<br />( 4 ) PubSub.unsubscribe(token):取消消息的订阅</p><h3 id="3-9-过度与动画"><a class="markdownIt-Anchor" href="#3-9-过度与动画"></a> 3. 9 过度与动画</h3><h4 id="3-9-1-效果"><a class="markdownIt-Anchor" href="#3-9-1-效果"></a> 3. 9. 1 效果</h4><h4 id="3-9-2-vue-动画的理解"><a class="markdownIt-Anchor" href="#3-9-2-vue-动画的理解"></a> 3. 9. 2 vue 动画的理解</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1 .操作css的trasition或animation</span><br><span class="line">2 .vue会给目标元素添加/移除特定的class</span><br><span class="line">3 .过渡的相关类名：</span><br><span class="line">1 .xxx-enter-active:指定显示的transition</span><br><span class="line">2 .xxx-leave-active:指定隐藏的transition</span><br><span class="line">3 .xxx-enter/xxx-leave-to:指定隐藏时的样式</span><br></pre></td></tr></table></figure><h4 id="3-9-3-基本过渡动画的编码"><a class="markdownIt-Anchor" href="#3-9-3-基本过渡动画的编码"></a> 3. 9. 3 基本过渡动画的编码</h4><ol><li>在目标元素外包裹&lt;transitionname=“xxx”&gt;</li><li>定义 class 样式<br />a) 指定过渡样式:transition<br />b) 指定隐藏时的样式:opacity/其它</li></ol><h2 id="第-4-章vue-中的-ajax"><a class="markdownIt-Anchor" href="#第-4-章vue-中的-ajax"></a> 第 4 章：Vue 中的 ajax</h2><h3 id="4-1-解决开发环境-ajax-跨域问题"><a class="markdownIt-Anchor" href="#4-1-解决开发环境-ajax-跨域问题"></a> 4. 1 解决开发环境 Ajax 跨域问题</h3><h6 id="使用代理服务器"><a class="markdownIt-Anchor" href="#使用代理服务器"></a> 使用代理服务器</h6><h3 id="4-2-github-用户搜索案例"><a class="markdownIt-Anchor" href="#4-2-github-用户搜索案例"></a> 4. 2 github 用户搜索案例</h3><h3 id="4-2-1-效果"><a class="markdownIt-Anchor" href="#4-2-1-效果"></a> 4. 2. 1 效果</h3><h3 id="4-2-2-接口地址"><a class="markdownIt-Anchor" href="#4-2-2-接口地址"></a> 4. 2. 2 接口地址</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://api.github.com/search/users?q=xxx</span><br></pre></td></tr></table></figure><h3 id="4-3-vue-项目中常用的-2-个-ajax-库"><a class="markdownIt-Anchor" href="#4-3-vue-项目中常用的-2-个-ajax-库"></a> 4. 3 vue 项目中常用的 2 个 Ajax 库</h3><h4 id="4-3-1-axios"><a class="markdownIt-Anchor" href="#4-3-1-axios"></a> 4. 3. 1 axios</h4><p>通用的 Ajax 请求库,官方推荐，使用广泛</p><h4 id="4-3-2-vue-resource"><a class="markdownIt-Anchor" href="#4-3-2-vue-resource"></a> 4. 3. 2 vue-resource</h4><p>vue 插件库,vue 1 .x 使用广泛， <strong>官方已不维护。</strong></p><h3 id="4-4-slot-插槽"><a class="markdownIt-Anchor" href="#4-4-slot-插槽"></a> 4. 4 slot 插槽</h3><h4 id="4-4-1-效果"><a class="markdownIt-Anchor" href="#4-4-1-效果"></a> 4. 4. 1 效果</h4><h6 id="效果一不使用插槽"><a class="markdownIt-Anchor" href="#效果一不使用插槽"></a> 效果一（不使用插槽）：</h6><h6 id="效果二默认插槽"><a class="markdownIt-Anchor" href="#效果二默认插槽"></a> 效果二（默认插槽）：</h6><h6 id="效果三具名插槽"><a class="markdownIt-Anchor" href="#效果三具名插槽"></a> 效果三（具名插槽）：</h6><h6 id="效果三作用域插槽"><a class="markdownIt-Anchor" href="#效果三作用域插槽"></a> 效果三（作用域插槽）：</h6><h4 id="4-4-1-理解"><a class="markdownIt-Anchor" href="#4-4-1-理解"></a> 4. 4. 1 理解</h4><h6 id="父组件向子组件传递带数据的标签当一个组件有不确定的结构时就需要使用"><a class="markdownIt-Anchor" href="#父组件向子组件传递带数据的标签当一个组件有不确定的结构时就需要使用"></a> 父组件向子组件传递带数据的标签，当一个组件有不确定的结构时,就需要使用</h6><p>slot 技术，注意：插槽内容是在父组件中编译后,再传递给子组件的。</p><h4 id="4-4-2-分类"><a class="markdownIt-Anchor" href="#4-4-2-分类"></a> 4. 4. 2 分类</h4><h6 id="1-默认插槽"><a class="markdownIt-Anchor" href="#1-默认插槽"></a> 1 .默认插槽</h6><h6 id="2-命名插槽"><a class="markdownIt-Anchor" href="#2-命名插槽"></a> 2 .命名插槽</h6><h6 id="3-作用域插槽"><a class="markdownIt-Anchor" href="#3-作用域插槽"></a> 3 .作用域插槽</h6><h2 id="第-5-章vuex"><a class="markdownIt-Anchor" href="#第-5-章vuex"></a> 第 5 章：vuex</h2><h3 id="5-1-理解-vuex"><a class="markdownIt-Anchor" href="#5-1-理解-vuex"></a> 5. 1 理解 vuex</h3><h4 id="5-1-1-vuex-是什么"><a class="markdownIt-Anchor" href="#5-1-1-vuex-是什么"></a> 5. 1. 1 vuex 是什么</h4><ol><li>概念：专门在 Vue 中实现集中式状态（数据）管理的一个 Vue 插件，对 vue 应<br />用中多个组件的共享状态进行集中式的管理（读/写），也是一种组件间通信的方<br />式，且适用于任意组件间通信。</li><li>Github 地址:<a href="https://github.com/vuejs/vuex">https://github.com/vuejs/vuex</a></li></ol><h4 id="5-1-2-什么时候使用-vuex"><a class="markdownIt-Anchor" href="#5-1-2-什么时候使用-vuex"></a> 5. 1. 2 什么时候使用 Vuex</h4><h6 id="1-多个组件依赖于同一状态"><a class="markdownIt-Anchor" href="#1-多个组件依赖于同一状态"></a> 1 .多个组件依赖于同一状态</h6><h6 id="2-来自不同组件的行为需要变更同一状态"><a class="markdownIt-Anchor" href="#2-来自不同组件的行为需要变更同一状态"></a> 2 .来自不同组件的行为需要变更同一状态</h6><h4 id="5-1-3-案例"><a class="markdownIt-Anchor" href="#5-1-3-案例"></a> 5. 1. 3 案例</h4><h4 id="5-1-4-vuex-工作原理图"><a class="markdownIt-Anchor" href="#5-1-4-vuex-工作原理图"></a> 5. 1. 4 Vuex 工作原理图</h4><h3 id="5-2-vuex-核心概念和-api"><a class="markdownIt-Anchor" href="#5-2-vuex-核心概念和-api"></a> 5. 2 vuex 核心概念和 API</h3><h3 id="5-2-1-state"><a class="markdownIt-Anchor" href="#5-2-1-state"></a> 5. 2. 1 state</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1 .vuex管理的状态对象</span><br><span class="line">2 .它应该是唯一的</span><br><span class="line">3 .示例代码：</span><br></pre></td></tr></table></figure><h3 id="5-2-2-actions"><a class="markdownIt-Anchor" href="#5-2-2-actions"></a> 5. 2. 2 actions</h3><h6 id="1-值为一个对象包含多个响应用户动作的回调函数"><a class="markdownIt-Anchor" href="#1-值为一个对象包含多个响应用户动作的回调函数"></a> 1 .值为一个对象，包含多个响应用户动作的回调函数</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2 .通过commit()来触发mutation中函数的调用,间接更新state</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">3 .如何触发actions中的回调？</span><br><span class="line">在组件中使用: $store.dispatch(&#x27;对应的action回调名&#x27;) 触发</span><br><span class="line">4 .可以包含异步代码（定时器,ajax等等）</span><br><span class="line">5 .示例代码：</span><br></pre></td></tr></table></figure><h3 id="5-2-3-mutations"><a class="markdownIt-Anchor" href="#5-2-3-mutations"></a> 5. 2. 3 mutations</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1 .值是一个对象，包含多个直接更新state的方法</span><br><span class="line">2 .谁能调用mutations中的方法？如何调用？</span><br><span class="line">在action中使用： commit(&#x27;对应的mutations方法名&#x27;) 触发</span><br><span class="line">3 .mutations中方法的特点：不能写异步代码、只能单纯的操作state</span><br><span class="line">4 .示例代码：</span><br></pre></td></tr></table></figure><h3 id="5-2-4-getters"><a class="markdownIt-Anchor" href="#5-2-4-getters"></a> 5. 2. 4 getters</h3><h6 id="1-值为一个对象包含多个用于返回数据的函数"><a class="markdownIt-Anchor" href="#1-值为一个对象包含多个用于返回数据的函数"></a> 1 .值为一个对象，包含多个用于返回数据的函数</h6><h5 id="2-如何使用-storegettersxxx"><a class="markdownIt-Anchor" href="#2-如何使用-storegettersxxx"></a> 2 .如何使用？—— $<a href="http://store.getters.xxx">store.getters.xxx</a></h5><h6 id="3-示例代码"><a class="markdownIt-Anchor" href="#3-示例代码"></a> 3 .示例代码：</h6><h3 id="5-2-5-modules"><a class="markdownIt-Anchor" href="#5-2-5-modules"></a> 5. 2. 5 modules</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1 .包含多个module</span><br><span class="line">2 .一个module是一个store的配置对象</span><br><span class="line">3 .与一个组件（包含有共享数据）对应</span><br></pre></td></tr></table></figure><h2 id="第-6-章vue-router"><a class="markdownIt-Anchor" href="#第-6-章vue-router"></a> 第 6 章：vue-router</h2><h3 id="6-1-相关理解"><a class="markdownIt-Anchor" href="#6-1-相关理解"></a> 6. 1 相关理解</h3><h4 id="6-1-1-vue-router-的理解"><a class="markdownIt-Anchor" href="#6-1-1-vue-router-的理解"></a> 6. 1. 1 vue-router 的理解</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vue的一个插件库，专门用来实现SPA应用</span><br></pre></td></tr></table></figure><h4 id="6-1-2-对-spa-应用的理解"><a class="markdownIt-Anchor" href="#6-1-2-对-spa-应用的理解"></a> 6. 1. 2 对 SPA 应用的理解</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1. 单页Web应用（singlepagewebapplication，SPA）。</span><br><span class="line">2. 整个应用只有 一个完整的页面 。</span><br><span class="line">3. 点击页面中的导航链接 不会刷新 页面，只会做页面的 局部更新。</span><br><span class="line">4. 数据需要通过ajax请求获取。</span><br></pre></td></tr></table></figure><h4 id="6-1-3-路由的理解"><a class="markdownIt-Anchor" href="#6-1-3-路由的理解"></a> 6. 1. 3 路由的理解</h4><h6 id="1-什么是路由"><a class="markdownIt-Anchor" href="#1-什么是路由"></a> 1. 什么是路由?</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">1. 一个路由就是一组映射关系（key-value）</span><br><span class="line">2. key为路径,value可能是function或component</span><br><span class="line">2. 路由分类</span><br><span class="line">1. 后端路由：</span><br><span class="line">1 ) 理解：value是function,用于处理客户端提交的请求。</span><br><span class="line">2 ) 工作过程：服务器接收到一个请求时,根据 请求路径 找到匹配的 函数</span><br><span class="line">来处理请求,返回响应数据。</span><br><span class="line">2. 前端路由：</span><br><span class="line">1 ) 理解：value是component，用于展示页面内容。</span><br><span class="line">2 ) 工作过程：当浏览器的路径改变时,对应的组件就会显示。</span><br></pre></td></tr></table></figure><h3 id="6-2-基本路由"><a class="markdownIt-Anchor" href="#6-2-基本路由"></a> 6. 2 基本路由</h3><h4 id="6-2-1-效果"><a class="markdownIt-Anchor" href="#6-2-1-效果"></a> 6. 2. 1 效果</h4><h4 id="6-2-2-总结编写使用路由的-3-步"><a class="markdownIt-Anchor" href="#6-2-2-总结编写使用路由的-3-步"></a> 6. 2. 2 总结:编写使用路由的 3 步</h4><h6 id="1-定义路由组件"><a class="markdownIt-Anchor" href="#1-定义路由组件"></a> 1. 定义路由组件</h6><h6 id="2-注册路由"><a class="markdownIt-Anchor" href="#2-注册路由"></a> 2. 注册路由</h6><h6 id="3-使用路由"><a class="markdownIt-Anchor" href="#3-使用路由"></a> 3. 使用路由</h6><h3 id="6-3-嵌套多级路由"><a class="markdownIt-Anchor" href="#6-3-嵌套多级路由"></a> 6. 3 嵌套（多级）路由</h3><h3 id="6-4-路由传参"><a class="markdownIt-Anchor" href="#6-4-路由传参"></a> 6. 4 路由传参</h3><h3 id="6-5-编程式路由导航"><a class="markdownIt-Anchor" href="#6-5-编程式路由导航"></a> 6. 5 编程式路由导航</h3><h5 id="相关-api"><a class="markdownIt-Anchor" href="#相关-api"></a> 相关 API：</h5><ol><li>this.$router.push(path):相当于点击路由链接(可以返回到当前路由界面)</li><li>this.$router.replace(path):用新路由替换当前路由(不可以返回到当前路由界面)</li><li>this.$router.back():请求(返回)上一个记录路由</li><li>this.$router.go(- 1 ):请求(返回)上一个记录路由</li><li>this.$router.go( 1 ):请求下一个记录路由</li></ol><h2 id="第-7-章vue-ui-组件库"><a class="markdownIt-Anchor" href="#第-7-章vue-ui-组件库"></a> 第 7 章：Vue UI 组件库</h2><h4 id="7-1-移动端常用-ui-组件库"><a class="markdownIt-Anchor" href="#7-1-移动端常用-ui-组件库"></a> 7. 1 移动端常用 UI 组件库</h4><ol><li>Vant <a href="https://youzan.github.io/vant">https://youzan.github.io/vant</a></li><li>CubeUI <a href="https://didi.github.io/cube-ui">https://didi.github.io/cube-ui</a></li><li>MintUI <a href="http://mint-ui.github.io">http://mint-ui.github.io</a></li></ol><h4 id="7-2-pc-端常用-ui-组件库"><a class="markdownIt-Anchor" href="#7-2-pc-端常用-ui-组件库"></a> 7. 2 PC 端常用 UI 组件库</h4><ol><li>ElementUI <a href="https://element.eleme.cn">https://element.eleme.cn</a></li><li>IViewUI <a href="https://www.iviewui.com">https://www.iviewui.com</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> Vue </category>
          
          <category> 编程笔记 </category>
          
          <category> Vue天禹老师笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
            <tag> 编程笔记 </tag>
            
            <tag> Vue学习笔记(尚硅谷天禹老师) </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Spring常见面试题</title>
      <link href="/posts/5dd00982/"/>
      <url>/posts/5dd00982/</url>
      
        <content type="html"><![CDATA[<h2 id="一般问题"><a class="markdownIt-Anchor" href="#一般问题"></a> 一般问题</h2><h3 id="不同版本的-spring-framework-有哪些主要功能"><a class="markdownIt-Anchor" href="#不同版本的-spring-framework-有哪些主要功能"></a> 不同版本的 Spring Framework 有哪些主要功能？</h3><table><thead><tr><th>Version</th><th>Feature</th></tr></thead><tbody><tr><td>Spring 2.5</td><td>发布于 2007 年。这是第一个支持注解的版本。</td></tr><tr><td>Spring 3.0</td><td>发布于 2009 年。它完全利用了 Java5 中的改进，并为 JEE6 提供了支持。</td></tr><tr><td>Spring 4.0</td><td>发布于 2013 年。这是第一个完全支持 JAVA8 的版本。</td></tr></tbody></table><h3 id="什么是-spring-framework"><a class="markdownIt-Anchor" href="#什么是-spring-framework"></a> 什么是 Spring Framework？</h3><ul><li>Spring 是一个开源应用框架，旨在降低应用程序开发的复杂度。</li><li>它是轻量级、松散耦合的。</li><li>它具有分层体系结构，允许用户选择组件，同时还为 J2EE 应用程序开发提供了一个有凝聚力的框架。</li><li>它可以集成其他框架，如 Structs、Hibernate、EJB 等，所以又称为框架的框架。</li></ul><h3 id="列举-spring-framework-的优点"><a class="markdownIt-Anchor" href="#列举-spring-framework-的优点"></a> 列举 Spring Framework 的优点。</h3><ul><li>由于 Spring Frameworks 的分层架构，用户可以自由选择自己需要的组件。</li><li>Spring Framework 支持 POJO(Plain Old Java Object) 编程，从而具备持续集成和可测试性。</li><li>由于依赖注入和控制反转，JDBC 得以简化。</li><li>它是开源免费的。</li></ul><h3 id="spring-framework-有哪些不同的功能"><a class="markdownIt-Anchor" href="#spring-framework-有哪些不同的功能"></a> Spring Framework 有哪些不同的功能？</h3><ul><li><strong>轻量级</strong> - Spring 在代码量和透明度方面都很轻便。</li><li><strong>IOC</strong> - 控制反转</li><li><strong>AOP</strong> - 面向切面编程可以将应用业务逻辑和系统服务分离，以实现高内聚。</li><li><strong>容器</strong> - Spring 负责创建和管理对象（Bean）的生命周期和配置。</li><li><strong>MVC</strong> - 对 web 应用提供了高度可配置性，其他框架的集成也十分方便。</li><li><strong>事务管理</strong> - 提供了用于事务管理的通用抽象层。Spring 的事务支持也可用于容器较少的环境。</li><li><strong>JDBC 异常</strong> - Spring 的 JDBC 抽象层提供了一个异常层次结构，简化了错误处理策略。</li></ul><h3 id="spring-framework-中有多少个模块它们分别是什么"><a class="markdownIt-Anchor" href="#spring-framework-中有多少个模块它们分别是什么"></a> Spring Framework 中有多少个模块，它们分别是什么？</h3><ul><li><p>Spring 核心容器</p><p>– 该层基本上是 Spring Framework 的核心。它包含以下模块：</p><ul><li>Spring Core</li><li>Spring Bean</li><li>SpEL (Spring Expression Language)</li><li>Spring Context</li></ul></li><li><p>数据访问/集成</p><p>– 该层提供与数据库交互的支持。它包含以下模块：</p><ul><li>JDBC (Java DataBase Connectivity)</li><li>ORM (Object Relational Mapping)</li><li>OXM (Object XML Mappers)</li><li>JMS (Java Messaging Service)</li><li>Transaction</li></ul></li><li><p>Web</p><p>– 该层提供了创建 Web 应用程序的支持。它包含以下模块：</p><ul><li>Web</li><li>Web – Servlet</li><li>Web – Socket</li><li>Web – Portlet</li></ul></li><li><p><strong>AOP</strong> – 该层支持面向切面编程</p></li><li><p><strong>Instrumentation</strong> – 该层为类检测和类加载器实现提供支持。</p></li><li><p><strong>Test</strong> – 该层为使用 JUnit 和 TestNG 进行测试提供支持。</p></li><li><p>几个杂项模块:</p><ul><li>Messaging – 该模块为 STOMP 提供支持。它还支持注解编程模型，该模型用于从 WebSocket 客户端路由和处理 STOMP 消息。</li><li>Aspects – 该模块为与 AspectJ 的集成提供支持。</li></ul></li></ul><h3 id="什么是-spring-配置文件"><a class="markdownIt-Anchor" href="#什么是-spring-配置文件"></a> 什么是 Spring 配置文件？</h3><p>Spring 配置文件是 XML 文件。该文件主要包含类信息。它描述了这些类是如何配置以及相互引入的。但是，XML 配置文件冗长且更加干净。如果没有正确规划和编写，那么在大项目中管理变得非常困难。</p><h3 id="spring-应用程序有哪些不同组件"><a class="markdownIt-Anchor" href="#spring-应用程序有哪些不同组件"></a> Spring 应用程序有哪些不同组件？</h3><p>Spring 应用一般有以下组件：</p><ul><li><strong>接口</strong> - 定义功能。</li><li><strong>Bean 类</strong> - 它包含属性，setter 和 getter 方法，函数等。</li><li><strong>Spring 面向切面编程（AOP）</strong> - 提供面向切面编程的功能。</li><li><strong>Bean 配置文件</strong> - 包含类的信息以及如何配置它们。</li><li><strong>用户程序</strong> - 它使用接口。</li></ul><h3 id="使用-spring-有哪些方式"><a class="markdownIt-Anchor" href="#使用-spring-有哪些方式"></a> 使用 Spring 有哪些方式？</h3><p>使用 Spring 有以下方式：</p><ul><li>作为一个成熟的 Spring Web 应用程序。</li><li>作为第三方 Web 框架，使用 Spring Frameworks 中间层。</li><li>用于远程使用。</li><li>作为企业级 Java Bean，它可以包装现有的 POJO（Plain Old Java Objects）。</li></ul><h2 id="依赖注入ioc"><a class="markdownIt-Anchor" href="#依赖注入ioc"></a> 依赖注入（Ioc）</h2><h3 id="什么是-spring-ioc-容器"><a class="markdownIt-Anchor" href="#什么是-spring-ioc-容器"></a> 什么是 Spring IOC 容器？</h3><p>Spring 框架的核心是 Spring 容器。容器创建对象，将它们装配在一起，配置它们并管理它们的完整生命周期。Spring 容器使用依赖注入来管理组成应用程序的组件。容器通过读取提供的配置元数据来接收对象进行实例化，配置和组装的指令。该元数据可以通过 XML，Java 注解或 Java 代码提供。</p><p><img src="https://upload-images.jianshu.io/upload_images/3101171-33099411d16ca051.png" alt="img" /></p><h3 id="什么是依赖注入"><a class="markdownIt-Anchor" href="#什么是依赖注入"></a> 什么是依赖注入？</h3><p>在依赖注入中，您不必创建对象，但必须描述如何创建它们。您不是直接在代码中将组件和服务连接在一起，而是描述配置文件中哪些组件需要哪些服务。由 IoC 容器将它们装配在一起。</p><h3 id="可以通过多少种方式完成依赖注入"><a class="markdownIt-Anchor" href="#可以通过多少种方式完成依赖注入"></a> 可以通过多少种方式完成依赖注入？</h3><p>通常，依赖注入可以通过三种方式完成，即：</p><ul><li>构造函数注入</li><li>setter 注入</li><li>接口注入</li></ul><p>在 Spring Framework 中，仅使用构造函数和 setter 注入。</p><h3 id="区分构造函数注入和-setter-注入"><a class="markdownIt-Anchor" href="#区分构造函数注入和-setter-注入"></a> 区分构造函数注入和 setter 注入。</h3><table><thead><tr><th>构造函数注入</th><th>setter 注入</th></tr></thead><tbody><tr><td>没有部分注入</td><td>有部分注入</td></tr><tr><td>不会覆盖 setter 属性</td><td>会覆盖 setter 属性</td></tr><tr><td>任意修改都会创建一个新实例</td><td>任意修改不会创建一个新实例</td></tr><tr><td>适用于设置很多属性</td><td>适用于设置少量属性</td></tr></tbody></table><h3 id="spring-中有多少种-ioc-容器"><a class="markdownIt-Anchor" href="#spring-中有多少种-ioc-容器"></a> spring 中有多少种 IOC 容器？</h3><ul><li>BeanFactory - BeanFactory 就像一个包含 bean 集合的工厂类。它会在客户端要求时实例化 bean。</li><li>ApplicationContext - ApplicationContext 接口扩展了 BeanFactory 接口。它在 BeanFactory 基础上提供了一些额外的功能。</li></ul><h3 id="区分-beanfactory-和-applicationcontext"><a class="markdownIt-Anchor" href="#区分-beanfactory-和-applicationcontext"></a> 区分 BeanFactory 和 ApplicationContext。</h3><table><thead><tr><th>BeanFactory</th><th>ApplicationContext</th></tr></thead><tbody><tr><td>它使用懒加载</td><td>它使用即时加载</td></tr><tr><td>它使用语法显式提供资源对象</td><td>它自己创建和管理资源对象</td></tr><tr><td>不支持国际化</td><td>支持国际化</td></tr><tr><td>不支持基于依赖的注解</td><td>支持基于依赖的注解</td></tr></tbody></table><h3 id="列举-ioc-的一些好处"><a class="markdownIt-Anchor" href="#列举-ioc-的一些好处"></a> 列举 IoC 的一些好处。</h3><p>IoC 的一些好处是：</p><ul><li>它将最小化应用程序中的代码量。</li><li>它将使您的应用程序易于测试，因为它不需要单元测试用例中的任何单例或 JNDI 查找机制。</li><li>它以最小的影响和最少的侵入机制促进松耦合。</li><li>它支持即时的实例化和延迟加载服务。</li></ul><h3 id="spring-ioc-的实现机制"><a class="markdownIt-Anchor" href="#spring-ioc-的实现机制"></a> Spring IoC 的实现机制。</h3><p>Spring 中的 IoC 的实现原理就是工厂模式加反射机制。</p><p>示例：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Fruit</span> &#123;</span><br><span class="line">     <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">eat</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Apple</span> <span class="keyword">implements</span> <span class="title class_">Fruit</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">eat</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Apple&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Orange</span> <span class="keyword">implements</span> <span class="title class_">Fruit</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">eat</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Orange&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Factory</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Fruit <span class="title function_">getInstance</span><span class="params">(String ClassName)</span> &#123;</span><br><span class="line">        Fruit f=<span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            f=(Fruit)Class.forName(ClassName).newInstance();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> f;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Client</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] a)</span> &#123;</span><br><span class="line">        Fruit f=Factory.getInstance(<span class="string">&quot;io.github.dunwu.spring.Apple&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(f!=<span class="literal">null</span>)&#123;</span><br><span class="line">            f.eat();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="beans"><a class="markdownIt-Anchor" href="#beans"></a> Beans</h2><h3 id="什么是-spring-bean"><a class="markdownIt-Anchor" href="#什么是-spring-bean"></a> 什么是 spring bean？</h3><ul><li>它们是构成用户应用程序主干的对象。</li><li>Bean 由 Spring IoC 容器管理。</li><li>它们由 Spring IoC 容器实例化，配置，装配和管理。</li><li>Bean 是基于用户提供给容器的配置元数据创建。</li></ul><h3 id="spring-提供了哪些配置方式"><a class="markdownIt-Anchor" href="#spring-提供了哪些配置方式"></a> spring 提供了哪些配置方式？</h3><ul><li>基于 xml 配置</li></ul><p>bean 所需的依赖项和服务在 XML 格式的配置文件中指定。这些配置文件通常包含许多 bean 定义和特定于应用程序的配置选项。它们通常以 bean 标签开头。例如：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;studentbean&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.edureka.firstSpring.StudentBean&quot;</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Edureka&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>基于注解配置</li></ul><p>您可以通过在相关的类，方法或字段声明上使用注解，将 bean 配置为组件类本身，而不是使用 XML 来描述 bean 装配。默认情况下，Spring 容器中未打开注解装配。因此，您需要在使用它之前在 Spring 配置文件中启用它。例如：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">beans</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:annotation-config</span>/&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- bean definitions go here --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>基于 Java API 配置</li></ul><p>Spring 的 Java 配置是通过使用 @Bean 和 @Configuration 来实现。</p><ol><li>@Bean 注解扮演与 <code>&lt;bean /&gt;</code> 元素相同的角色。</li><li>@Configuration 类允许通过简单地调用同一个类中的其他 @Bean 方法来定义 bean 间依赖关系。</li></ol><p>例如：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StudentConfig</span> &#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> StudentBean <span class="title function_">myStudent</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">StudentBean</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="spring-支持集中-bean-scope"><a class="markdownIt-Anchor" href="#spring-支持集中-bean-scope"></a> spring 支持集中 bean scope？</h3><p>Spring bean 支持 5 种 scope：</p><ul><li><strong>Singleton</strong> - 每个 Spring IoC 容器仅有一个单实例。</li><li><strong>Prototype</strong> - 每次请求都会产生一个新的实例。</li><li><strong>Request</strong> - 每一次 HTTP 请求都会产生一个新的实例，并且该 bean 仅在当前 HTTP 请求内有效。</li><li><strong>Session</strong> - 每一次 HTTP 请求都会产生一个新的 bean，同时该 bean 仅在当前 HTTP session 内有效。</li><li><strong>Global-session</strong> - 类似于标准的 HTTP Session 作用域，不过它仅仅在基于 portlet 的 web 应用中才有意义。Portlet 规范定义了全局 Session 的概念，它被所有构成某个 portlet web 应用的各种不同的 portlet 所共享。在 global session 作用域中定义的 bean 被限定于全局 portlet Session 的生命周期范围内。如果你在 web 中使用 global session 作用域来标识 bean，那么 web 会自动当成 session 类型来使用。</li></ul><p>仅当用户使用支持 Web 的 ApplicationContext 时，最后三个才可用。</p><h3 id="spring-bean-容器的生命周期是什么样的"><a class="markdownIt-Anchor" href="#spring-bean-容器的生命周期是什么样的"></a> spring bean 容器的生命周期是什么样的？</h3><p>spring bean 容器的生命周期流程如下：</p><ol><li>Spring 容器根据配置中的 bean 定义中实例化 bean。</li><li>Spring 使用依赖注入填充所有属性，如 bean 中所定义的配置。</li><li>如果 bean 实现 BeanNameAware 接口，则工厂通过传递 bean 的 ID 来调用 setBeanName()。</li><li>如果 bean 实现 BeanFactoryAware 接口，工厂通过传递自身的实例来调用 setBeanFactory()。</li><li>如果存在与 bean 关联的任何 BeanPostProcessors，则调用 preProcessBeforeInitialization() 方法。</li><li>如果为 bean 指定了 init 方法（<code>&lt;bean&gt;</code> 的 init-method 属性），那么将调用它。</li><li>最后，如果存在与 bean 关联的任何 BeanPostProcessors，则将调用 postProcessAfterInitialization() 方法。</li><li>如果 bean 实现 DisposableBean 接口，当 spring 容器关闭时，会调用 destory()。</li><li>如果为 bean 指定了 destroy 方法（<code>&lt;bean&gt;</code> 的 destroy-method 属性），那么将调用它。</li></ol><h3 id="什么是-spring-的内部-bean"><a class="markdownIt-Anchor" href="#什么是-spring-的内部-bean"></a> 什么是 spring 的内部 bean？</h3><p>只有将 bean 用作另一个 bean 的属性时，才能将 bean 声明为内部 bean。为了定义 bean，Spring 的基于 XML 的配置元数据在 <code>&lt;property&gt;</code> 或 <code>&lt;constructor-arg&gt;</code> 中提供了 <code>&lt;bean&gt;</code> 元素的使用。内部 bean 总是匿名的，它们总是作为原型。</p><p>例如，假设我们有一个 Student 类，其中引用了 Person 类。这里我们将只创建一个 Person 类实例并在 Student 中使用它。</p><p>Student.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Student</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Person person;</span><br><span class="line">    <span class="comment">//Setters and Getters</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String address;</span><br><span class="line">    <span class="comment">//Setters and Getters</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>bean.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">“StudentBean</span>&quot; <span class="attr">class</span>=<span class="string">&quot;com.edureka.Student&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;person&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--This is inner bean --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.edureka.Person&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">“Scott</span>&quot;&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;address&quot;</span> <span class="attr">value</span>=<span class="string">“Bangalore</span>&quot;&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="什么是-spring-装配"><a class="markdownIt-Anchor" href="#什么是-spring-装配"></a> 什么是 spring 装配</h3><p>当 bean 在 Spring 容器中组合在一起时，它被称为装配或 bean 装配。 Spring 容器需要知道需要什么 bean 以及容器应该如何使用依赖注入来将 bean 绑定在一起，同时装配 bean。</p><h3 id="自动装配有哪些方式"><a class="markdownIt-Anchor" href="#自动装配有哪些方式"></a> 自动装配有哪些方式？</h3><p>Spring 容器能够自动装配 bean。也就是说，可以通过检查 BeanFactory 的内容让 Spring 自动解析 bean 的协作者。</p><p>自动装配的不同模式：</p><ul><li><strong>no</strong> - 这是默认设置，表示没有自动装配。应使用显式 bean 引用进行装配。</li><li><strong>byName</strong> - 它根据 bean 的名称注入对象依赖项。它匹配并装配其属性与 XML 文件中由相同名称定义的 bean。</li><li><strong>byType</strong> - 它根据类型注入对象依赖项。如果属性的类型与 XML 文件中的一个 bean 名称匹配，则匹配并装配属性。</li><li><strong>构造函数</strong> - 它通过调用类的构造函数来注入依赖项。它有大量的参数。</li><li><strong>autodetect</strong> - 首先容器尝试通过构造函数使用 autowire 装配，如果不能，则尝试通过 byType 自动装配。</li></ul><h3 id="自动装配有什么局限"><a class="markdownIt-Anchor" href="#自动装配有什么局限"></a> 自动装配有什么局限？</h3><ul><li>覆盖的可能性 - 您始终可以使用 <code>&lt;constructor-arg&gt;</code> 和 <code>&lt;property&gt;</code> 设置指定依赖项，这将覆盖自动装配。</li><li>基本元数据类型 - 简单属性（如原数据类型，字符串和类）无法自动装配。</li><li>令人困惑的性质 - 总是喜欢使用明确的装配，因为自动装配不太精确。</li></ul><h2 id="注解"><a class="markdownIt-Anchor" href="#注解"></a> 注解</h2><h3 id="你用过哪些重要的-spring-注解"><a class="markdownIt-Anchor" href="#你用过哪些重要的-spring-注解"></a> 你用过哪些重要的 Spring 注解？</h3><ul><li><strong>@Controller</strong> - 用于 Spring MVC 项目中的控制器类。</li><li><strong>@Service</strong> - 用于服务类。</li><li><strong>@RequestMapping</strong> - 用于在控制器处理程序方法中配置 URI 映射。</li><li><strong>@ResponseBody</strong> - 用于发送 Object 作为响应，通常用于发送 XML 或 JSON 数据作为响应。</li><li><strong>@PathVariable</strong> - 用于将动态值从 URI 映射到处理程序方法参数。</li><li><strong>@Autowired</strong> - 用于在 spring bean 中自动装配依赖项。</li><li><strong>@Qualifier</strong> - 使用 @Autowired 注解，以避免在存在多个 bean 类型实例时出现混淆。</li><li><strong>@Scope</strong> - 用于配置 spring bean 的范围。</li><li><strong>@Configuration</strong>，<strong>@ComponentScan</strong> 和 <strong>@Bean</strong> - 用于基于 java 的配置。</li><li><strong>@Aspect</strong>，<strong>@Before</strong>，<strong>@After</strong>，<strong>@Around</strong>，<strong>@Pointcut</strong> - 用于切面编程（AOP）。</li></ul><h3 id="如何在-spring-中启动注解装配"><a class="markdownIt-Anchor" href="#如何在-spring-中启动注解装配"></a> 如何在 spring 中启动注解装配？</h3><p>默认情况下，Spring 容器中未打开注解装配。因此，要使用基于注解装配，我们必须通过配置<code>&lt;context：annotation-config /&gt;</code> 元素在 Spring 配置文件中启用它。</p><h3 id="component-controller-repository-service-有何区别"><a class="markdownIt-Anchor" href="#component-controller-repository-service-有何区别"></a> @Component, @Controller, @Repository, @Service 有何区别？</h3><ul><li>@Component：这将 java 类标记为 bean。它是任何 Spring 管理组件的通用构造型。spring 的组件扫描机制现在可以将其拾取并将其拉入应用程序环境中。</li><li>@Controller：这将一个类标记为 Spring Web MVC 控制器。标有它的 Bean 会自动导入到 IoC 容器中。</li><li>@Service：此注解是组件注解的特化。它不会对 @Component 注解提供任何其他行为。您可以在服务层类中使用 @Service 而不是 @Component，因为它以更好的方式指定了意图。</li><li>@Repository：这个注解是具有类似用途和功能的 @Component 注解的特化。它为 DAO 提供了额外的好处。它将 DAO 导入 IoC 容器，并使未经检查的异常有资格转换为 Spring DataAccessException。</li></ul><h3 id="required-注解有什么用"><a class="markdownIt-Anchor" href="#required-注解有什么用"></a> @Required 注解有什么用？</h3><p>@Required 应用于 bean 属性 setter 方法。此注解仅指示必须在配置时使用 bean 定义中的显式属性值或使用自动装配填充受影响的 bean 属性。如果尚未填充受影响的 bean 属性，则容器将抛出 BeanInitializationException。</p><p>示例：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Employee</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="meta">@Required</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.name=name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> string <span class="title function_">getName</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="autowired-注解有什么用"><a class="markdownIt-Anchor" href="#autowired-注解有什么用"></a> @Autowired 注解有什么用？</h3><p>@Autowired 可以更准确地控制应该在何处以及如何进行自动装配。此注解用于在 setter 方法，构造函数，具有任意名称或多个参数的属性或方法上自动装配 bean。默认情况下，它是类型驱动的注入。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Employee</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name=name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> string <span class="title function_">getName</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="qualifier-注解有什么用"><a class="markdownIt-Anchor" href="#qualifier-注解有什么用"></a> @Qualifier 注解有什么用？</h3><p>当您创建多个相同类型的 bean 并希望仅使用属性装配其中一个 bean 时，您可以使用@Qualifier 注解和 @Autowired 通过指定应该装配哪个确切的 bean 来消除歧义。</p><p>例如，这里我们分别有两个类，Employee 和 EmpAccount。在 EmpAccount 中，使用@Qualifier 指定了必须装配 id 为 emp1 的 bean。</p><p>Employee.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Employee</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name=name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> string <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>EmpAccount.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EmpAccount</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Employee emp;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="meta">@Qualifier(emp1)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">showName</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(“Employee name : ”+emp.getName);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="requestmapping-注解有什么用"><a class="markdownIt-Anchor" href="#requestmapping-注解有什么用"></a> @RequestMapping 注解有什么用？</h3><p>@RequestMapping 注解用于将特定 HTTP 请求方法映射到将处理相应请求的控制器中的特定类/方法。此注解可应用于两个级别：</p><ul><li>类级别：映射请求的 URL</li><li>方法级别：映射 URL 以及 HTTP 请求方法</li></ul><h2 id="数据访问"><a class="markdownIt-Anchor" href="#数据访问"></a> 数据访问</h2><h3 id="spring-dao-有什么用"><a class="markdownIt-Anchor" href="#spring-dao-有什么用"></a> spring DAO 有什么用？</h3><p>Spring DAO 使得 JDBC，Hibernate 或 JDO 这样的数据访问技术更容易以一种统一的方式工作。这使得用户容易在持久性技术之间切换。它还允许您在编写代码时，无需考虑捕获每种技术不同的异常。</p><h3 id="列举-spring-dao-抛出的异常"><a class="markdownIt-Anchor" href="#列举-spring-dao-抛出的异常"></a> 列举 Spring DAO 抛出的异常。</h3><h3 id="spring-jdbc-api-中存在哪些类"><a class="markdownIt-Anchor" href="#spring-jdbc-api-中存在哪些类"></a> spring JDBC API 中存在哪些类？</h3><ul><li>JdbcTemplate</li><li>SimpleJdbcTemplate</li><li>NamedParameterJdbcTemplate</li><li>SimpleJdbcInsert</li><li>SimpleJdbcCall</li></ul><h3 id="使用-spring-访问-hibernate-的方法有哪些"><a class="markdownIt-Anchor" href="#使用-spring-访问-hibernate-的方法有哪些"></a> 使用 Spring 访问 Hibernate 的方法有哪些？</h3><p>我们可以通过两种方式使用 Spring 访问 Hibernate：</p><ol><li>使用 Hibernate 模板和回调进行控制反转</li><li>扩展 HibernateDAOSupport 并应用 AOP 拦截器节点</li></ol><h3 id="列举-spring-支持的事务管理类型"><a class="markdownIt-Anchor" href="#列举-spring-支持的事务管理类型"></a> 列举 spring 支持的事务管理类型</h3><p>Spring 支持两种类型的事务管理：</p><ol><li>程序化事务管理：在此过程中，在编程的帮助下管理事务。它为您提供极大的灵活性，但维护起来非常困难。</li><li>声明式事务管理：在此，事务管理与业务代码分离。仅使用注解或基于 XML 的配置来管理事务。</li></ol><h3 id="spring-支持哪些-orm-框架"><a class="markdownIt-Anchor" href="#spring-支持哪些-orm-框架"></a> spring 支持哪些 ORM 框架</h3><ul><li>Hibernate</li><li>iBatis</li><li>JPA</li><li>JDO</li><li>OJB</li></ul><h2 id="aop"><a class="markdownIt-Anchor" href="#aop"></a> AOP</h2><h3 id="什么是-aop"><a class="markdownIt-Anchor" href="#什么是-aop"></a> 什么是 AOP？</h3><p>AOP(Aspect-Oriented Programming), 即 <strong>面向切面编程</strong>, 它与 OOP( Object-Oriented Programming, 面向对象编程) 相辅相成, 提供了与 OOP 不同的抽象软件结构的视角. 在 OOP 中, 我们以类(class)作为我们的基本单元, 而 AOP 中的基本单元是 <strong>Aspect(切面)</strong></p><h3 id="aop-中的-aspect-advice-pointcut-jointpoint-和-advice-参数分别是什么"><a class="markdownIt-Anchor" href="#aop-中的-aspect-advice-pointcut-jointpoint-和-advice-参数分别是什么"></a> AOP 中的 Aspect、Advice、Pointcut、JointPoint 和 Advice 参数分别是什么？</h3><ul><li><strong>Aspect</strong> - Aspect 是一个实现交叉问题的类，例如事务管理。方面可以是配置的普通类，然后在 Spring Bean 配置文件中配置，或者我们可以使用 Spring AspectJ 支持使用 @Aspect 注解将类声明为 Aspect。</li><li><strong>Advice</strong> - Advice 是针对特定 JoinPoint 采取的操作。在编程方面，它们是在应用程序中达到具有匹配切入点的特定 JoinPoint 时执行的方法。您可以将 Advice 视为 Spring 拦截器（Interceptor）或 Servlet 过滤器（filter）。</li><li><strong>Advice Arguments</strong> - 我们可以在 advice 方法中传递参数。我们可以在切入点中使用 args() 表达式来应用于与参数模式匹配的任何方法。如果我们使用它，那么我们需要在确定参数类型的 advice 方法中使用相同的名称。</li><li><strong>Pointcut</strong> - Pointcut 是与 JoinPoint 匹配的正则表达式，用于确定是否需要执行 Advice。 Pointcut 使用与 JoinPoint 匹配的不同类型的表达式。Spring 框架使用 AspectJ Pointcut 表达式语言来确定将应用通知方法的 JoinPoint。</li><li><strong>JoinPoint</strong> - JoinPoint 是应用程序中的特定点，例如方法执行，异常处理，更改对象变量值等。在 Spring AOP 中，JoinPoint 始终是方法的执行器。</li></ul><h3 id="什么是通知advice"><a class="markdownIt-Anchor" href="#什么是通知advice"></a> 什么是通知（Advice）？</h3><p>特定 JoinPoint 处的 Aspect 所采取的动作称为 Advice。Spring AOP 使用一个 Advice 作为拦截器，在 JoinPoint “周围”维护一系列的拦截器。</p><h3 id="有哪些类型的通知advice"><a class="markdownIt-Anchor" href="#有哪些类型的通知advice"></a> 有哪些类型的通知（Advice）？</h3><ul><li><strong>Before</strong> - 这些类型的 Advice 在 joinpoint 方法之前执行，并使用 @Before 注解标记进行配置。</li><li><strong>After Returning</strong> - 这些类型的 Advice 在连接点方法正常执行后执行，并使用@AfterReturning 注解标记进行配置。</li><li><strong>After Throwing</strong> - 这些类型的 Advice 仅在 joinpoint 方法通过抛出异常退出并使用 @AfterThrowing 注解标记配置时执行。</li><li><strong>After (finally)</strong> - 这些类型的 Advice 在连接点方法之后执行，无论方法退出是正常还是异常返回，并使用 @After 注解标记进行配置。</li><li><strong>Around</strong> - 这些类型的 Advice 在连接点之前和之后执行，并使用 @Around 注解标记进行配置。</li></ul><h3 id="指出在-spring-aop-中-concern-和-cross-cutting-concern-的不同之处"><a class="markdownIt-Anchor" href="#指出在-spring-aop-中-concern-和-cross-cutting-concern-的不同之处"></a> 指出在 spring aop 中 concern 和 cross-cutting concern 的不同之处。</h3><p>concern 是我们想要在应用程序的特定模块中定义的行为。它可以定义为我们想要实现的功能。</p><p>cross-cutting concern 是一个适用于整个应用的行为，这会影响整个应用程序。例如，日志记录，安全性和数据传输是应用程序几乎每个模块都需要关注的问题，因此它们是跨领域的问题。</p><h3 id="aop-有哪些实现方式"><a class="markdownIt-Anchor" href="#aop-有哪些实现方式"></a> AOP 有哪些实现方式？</h3><p>实现 AOP 的技术，主要分为两大类：</p><ul><li>静态代理 - 指使用 AOP 框架提供的命令进行编译，从而在编译阶段就可生成 AOP 代理类，因此也称为编译时增强；<ul><li>编译时编织（特殊编译器实现）</li><li>类加载时编织（特殊的类加载器实现）。</li></ul></li><li>动态代理 - 在运行时在内存中“临时”生成 AOP 动态代理类，因此也被称为运行时增强。<ul><li>JDK 动态代理</li><li>CGLIB</li></ul></li></ul><h3 id="spring-aop-and-aspectj-aop-有什么区别"><a class="markdownIt-Anchor" href="#spring-aop-and-aspectj-aop-有什么区别"></a> Spring AOP and AspectJ AOP 有什么区别？</h3><p>Spring AOP 基于动态代理方式实现；AspectJ 基于静态代理方式实现。 Spring AOP 仅支持方法级别的 PointCut；提供了完全的 AOP 支持，它还支持属性级别的 PointCut。</p><h3 id="如何理解-spring-中的代理"><a class="markdownIt-Anchor" href="#如何理解-spring-中的代理"></a> 如何理解 Spring 中的代理？</h3><p>将 Advice 应用于目标对象后创建的对象称为代理。在客户端对象的情况下，目标对象和代理对象是相同的。</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Advice + Target Object = Proxy</span><br></pre></td></tr></table></figure><h3 id="什么是编织weaving"><a class="markdownIt-Anchor" href="#什么是编织weaving"></a> 什么是编织（Weaving）？</h3><p>为了创建一个 advice 对象而链接一个 aspect 和其它应用类型或对象，称为编织（Weaving）。在 Spring AOP 中，编织在运行时执行。请参考下图：</p><p><img src="https://upload-images.jianshu.io/upload_images/3101171-cfaa92f0e4115b4a.png" alt="img" /></p><h2 id="mvc"><a class="markdownIt-Anchor" href="#mvc"></a> MVC</h2><h3 id="spring-mvc-框架有什么用"><a class="markdownIt-Anchor" href="#spring-mvc-框架有什么用"></a> Spring MVC 框架有什么用？</h3><p>Spring Web MVC 框架提供 <strong>模型-视图-控制器</strong> 架构和随时可用的组件，用于开发灵活且松散耦合的 Web 应用程序。 MVC 模式有助于分离应用程序的不同方面，如输入逻辑，业务逻辑和 UI 逻辑，同时在所有这些元素之间提供松散耦合。</p><h3 id="描述一下-dispatcherservlet-的工作流程"><a class="markdownIt-Anchor" href="#描述一下-dispatcherservlet-的工作流程"></a> 描述一下 DispatcherServlet 的工作流程</h3><p>DispatcherServlet 的工作流程可以用一幅图来说明：</p><ol><li><p>向服务器发送 HTTP 请求，请求被前端控制器 <code>DispatcherServlet</code> 捕获。</p></li><li><p><code>DispatcherServlet</code> 根据 <strong>-servlet.xml</strong> 中的配置对请求的 URL 进行解析，得到请求资源标识符（URI）。然后根据该 URI，调用 <code>HandlerMapping</code> 获得该 Handler 配置的所有相关的对象（包括 Handler 对象以及 Handler 对象对应的拦截器），最后以<code>HandlerExecutionChain</code> 对象的形式返回。</p></li><li><p><code>DispatcherServlet</code> 根据获得的<code>Handler</code>，选择一个合适的 <code>HandlerAdapter</code>。（附注：如果成功获得<code>HandlerAdapter</code>后，此时将开始执行拦截器的 preHandler(…)方法）。</p></li><li><p>提取</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Request</span><br></pre></td></tr></table></figure><p>中的模型数据，填充</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Handler</span><br></pre></td></tr></table></figure><p>入参，开始执行</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Handler</span><br></pre></td></tr></table></figure><p>（</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Controller</span><br></pre></td></tr></table></figure><p>)。 在填充</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Handler</span><br></pre></td></tr></table></figure><p>的入参过程中，根据你的配置，Spring 将帮你做一些额外的工作：</p><ul><li>HttpMessageConveter： 将请求消息（如 Json、xml 等数据）转换成一个对象，将对象转换为指定的响应信息。</li><li>数据转换：对请求消息进行数据转换。如<code>String</code>转换成<code>Integer</code>、<code>Double</code>等。</li><li>数据根式化：对请求消息进行数据格式化。 如将字符串转换成格式化数字或格式化日期等。</li><li>数据验证： 验证数据的有效性（长度、格式等），验证结果存储到<code>BindingResult</code>或<code>Error</code>中。</li></ul></li><li><p>Handler(Controller)执行完成后，向 <code>DispatcherServlet</code> 返回一个 <code>ModelAndView</code> 对象；</p></li><li><p>根据返回的<code>ModelAndView</code>，选择一个适合的 <code>ViewResolver</code>（必须是已经注册到 Spring 容器中的<code>ViewResolver</code>)返回给<code>DispatcherServlet</code>。</p></li><li><p><code>ViewResolver</code> 结合<code>Model</code>和<code>View</code>，来渲染视图。</p></li><li><p>视图负责将渲染结果返回给客户端。</p></li></ol><h3 id="介绍一下-webapplicationcontext"><a class="markdownIt-Anchor" href="#介绍一下-webapplicationcontext"></a> 介绍一下 WebApplicationContext</h3><p>WebApplicationContext 是 ApplicationContext 的扩展。它具有 Web 应用程序所需的一些额外功能。它与普通的 ApplicationContext 在解析主题和决定与哪个 servlet 关联的能力方面有所不同。</p><p>本文大部分从网络收集,希望此文能给您带来帮助!</p><p>如果您有更好的建议可以在下方留言!</p>]]></content>
      
      
      <categories>
          
          <category> Spring </category>
          
          <category> Java </category>
          
          <category> 面试题 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Spring </tag>
            
            <tag> Spring面试题 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SpringBean声明周期</title>
      <link href="/posts/93f3f3c2/"/>
      <url>/posts/93f3f3c2/</url>
      
        <content type="html"><![CDATA[<h2 id="spring-bean-简介"><a class="markdownIt-Anchor" href="#spring-bean-简介"></a> Spring Bean 简介</h2><p>如何注册一个 Spring Bean？</p><p>通过 BeanDefinition 和外部单体对象来注册</p><h3 id="beandefinition"><a class="markdownIt-Anchor" href="#beandefinition"></a> BeanDefinition</h3><h4 id="什么是-beandefinition"><a class="markdownIt-Anchor" href="#什么是-beandefinition"></a> 什么是 BeanDefinition</h4><p><code>BeanDefinition</code> 是 Spring Framework 中定义 Bean 的配置元信息接口，包含：</p><ul><li>Bean 类名</li><li>Bean 行为配置元素，如：作用域、自动绑定的模式、生命周期回调等</li><li>其他 Bean 引用</li><li>配置设置，如 Bean 属性（Properties）</li></ul><h4 id="lbeandefinition-元信息beandefinition-元信息"><a class="markdownIt-Anchor" href="#lbeandefinition-元信息beandefinition-元信息"></a> l#beandefinition-元信息)BeanDefinition 元信息</h4><p><code>BeanDefinition</code> 元信息如下：</p><table><thead><tr><th>属性（Property）</th><th>说明</th></tr></thead><tbody><tr><td>Class Bean</td><td>全类名，必须是具体类，不能用抽象类或接口</td></tr><tr><td>Name Bean</td><td>的名称或者 ID</td></tr><tr><td>Scope Bean</td><td>的作用域（如：singleton、prototype 等）</td></tr><tr><td>Constructor arguments Bean</td><td>构造器参数（用于依赖注入）</td></tr><tr><td>Properties Bean</td><td>属性设置（用于依赖注入）</td></tr><tr><td>Autowiring mode Bean</td><td>自动绑定模式（如：通过名称 byName）</td></tr><tr><td>Lazy initialization mode Bean</td><td>延迟初始化模式（延迟和非延迟）</td></tr><tr><td>Initialization method Bean</td><td>初始化回调方法名称</td></tr><tr><td>Destruction method Bean</td><td>销毁回调方法名称</td></tr></tbody></table><h4 id="beandefinition-构建"><a class="markdownIt-Anchor" href="#beandefinition-构建"></a> BeanDefinition 构建</h4><p>BeanDefinition 构建方式：</p><ul><li>通过 <code>BeanDefinitionBuilder</code></li><li>通过 <code>AbstractBeanDefinition</code> 以及派生类</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1.通过 BeanDefinitionBuilder 构建</span></span><br><span class="line"><span class="type">BeanDefinitionBuilder</span> <span class="variable">beanDefinitionBuilder</span> <span class="operator">=</span> BeanDefinitionBuilder.genericBeanDefinition(User.class);</span><br><span class="line"><span class="comment">// 通过属性设置</span></span><br><span class="line">beanDefinitionBuilder</span><br><span class="line">  .addPropertyValue(<span class="string">&quot;id&quot;</span>, <span class="number">1</span>)</span><br><span class="line">  .addPropertyValue(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;小马哥&quot;</span>);</span><br><span class="line"><span class="comment">// 获取 BeanDefinition 实例</span></span><br><span class="line"><span class="type">BeanDefinition</span> <span class="variable">beanDefinition</span> <span class="operator">=</span> beanDefinitionBuilder.getBeanDefinition();</span><br><span class="line"><span class="comment">// BeanDefinition 并非 Bean 终态，可以自定义修改</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. 通过 AbstractBeanDefinition 以及派生类</span></span><br><span class="line"><span class="type">GenericBeanDefinition</span> <span class="variable">genericBeanDefinition</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">GenericBeanDefinition</span>();</span><br><span class="line"><span class="comment">// 设置 Bean 类型</span></span><br><span class="line">genericBeanDefinition.setBeanClass(User.class);</span><br><span class="line"><span class="comment">// 通过 MutablePropertyValues 批量操作属性</span></span><br><span class="line"><span class="type">MutablePropertyValues</span> <span class="variable">propertyValues</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MutablePropertyValues</span>();</span><br><span class="line"><span class="comment">//        propertyValues.addPropertyValue(&quot;id&quot;, 1);</span></span><br><span class="line"><span class="comment">//        propertyValues.addPropertyValue(&quot;name&quot;, &quot;小马哥&quot;);</span></span><br><span class="line">propertyValues</span><br><span class="line">  .add(<span class="string">&quot;id&quot;</span>, <span class="number">1</span>)</span><br><span class="line">  .add(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;小马哥&quot;</span>);</span><br><span class="line"><span class="comment">// 通过 set MutablePropertyValues 批量操作属性</span></span><br><span class="line">genericBeanDefinition.setPropertyValues(propertyValues);</span><br></pre></td></tr></table></figure><h3 id="命名-spring-bean"><a class="markdownIt-Anchor" href="#命名-spring-bean"></a> 命名 Spring Bean</h3><h4 id="spring-bean-命名规则"><a class="markdownIt-Anchor" href="#spring-bean-命名规则"></a> Spring Bean 命名规则</h4><p>每个 Bean 拥有一个或多个标识符（identifiers），这些标识符在 Bean 所在的容器必须是唯一的。通常，一个 Bean 仅有一个标识符，如果需要额外的，可考虑使用别名（Alias）来扩充。</p><p>在基于 XML 的配置元信息中，开发人员可用 id 或者 name 属性来规定 Bean 的标识符。通常 Bean 的标识符由字母组成，允许出现特殊字符。如果要想引入 Bean 的别名的话，可在 name 属性使用半角逗号（“,”）或分号（“;”) 来间隔。</p><p>Bean 的 id 或 name 属性并非必须制定，如果留空的话，容器会为 Bean 自动生成一个唯一的名称。Bean 的命名尽管没有限制，不过官方建议采用驼峰的方式，更符合 Java 的命名约定。</p><h4 id="spring-bean-命名生成器"><a class="markdownIt-Anchor" href="#spring-bean-命名生成器"></a> Spring Bean 命名生成器</h4><p>Spring 提供了两种 Spring Bean 命名生成器：</p><ul><li>DefaultBeanNameGenerator：默认通用 BeanNameGenerator 实现。</li><li>AnnotationBeanNameGenerator：基于注解扫描的 BeanNameGenerator 实现。</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">BeanNameGenerator</span> &#123;</span><br><span class="line">   String <span class="title function_">generateBeanName</span><span class="params">(BeanDefinition definition, BeanDefinitionRegistry registry)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="spring-bean-别名"><a class="markdownIt-Anchor" href="#spring-bean-别名"></a> Spring Bean 别名</h4><p>可能存在这样的场景，不同系统中对于同一 bean 的命名方式不一样。 为了适配，Spring 支持 <code>&lt;alias&gt;</code> 为 bean 添加别名的功能。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;user&quot;</span> <span class="attr">class</span>=<span class="string">&quot;io.github.dunwu.spring.core.domain.User&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">p:name</span>=<span class="string">&quot;张三&quot;</span> <span class="attr">p:age</span>=<span class="string">&quot;18&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">alias</span> <span class="attr">name</span>=<span class="string">&quot;sysUser&quot;</span> <span class="attr">alias</span>=<span class="string">&quot;superUser&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure><p>Bean 别名（Alias）的作用：</p><ul><li>复用现有的 BeanDefinition</li><li>更具有场景化的命名方法，比如：<ul><li><code>&lt;alias name=&quot;myApp-dataSource&quot; alias=&quot;subsystemA-dataSource&quot;/&gt;</code></li><li><code>&lt;alias name=&quot;myApp-dataSource&quot; alias=&quot;subsystemB-dataSource&quot;/&gt;</code></li></ul></li></ul><h2 id="bean-生命周期流程"><a class="markdownIt-Anchor" href="#bean-生命周期流程"></a> Bean 生命周期流程</h2><p><img src="https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fupload-images.jianshu.io%2Fupload_images%2F14623831-a87d9a6ee1be94a3.png%3FimageMogr2%2Fauto-orient%2Fstrip%257CimageView2%2F2%2Fw%2F1240&amp;refer=http%3A%2F%2Fupload-images.jianshu.io&amp;app=2002&amp;size=f9999,10000&amp;q=a80&amp;n=0&amp;g=0n&amp;fmt=auto?sec=1654251154&amp;t=39886bb51305eca4d749695ecca02657" alt="img" /></p><ol><li>Spring 对 Bean 进行实例化（相当于 new XXX()）</li><li>Spring 将值和引用注入进 Bean 对应的属性中</li><li>如果 Bean 实现了 <code>BeanNameAware</code> 接口，Spring 将 Bean 的 ID 传递给 <code>setBeanName</code> 方法<ul><li>作用是通过 Bean 的引用来获得 Bean ID，一般业务中是很少有用到 Bean 的 ID 的</li></ul></li><li>如果 Bean 实现了 <code>BeanFactoryAware</code> 接口，Spring 将调用 <code>setBeanDactory</code> 方法，并把 <code>BeanFactory</code> 容器实例作为参数传入。<ul><li>作用是获取 Spring 容器，如 Bean 通过 Spring 容器发布事件等</li></ul></li><li>如果 Bean 实现了 <code>ApplicationContextAware</code> 接口，Spring 容器将调用 <code>setApplicationContext</code> 方法，把应用上下文作为参数传入<ul><li>作用与 <code>BeanFactory</code> 类似都是为了获取 Spring 容器，不同的是 Spring 容器在调用 <code>setApplicationContext</code> 方法时会把它自己作为 <code>setApplicationContext</code> 的参数传入，而 Spring 容器在调用 <code>setBeanFactory</code> 前需要使用者自己指定（注入）<code>setBeanFactory</code> 里的参数 <code>BeanFactory</code></li></ul></li><li>如果 Bean 实现了 <code>BeanPostProcess</code> 接口，Spring 将调用 <code>postProcessBeforeInitialization</code> 方法<ul><li>作用是在 Bean 实例创建成功后对其进行增强处理，如对 Bean 进行修改，增加某个功能</li></ul></li><li>如果 Bean 实现了 <code>InitializingBean</code> 接口，Spring 将调用 <code>afterPropertiesSet</code> 方法，作用与在配置文件中对 Bean 使用 <code>init-method</code> 声明初始化的作用一样，都是在 Bean 的全部属性设置成功后执行的初始化方法。</li><li>如果 Bean 实现了 <code>BeanPostProcess</code> 接口，Spring 将调用 <code>postProcessAfterInitialization</code> 方法<ul><li><code>postProcessBeforeInitialization</code> 是在 Bean 初始化前执行的，而 <code>postProcessAfterInitialization</code> 是在 Bean 初始化后执行的</li></ul></li><li>经过以上的工作后，Bean 将一直驻留在应用上下文中给应用使用，直到应用上下文被销毁</li><li>如果 Bean 实现了 <code>DispostbleBean</code> 接口，Spring 将调用它的 <code>destory</code> 方法，作用与在配置文件中对 Bean 使用 <code>destory-method</code> 属性的作用一样，都是在 Bean 实例销毁前执行的方法。</li></ol><h2 id="spring-bean-注册"><a class="markdownIt-Anchor" href="#spring-bean-注册"></a> Spring Bean 注册</h2><p>注册 Spring Bean 实际上是将 <code>BeanDefinition</code> 注册到 IoC 容器中。</p><h3 id="xml-配置元信息"><a class="markdownIt-Anchor" href="#xml-配置元信息"></a> XML 配置元信息</h3><p>Spring 的传统配置方式。在 <code>&lt;bean&gt;</code> 标签中配置元数据内容。</p><p>缺点是当 JavaBean 过多时，产生的配置文件足以让你眼花缭乱。</p><h3 id="注解配置元信息"><a class="markdownIt-Anchor" href="#注解配置元信息"></a> 注解配置元信息</h3><p>使用 <code>@Bean</code>、<code>@Component</code>、<code>@Import</code> 注解注册 Spring Bean。</p><h3 id="java-api-配置元信息"><a class="markdownIt-Anchor" href="#java-api-配置元信息"></a> Java API 配置元信息</h3><ul><li>命名方式：<code>BeanDefinitionRegistry#registerBeanDefinition(String,BeanDefinition)</code></li><li>非命名方式：<code>BeanDefinitionReaderUtils#registerWithGeneratedName(AbstractBeanDefinition,Be</code> <code>anDefinitionRegistry)</code></li><li>配置类方式：<code>AnnotatedBeanDefinitionReader#register(Class...)</code></li></ul><p>[示例]</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Import(AnnotationComponentScan.MyConfiguration.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AnnotationComponentScan</span> &#123;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">      <span class="comment">// 创建 BeanFactory 容器</span></span><br><span class="line">      <span class="type">AnnotationConfigApplicationContext</span> <span class="variable">ctx</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AnnotationConfigApplicationContext</span>();</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 1.注册配置类</span></span><br><span class="line">      ctx.register(AnnotationComponentScan.class);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 2.通过 Java API 注册</span></span><br><span class="line">      registerBeanDefinition(ctx, <span class="string">&quot;zhaoliu&quot;</span>, User.class);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 启动应用上下文</span></span><br><span class="line">      ctx.refresh();</span><br><span class="line"></span><br><span class="line">      <span class="type">User</span> <span class="variable">wangwu</span> <span class="operator">=</span> (User) ctx.getBean(<span class="string">&quot;wangwu&quot;</span>);</span><br><span class="line">      System.out.println(<span class="string">&quot;wangwu info: &quot;</span> + wangwu);</span><br><span class="line">      System.out.println(<span class="string">&quot;All beans of User: &quot;</span> + ctx.getBeansOfType(User.class));</span><br><span class="line"></span><br><span class="line">      <span class="comment">//显示关闭 ApplicationContext</span></span><br><span class="line">      ctx.close();</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">registerBeanDefinition</span><span class="params">(BeanDefinitionRegistry registry, String beanName, Class&lt;?&gt; beanClass)</span> &#123;</span><br><span class="line">      <span class="type">BeanDefinitionBuilder</span> <span class="variable">builder</span> <span class="operator">=</span> BeanDefinitionBuilder.genericBeanDefinition(beanClass);</span><br><span class="line">      builder.addPropertyValue(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;赵六&quot;</span>);</span><br><span class="line">      builder.addPropertyValue(<span class="string">&quot;age&quot;</span>, <span class="number">31</span>);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 注册 BeanDefinition</span></span><br><span class="line">      registry.registerBeanDefinition(beanName, builder.getBeanDefinition());</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="meta">@Configuration</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">MyConfiguration</span> &#123;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 注解方式配置元信息</span></span><br><span class="line">      <span class="meta">@Bean(name = &#123; &quot;user&quot;, &quot;wangwu&quot; &#125;)</span></span><br><span class="line">      <span class="keyword">public</span> User <span class="title function_">user</span><span class="params">()</span> &#123;</span><br><span class="line">         <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&quot;王五&quot;</span>, <span class="number">21</span>);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="spring-bean-实例化"><a class="markdownIt-Anchor" href="#spring-bean-实例化"></a> Spring Bean 实例化</h2><p>Spring Bean 实例化方式：</p><ul><li>常规方式<ul><li>通过构造器（配置元信息：XML、Java 注解和 Java API）</li><li>通过静态工厂方法（配置元信息：XML、Java 注解和 Java API）</li><li>通过 Bean 工厂方法（配置元信息：XML、Java 注解和 Java API）</li><li>通过 <code>FactoryBean</code>（配置元信息：XML、Java 注解和 Java API）</li></ul></li><li>特殊方式<ul><li>通过 <code>ServiceLoaderFactoryBean</code>（配置元信息：XML、Java 注解和 Java API ）</li><li>通过 <code>AutowireCapableBeanFactory#createBean(java.lang.Class, int, boolean)</code></li><li>通过 <code>BeanDefinitionRegistry#registerBeanDefinition(String,BeanDefinition)</code></li></ul></li></ul><h2 id="spring-bean-初始化和销毁"><a class="markdownIt-Anchor" href="#spring-bean-初始化和销毁"></a> Spring Bean 初始化和销毁</h2><p>Spring Bean 初始化和销毁的方式有以下几种：</p><ol><li>使用 <code>@PostConstruct</code> 和 <code>@PreDestroy</code> 注解分别指定相应的初始化方法和销毁方法。</li><li>实现 <code>InitializingBean</code> 接口的 <code>afterPropertiesSet()</code> 方法来编写初始化方法；实现 <code>DisposableBean</code> 接口的 <code>destroy()</code> 方法来编写销毁方法。</li><li>自定义初始化方法<ul><li>XML 配置：<code>&lt;bean init-method=&quot;init&quot; destroy=&quot;destroy&quot; ... /&gt;</code></li><li>Java 注解：<code>@Bean(initMethod = &quot;init&quot;, destroyMethod = &quot;destroy&quot;)</code></li><li>Java API：<code>AbstractBeanDefinition#setInitMethodName(String)</code> 和 <code>AbstractBeanDefinition#setDestroyMethodName(String)</code> 分别定义初始化和销毁方法</li></ul></li></ol><p>注意：如果同时存在，执行顺序会按照序列执行。</p><h3 id="bean-的-initmethod-和-destroymethod"><a class="markdownIt-Anchor" href="#bean-的-initmethod-和-destroymethod"></a> <code>@Bean</code> 的 initMethod 和 destroyMethod</h3><p>（1）定义 Bean 实例</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Pojo</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Pojo</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;[Pojo 构造方法]&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;[Pojo 初始化方法]&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;[Pojo 销毁方法]&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>（2）使用 <code>@Bean</code> 在配置类中注册 Bean</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AnnotationBeanDemo</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean(initMethod = &quot;init&quot;, destroyMethod = &quot;destroy&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Pojo <span class="title function_">pojo</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Pojo</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>说明：<code>@Bean</code> 注解的 <code>initMethod</code> 和 <code>destroyMethod</code> 属性分别用于指定 Bean 对应的初始化方法和销毁方法。</p></blockquote><p>（3）测试：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    <span class="type">AnnotationConfigApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AnnotationConfigApplicationContext</span>(AnnotationBeanDemo.class);</span><br><span class="line">    System.out.println(<span class="string">&quot;AnnotationBeanDemo 示例结束&quot;</span>);</span><br><span class="line">    context.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>输出</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[Pojo 构造方法]</span><br><span class="line">[Pojo 初始化方法]</span><br><span class="line">AnnotationBeanDemo 示例结束</span><br><span class="line">[Pojo 销毁方法]</span><br></pre></td></tr></table></figure><h3 id="initializingbean-和-disposablebean"><a class="markdownIt-Anchor" href="#initializingbean-和-disposablebean"></a> <code>InitializingBean</code> 和 <code>DisposableBean</code></h3><ul><li><code>InitializingBean</code> 接口包含一个 <code>afterPropertiesSet</code> 方法，可以通过实现该接口，然后在这个方法中编写初始化逻辑。</li><li><code>DisposableBean</code>接口包含一个 <code>destory</code> 方法，可以通过实现该接口，然后在这个方法中编写销毁逻辑。</li></ul><p>（1）定义 Bean 实例</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Pojo2</span> <span class="keyword">implements</span> <span class="title class_">InitializingBean</span>, DisposableBean &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Pojo2</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;[Pojo2 构造方法]&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterPropertiesSet</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;[Pojo2 初始化方法]&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;[Pojo2 销毁方法]&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>（2）使用 <code>@Bean</code> 在配置类中注册 Bean</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AnnotationBeanDemo</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Pojo2 <span class="title function_">pojo2</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Pojo2</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>（3）测试：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    <span class="type">AnnotationConfigApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AnnotationConfigApplicationContext</span>(AnnotationBeanDemo.class);</span><br><span class="line">    System.out.println(<span class="string">&quot;AnnotationBeanDemo 示例结束&quot;</span>);</span><br><span class="line">    context.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>输出</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[Pojo2 构造方法]</span><br><span class="line">[Pojo2 初始化方法]</span><br><span class="line">AnnotationBeanDemo 示例结束</span><br><span class="line">[Pojo2 销毁方法]</span><br></pre></td></tr></table></figure><h3 id="postconstruct-和-predestroy"><a class="markdownIt-Anchor" href="#postconstruct-和-predestroy"></a> <code>@PostConstruct</code> 和 <code>@PreDestroy</code></h3><p>可以使用 <code>@PostConstruct</code> 和 <code>@PreDestroy</code> 注解修饰方法来指定相应的初始化和销毁方法。</p><h3 id="beanpostprocessor"><a class="markdownIt-Anchor" href="#beanpostprocessor"></a> <code>BeanPostProcessor</code></h3><p>Spring 提供了一个 <code>BeanPostProcessor</code> 接口，提供了两个方法 <code>postProcessBeforeInitialization</code> 和 <code>postProcessAfterInitialization</code>。其中<code>postProcessBeforeInitialization</code> 在组件的初始化方法调用之前执行，<code>postProcessAfterInitialization</code> 在组件的初始化方法调用之后执行。它们都包含两个入参：</p><ol><li>bean：当前组件对象；</li><li>beanName：当前组件在容器中的名称。</li></ol><p>（1）定义 Pojo，如上面的例子</p><p>（2）定义 <code>BeanPostProcessor</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyBeanPostProcessor</span> <span class="keyword">implements</span> <span class="title class_">BeanPostProcessor</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MyBeanPostProcessor</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;[BeanPostProcessor] construct&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">postProcessBeforeInitialization</span><span class="params">(Object bean, String beanName)</span> <span class="keyword">throws</span> BeansException &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;[BeanPostProcessor] postProcessBeforeInitialization&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> bean;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">postProcessAfterInitialization</span><span class="params">(Object bean, String beanName)</span> <span class="keyword">throws</span> BeansException &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;[BeanPostProcessor] postProcessAfterInitialization&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> bean;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>（3）使用 <code>@Bean</code> 在配置类中注册 Bean</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> Pojo <span class="title function_">pojo</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Pojo</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> MyBeanPostProcessor <span class="title function_">myBeanPostProcessor</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">MyBeanPostProcessor</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>（3）测试：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    <span class="type">AnnotationConfigApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span></span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">AnnotationConfigApplicationContext</span>(MyBeanPostProcessorDemo.class);</span><br><span class="line">    System.out.println(<span class="string">&quot;BeanPostProcessorDemo 示例结束&quot;</span>);</span><br><span class="line">    context.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>输出</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[BeanPostProcessor] construct</span><br><span class="line">[Pojo 构造方法]</span><br><span class="line">[BeanPostProcessor] postProcessBeforeInitialization</span><br><span class="line">[Pojo 初始化方法]</span><br><span class="line">[BeanPostProcessor] postProcessAfterInitialization</span><br><span class="line">BeanPostProcessorDemo 示例结束</span><br><span class="line">[Pojo 销毁方法]</span><br></pre></td></tr></table></figure><h2 id="spring-bean-垃圾回收"><a class="markdownIt-Anchor" href="#spring-bean-垃圾回收"></a> Spring Bean 垃圾回收</h2><p>Spring Bean 垃圾回收步骤：</p><ol><li>关闭 Spring 容器（应用上下文）</li><li>执行 GC</li><li>Spring Bean 覆盖的 finalize() 方法被回调</li></ol><h2 id="参考资料"><a class="markdownIt-Anchor" href="#参考资料"></a> 参考资料</h2><ul><li><a href="https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/core.html#beans">Spring 官方文档之 Core Technologies</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> Spring </category>
          
          <category> SpringBean生命周期 </category>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> SpringBean生命周期 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Spring-依赖注入IOC</title>
      <link href="/posts/841c624e/"/>
      <url>/posts/841c624e/</url>
      
        <content type="html"><![CDATA[<h2 id="ioc-概念简介"><a class="markdownIt-Anchor" href="#ioc-概念简介"></a> IoC 概念简介</h2><h3 id="ioc-是什么"><a class="markdownIt-Anchor" href="#ioc-是什么"></a> IoC 是什么</h3><blockquote><p><strong>IoC，是 Inversion of Control 的缩写，即控制反转。</strong></p><ul><li>上层模块不应该依赖于下层模块，它们共同依赖于一个抽象</li><li>抽象不能依赖于具体实现，具体实现依赖于抽象</li></ul><p><em>注：又称为依赖倒置原则。这是设计模式六大原则之一。</em></p></blockquote><p>IoC 不是什么技术，而是一种设计思想。在 Java 开发中，IoC 意味着将你设计好的对象交给容器控制，而不是传统的在你的对象内部直接控制。如何理解 Ioc 呢？理解 Ioc 的关键是要明确“谁控制谁，控制什么，为何是反转（有反转就应该有正转了），哪些方面反转了”，那我们来深入分析一下：</p><ul><li>**谁控制谁，控制什么：**传统 JavaSE 程序设计，我们直接在对象内部通过 new 进行创建对象，是程序主动去创建依赖对象；而 IoC 是有专门一个容器来创建这些对象，即由 IoC 容器来控制对象的创建；谁控制谁？当然是 IoC 容器控制了对象；控制什么？那就是主要控制了外部资源获取（不只是对象包括比如文件等）。</li><li>**为何是反转，哪些方面反转了：**有反转就有正转，传统应用程序是由我们自己在对象中主动控制去直接获取依赖对象，也就是正转；而反转则是由容器来帮忙创建及注入依赖对象；为何是反转？因为由容器帮我们查找及注入依赖对象，对象只是被动的接受依赖对象，所以是反转；哪些方面反转了？依赖对象的获取被反转了。</li></ul><h3 id="ioc-能做什么"><a class="markdownIt-Anchor" href="#ioc-能做什么"></a> IoC 能做什么</h3><p>IoC 不是一种技术，只是一种思想，一个重要的面向对象编程的法则，它能指导我们如何设计出松耦合、更优良的程序。传统应用程序都是由我们在类内部主动创建依赖对象，从而导致类与类之间高耦合，难于测试；有了 IoC 容器后，把创建和查找依赖对象的控制权交给了容器，由容器进行注入组合对象，所以对象与对象之间是松散耦合，这样也方便测试，利于功能复用，更重要的是使得程序的整个体系结构变得非常灵活。</p><p>其实 IoC 对编程带来的最大改变不是从代码上，而是从思想上，发生了“主从换位”的变化。应用程序原本是老大，要获取什么资源都是主动出击，但是在 IoC/DI 思想中，应用程序就变成被动的了，被动的等待 IoC 容器来创建并注入它所需要的资源了。</p><p>IoC 很好的体现了面向对象设计法则之一—— <strong>好莱坞法则：“别找我们，我们找你”</strong>；即由 IoC 容器帮对象找相应的依赖对象并注入，而不是由对象主动去找。</p><h3 id="ioc-和-di"><a class="markdownIt-Anchor" href="#ioc-和-di"></a> IoC 和 DI</h3><p>其实它们是同一个概念的不同角度描述，由于控制反转概念比较含糊（可能只是理解为容器控制对象这一个层面，很难让人想到谁来维护对象关系），所以 2004 年大师级人物 Martin Fowler 又给出了一个新的名字：“依赖注入”，相对 IoC 而言，“依赖注入”明确描述了“被注入对象依赖 IoC 容器配置依赖对象”。</p><blockquote><p>注：如果想要更加深入的了解 IoC 和 DI，请参考大师级人物 Martin Fowler 的一篇经典文章 <a href="http://www.martinfowler.com/articles/injection.html">Inversion of Control Containers and the Dependency Injection pattern (opens new window)</a>。</p></blockquote><h3 id="ioc-容器"><a class="markdownIt-Anchor" href="#ioc-容器"></a> IoC 容器</h3><p>IoC 容器就是具有依赖注入功能的容器。IoC 容器负责实例化、定位、配置应用程序中的对象及建立这些对象间的依赖。应用程序无需直接在代码中 new 相关的对象，应用程序由 IoC 容器进行组装。在 Spring 中 BeanFactory 是 IoC 容器的实际代表者。</p><p>Spring IoC 容器如何知道哪些是它管理的对象呢？这就需要配置文件，Spring IoC 容器通过读取配置文件中的配置元数据，通过元数据对应用中的各个对象进行实例化及装配。一般使用基于 xml 配置文件进行配置元数据，而且 Spring 与配置文件完全解耦的，可以使用其他任何可能的方式进行配置元数据，比如注解、基于 java 文件的、基于属性文件的配置都可以。</p><p>那 Spring IoC 容器管理的对象叫什么呢？</p><h3 id="bean"><a class="markdownIt-Anchor" href="#bean"></a> Bean</h3><blockquote><p><strong>JavaBean</strong> 是一种 JAVA 语言写成的可重用组件。为写成 JavaBean，类必须是具体的和公共的，并且具有无参数的构造器。JavaBean 对外部通过提供 getter / setter 方法来访问其成员。</p></blockquote><p>由 IoC 容器管理的那些组成你应用程序的对象我们就叫它 Bean。Bean 就是由 Spring 容器初始化、装配及管理的对象，除此之外，bean 就与应用程序中的其他对象没有什么区别了。那 IoC 怎样确定如何实例化 Bean、管理 Bean 之间的依赖关系以及管理 Bean 呢？这就需要配置元数据，在 Spring 中由 BeanDefinition 代表，后边会详细介绍，配置元数据指定如何实例化 Bean、如何组装 Bean 等。</p><h2 id="spring-ioc"><a class="markdownIt-Anchor" href="#spring-ioc"></a> Spring IoC</h2><h3 id="核心接口"><a class="markdownIt-Anchor" href="#核心接口"></a> 核心接口</h3><p><code>org.springframework.beans</code> 和 <code>org.springframework.context</code> 是 IoC 容器的基础。</p><p>在 Spring 中，有两种 IoC 容器：<code>BeanFactory</code> 和 <code>ApplicationContext</code>。</p><ul><li><code>BeanFactory</code>：BeanFactory 提供了 Spring 容器的配置框架和基本功能。</li><li><code>ApplicationContext</code>：BeanFactory 的子接口。它还扩展了其他一些接口，以支持更丰富的功能，如：国际化、访问资源、事件机制、更方便的支持 AOP、在 web 应用中指定应用层上下文等。</li></ul><p>实际开发中，更推荐使用 <code>ApplicationContext</code> 作为 IoC 容器，因为它的功能远多于 <code>FactoryBean</code>。</p><p>常见 <code>ApplicationContext</code> 实现：</p><ul><li><strong>ClassPathXmlApplicationContext</strong>：<code>ApplicationContext</code> 的实现，从 classpath 获取配置文件；</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">BeanFactory</span> <span class="variable">beanFactory</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;classpath.xml&quot;</span>);</span><br></pre></td></tr></table></figure><ul><li><strong>FileSystemXmlApplicationContext</strong>：<code>ApplicationContext</code> 的实现，从文件系统获取配置文件。</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">BeanFactory</span> <span class="variable">beanFactory</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileSystemXmlApplicationContext</span>(<span class="string">&quot;fileSystemConfig.xml&quot;</span>);</span><br></pre></td></tr></table></figure><h3 id="ioc-容器工作步骤"><a class="markdownIt-Anchor" href="#ioc-容器工作步骤"></a> IoC 容器工作步骤</h3><p>使用 IoC 容器可分为三步骤：</p><ol><li><strong>配置元数据</strong>：需要配置一些元数据来告诉 Spring，你希望容器如何工作，具体来说，就是如何去初始化、配置、管理 JavaBean 对象。</li><li><strong>实例化容器</strong>：由 IoC 容器解析配置的元数据。IoC 容器的 Bean Reader 读取并解析配置文件，根据定义生成 BeanDefinition 配置元数据对象，IoC 容器根据 <code>BeanDefinition</code> 进行实例化、配置及组装 Bean。</li><li><strong>使用容器</strong>：由客户端实例化容器，获取需要的 Bean</li></ol><h3 id="配置元数据"><a class="markdownIt-Anchor" href="#配置元数据"></a> 配置元数据</h3><p>**元数据（Metadata）**又称中介数据、中继数据，为描述数据的数据（data about data），主要是描述数据属性（property）的信息。</p><p>配置元数据的方式：</p><ul><li><p><strong>基于 xml 配置</strong>：Spring 的传统配置方式。在 <code>&lt;beans&gt;</code> 标签中配置元数据内容。</p><p>缺点是当 JavaBean 过多时，产生的配置文件足以让你眼花缭乱。</p></li><li><p><strong>基于注解配置</strong>：Spring2.5 引入。可以大大简化你的配置。</p></li><li><p><strong>基于 Java 配置</strong>：可以使用 Java 类来定义 JavaBean 。</p><p>为了使用这个新特性，需要用到 <code>@Configuration</code> 、<code>@Bean</code> 、<code>@Import</code> 和 <code>@DependsOn</code> 注解</p></li></ul><h3 id="spring-bean-概述"><a class="markdownIt-Anchor" href="#spring-bean-概述"></a> Spring Bean 概述</h3><p>一个 Spring 容器管理一个或多个 bean。这些 bean 根据你配置的元数据（比如 xml 形式）来创建。</p><p>Spring IoC 容器本身，并不能识别你配置的元数据。为此，要将这些配置信息转为 Spring 能识别的格式——<code>BeanDefinition</code> 对象。</p><ul><li><p><strong>命名 Bean</strong></p><ul><li>指定 id 和 name 属性不是必须的。Spring 中，并非一定要指定 id 和 name 属性。实际上，Spring 会自动为其分配一个特殊名。如果你需要引用声明的 bean，这时你才需要一个标识。官方推荐驼峰命名法来命名。</li></ul></li><li><p><strong>支持别名</strong></p><ul><li><p>可能存在这样的场景，不同系统中对于同一 bean 的命名方式不一样。 为了适配，Spring 支持 <code>&lt;alias&gt;</code> 为 bean 添加别名的功能。</p></li><li><pre class="highlight"><code class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">alias</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"subsystemA-dataSource"</span> <span class="hljs-attr">alias</span>=<span class="hljs-string">"subsystemB-dataSource"</span>/&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">alias</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"subsystemA-dataSource"</span> <span class="hljs-attr">alias</span>=<span class="hljs-string">"myApp-dataSource"</span> /&gt;</span><span class="hljs-comment"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- **实例化 Bean**</span><br><span class="line"></span><br><span class="line">  - 构造器方式</span><br><span class="line"></span><br><span class="line">  - ```xml</span><br><span class="line">    &lt;bean id=&quot;exampleBean&quot; class=&quot;examples.ExampleBean&quot;/&gt;</span><br></pre></td></tr></table></figure></span></code></pre></li></ul></li></ul><h3 id="依赖注入模式"><a class="markdownIt-Anchor" href="#依赖注入模式"></a> 依赖注入模式</h3><p>依赖注入模式可以分为手动模式和自动模式。</p><h4 id="手动注入"><a class="markdownIt-Anchor" href="#手动注入"></a> 手动注入</h4><p>配置或者编程的方式，提前安排注入规则</p><ul><li>XML 资源配置元信息</li><li>Java 注解配置元信息</li><li>API 配置元信息</li></ul><h4 id="自动注入"><a class="markdownIt-Anchor" href="#自动注入"></a> 自动注入</h4><p>实现方提供依赖自动关联的方式，按照內建的注入规则（官方不推荐）</p><ul><li>Autowiring（自动绑定）</li></ul><table><thead><tr><th>模式</th><th>说明</th></tr></thead><tbody><tr><td>no</td><td>默认值，未激活 Autowiring，需要手动指定依赖注入对象。</td></tr><tr><td>byName</td><td>根据被注入属性的名称作为 Bean 名称进行依赖查找，并将对象设置到该属性。</td></tr><tr><td>byType</td><td>根据被注入属性的类型作为依赖类型进行查找，并将对象设置到该属性。</td></tr><tr><td>constructor</td><td>特殊 byType 类型，用于构造器参数。</td></tr></tbody></table><blockquote><p>限制和不足参考：<a href="https://docs.spring.io/spring/docs/5.2.2.RELEASE/spring-frameworkreference/core.html#beans-autowired-exceptions">Limitations and Disadvantages of Autowiring 小节(opens new window)</a></p></blockquote><h4 id="依赖注入类型"><a class="markdownIt-Anchor" href="#依赖注入类型"></a> 依赖注入类型</h4><table><thead><tr><th>依赖注入类型</th><th>配置元数据举例</th></tr></thead><tbody><tr><td>Setter 方法</td><td><code>&lt;proeprty name=&quot;user&quot; ref=&quot;userBean&quot;/&gt;</code></td></tr><tr><td>构造器</td><td><code>&lt;constructor-arg name=&quot;user&quot; ref=&quot;userBean&quot; /&gt;</code></td></tr><tr><td>字段</td><td><code>@Autowired User user;</code></td></tr><tr><td>方法</td><td><code>@Autowired public void user(User user) &#123; ... &#125;</code></td></tr><tr><td>接口回调</td><td><code>class MyBean implements BeanFactoryAware &#123; ... &#125;</code></td></tr></tbody></table><h4 id="setter-方法注入"><a class="markdownIt-Anchor" href="#setter-方法注入"></a> Setter 方法注入</h4><p>手动模式</p><ul><li>XML 资源配置元信息</li><li>Java 注解配置元信息</li><li>API 配置元信息</li></ul><p>自动模式</p><ul><li>byName</li><li>byType</li></ul><h4 id="构造器注入"><a class="markdownIt-Anchor" href="#构造器注入"></a> 构造器注入</h4><p>手动模式</p><ul><li>XML 资源配置元信息</li><li>Java 注解配置元信息</li><li>API 配置元信息</li></ul><p>自动模式</p><ul><li>constructor</li></ul><h4 id="字段注入"><a class="markdownIt-Anchor" href="#字段注入"></a> 字段注入</h4><p>手动模式（Java 注解配置元信息）</p><ul><li><code>@Autowired</code></li><li><code>@Resource</code></li><li><code>@Inject</code>（可选）</li></ul><h4 id="方法注入"><a class="markdownIt-Anchor" href="#方法注入"></a> 方法注入</h4><p>手动模式（Java 注解配置元信息）</p><ul><li><code>@Autowired</code></li><li><code>@Resource</code></li><li><code>@Inject</code>（可选）</li><li><code>@Bean</code></li></ul><h4 id="接口回调注入"><a class="markdownIt-Anchor" href="#接口回调注入"></a> 接口回调注入</h4><p>Aware 系列接口回调</p><table><thead><tr><th>內建接口</th><th>说明</th></tr></thead><tbody><tr><td><code>BeanFactoryAware</code></td><td>获取 IoC 容器- <code>BeanFactory</code></td></tr><tr><td><code>ApplicationContextAware</code></td><td>获取 Spring 应用上下文- <code>ApplicationContext</code> 对象</td></tr><tr><td><code>EnvironmentAware</code></td><td>获取 <code>Environment</code> 对象</td></tr><tr><td><code>ResourceLoaderAware</code></td><td>获取资源加载器对象- <code>ResourceLoader</code></td></tr><tr><td><code>BeanClassLoaderAware</code></td><td>获取加载当前 Bean Class 的 <code>ClassLoader</code></td></tr><tr><td><code>BeanNameAware</code></td><td>获取当前 Bean 的名称</td></tr><tr><td><code>MessageSourceAware</code></td><td>获取 <code>MessageSource</code> 对象，用于 Spring 国际化</td></tr><tr><td><code>ApplicationEventPublisherAware</code></td><td>获取 <code>ApplicationEventPublishAware</code> 对象，用于 Spring 事件</td></tr><tr><td><code>EmbeddedValueResolverAware</code></td><td>获取 <code>StringValueResolver</code> 对象，用于占位符处理</td></tr></tbody></table><h4 id="依赖注入类型选择"><a class="markdownIt-Anchor" href="#依赖注入类型选择"></a> 依赖注入类型选择</h4><ul><li>低依赖：构造器注入</li><li>多依赖：Setter 方法注入</li><li>便利性：字段注入</li><li>声明类：方法注入</li></ul><h3 id="被注入的数据类型"><a class="markdownIt-Anchor" href="#被注入的数据类型"></a> 被注入的数据类型</h3><p>基础类型</p><ul><li>原生类型（Primitive）：boolean、byte、char、short、int、float、long、double</li><li>标量类型（Scalar）：Number、Character、Boolean、Enum、Locale、Charset、Currency、Properties、UUID</li><li>常规类型（General）：Object、String、TimeZone、Calendar、Optional 等</li><li>Spring 类型：Resource、InputSource、Formatter 等</li></ul><p>集合类型</p><ul><li>数组类型（Array）：原生类型、标量类型、常规类型、Spring 类型</li><li>集合类型（Collection）<ul><li>Collection：List、Set（SortedSet、NavigableSet、EnumSet）</li><li>Map：Properties</li></ul></li></ul><h2 id="ioc-依赖查找"><a class="markdownIt-Anchor" href="#ioc-依赖查找"></a> IoC 依赖查找</h2><p><strong>依赖查找是主动或手动的依赖查找方式，通常需要依赖容器或标准 API 实现</strong>。</p><ul><li>根据 Bean 名称查找<ul><li>实时查找</li><li>延迟查找</li></ul></li><li>根据 Bean 类型查找</li><li>根据 Bean 名称 + 类型查找</li><li>根据 Java 注解查找</li></ul><p>【示例】Spring IoC 依赖查找</p><p>xml 元信息配置</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">xmlns:p</span>=<span class="string">&quot;http://www.springframework.org/schema/p&quot;</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.2.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;objectFactory&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.beans.factory.config.ObjectFactoryCreatingFactoryBean&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;targetBeanName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;user&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;user&quot;</span> <span class="attr">class</span>=<span class="string">&quot;io.github.dunwu.spring.core.domain.User&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">p:name</span>=<span class="string">&quot;张三&quot;</span> <span class="attr">p:age</span>=<span class="string">&quot;18&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;superUser&quot;</span> <span class="attr">class</span>=<span class="string">&quot;io.github.dunwu.spring.core.domain.SysUser&quot;</span> <span class="attr">parent</span>=<span class="string">&quot;user&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;李四&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;age&quot;</span> <span class="attr">value</span>=<span class="string">&quot;19&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;address&quot;</span> <span class="attr">value</span>=<span class="string">&quot;南京&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><p>依赖查找示例代码：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BeanFactoryDemo</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"><span class="type">BeanFactory</span> <span class="variable">beanFactory</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;spring/spring-dependency-lookup.xml&quot;</span>);</span><br><span class="line">lookupByType(beanFactory);</span><br><span class="line">lookupByNameInRealTime(beanFactory);</span><br><span class="line">lookupByNameInLazy(beanFactory);</span><br><span class="line">lookupByAnnotation(beanFactory);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">lookupByType</span><span class="params">(BeanFactory beanFactory)</span> &#123;</span><br><span class="line"><span class="type">SysUser</span> <span class="variable">user</span> <span class="operator">=</span> beanFactory.getBean(SysUser.class);</span><br><span class="line">System.out.println(<span class="string">&quot;SysUser = &quot;</span> + user);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">lookupByNameInRealTime</span><span class="params">(BeanFactory beanFactory)</span> &#123;</span><br><span class="line"><span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> (User) beanFactory.getBean(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">System.out.println(<span class="string">&quot;user = &quot;</span> + user);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">lookupByNameInLazy</span><span class="params">(BeanFactory beanFactory)</span> &#123;</span><br><span class="line">ObjectFactory&lt;User&gt; objectFactory = (ObjectFactory&lt;User&gt;) beanFactory.getBean(<span class="string">&quot;objectFactory&quot;</span>);</span><br><span class="line"><span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> objectFactory.getObject();</span><br><span class="line">System.out.println(<span class="string">&quot;user = &quot;</span> + user);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">lookupByAnnotation</span><span class="params">(BeanFactory beanFactory)</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (beanFactory <span class="keyword">instanceof</span> ListableBeanFactory) &#123;</span><br><span class="line"><span class="type">ListableBeanFactory</span> <span class="variable">listableBeanFactory</span> <span class="operator">=</span> (ListableBeanFactory) beanFactory;</span><br><span class="line">Map&lt;String, Object&gt; users = listableBeanFactory.getBeansWithAnnotation(Super.class);</span><br><span class="line">System.out.println(<span class="string">&quot;users = &quot;</span> + users);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ioc-依赖注入"><a class="markdownIt-Anchor" href="#ioc-依赖注入"></a> IoC 依赖注入</h2><p>DI，是 Dependency Injection 的缩写，即依赖注入。依赖注入是 IoC 的最常见形式。依赖注入是手动或自动绑定的方式，无需依赖特定的容器或 API。</p><p><strong>容器全权负责组件的装配，它会把符合依赖关系的对象通过 JavaBean 属性或者构造函数传递给需要的对象</strong>。</p><p>DI 是组件之间依赖关系由容器在运行期决定，形象的说，即由容器动态的将某个依赖关系注入到组件之中。依赖注入的目的并非为软件系统带来更多功能，而是为了提升组件重用的频率，并为系统搭建一个灵活、可扩展的平台。通过依赖注入机制，我们只需要通过简单的配置，而无需任何代码就可指定目标需要的资源，完成自身的业务逻辑，而不需要关心具体的资源来自何处，由谁实现。</p><p>理解 DI 的关键是：“谁依赖谁，为什么需要依赖，谁注入谁，注入了什么”，那我们来深入分析一下：</p><ul><li>**谁依赖于谁：**当然是应用程序依赖于 IoC 容器；</li><li>**为什么需要依赖：**应用程序需要 IoC 容器来提供对象需要的外部资源；</li><li>**谁注入谁：**很明显是 IoC 容器注入应用程序某个对象，应用程序依赖的对象；</li><li><strong>注入了什么</strong>：就是注入某个对象所需要的外部资源（包括对象、资源、常量数据）。</li></ul><p>IoC 依赖注入 API</p><ul><li>根据 Bean 名称注入</li><li>根据 Bean 类型注入</li><li>注入容器内建 Bean 对象</li><li>注入非 Bean 对象</li><li>注入类型<ul><li>实时注入</li><li>延迟注入</li></ul></li></ul><h2 id="ioc-容器配置"><a class="markdownIt-Anchor" href="#ioc-容器配置"></a> IoC 容器配置</h2><p>IoC 容器的配置有三种方式：</p><ul><li>基于 xml 配置</li><li>基于注解配置</li><li>基于 Java 配置</li></ul><p>作为 Spring 传统的配置方式，xml 配置方式一般为大家所熟知。</p><p>如果厌倦了 xml 配置，Spring 也提供了注解配置方式或 Java 配置方式来简化配置。</p><p><strong>本文，将对 Java 配置 IoC 容器做详细的介绍。</strong></p><h3 id=""><a class="markdownIt-Anchor" href="#"></a> <a href="https://dunwu.github.io/spring-tutorial/core/Spring%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5.html#_5-1-xml-%E9%85%8D%E7%BD%AE">#</a>5.1. Xml 配置</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">         http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">import</span> <span class="attr">resource</span>=<span class="string">&quot;resource1.xml&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bean1&quot;</span> <span class="attr">class</span>=<span class="string">&quot;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;bean2&quot;</span> <span class="attr">class</span>=<span class="string">&quot;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">&quot;bean2&quot;</span> <span class="attr">class</span>=<span class="string">&quot;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">alias</span> <span class="attr">alias</span>=<span class="string">&quot;bean3&quot;</span> <span class="attr">name</span>=<span class="string">&quot;bean2&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">import</span> <span class="attr">resource</span>=<span class="string">&quot;resource2.xml&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><p>标签说明：</p><ul><li><code>&lt;beans&gt;</code> 是 Spring 配置文件的根节点。</li><li><code>&lt;bean&gt;</code> 用来定义一个 JavaBean。<code>id</code> 属性是它的标识，在文件中必须唯一；<code>class</code> 属性是它关联的类。</li><li><code>&lt;alias&gt;</code> 用来定义 Bean 的别名。</li><li><code>&lt;import&gt;</code> 用来导入其他配置文件的 Bean 定义。这是为了加载多个配置文件，当然也可以把这些配置文件构造为一个数组（new String[] {“config1.xml”, config2.xml}）传给 <code>ApplicationContext</code> 实现类进行加载多个配置文件，那一个更适合由用户决定；这两种方式都是通过调用 Bean Definition Reader 读取 Bean 定义，内部实现没有任何区别。<code>&lt;import&gt;</code> 标签可以放在 <code>&lt;beans&gt;</code> 下的任何位置，没有顺序关系。</li></ul><h4 id="-2"><a class="markdownIt-Anchor" href="#-2"></a> <a href="https://dunwu.github.io/spring-tutorial/core/Spring%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5.html#%E5%AE%9E%E4%BE%8B%E5%8C%96%E5%AE%B9%E5%99%A8">#</a>实例化容器</h4><p>实例化容器的过程： 定位资源（XML 配置文件） 读取配置信息(Resource) 转化为 Spring 可识别的数据形式（BeanDefinition）</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span></span><br><span class="line">      <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="keyword">new</span> <span class="title class_">String</span>[] &#123;<span class="string">&quot;services.xml&quot;</span>, <span class="string">&quot;daos.xml&quot;</span>&#125;);</span><br></pre></td></tr></table></figure><p>组合 xml 配置文件 配置的 Bean 功能各不相同，都放在一个 xml 文件中，不便管理。 Java 设计模式讲究职责单一原则。配置其实也是如此，功能不同的 JavaBean 应该被组织在不同的 xml 文件中。然后使用 import 标签把它们统一导入。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">import</span> <span class="attr">resource</span>=<span class="string">&quot;classpath:spring/applicationContext.xml&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">import</span> <span class="attr">resource</span>=<span class="string">&quot;/WEB-INF/spring/service.xml&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure><h4 id="-3"><a class="markdownIt-Anchor" href="#-3"></a> <a href="https://dunwu.github.io/spring-tutorial/core/Spring%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5.html#%E4%BD%BF%E7%94%A8%E5%AE%B9%E5%99%A8">#</a>使用容器</h4><p>使用容器的方式就是通过<code>getBean</code>获取 IoC 容器中的 JavaBean。 Spring 也有其他方法去获得 JavaBean，但是 Spring 并不推荐其他方式。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// create and configure beans</span></span><br><span class="line"><span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="keyword">new</span> <span class="title class_">String</span>[] &#123;<span class="string">&quot;services.xml&quot;</span>, <span class="string">&quot;daos.xml&quot;</span>&#125;);</span><br><span class="line"><span class="comment">// retrieve configured instance</span></span><br><span class="line"><span class="type">PetStoreService</span> <span class="variable">service</span> <span class="operator">=</span> context.getBean(<span class="string">&quot;petStore&quot;</span>, PetStoreService.class);</span><br><span class="line"><span class="comment">// use configured instance</span></span><br><span class="line">List&lt;String&gt; userList = service.getUsernameList();</span><br></pre></td></tr></table></figure><h3 id="注解配置"><a class="markdownIt-Anchor" href="#注解配置"></a> 注解配置</h3><p>Spring2.5 引入了注解。 于是，一个问题产生了：<strong>使用注解方式注入 JavaBean 是不是一定完爆 xml 方式？</strong> 未必。正所谓，仁者见仁智者见智。任何事物都有其优缺点，看你如何取舍。来看看注解的优缺点： <strong>优点</strong>：大大减少了配置，并且可以使配置更加精细——类，方法，字段都可以用注解去标记。 <strong>缺点</strong>：使用注解，不可避免产生了侵入式编程，也产生了一些问题。</p><ul><li>你需要将注解加入你的源码并编译它；</li><li>注解往往比较分散，不易管控。</li></ul><blockquote><p>注：spring 中，先进行注解注入，然后才是 xml 注入，因此如果注入的目标相同，后者会覆盖前者。</p></blockquote><h4 id="启动注解"><a class="markdownIt-Anchor" href="#启动注解"></a> 启动注解</h4><p>Spring 默认是不启用注解的。如果想使用注解，需要先在 xml 中启动注解。 启动方式：在 xml 中加入一个标签，很简单吧。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context:annotation-config</span>/&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>注：<code>&lt;context:annotation-config/&gt;</code> 只会检索定义它的上下文。什么意思呢？就是说，如果你 为 DispatcherServlet 指定了一个<code>WebApplicationContext</code>，那么它只在 controller 中查找<code>@Autowired</code>注解，而不会检查其它的路径。</p></blockquote><h4 id="required"><a class="markdownIt-Anchor" href="#required"></a> <code>@Required</code></h4><p><code>@Required</code> 注解只能用于修饰 bean 属性的 setter 方法。受影响的 bean 属性必须在配置时被填充在 xml 配置文件中，否则容器将抛出<code>BeanInitializationException</code>。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AnnotationRequired</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String sex;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Required</span> 注解用于bean属性的setter方法并且它指示，受影响的bean属性必须在配置时被填充在xml配置文件中，</span></span><br><span class="line"><span class="comment">     *           否则容器将抛出BeanInitializationException。</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Required</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getSex</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> sex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setSex</span><span class="params">(String sex)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.sex = sex;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="autowired"><a class="markdownIt-Anchor" href="#autowired"></a> <code>@Autowired</code></h4><p><code>@Autowired</code>注解可用于修饰属性、setter 方法、构造方法。</p><p>@Autowired 注入过程</p><ul><li>元信息解析</li><li>依赖查找</li><li>依赖注入（字段、方法）</li></ul><blockquote><p>注：<code>@Autowired</code>注解也可用于修饰构造方法，但如果类中只有默认构造方法，则没有必要。如果有多个构造器，至少应该修饰一个，来告诉容器哪一个必须使用。</p></blockquote><p>可以使用 JSR330 的注解<code>@Inject</code>来替代<code>@Autowired</code>。</p><p><strong>*范例*</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AnnotationAutowired</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Logger</span> <span class="variable">log</span> <span class="operator">=</span> LoggerFactory.getLogger(AnnotationRequired.class);</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> Apple fieldA;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Banana fieldB;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Orange fieldC;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Apple <span class="title function_">getFieldA</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> fieldA;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setFieldA</span><span class="params">(Apple fieldA)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.fieldA = fieldA;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Banana <span class="title function_">getFieldB</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> fieldB;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setFieldB</span><span class="params">(Banana fieldB)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.fieldB = fieldB;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Orange <span class="title function_">getFieldC</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> fieldC;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setFieldC</span><span class="params">(Orange fieldC)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.fieldC = fieldC;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">AnnotationAutowired</span><span class="params">()</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">AnnotationAutowired</span><span class="params">(Orange fieldC)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.fieldC = fieldC;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">AbstractApplicationContext</span> <span class="variable">ctx</span> <span class="operator">=</span></span><br><span class="line">                        <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;spring/spring-annotation.xml&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">AnnotationAutowired</span> <span class="variable">annotationAutowired</span> <span class="operator">=</span></span><br><span class="line">                        (AnnotationAutowired) ctx.getBean(<span class="string">&quot;annotationAutowired&quot;</span>);</span><br><span class="line">        log.debug(<span class="string">&quot;fieldA: &#123;&#125;, fieldB:&#123;&#125;, fieldC:&#123;&#125;&quot;</span>, annotationAutowired.getFieldA().getName(),</span><br><span class="line">                        annotationAutowired.getFieldB().getName(),</span><br><span class="line">                        annotationAutowired.getFieldC().getName());</span><br><span class="line">        ctx.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>xml 中的配置</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 测试@Autowired --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;apple&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.zp.notes.spring.beans.annotation.sample.Apple&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;potato&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.zp.notes.spring.beans.annotation.sample.Banana&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;tomato&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.zp.notes.spring.beans.annotation.sample.Orange&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;annotationAutowired&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.zp.notes.spring.beans.annotation.sample.AnnotationAutowired&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure><h4 id="qualifier"><a class="markdownIt-Anchor" href="#qualifier"></a> <code>@Qualifier</code></h4><p>在<code>@Autowired</code>注解中，提到了如果发现有多个候选的 bean 都符合修饰类型，Spring 就会抓瞎了。</p><p>那么，如何解决这个问题。</p><p>可以通过<code>@Qualifier</code>指定 bean 名称来锁定真正需要的那个 bean。</p><p><strong>*范例*</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AnnotationQualifier</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Logger</span> <span class="variable">log</span> <span class="operator">=</span> LoggerFactory.getLogger(AnnotationQualifier.class);</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="meta">@Qualifier(&quot;dog&quot;)</span> <span class="comment">/** 去除这行，会报异常 */</span></span><br><span class="line">    Animal dog;</span><br><span class="line"></span><br><span class="line">    Animal cat;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Animal <span class="title function_">getDog</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> dog;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setDog</span><span class="params">(Animal dog)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.dog = dog;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Animal <span class="title function_">getCat</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> cat;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setCat</span><span class="params">(<span class="meta">@Qualifier(&quot;cat&quot;)</span> Animal cat)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.cat = cat;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">AbstractApplicationContext</span> <span class="variable">ctx</span> <span class="operator">=</span></span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;spring/spring-annotation.xml&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">AnnotationQualifier</span> <span class="variable">annotationQualifier</span> <span class="operator">=</span></span><br><span class="line">                (AnnotationQualifier) ctx.getBean(<span class="string">&quot;annotationQualifier&quot;</span>);</span><br><span class="line"></span><br><span class="line">        log.debug(<span class="string">&quot;Dog name: &#123;&#125;&quot;</span>, annotationQualifier.getDog().getName());</span><br><span class="line">        log.debug(<span class="string">&quot;Cat name: &#123;&#125;&quot;</span>, annotationQualifier.getCat().getName());</span><br><span class="line">        ctx.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">Animal</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Dog</span> <span class="keyword">extends</span> <span class="title class_">Animal</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;狗&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Cat</span> <span class="keyword">extends</span> <span class="title class_">Animal</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;猫&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>xml 中的配置</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 测试@Qualifier --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dog&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.zp.notes.spring.beans.annotation.sample.Dog&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;cat&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.zp.notes.spring.beans.annotation.sample.Cat&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;annotationQualifier&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.zp.notes.spring.beans.annotation.sample.AnnotationQualifier&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure><h4 id="resource"><a class="markdownIt-Anchor" href="#resource"></a> <code>@Resource</code></h4><p>Spring 支持 JSP250 规定的注解<code>@Resource</code>。这个注解根据指定的名称来注入 bean。</p><p>如果没有为<code>@Resource</code>指定名称，它会像<code>@Autowired</code>一样按照类型去寻找匹配。</p><p>在 Spring 中，由<code>CommonAnnotationBeanPostProcessor</code>来处理<code>@Resource</code>注解。</p><p><strong>*范例*</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AnnotationResource</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Logger</span> <span class="variable">log</span> <span class="operator">=</span> LoggerFactory.getLogger(AnnotationResource.class);</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource(name = &quot;flower&quot;)</span></span><br><span class="line">    Plant flower;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource(name = &quot;tree&quot;)</span></span><br><span class="line">    Plant tree;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Plant <span class="title function_">getFlower</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> flower;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setFlower</span><span class="params">(Plant flower)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.flower = flower;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Plant <span class="title function_">getTree</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> tree;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setTree</span><span class="params">(Plant tree)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.tree = tree;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">AbstractApplicationContext</span> <span class="variable">ctx</span> <span class="operator">=</span></span><br><span class="line">                        <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;spring/spring-annotation.xml&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">AnnotationResource</span> <span class="variable">annotationResource</span> <span class="operator">=</span></span><br><span class="line">                        (AnnotationResource) ctx.getBean(<span class="string">&quot;annotationResource&quot;</span>);</span><br><span class="line">        log.debug(<span class="string">&quot;type: &#123;&#125;, name: &#123;&#125;&quot;</span>, annotationResource.getFlower().getClass(), annotationResource.getFlower().getName());</span><br><span class="line">        log.debug(<span class="string">&quot;type: &#123;&#125;, name: &#123;&#125;&quot;</span>, annotationResource.getTree().getClass(), annotationResource.getTree().getName());</span><br><span class="line">        ctx.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>xml 的配置</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 测试@Resource --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;flower&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.zp.notes.spring.beans.annotation.sample.Flower&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;tree&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.zp.notes.spring.beans.annotation.sample.Tree&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;annotationResource&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.zp.notes.spring.beans.annotation.sample.AnnotationResource&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure><h4 id="postconstruct-和-predestroy"><a class="markdownIt-Anchor" href="#postconstruct-和-predestroy"></a> <code>@PostConstruct</code> 和 <code>@PreDestroy</code></h4><p><code>@PostConstruct</code> 和 <code>@PreDestroy</code> 是 JSR 250 规定的用于生命周期的注解。</p><p>从其名号就可以看出，一个是在构造之后调用的方法，一个是销毁之前调用的方法。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AnnotationPostConstructAndPreDestroy</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Logger</span> <span class="variable">log</span> <span class="operator">=</span> LoggerFactory.getLogger(AnnotationPostConstructAndPreDestroy.class);</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PostConstruct</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">()</span> &#123;</span><br><span class="line">        log.debug(<span class="string">&quot;call @PostConstruct method&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PreDestroy</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> &#123;</span><br><span class="line">        log.debug(<span class="string">&quot;call @PreDestroy method&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="inject"><a class="markdownIt-Anchor" href="#inject"></a> <code>@Inject</code></h4><p>从 Spring3.0 开始，Spring 支持 JSR 330 标准注解（依赖注入）。</p><p>注：如果要使用 JSR 330 注解，需要使用外部 jar 包。</p><p>若你使用 maven 管理 jar 包，只需要添加依赖到 pom.xml 即可：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.inject<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax.inject<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>@Inject</code> 和 <code>@Autowired</code> 一样，可以修饰属性、setter 方法、构造方法。</p><p><strong>*范例*</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AnnotationInject</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Logger</span> <span class="variable">log</span> <span class="operator">=</span> LoggerFactory.getLogger(AnnotationInject.class);</span><br><span class="line">    <span class="meta">@Inject</span></span><br><span class="line">    Apple fieldA;</span><br><span class="line"></span><br><span class="line">    Banana fieldB;</span><br><span class="line"></span><br><span class="line">    Orange fieldC;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Apple <span class="title function_">getFieldA</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> fieldA;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setFieldA</span><span class="params">(Apple fieldA)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.fieldA = fieldA;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Banana <span class="title function_">getFieldB</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> fieldB;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Inject</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setFieldB</span><span class="params">(Banana fieldB)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.fieldB = fieldB;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Orange <span class="title function_">getFieldC</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> fieldC;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">AnnotationInject</span><span class="params">()</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Inject</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">AnnotationInject</span><span class="params">(Orange fieldC)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.fieldC = fieldC;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">AbstractApplicationContext</span> <span class="variable">ctx</span> <span class="operator">=</span></span><br><span class="line">                        <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;spring/spring-annotation.xml&quot;</span>);</span><br><span class="line">        <span class="type">AnnotationInject</span> <span class="variable">annotationInject</span> <span class="operator">=</span> (AnnotationInject) ctx.getBean(<span class="string">&quot;annotationInject&quot;</span>);</span><br><span class="line"></span><br><span class="line">        log.debug(<span class="string">&quot;type: &#123;&#125;, name: &#123;&#125;&quot;</span>, annotationInject.getFieldA().getClass(),</span><br><span class="line">                        annotationInject.getFieldA().getName());</span><br><span class="line"></span><br><span class="line">        log.debug(<span class="string">&quot;type: &#123;&#125;, name: &#123;&#125;&quot;</span>, annotationInject.getFieldB().getClass(),</span><br><span class="line">                        annotationInject.getFieldB().getName());</span><br><span class="line"></span><br><span class="line">        log.debug(<span class="string">&quot;type: &#123;&#125;, name: &#123;&#125;&quot;</span>, annotationInject.getFieldC().getClass(),</span><br><span class="line">                        annotationInject.getFieldC().getName());</span><br><span class="line"></span><br><span class="line">        ctx.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="java-配置"><a class="markdownIt-Anchor" href="#java-配置"></a> Java 配置</h3><p>基于 Java 配置 Spring IoC 容器，实际上是<strong>Spring 允许用户定义一个类，在这个类中去管理 IoC 容器的配置</strong>。</p><p>为了让 Spring 识别这个定义类为一个 Spring 配置类，需要用到两个注解：<code>@Configuration</code>和<code>@Bean</code>。</p><p>如果你熟悉 Spring 的 xml 配置方式，你可以将<code>@Configuration</code>等价于<code>&lt;beans&gt;</code>标签；将<code>@Bean</code>等价于<code>&lt;bean&gt;</code>标签。</p><h4 id="bean-2"><a class="markdownIt-Anchor" href="#bean-2"></a> <code>@Bean</code></h4><p>@Bean 的修饰目标只能是方法或注解。</p><p>@Bean 只能定义在 <code>@Configuration</code> 或 <code>@Component</code> 注解修饰的类中。</p><h4 id="声明一个-bean"><a class="markdownIt-Anchor" href="#声明一个-bean"></a> 声明一个 bean</h4><p>此外，@Configuration 类允许在同一个类中通过@Bean 定义内部 bean 依赖。</p><p>声明一个 bean，只需要在 bean 属性的 set 方法上标注@Bean 即可。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AnnotationConfiguration</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Logger</span> <span class="variable">log</span> <span class="operator">=</span> LoggerFactory.getLogger(JavaComponentScan.class);</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Job <span class="title function_">getPolice</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Police</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">AnnotationConfigApplicationContext</span> <span class="variable">ctx</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AnnotationConfigApplicationContext</span>(AnnotationConfiguration.class);</span><br><span class="line">        ctx.scan(<span class="string">&quot;org.zp.notes.spring.beans&quot;</span>);</span><br><span class="line">        ctx.refresh();</span><br><span class="line">        <span class="type">Job</span> <span class="variable">job</span> <span class="operator">=</span> (Job) ctx.getBean(<span class="string">&quot;police&quot;</span>);</span><br><span class="line">        log.debug(<span class="string">&quot;job: &#123;&#125;, work: &#123;&#125;&quot;</span>, job.getClass(), job.work());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Job</span> &#123;</span><br><span class="line">    String <span class="title function_">work</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component(&quot;police&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Police</span> <span class="keyword">implements</span> <span class="title class_">Job</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">work</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;抓罪犯&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这等价于配置</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">beans</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;police&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.zp.notes.spring.ioc.sample.job.Police&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><p>@Bean 注解用来表明一个方法实例化、配置合初始化一个被 Spring IoC 容器管理的新对象。</p><p>如果你熟悉 Spring 的 xml 配置，你可以将@Bean 视为等价于<code>&lt;beans&gt;</code>标签。</p><p>@Bean 注解可以用于任何的 Spring <code>@Component</code> bean，然而，通常被用于<code>@Configuration</code> bean。</p><h4 id="configuration"><a class="markdownIt-Anchor" href="#configuration"></a> <code>@Configuration</code></h4><p><code>@Configuration</code> 是一个类级别的注解，用来标记被修饰类的对象是一个<code>BeanDefinition</code>。</p><p><code>@Configuration</code> 声明 bean 是通过被 <code>@Bean</code> 修饰的公共方法。此外，<code>@Configuration</code> 允许在同一个类中通过 <code>@Bean</code> 定义内部 bean 依赖。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AppConfig</span> &#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> MyService <span class="title function_">myService</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">MyServiceImpl</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这等价于配置</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">beans</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;myService&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.acme.services.MyServiceImpl&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><p>用 <code>AnnotationConfigApplicationContext</code> 实例化 IoC 容器。</p><h2 id="最佳实践"><a class="markdownIt-Anchor" href="#最佳实践"></a> 最佳实践</h2><h3 id="singleton-的-bean-如何注入-prototype-的-bean"><a class="markdownIt-Anchor" href="#singleton-的-bean-如何注入-prototype-的-bean"></a> singleton 的 Bean 如何注入 prototype 的 Bean</h3><p>Spring 创建的 Bean 默认是单例的，但当 Bean 遇到继承的时候，可能会忽略这一点。</p><p>假设有一个 SayService 抽象类，其中维护了一个类型是 ArrayList 的字段 data，用于保存方法处理的中间数据。每次调用 say 方法都会往 data 加入新数据，可以认为 SayService 是有状态，如果 SayService 是单例的话必然会 OOM。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * SayService 是有状态，如果 SayService 是单例的话必然会 OOM</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">SayService</span> &#123;</span><br><span class="line"></span><br><span class="line">   List&lt;String&gt; data = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">say</span><span class="params">()</span> &#123;</span><br><span class="line">      data.add(IntStream.rangeClosed(<span class="number">1</span>, <span class="number">1000000</span>)</span><br><span class="line">         .mapToObj(__ -&gt; <span class="string">&quot;a&quot;</span>)</span><br><span class="line">         .collect(Collectors.joining(<span class="string">&quot;&quot;</span>)) + UUID.randomUUID().toString());</span><br><span class="line">      log.info(<span class="string">&quot;I&#x27;m &#123;&#125; size:&#123;&#125;&quot;</span>, <span class="built_in">this</span>, data.size());</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>但实际开发的时候，开发同学没有过多思考就把 SayHello 和 SayBye 类加上了 @Service 注解，让它们成为了 Bean，也没有考虑到父类是有状态的。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SayBye</span> <span class="keyword">extends</span> <span class="title class_">SayService</span> &#123;</span><br><span class="line"></span><br><span class="line">   <span class="meta">@Override</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">say</span><span class="params">()</span> &#123;</span><br><span class="line">      <span class="built_in">super</span>.say();</span><br><span class="line">      log.info(<span class="string">&quot;bye&quot;</span>);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SayHello</span> <span class="keyword">extends</span> <span class="title class_">SayService</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">say</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="built_in">super</span>.say();</span><br><span class="line">log.info(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在为类标记上 @Service 注解把类型交由容器管理前，首先评估一下类是否有状态，然后为 Bean 设置合适的 Scope。</p><p>调用代码：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;beansingletonandorder&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BeanSingletonAndOrderController</span> &#123;</span><br><span class="line"></span><br><span class="line">   <span class="meta">@Autowired</span></span><br><span class="line">   List&lt;SayService&gt; sayServiceList;</span><br><span class="line">   <span class="meta">@Autowired</span></span><br><span class="line">   <span class="keyword">private</span> ApplicationContext applicationContext;</span><br><span class="line"></span><br><span class="line">   <span class="meta">@GetMapping(&quot;test&quot;)</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span> &#123;</span><br><span class="line">      log.info(<span class="string">&quot;====================&quot;</span>);</span><br><span class="line">      sayServiceList.forEach(SayService::say);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>可能有人认为，为 SayHello 和 SayBye 两个类都标记了 @Scope 注解，设置了 PROTOTYPE 的生命周期就可以解决上面的问题。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Scope(value = ConfigurableBeanFactory.SCOPE_PROTOTYPE)</span></span><br></pre></td></tr></table></figure><p>但实际上还是有问题。因为@RestController 注解 =@Controller 注解 +@ResponseBody 注解，又因为 @Controller 标记了 @Component 元注解，所以 @RestController 注解其实也是一个 Spring Bean。</p><p>Bean 默认是单例的，所以单例的 Controller 注入的 Service 也是一次性创建的，即使 Service 本身标识了 prototype 的范围也没用。</p><p>修复方式是，让 Service 以代理方式注入。这样虽然 Controller 本身是单例的，但每次都能从代理获取 Service。这样一来，prototype 范围的配置才能真正生效。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Scope(value = ConfigurableBeanFactory.SCOPE_PROTOTYPE, proxyMode = ScopedProx)</span></span><br></pre></td></tr></table></figure><h2 id="参考资料"><a class="markdownIt-Anchor" href="#参考资料"></a> 参考资料</h2><ul><li><a href="https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/core.html#beans">Spring 官方文档之 Core Technologies</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> Spring </category>
          
          <category> Java </category>
          
          <category> SpringIOC详解 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Spring </tag>
            
            <tag> Java </tag>
            
            <tag> SpringIOC </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>一键生成代码</title>
      <link href="/posts/1d84dc88/"/>
      <url>/posts/1d84dc88/</url>
      
        <content type="html"><![CDATA[<div class="tip home"><p>写在前面的话:<br />本脚本模板不收取任何费用,初衷就是不想重复造梯子,如果对各位有帮助的话,可以给作者打上一杯奶茶钱,目前插件还是有点小 Bug,但是不影响使用,现在各平台相关的代码生成插件也比较成熟了,并且带有独特的特色和一些自带的代码提示功能,使用感受整体都不错,但是好用的插件肯定是要收费的啦~具体的请参考下面相关插件查看</p></div><details class="folding-tag" green><summary> 查看视频教程 </summary>              <div class='content'>              <iframe class="bilibili" src="//player.bilibili.com/player.html?aid=981357376&bvid=BV1q44y1u7EL&cid=711986806&page=1&high_quality=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" > </iframe>              </div>            </details><table><thead><tr><th style="text-align:center">参考插件</th></tr></thead><tbody><tr><td style="text-align:center"><strong><a href="https://github.com/gejun123456/MyBatisCodeHelper-Pro">MyBatisCodeHelper-Pro</a></strong></td></tr><tr><td style="text-align:center"><a href="https://github.com/zhengjunbase/codehelper.generator"><strong>codehelper.generator</strong></a></td></tr><tr><td style="text-align:center"><a href="https://github.com/mybatis/mybatis-3"><strong>mybatis</strong></a></td></tr><tr><td style="text-align:center"><a href="https://github.com/mybatis/generator">mybatis generator</a></td></tr><tr><td style="text-align:center"><a href="https://github.com/pagehelper/Mybatis-PageHelper">pageHelper</a></td></tr><tr><td style="text-align:center"><a href="https://github.com/zouzg/mybatis-generator-gui">mybatis-generator-gui</a></td></tr><tr><td style="text-align:center"><a href="https://github.com/itfsw/mybatis-generator-plugin">mybatis generator plugin</a></td></tr><tr><td style="text-align:center"><a href="https://github.com/baomidou/mybatis-plus">mybatisplus</a></td></tr></tbody></table><details class="folding-tag" cyan><summary> 功能介绍 </summary>              <div class='content'>              <p>本脚本只适用于 EasyCode 模板搭配使用</p><p>支持生成代码具体如下:</p><div class='checkbox blue checked'><input type="checkbox" checked="checked"/>            <p>controller 层代码</p>            </div><div class='checkbox blue checked'><input type="checkbox" checked="checked"/>            <p>handler 处理器</p>            </div><div class='checkbox blue checked'><input type="checkbox" checked="checked"/>            <p>interceptor 拦截器</p>            </div><div class='checkbox blue checked'><input type="checkbox" checked="checked"/>            <p>mapper 数据库接口</p>            </div><div class='checkbox blue checked'><input type="checkbox" checked="checked"/>            <p>pojo 实体类</p>            </div><div class='checkbox blue checked'><input type="checkbox" checked="checked"/>            <p>service 服务层</p>            </div><div class='checkbox blue checked'><input type="checkbox" checked="checked"/>            <p>service-impl 服务层实现类</p>            </div><div class='checkbox blue checked'><input type="checkbox" checked="checked"/>            <p>application.yaml yaml全局配置文件</p>            </div><div class='checkbox red'><input type="checkbox" />            <p>Bug修复~</p>            </div><p>是不是很方便,一键生成到底,基本满足你日常 CRUD</p><p>虽然还是有点 Bug,但是我觉得他已经成熟了,因为不影响使用,具体 Bug 我会在下文中讲些</p>              </div>            </details><h2 id="使用教程"><a class="markdownIt-Anchor" href="#使用教程"></a> 使用教程</h2><h3 id="前置条件"><a class="markdownIt-Anchor" href="#前置条件"></a> 前置条件</h3><p>随意创建一个 SpringBoot 项目,在 pom 里面引入相关依赖</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--mp--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.baomidou<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-plus-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--Mysql驱动--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--mp代码生成器--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.baomidou<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-plus-generator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/com.alibaba/druid-spring-boot-starter --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>搜索 EasyCode 插件安装</p><p><img src="https://unpkg.com/serms-assets@1.0.23/imgs/image-20220504090944383.png" alt="" /></p><p>在文件&gt;设置&gt;其他设置&gt;EasyCode&gt;Template 中添加组名,命名随意,可以看到,除了第一个,下面四个都插件自带的,你们也可以尝试一下</p><p><img src="https://unpkg.com/serms-assets@1.0.23/imgs/image-20220504091123867.png" alt="" /></p><p>接下来就是最重要的添加模板了</p><h3 id="pojojavavm"><a class="markdownIt-Anchor" href="#pojojavavm"></a> pojo.java.vm</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">$!&#123;define.vm&#125;</span><br><span class="line">#set($author = <span class="string">&quot;SerMs&quot;</span>)</span><br><span class="line">#save(<span class="string">&quot;/pojo&quot;</span>, <span class="string">&quot;.java&quot;</span>)</span><br><span class="line"></span><br><span class="line">#setPackageSuffix(<span class="string">&quot;pojo&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.annotation.*;</span><br><span class="line"><span class="keyword">import</span> lombok.AllArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> lombok.NoArgsConstructor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#tableComment(<span class="string">&quot;实体类&quot;</span>)</span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">$</span>!&#123;tableInfo.name&#125; <span class="keyword">implements</span> <span class="title class_">Serializable</span>&#123;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> serialVersionUID= $!tool.serial();</span><br><span class="line">#foreach($column in $tableInfo.pkColumn)</span><br><span class="line">    #<span class="keyword">if</span>($&#123;column.comment&#125;)<span class="comment">/**</span></span><br><span class="line"><span class="comment">     * $&#123;column.comment&#125;</span></span><br><span class="line"><span class="comment">     */</span>#end</span><br><span class="line"></span><br><span class="line"><span class="meta">@TableId(value = &quot;$!&#123;column.obj.name&#125;&quot; , type = IdType.AUTO)</span></span><br><span class="line"><span class="keyword">private</span> $!&#123;tool.getClsNameByFullName($column.type)&#125; $!&#123;column.name&#125;;</span><br><span class="line">#end</span><br><span class="line">#foreach($column in $tableInfo.otherColumn)</span><br><span class="line"></span><br><span class="line">    #<span class="keyword">if</span>($&#123;column.comment&#125;)<span class="comment">/**$&#123;column.comment&#125;*/</span>#end</span><br><span class="line">    #<span class="keyword">if</span>(!($column.name.equals(<span class="string">&#x27;deleted&#x27;</span>)||$column.name.equals(<span class="string">&#x27;updateTime&#x27;</span>)||$column.name.equals(<span class="string">&#x27;createTime&#x27;</span>)))<span class="meta">@TableField(value = &quot;$!&#123;column.obj.name&#125;&quot;)</span>#end</span><br><span class="line">    #<span class="keyword">if</span>($column.name.equals(<span class="string">&#x27;createTime&#x27;</span>))</span><br><span class="line">    <span class="comment">/** 创建时间 */</span></span><br><span class="line">    <span class="meta">@TableField(value = &quot;$!&#123;column.obj.name&#125;&quot; , fill = FieldFill.INSERT)</span>#end</span><br><span class="line">    #<span class="keyword">if</span>($column.name.equals(<span class="string">&#x27;updateTime&#x27;</span>))</span><br><span class="line">    <span class="comment">/** 修改时间 */</span></span><br><span class="line">    <span class="meta">@TableField(value = &quot;$!&#123;column.obj.name&#125;&quot; , fill = FieldFill.INSERT_UPDATE)</span>#end</span><br><span class="line">    #<span class="keyword">if</span>($column.name.equals(<span class="string">&#x27;deleted&#x27;</span>))<span class="meta">@TableLogic</span></span><br><span class="line">    #end</span><br><span class="line"><span class="keyword">private</span> $!&#123;tool.getClsNameByFullName($column.type)&#125; $!&#123;column.name&#125;;</span><br><span class="line">#end</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="serviceimpljavavm"><a class="markdownIt-Anchor" href="#serviceimpljavavm"></a> serviceImpl.java.vm</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">##定义初始变量</span><br><span class="line">#set($author = <span class="string">&quot;SerMs&quot;</span>)</span><br><span class="line">#set($tableName = $tool.append($tableInfo.name, <span class="string">&quot;ServiceImpl&quot;</span>))</span><br><span class="line">##设置回调</span><br><span class="line">$!callback.setFileName($tool.append($tableName, <span class="string">&quot;.java&quot;</span>))</span><br><span class="line">$!callback.setSavePath($tool.append($tableInfo.savePath, <span class="string">&quot;/service/impl&quot;</span>))</span><br><span class="line"></span><br><span class="line">##拿到主键</span><br><span class="line">#<span class="keyword">if</span>(!$tableInfo.pkColumn.isEmpty())</span><br><span class="line">    #set($pk = $tableInfo.pkColumn.get(<span class="number">0</span>))</span><br><span class="line">#end</span><br><span class="line"></span><br><span class="line">#<span class="keyword">if</span>($tableInfo.savePackageName)<span class="keyword">package</span> $!&#123;tableInfo.savePackageName&#125;.#&#123;end&#125;service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.service.impl.ServiceImpl;</span><br><span class="line"><span class="keyword">import</span> $!&#123;tableInfo.savePackageName&#125;.pojo.$!&#123;tableInfo.name&#125;;</span><br><span class="line"><span class="keyword">import</span> $!&#123;tableInfo.savePackageName&#125;.mapper.$!&#123;tableInfo.name&#125;Mapper;</span><br><span class="line"><span class="keyword">import</span> $!&#123;tableInfo.savePackageName&#125;.service.$!&#123;tableInfo.name&#125;Service;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * $!&#123;tableInfo.comment&#125;($!&#123;tableInfo.name&#125;)表服务实现类</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> $!author</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> $!time.currTime()</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Service(&quot;$!tool.firstLowerCase($!&#123;tableInfo.name&#125;)Service&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">$</span>!&#123;tableName&#125; <span class="keyword">extends</span> <span class="title class_">ServiceImpl</span>&lt;$!&#123;tableInfo.name&#125;Mapper, $!&#123;tableInfo.name&#125;&gt; <span class="keyword">implements</span> <span class="title class_">$</span>!&#123;tableInfo.name&#125;Service &#123;&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="mapperjavavm"><a class="markdownIt-Anchor" href="#mapperjavavm"></a> mapper.java.vm</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">#set($tableName = $tool.append($tableInfo.name, <span class="string">&quot;Mapper&quot;</span>))</span><br><span class="line">#set($author = <span class="string">&quot;SerMs&quot;</span>)</span><br><span class="line"></span><br><span class="line">$!callback.setFileName($tool.append($tableName, <span class="string">&quot;.java&quot;</span>))</span><br><span class="line">$!callback.setSavePath($tool.append($tableInfo.savePath, <span class="string">&quot;/mapper&quot;</span>))</span><br><span class="line"></span><br><span class="line">#<span class="keyword">if</span>(!$tableInfo.pkColumn.isEmpty())</span><br><span class="line">    #set($pk = $tableInfo.pkColumn.get(<span class="number">0</span>))</span><br><span class="line">#end</span><br><span class="line"></span><br><span class="line">#<span class="keyword">if</span>($tableInfo.savePackageName)<span class="keyword">package</span> $!&#123;tableInfo.savePackageName&#125;.#&#123;end&#125;mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.core.mapper.BaseMapper;</span><br><span class="line"><span class="keyword">import</span> $!&#123;tableInfo.savePackageName&#125;.pojo.$!tableInfo.name;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * $!&#123;tableInfo.comment&#125;($!&#123;tableInfo.name&#125;)表数据库访问层</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> $!author</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> $!time.currTime()</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">$</span>!&#123;tableName&#125; <span class="keyword">extends</span> <span class="title class_">BaseMapper</span>&lt;$!tableInfo.name&gt; &#123;&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="servicejavavm"><a class="markdownIt-Anchor" href="#servicejavavm"></a> service.java.vm</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">#set($author = <span class="string">&quot;SerMs&quot;</span>)</span><br><span class="line">#set($tableName = $tool.append($tableInfo.name, <span class="string">&quot;Service&quot;</span>))</span><br><span class="line"></span><br><span class="line">$!callback.setFileName($tool.append($tableName, <span class="string">&quot;.java&quot;</span>))</span><br><span class="line">$!callback.setSavePath($tool.append($tableInfo.savePath, <span class="string">&quot;/service&quot;</span>))</span><br><span class="line"></span><br><span class="line">#<span class="keyword">if</span>(!$tableInfo.pkColumn.isEmpty())</span><br><span class="line">    #set($pk = $tableInfo.pkColumn.get(<span class="number">0</span>))</span><br><span class="line">#end</span><br><span class="line"></span><br><span class="line">#<span class="keyword">if</span>($tableInfo.savePackageName)<span class="keyword">package</span> $!&#123;tableInfo.savePackageName&#125;.#&#123;end&#125;service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> $!&#123;tableInfo.savePackageName&#125;.pojo.$!&#123;tableInfo.name&#125;;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.service.IService;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * $!&#123;tableInfo.comment&#125;($!&#123;tableInfo.name&#125;)表服务接口</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> $!author</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> $!time.currTime()</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">$</span>!&#123;tableName&#125; <span class="keyword">extends</span> <span class="title class_">IService</span>&lt;$!tableInfo.name&gt; &#123;&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="controllerjavavm"><a class="markdownIt-Anchor" href="#controllerjavavm"></a> controller.java.vm</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line">#set($author = <span class="string">&quot;SerMs&quot;</span>)</span><br><span class="line">#set($tableName = $tool.append($tableInfo.name, <span class="string">&quot;Controller&quot;</span>))</span><br><span class="line"></span><br><span class="line">$!callback.setFileName($tool.append($tableName, <span class="string">&quot;.java&quot;</span>))</span><br><span class="line">$!callback.setSavePath($tool.append($tableInfo.savePath, <span class="string">&quot;/controller&quot;</span>))</span><br><span class="line"></span><br><span class="line">#<span class="keyword">if</span>(!$tableInfo.pkColumn.isEmpty())</span><br><span class="line">    #set($pk = $tableInfo.pkColumn.get(<span class="number">0</span>))</span><br><span class="line">#end</span><br><span class="line"></span><br><span class="line">#<span class="keyword">if</span>($tableInfo.savePackageName)<span class="keyword">package</span> $!&#123;tableInfo.savePackageName&#125;.#&#123;end&#125;controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.plugins.pagination.Page;</span><br><span class="line"><span class="keyword">import</span> $!&#123;tableInfo.savePackageName&#125;.pojo.$!&#123;tableInfo.name&#125;;</span><br><span class="line"><span class="keyword">import</span> $!&#123;tableInfo.savePackageName&#125;.service.$!&#123;tableInfo.name&#125;Service;</span><br><span class="line"><span class="keyword">import</span> $!&#123;tableInfo.savePackageName&#125;.util.R;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.annotation.Resource;</span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * $!&#123;tableInfo.comment&#125;($!&#123;tableInfo.name&#125;)表控制层</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> $!author</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> $!time.currTime()</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;$!tool.firstLowerCase($tableInfo.name)&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">$</span>!&#123;tableName&#125; &#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 服务对象</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Resource</span></span><br><span class="line"><span class="keyword">private</span> $!&#123;tableInfo.name&#125;Service $!tool.firstLowerCase($tableInfo.name)Service;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 分页查询所有数据</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="meta">@GetMapping</span></span><br><span class="line"><span class="keyword">public</span> R <span class="title function_">page</span><span class="params">(<span class="meta">@RequestParam</span> <span class="type">int</span> current,<span class="meta">@RequestParam</span> <span class="type">int</span> size)</span>&#123;</span><br><span class="line">        Page&lt;$!&#123;tableInfo.name&#125;&gt; page=<span class="keyword">new</span> <span class="title class_">Page</span>&lt;&gt;(current,size);</span><br><span class="line">        <span class="keyword">return</span> R.ok().setData(<span class="built_in">this</span>.$!&#123;tool.firstLowerCase($tableInfo.name)&#125;Service.page(page));&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 通过主键查询单条数据</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> R <span class="title function_">selectOne</span><span class="params">(<span class="meta">@PathVariable</span> Serializable id)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> R.ok().setData(<span class="built_in">this</span>.$!&#123;tool.firstLowerCase($tableInfo.name)&#125;Service.getById(id));&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 新增数据</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@PostMapping</span></span><br><span class="line"><span class="keyword">public</span> R <span class="title function_">save</span><span class="params">(<span class="meta">@RequestBody</span> $!&#123;tableInfo.name&#125; $!tool.firstLowerCase($tableInfo.name)</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> R.ok().setData(<span class="built_in">this</span>.$!&#123;tool.firstLowerCase($tableInfo.name)&#125;Service.save($!tool.firstLowerCase($tableInfo.name)));&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 修改数据</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@PutMapping</span></span><br><span class="line"><span class="keyword">public</span> R <span class="title function_">updateById</span><span class="params">(<span class="meta">@RequestBody</span> $!&#123;tableInfo.name&#125; $!tool.firstLowerCase($tableInfo.name)</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> R.ok().setData(<span class="built_in">this</span>.$!&#123;tool.firstLowerCase($tableInfo.name)&#125;Service.updateById($!tool.firstLowerCase($tableInfo.name)));&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 单条/批量删除数据</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@DeleteMapping</span></span><br><span class="line"><span class="keyword">public</span> R <span class="title function_">delete</span><span class="params">(<span class="meta">@RequestParam</span> List&lt;Long&gt; id)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> R.ok().setData(<span class="built_in">this</span>.$!&#123;tool.firstLowerCase($tableInfo.name)&#125;Service.removeByIds(id));&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>r.java.vm</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">$!&#123;define.vm&#125;</span><br><span class="line">#set($author = <span class="string">&quot;SerMs&quot;</span>)</span><br><span class="line"></span><br><span class="line">#save(<span class="string">&quot;/util&quot;</span>, <span class="string">&quot;R.java&quot;</span>)</span><br><span class="line"></span><br><span class="line">#setPackageSuffix(<span class="string">&quot;util&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 统一返回对象R</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> $!author</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> $!time.currTime()</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">R</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> code;</span><br><span class="line">    <span class="keyword">private</span> String message;</span><br><span class="line">    <span class="keyword">private</span> Object data;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 设置数据</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> data 数据</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> R</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> R <span class="title function_">setData</span><span class="params">(Object data)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.data = data;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 操作成功</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> R</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> R <span class="title function_">ok</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">R</span> <span class="variable">r</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">R</span>();</span><br><span class="line">        r.code = <span class="number">200</span>;</span><br><span class="line">        r.message = <span class="string">&quot;OK&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> r;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 操作失败</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> R</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> R <span class="title function_">fail</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">R</span> <span class="variable">r</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">R</span>();</span><br><span class="line">        r.code = <span class="number">205</span>;</span><br><span class="line">        r.message = <span class="string">&quot;fail&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> r;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 系统异常</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> R <span class="title function_">exp</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">R</span> <span class="variable">r</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">R</span>();</span><br><span class="line">        r.code = <span class="number">500</span>;</span><br><span class="line">        r.message = <span class="string">&quot;exception&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> r;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="interceptor351javavm"><a class="markdownIt-Anchor" href="#interceptor351javavm"></a> interceptor3.5.1.java.vm</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">$!&#123;define.vm&#125;</span><br><span class="line">#set($author = <span class="string">&quot;SerMs&quot;</span>)</span><br><span class="line"></span><br><span class="line">#save(<span class="string">&quot;/interceptor&quot;</span>, <span class="string">&quot;MybatisPlusPageInterceptor.java&quot;</span>)</span><br><span class="line"></span><br><span class="line">#setPackageSuffix(<span class="string">&quot;interceptor&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.plugins.MybatisPlusInterceptor;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.plugins.inner.PaginationInnerInterceptor;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * MyBatis-Plus 3.5.1 拦截器</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> $!author</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> $!time.currTime()</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MybatisPlusPageInterceptor</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 新版分页插件设置</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> MybatisPlusInterceptor <span class="title function_">getPaginationInnerInterceptor</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">MybatisPlusInterceptor</span> <span class="variable">interceptor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MybatisPlusInterceptor</span>();</span><br><span class="line">        interceptor.addInnerInterceptor(<span class="keyword">new</span> <span class="title class_">PaginationInnerInterceptor</span>());</span><br><span class="line">        <span class="keyword">return</span> interceptor;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="handler351javavm"><a class="markdownIt-Anchor" href="#handler351javavm"></a> handler3.5.1.java.vm</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">$!&#123;define.vm&#125;</span><br><span class="line">#set($author = <span class="string">&quot;SerMs&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#save(<span class="string">&quot;/handler&quot;</span>,<span class="string">&quot;MyMetaObjectHandler.java&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#setPackageSuffix(<span class="string">&quot;handler&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.core.handlers.MetaObjectHandler;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.reflection.MetaObject;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * MyBatis-Plus 3.5.1 处理器</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> $!author</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> $!time.currTime()</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyMetaObjectHandler</span> <span class="keyword">implements</span> <span class="title class_">MetaObjectHandler</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 插入时的填充策略</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> metaObject</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">insertFill</span><span class="params">(MetaObject metaObject)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.setFieldValByName(<span class="string">&quot;createTime&quot;</span> , <span class="keyword">new</span> <span class="title class_">Date</span>(), metaObject);</span><br><span class="line">        <span class="built_in">this</span>.setFieldValByName(<span class="string">&quot;updateTime&quot;</span> , <span class="keyword">new</span> <span class="title class_">Date</span>(), metaObject);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 更新时的填充策略</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> metaObject</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">updateFill</span><span class="params">(MetaObject metaObject)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.setFieldValByName(<span class="string">&quot;updateTime&quot;</span> , <span class="keyword">new</span> <span class="title class_">Date</span>(), metaObject);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>application.yaml.vm</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">##设置保存名称与保存位置</span><br><span class="line">$!callback.setFileName(<span class="string">&quot;application.yaml&quot;</span>)</span><br><span class="line">$!callback.setSavePath($tool.append($modulePath, <span class="string">&quot;/src/main/resources&quot;</span>))</span><br><span class="line">spring:</span><br><span class="line">  datasource:</span><br><span class="line">    url: jdbc:mysql:<span class="comment">//localhost:3306/XXXX?allowPublicKeyRetrieval=true&amp;serverTimezone=GMT%2B8&amp;characterEncoding=utf-8&amp;useSSL=false</span></span><br><span class="line">    username: root</span><br><span class="line">    password: <span class="number">123456</span></span><br><span class="line">    type: com.alibaba.druid.pool.DruidDataSource</span><br><span class="line">    druid:</span><br><span class="line">      # 下面为连接池的补充设置，应用到上面所有数据源中</span><br><span class="line">      # 初始化大小，最小，最大</span><br><span class="line">      initial-size: <span class="number">5</span></span><br><span class="line">      min-idle: <span class="number">5</span></span><br><span class="line">      max-active: <span class="number">20</span></span><br><span class="line">      # 配置获取连接等待超时的时间</span><br><span class="line">      max-wait: <span class="number">60000</span></span><br><span class="line">      # 配置间隔多久才进行一次检测，检测需要关闭的空闲连接，单位是毫秒</span><br><span class="line">      time-between-eviction-runs-millis: <span class="number">60000</span></span><br><span class="line">      # 配置一个连接在池中最小生存的时间，单位是毫秒</span><br><span class="line">      min-evictable-idle-time-millis: <span class="number">300000</span></span><br><span class="line"></span><br><span class="line">#配置日志，我们所用的sql现在是不可见的，我们希望知道他是怎么执行的，所以我们必须要查看日志！</span><br><span class="line">mybatis-plus:</span><br><span class="line">  global-config:</span><br><span class="line">    db-config:</span><br><span class="line">      logic-delete-field: deleted # 全局逻辑删除的实体字段名(since <span class="number">3.3</span><span class="number">.0</span>,配置后可以忽略不配置步骤<span class="number">2</span>)</span><br><span class="line">      logic-delete-value: <span class="number">1</span> # 逻辑已删除值(默认为 <span class="number">1</span>)</span><br><span class="line">      logic-not-delete-value: <span class="number">0</span> # 逻辑未删除值(默认为 <span class="number">0</span>)</span><br><span class="line">  configuration:</span><br><span class="line">    log-impl: org.apache.ibatis.logging.stdout.StdOutImpl</span><br></pre></td></tr></table></figure><p>添加完后点击应用</p><h3 id="一键生成"><a class="markdownIt-Anchor" href="#一键生成"></a> 一键生成</h3><p>选择<code>数据库表</code>右击选择<code>EasyCode</code>选择第一个</p><p>注意看,目前可以看到我项目左右目录里面并没有什么代码~</p><p><img src="https://unpkg.com/serms-assets@1.0.23/imgs/image-20220504093031339.png" alt="" /></p><p>选择项目工程模块,选择模块对应的包,选择你创建好的组名</p><p>选择单表,选择单表,第一次使用模板不要多表!!!</p><p>单表构建全选所有配置,侧面按照我选的来选就行,下面我会讲解,因为这里有 Bug</p><p><img src="https://unpkg.com/serms-assets@1.0.23/imgs/image-20220504093152583.png" alt="" /></p><p>点击确定之后可以看到我左侧项目目录代码已经生成完毕了~</p><p>接下来如果你想多表创建就可以这样选择,不需要在选择<span class='p blue'>applicationYAML&interceptor类&R类&handler配置类</span>了</p><p><img src="https://unpkg.com/serms-assets@1.0.23/imgs/image-20220504094428113.png" alt="" /></p><h3 id="配置"><a class="markdownIt-Anchor" href="#配置"></a> 配置</h3><p>因为本人技术有限,有些地方还是会有一点小 Bug</p><p>如下图所示:在生成的文件里面会发现有 handler 处理类 interceptor 拦截器 util 工具类都相应的爆红了~</p><p><img src="https://unpkg.com/serms-assets@1.0.23/imgs/image-20220504094957874.png" alt="" /></p><p>不要慌,这里的原因很简单,解决方案也就更很简单了</p><p>把文件名修改更 class 类名一直就欧克了</p><p>然后修改 applicationYml 文件,把你数据库名修改一下,账号密码修改一下,就可以跑了~</p><p><img src="https://unpkg.com/serms-assets@1.0.23/imgs/image-20220504095443091.png" alt="" /></p><h3 id="去-man-访问一下~"><a class="markdownIt-Anchor" href="#去-man-访问一下~"></a> 去 man 访问一下~</h3><p>分页查询一下 200OK 没问题,</p><p><img src="https://unpkg.com/serms-assets@1.0.23/imgs/image-20220504095959606.png" alt="" /></p><p>其余的自己测试,这里就不多做阐述了~</p><div class="tip warning"><p>注意:Bug!!!</p><p>在项目第一次使用模板的时候建议先单表生成,因为<span class='p blue'>applicationYAML&amp;interceptor类&amp;R类&amp;handler配置类</span>都只需生成一次,如果你多表一次性全部全选,就会创建多个<span class='p blue'>applicationYAML&amp;interceptor类&amp;R类&amp;handler配置类</span>,到时候出事就别说我没提醒~</p><p>如有更好的建议,可以在下面留言反馈~</p></div>]]></content>
      
      
      <categories>
          
          <category> Spring </category>
          
          <category> 插件 </category>
          
          <category> EasyCode代码模板生成 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SpringBoot代码模板 </tag>
            
            <tag> MybatisPlus代码模板 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>回溯经典问题</title>
      <link href="/posts/bcbdb63a/"/>
      <url>/posts/bcbdb63a/</url>
      
        <content type="html"><![CDATA[<h2 id="递归的概念"><a class="markdownIt-Anchor" href="#递归的概念"></a> 递归的概念</h2><p>简单的说：递归就是方法<span class='p red'>调用自己</span>,每次调用<span class='p red'>传入不同的变量</span>。递归有助于编程者解决复杂的问题，同时可以让代码变得简洁</p><hr /><h2 id="两个案列说明递归的调用机制"><a class="markdownIt-Anchor" href="#两个案列说明递归的调用机制"></a> 两个案列说明递归的调用机制</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo1</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        test(<span class="number">4</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">(<span class="type">int</span> n)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(n&gt;<span class="number">2</span>)&#123;</span><br><span class="line">            test(n-<span class="number">1</span>);</span><br><span class="line">        &#125;<span class="comment">//else&#123;加上else输出结果又是怎么样呢！</span></span><br><span class="line">        System.out.println(<span class="string">&quot;n=&quot;</span>+n);</span><br><span class="line">        <span class="comment">//&#125;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>建议先自己分析一下这个运行结果是啥！</p><p>然后在idea里面编译运行看一下结果，是不是和你想的一样。</p><p>递归调用的规则：</p><p>1.当程序执行到一个方法时，就会开辟一个独立的空间(栈 )</p><p>2.就像上面的案例，当执行test(4)时，因为n&gt;2,所以开始执行test(3)，注意此时test(4)是未执行完的，直到test(2),test(3)完毕出栈之后，最后才是test(4)</p><p>3.每个空间的数据（局部变量，是独立的）</p><p>再来一个例子</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//阶乘问题</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Demo2</span>&#123;</span><br><span class="line">    puclic <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>&#123;</span><br><span class="line">        System.out.println(fun(<span class="number">4</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">fun</span><span class="params">(<span class="type">int</span> n)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(n==<span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> n*fun(n-<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr /><h2 id="递归需要遵守的重要规则"><a class="markdownIt-Anchor" href="#递归需要遵守的重要规则"></a> 递归需要遵守的重要规则</h2><p>1）执行一个方法时，就创建一个新的受保护的独立空间（栈空间）</p><p>2）方法的局部变量时独立的，不会相互影响</p><p>3）如果方法中应用的是引用类型的变量（比如数组），就会共享该引用类型的数据</p><p>3）递归必须向退出递归的条件逼近，否则就是无限递归，死龟！</p><p>4）当一个方法执行完毕，或者遇到return，就会返回，遵守谁调用，就将结果返回给谁，同时当方法执行完毕或者返回时，该方法也就执行完毕。</p><h2 id="经典迷宫问题"><a class="markdownIt-Anchor" href="#经典迷宫问题"></a> 经典迷宫问题</h2><span class='p center small'>问题：小球从坐标位置为（1，1）的空白位置移动到（6，5）的最短路径怎么用回溯的思想求出来（注：左上角的坐标是(0，0))</span><p><img src="https://img-blog.csdnimg.cn/20210513162036833.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjMyNDE0,size_16,color_FFFFFF,t_70" alt="" /></p><p>提示：</p><ul><li>小球得到的路径，和程序员设置的找路策略有关即:找路的上下左右的顺序相关</li><li>在得到小球路径时，可以先使用(下右上左)，再改成(上右下左)，看看路径是不是有变化</li><li>测试回潮现象</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> SerMs</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2022/4/27 19:52</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MiGong</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">//先创建一个二维数组,模拟迷宫</span></span><br><span class="line">        <span class="comment">//地图</span></span><br><span class="line">        <span class="type">int</span>[][] map = <span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">8</span>][<span class="number">7</span>];</span><br><span class="line">        <span class="comment">//使用1表示墙</span></span><br><span class="line">        <span class="comment">//上下全部置为1</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">7</span>; i++) &#123;</span><br><span class="line">            map[<span class="number">0</span>][i] = <span class="number">1</span>;</span><br><span class="line">            map[<span class="number">7</span>][i] = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//左右全部置为1</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">8</span>; i++) &#123;</span><br><span class="line">            map[i][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">            map[i][<span class="number">6</span>] = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//设置挡板,1表示</span></span><br><span class="line">        map[<span class="number">3</span>][<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">        map[<span class="number">3</span>][<span class="number">2</span>] = <span class="number">1</span>;</span><br><span class="line">        map[<span class="number">1</span>][<span class="number">2</span>] = <span class="number">1</span>;</span><br><span class="line">        map[<span class="number">2</span>][<span class="number">2</span>] = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//输出地图</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">8</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; <span class="number">7</span>; j++) &#123;</span><br><span class="line">                System.out.print(map[i][j] + <span class="string">&quot;  &quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//使用递归回溯给小球找路</span></span><br><span class="line">        setWay(map, <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">        <span class="comment">//输出新的地图,小球走过,并标识过的递归</span></span><br><span class="line">        System.out.println(<span class="string">&quot;输出新的地图,小球走过,并标识过的递归&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">8</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; <span class="number">7</span>; j++) &#123;</span><br><span class="line">                System.out.print(map[i][j] + <span class="string">&quot;  &quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//使用递归回溯来给小球找路</span></span><br><span class="line">    <span class="comment">//1. map表示地图</span></span><br><span class="line">    <span class="comment">//2. i,j表示从地图的哪个位置开始出发(1,1)</span></span><br><span class="line">    <span class="comment">//3. 如果小球能到map[6][5]位置,则说明通路找到</span></span><br><span class="line">    <span class="comment">//4. 约定,当map[i][j] 为0表示该点没有走过,当为1表示墙,2表示通路可以走,3表示该点走过但是不通</span></span><br><span class="line">    <span class="comment">//5. 在走迷宫时,需要确定一个策略(方法) 下-&gt;右-&gt;上-&gt;左,如果该点走不通,在回溯</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 说明</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> map 表示地图</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> i   从哪个位置开始找路</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> j</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 如果找到通路, 就返回treu, 否则返回false</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">setWay</span><span class="params">(<span class="type">int</span>[][] map, <span class="type">int</span> i, <span class="type">int</span> j)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (map[<span class="number">6</span>][<span class="number">5</span>] == <span class="number">2</span>) &#123;    <span class="comment">//通路已找到欧克</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (map[i][j] == <span class="number">0</span>) &#123;    <span class="comment">//如果当前这个点还没有走过</span></span><br><span class="line">                <span class="comment">//按照策略  下-&gt;右-&gt;上-&gt;左,如果该点走不通,在回溯</span></span><br><span class="line">                map[i][j] = <span class="number">2</span>;  <span class="comment">//假定该点时可以走通</span></span><br><span class="line">                <span class="keyword">if</span> (setWay(map, i + <span class="number">1</span>, j)) &#123;  <span class="comment">//向下走</span></span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (setWay(map, i, j + <span class="number">1</span>)) &#123;    <span class="comment">//向右走</span></span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (setWay(map, i - <span class="number">1</span>, j)) &#123;   <span class="comment">//向上走</span></span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (setWay(map, i, j - <span class="number">1</span>)) &#123;  <span class="comment">//向左走</span></span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="comment">//说明该点是走不通,是死路</span></span><br><span class="line">                    map[i][j] = <span class="number">3</span>;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123; <span class="comment">//如果map[i][j] !=0,可能是1,2,3</span></span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 数据结构 </category>
          
          <category> 递归 </category>
          
          <category> 算法 </category>
          
          <category> 回溯 </category>
          
          <category> 算法面试题 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数据结构 </tag>
            
            <tag> 算法 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>哔哔图片问题</title>
      <link href="/posts/f605ecd9/"/>
      <url>/posts/f605ecd9/</url>
      
        <content type="html"><![CDATA[<div class="tip home"><p>本文根据洪哥哔哔教程二改~解决哔哔发送图片问题</p></div><table><thead><tr><th style="text-align:center">相关教程</th><th style="text-align:center">教程地址</th></tr></thead><tbody><tr><td style="text-align:center">洪哥哔哔教程</td><td style="text-align:center"><div class="tag link"><a class="link-card" title="洪哥哔哔教程" href="https://blog.zhheo.com/p/a6947667.html"><div class="left"><img src="https://unpkg.com/akilar-friends@latest/avatar/blog.zhheo.com.jpg"/></div><div class="right"><p class="text">洪哥哔哔教程</p><p class="url">https://blog.zhheo.com/p/a6947667.html</p></div></a></div></td></tr><tr><td style="text-align:center">「哔哔点啥」微信公众号</td><td style="text-align:center"><a href="https://immmmm.com/bb-by-wechat-pro/">「哔哔点啥」微信公众号 2.0</a></td></tr></tbody></table><details class="folding-tag" yellow><summary> 问题说明 </summary>              <div class='content'>              <p><img src="https://unpkg.com/serms-assets@1.0.21/bufferfly/image-20220419142846050.png" alt="" /></p><p><img src="https://unpkg.com/serms-assets@1.0.21/bufferfly/image-20220419142902156.png" alt="" /></p><p><img src="https://unpkg.com/serms-assets@1.0.21/bufferfly/image-20220419142911862.png" alt="" /></p><div class="tip "><p>可以看到问题很明显</p><ol><li>图片大小</li><li>图片上下有多余得代码(洪哥 js 得问题)</li><li>无法预览</li></ol></div>              </div>            </details><h2 id="修改步骤"><a class="markdownIt-Anchor" href="#修改步骤"></a> 修改步骤</h2><div class="tabs" id="test1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#test1-1">源码修改方式</button></li><li class="tab"><button type="button" data-href="#test1-2">cdn链接替换(推荐)</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="test1-1"><p><img src="https://unpkg.com/serms-assets@1.0.21/bufferfly/image-20220419145803095.png" alt="" /></p><p>将洪哥 heobbe.js 文件拉取到博客存放 js 得目录下</p><p>修改其中得<code>urlToLink</code>方法</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">urlToLink</span>(<span class="params">str</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;判断是否是图片&quot;</span>, str.<span class="title function_">indexOf</span>(<span class="string">&quot;http&quot;</span>));</span><br><span class="line">  <span class="keyword">if</span> (str.<span class="title function_">indexOf</span>(<span class="string">&quot;http&quot;</span>) != -<span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> re_forpic =</span><br><span class="line">      <span class="regexp">/\bhttps?:[^:&lt;&gt;&quot;]*\/([^:&lt;&gt;&quot;]*)(\.(jpeg)|(png)|(jpg)|(webp))(!blogimg)?/g</span>;</span><br><span class="line">    <span class="keyword">var</span> a1;</span><br><span class="line">    <span class="keyword">var</span> a2;</span><br><span class="line">    str.<span class="title function_">replace</span>(re_forpic, <span class="keyword">function</span> (<span class="params">imgurl</span>) &#123;</span><br><span class="line">      a1 =</span><br><span class="line">        <span class="string">&quot;&lt;a href=&quot;</span> +</span><br><span class="line">        imgurl +</span><br><span class="line">        <span class="string">&quot; data-fancybox=&#x27;gallery&#x27; data-caption=&#x27;&#x27; data-thumb=&quot;</span> +</span><br><span class="line">        imgurl +</span><br><span class="line">        <span class="string">&quot;&gt;&quot;</span>;</span><br><span class="line">      a2 = <span class="string">&quot;&lt;img src=&quot;</span> + imgurl + <span class="string">&quot;&gt;&lt;/img&gt;&lt;/a&gt;&quot;</span>;</span><br><span class="line">    &#125;);</span><br><span class="line">    str = a1 + a2;</span><br><span class="line">    <span class="keyword">return</span> a1 + a2;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> re = <span class="regexp">/\bhttps?:\/\/(?!\S+(?:jpe?g|png|bmp|gif|webp|gif))\S+/g</span>;</span><br><span class="line"></span><br><span class="line">    str = str.<span class="title function_">replace</span>(re, <span class="keyword">function</span> (<span class="params">website</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> (</span><br><span class="line">        <span class="string">&quot; &lt;a href=&#x27;&quot;</span> + website + <span class="string">&quot;&#x27;rel=&#x27;noopener&#x27; target=&#x27;_blank&#x27;&gt;↘链接↙&lt;/a&gt;&quot;</span></span><br><span class="line">      );</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> str;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>修改完后全文(可直接复制这个粘贴替换 heobber.js)</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// if (document.querySelector(&#x27;#bber-loading&#x27;)) &#123;</span></span><br><span class="line"><span class="comment">//   var loading_pic = document.getElementById(&#x27;bber-loading&#x27;);</span></span><br><span class="line"><span class="comment">//   loading_pic.innerHTML = &#x27;&lt;span id=&quot;moments_loading&quot;&gt;&lt;i class=&quot;fa fa-spinner fa-spin&quot;&gt;&lt;/i&gt;&lt;/span&gt;&#x27;;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getbbdata</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> bbsurl = bbapiurl;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> httpRequest = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>(); <span class="comment">//第一步：建立所需的对象</span></span><br><span class="line">  httpRequest.<span class="title function_">open</span>(<span class="string">&quot;GET&quot;</span>, bbsurl, <span class="literal">true</span>); <span class="comment">//第二步：打开连接  将请求参数写在url中  ps:&quot;./Ptest.php?name=test&amp;nameone=testone&quot;</span></span><br><span class="line">  httpRequest.<span class="title function_">send</span>(); <span class="comment">//第三步：发送请求  将请求参数写在URL中</span></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 获取数据后的处理程序</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  httpRequest.<span class="property">onreadystatechange</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (httpRequest.<span class="property">readyState</span> == <span class="number">4</span> &amp;&amp; httpRequest.<span class="property">status</span> == <span class="number">200</span>) &#123;</span><br><span class="line">      <span class="keyword">var</span> json = httpRequest.<span class="property">responseText</span>; <span class="comment">//获取到json字符串，还需解析</span></span><br><span class="line">      <span class="keyword">var</span> obj = <span class="built_in">eval</span>(<span class="string">&quot;(&quot;</span> + json + <span class="string">&quot;)&quot;</span>);</span><br><span class="line">      <span class="comment">// console.log(obj.data)</span></span><br><span class="line">      <span class="keyword">const</span> bbArray = obj.<span class="property">data</span>.<span class="title function_">map</span>(<span class="function"><span class="params">e</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">          <span class="attr">date</span>: e.<span class="property">date</span>,</span><br><span class="line">          <span class="attr">content</span>: e.<span class="property">content</span>,</span><br><span class="line">          <span class="attr">from</span>: e.<span class="property">from</span>,</span><br><span class="line">        &#125;;</span><br><span class="line">      &#125;);</span><br><span class="line">      <span class="comment">// console.log(fundsArray)</span></span><br><span class="line">      saveToLocal.<span class="title function_">set</span>(<span class="string">&quot;zhheo-bb&quot;</span>, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(bbArray), <span class="number">5</span> / (<span class="number">60</span> * <span class="number">24</span>));</span><br><span class="line">      <span class="keyword">const</span> data = saveToLocal.<span class="title function_">get</span>(<span class="string">&quot;zhheo-bb&quot;</span>);</span><br><span class="line">      <span class="title function_">generateBBHtml</span>(<span class="title class_">JSON</span>.<span class="title function_">parse</span>(data));</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> <span class="title function_">generateBBHtml</span> = array =&gt; &#123;</span><br><span class="line">  <span class="keyword">var</span> $dom = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#bber&quot;</span>);</span><br><span class="line">  <span class="keyword">var</span> result = <span class="string">&#x27;&lt;section class=&quot;timeline page-1&quot;&gt;&lt;ul&gt;&lt;div class=&quot;list&quot;&gt;&#x27;</span>;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(array);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (array.<span class="property">length</span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; array.<span class="property">length</span>; i++) &#123;</span><br><span class="line">      <span class="keyword">var</span> from_icon = <span class="string">&quot;&quot;</span>;</span><br><span class="line">      <span class="keyword">if</span> (array[i].<span class="property">from</span>.<span class="title function_">indexOf</span>(<span class="string">&quot;iPhone&quot;</span>) != -<span class="number">1</span>) &#123;</span><br><span class="line">        from_icon = <span class="string">&#x27;&lt;i class=&quot;fas fa-mobile-alt&quot;&gt;&lt;/i&gt;&#x27;</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (array[i].<span class="property">from</span>.<span class="title function_">indexOf</span>(<span class="string">&quot;iPad&quot;</span>) != -<span class="number">1</span>) &#123;</span><br><span class="line">        from_icon = <span class="string">&#x27;&lt;i class=&quot;fas fa-tablet-alt&quot;&gt;&lt;/i&gt;&#x27;</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (array[i].<span class="property">from</span>.<span class="title function_">indexOf</span>(<span class="string">&quot;Mac&quot;</span>) != -<span class="number">1</span>) &#123;</span><br><span class="line">        from_icon = <span class="string">&#x27;&lt;i class=&quot;fas fa-laptop&quot;&gt;&lt;/i&gt;&#x27;</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (array[i].<span class="property">from</span>.<span class="title function_">indexOf</span>(<span class="string">&quot;微信&quot;</span>) != -<span class="number">1</span>) &#123;</span><br><span class="line">        from_icon = <span class="string">&#x27;&lt;i class=&quot;fab fa-weixin&quot; style=&quot;font-size: 0.6rem&quot;&gt;&lt;/i&gt;&#x27;</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        from_icon = <span class="string">&#x27;&lt;i class=&quot;fas fa-tools&quot;&gt;&lt;/i&gt;&#x27;</span>;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">var</span> d = <span class="keyword">new</span> <span class="title class_">Date</span>(array[i].<span class="property">date</span>);</span><br><span class="line">      <span class="keyword">var</span> dtime = array[i].<span class="property">date</span>,</span><br><span class="line">        data =</span><br><span class="line">          d.<span class="title function_">getFullYear</span>() +</span><br><span class="line">          <span class="string">&quot;/&quot;</span> +</span><br><span class="line">          (d.<span class="title function_">getMonth</span>() + <span class="number">1</span>) +</span><br><span class="line">          <span class="string">&quot;/&quot;</span> +</span><br><span class="line">          d.<span class="title function_">getDate</span>() +</span><br><span class="line">          <span class="string">&quot; &quot;</span> +</span><br><span class="line">          d.<span class="title function_">getHours</span>() +</span><br><span class="line">          <span class="string">&quot;:&quot;</span> +</span><br><span class="line">          d.<span class="title function_">getMinutes</span>() +</span><br><span class="line">          <span class="string">&quot;:&quot;</span> +</span><br><span class="line">          d.<span class="title function_">getSeconds</span>();</span><br><span class="line">      <span class="keyword">var</span> dataCont =</span><br><span class="line">        <span class="string">&#x27;&lt;p class=&quot;datacont&quot;&gt;&#x27;</span> + <span class="title function_">urlToLink</span>(array[i].<span class="property">content</span>) + <span class="string">&quot;&lt;/p&gt;&quot;</span>;</span><br><span class="line">      <span class="keyword">var</span> dataTime = <span class="string">&#x27;&lt;p class=&quot;datatime&quot;&gt;&#x27;</span> + data + <span class="string">&quot;&lt;/p&gt;&quot;</span>;</span><br><span class="line"></span><br><span class="line">      result +=</span><br><span class="line">        <span class="string">`&lt;li class=&quot;item&quot;&gt;&lt;div&gt;`</span> +</span><br><span class="line">        dataTime +</span><br><span class="line">        dataCont +</span><br><span class="line">        <span class="string">`&lt;/p&gt;&lt;p class=&quot;datafrom&quot;&gt;&lt;small&gt;`</span> +</span><br><span class="line">        from_icon +</span><br><span class="line">        array[i].<span class="property">from</span> +</span><br><span class="line">        <span class="string">`&lt;/small&gt;&lt;/p&gt;&lt;/div&gt;&lt;/li&gt;`</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    result += <span class="string">&#x27;!&#123;_p(&quot;aside.card_funds.zero&quot;)&#125;&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  result += <span class="string">&quot;&lt;/div&gt;&lt;/ul&gt;&lt;/section&gt;&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> $dom = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#bber&quot;</span>);</span><br><span class="line"></span><br><span class="line">  $dom.<span class="property">innerHTML</span> = result;</span><br><span class="line">  <span class="title class_">Lately</span>(&#123;</span><br><span class="line">    <span class="attr">target</span>: <span class="string">&quot;#bber .datatime&quot;</span>,</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="variable language_">window</span>.<span class="property">lazyLoadInstance</span> &amp;&amp; <span class="variable language_">window</span>.<span class="property">lazyLoadInstance</span>.<span class="title function_">update</span>();</span><br><span class="line">  <span class="variable language_">window</span>.<span class="property">pjax</span> &amp;&amp; <span class="variable language_">window</span>.<span class="property">pjax</span>.<span class="title function_">refresh</span>($dom);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#bber&quot;</span>)) &#123;</span><br><span class="line">  <span class="title function_">getbbdata</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">urlToLink</span>(<span class="params">str</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;判断是否是图片&quot;</span>, str.<span class="title function_">indexOf</span>(<span class="string">&quot;http&quot;</span>));</span><br><span class="line">  <span class="keyword">if</span> (str.<span class="title function_">indexOf</span>(<span class="string">&quot;http&quot;</span>) != -<span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> re_forpic =</span><br><span class="line">      <span class="regexp">/\bhttps?:[^:&lt;&gt;&quot;]*\/([^:&lt;&gt;&quot;]*)(\.(jpeg)|(png)|(jpg)|(webp))(!blogimg)?/g</span>;</span><br><span class="line">    <span class="keyword">var</span> a1;</span><br><span class="line">    <span class="keyword">var</span> a2;</span><br><span class="line">    str.<span class="title function_">replace</span>(re_forpic, <span class="keyword">function</span> (<span class="params">imgurl</span>) &#123;</span><br><span class="line">      a1 =</span><br><span class="line">        <span class="string">&quot;&lt;a href=&quot;</span> +</span><br><span class="line">        imgurl +</span><br><span class="line">        <span class="string">&quot; data-fancybox=&#x27;gallery&#x27; data-caption=&#x27;&#x27; data-thumb=&quot;</span> +</span><br><span class="line">        imgurl +</span><br><span class="line">        <span class="string">&quot;&gt;&quot;</span>;</span><br><span class="line">      a2 = <span class="string">&quot;&lt;img src=&quot;</span> + imgurl + <span class="string">&quot;&gt;&lt;/img&gt;&lt;/a&gt;&quot;</span>;</span><br><span class="line">    &#125;);</span><br><span class="line">    str = a1 + a2;</span><br><span class="line">    <span class="keyword">return</span> a1 + a2;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> re = <span class="regexp">/\bhttps?:\/\/(?!\S+(?:jpe?g|png|bmp|gif|webp|gif))\S+/g</span>;</span><br><span class="line"></span><br><span class="line">    str = str.<span class="title function_">replace</span>(re, <span class="keyword">function</span> (<span class="params">website</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> (</span><br><span class="line">        <span class="string">&quot; &lt;a href=&#x27;&quot;</span> + website + <span class="string">&quot;&#x27;rel=&#x27;noopener&#x27; target=&#x27;_blank&#x27;&gt;↘链接↙&lt;/a&gt;&quot;</span></span><br><span class="line">      );</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> str;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">MIT License - http://www.opensource.org/licenses/mit-license.php</span></span><br><span class="line"><span class="comment">For usage and examples, visit:</span></span><br><span class="line"><span class="comment">https://tokinx.github.io/lately/</span></span><br><span class="line"><span class="comment">Copyright (c) 2017, Biji.IO</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">var</span> $jscomp = $jscomp || &#123;&#125;;</span><br><span class="line">$jscomp.<span class="property">scope</span> = &#123;&#125;;</span><br><span class="line">$jscomp.<span class="property">arrayIteratorImpl</span> = <span class="keyword">function</span> (<span class="params">b</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> g = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> g &lt; b.<span class="property">length</span></span><br><span class="line">      ? &#123;</span><br><span class="line">          <span class="attr">done</span>: !<span class="number">1</span>,</span><br><span class="line">          <span class="attr">value</span>: b[g++],</span><br><span class="line">        &#125;</span><br><span class="line">      : &#123;</span><br><span class="line">          <span class="attr">done</span>: !<span class="number">0</span>,</span><br><span class="line">        &#125;;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br><span class="line">$jscomp.<span class="property">arrayIterator</span> = <span class="keyword">function</span> (<span class="params">b</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">next</span>: $jscomp.<span class="title function_">arrayIteratorImpl</span>(b),</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br><span class="line">$jscomp.<span class="property">makeIterator</span> = <span class="keyword">function</span> (<span class="params">b</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> g = <span class="string">&quot;undefined&quot;</span> != <span class="keyword">typeof</span> <span class="title class_">Symbol</span> &amp;&amp; <span class="title class_">Symbol</span>.<span class="property">iterator</span> &amp;&amp; b[<span class="title class_">Symbol</span>.<span class="property">iterator</span>];</span><br><span class="line">  <span class="keyword">return</span> g ? g.<span class="title function_">call</span>(b) : $jscomp.<span class="title function_">arrayIterator</span>(b);</span><br><span class="line">&#125;;</span><br><span class="line">(<span class="keyword">function</span> (<span class="params">b, g</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> p = <span class="keyword">function</span> (<span class="params">h</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> d = h.<span class="property">lang</span> || &#123;</span><br><span class="line">      <span class="attr">second</span>: <span class="string">&quot;\u79d2&quot;</span>,</span><br><span class="line">      <span class="attr">minute</span>: <span class="string">&quot;\u5206\u949f&quot;</span>,</span><br><span class="line">      <span class="attr">hour</span>: <span class="string">&quot;\u5c0f\u65f6&quot;</span>,</span><br><span class="line">      <span class="attr">day</span>: <span class="string">&quot;\u5929&quot;</span>,</span><br><span class="line">      <span class="attr">month</span>: <span class="string">&quot;\u4e2a\u6708&quot;</span>,</span><br><span class="line">      <span class="attr">year</span>: <span class="string">&quot;\u5e74&quot;</span>,</span><br><span class="line">      <span class="attr">ago</span>: <span class="string">&quot;\u524d&quot;</span>,</span><br><span class="line">      <span class="attr">error</span>: <span class="string">&quot;NaN&quot;</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">    h = $jscomp.<span class="title function_">makeIterator</span>(<span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(h.<span class="property">target</span> || <span class="string">&quot;.time&quot;</span>));</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> c = h.<span class="title function_">next</span>(); !c.<span class="property">done</span>; c = h.<span class="title function_">next</span>()) &#123;</span><br><span class="line">      c = c.<span class="property">value</span>;</span><br><span class="line">      <span class="keyword">var</span> a = c.<span class="property">dateTime</span>;</span><br><span class="line">      <span class="keyword">var</span> e = c.<span class="property">title</span>,</span><br><span class="line">        f = c.<span class="property">innerHTML</span>;</span><br><span class="line">      <span class="keyword">if</span> (</span><br><span class="line">        !a ||</span><br><span class="line">        <span class="built_in">isNaN</span>(</span><br><span class="line">          <span class="keyword">new</span> <span class="title class_">Date</span>(</span><br><span class="line">            (a = a.<span class="title function_">replace</span>(<span class="regexp">/(.*)[a-z](.*)\+(.*)/gi</span>, <span class="string">&quot;$1 $2&quot;</span>).<span class="title function_">replace</span>(<span class="regexp">/-/g</span>, <span class="string">&quot;/&quot;</span>))</span><br><span class="line">          )</span><br><span class="line">        )</span><br><span class="line">      )</span><br><span class="line">        <span class="keyword">if</span> (e &amp;&amp; !<span class="built_in">isNaN</span>(<span class="keyword">new</span> <span class="title class_">Date</span>((e = e.<span class="title function_">replace</span>(<span class="regexp">/-/g</span>, <span class="string">&quot;/&quot;</span>))))) a = e;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (f &amp;&amp; !<span class="built_in">isNaN</span>(<span class="keyword">new</span> <span class="title class_">Date</span>((f = f.<span class="title function_">replace</span>(<span class="regexp">/-/g</span>, <span class="string">&quot;/&quot;</span>))))) a = f;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">break</span>;</span><br><span class="line">      c.<span class="property">title</span> = a;</span><br><span class="line">      a = <span class="keyword">new</span> <span class="title class_">Date</span>(a);</span><br><span class="line">      a = (<span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getTime</span>() - a.<span class="title function_">getTime</span>()) / <span class="number">1e3</span>;</span><br><span class="line">      e = a / <span class="number">60</span>;</span><br><span class="line">      f = e / <span class="number">60</span>;</span><br><span class="line">      <span class="keyword">var</span> k = f / <span class="number">24</span>,</span><br><span class="line">        l = k / <span class="number">30</span>,</span><br><span class="line">        m = l / <span class="number">12</span>;</span><br><span class="line">      c.<span class="property">innerHTML</span> =</span><br><span class="line">        (<span class="number">1</span> &lt;= m</span><br><span class="line">          ? <span class="title class_">Math</span>.<span class="title function_">floor</span>(m) + d.<span class="property">year</span></span><br><span class="line">          : <span class="number">1</span> &lt;= l</span><br><span class="line">          ? <span class="title class_">Math</span>.<span class="title function_">floor</span>(l) + d.<span class="property">month</span></span><br><span class="line">          : <span class="number">1</span> &lt;= k</span><br><span class="line">          ? <span class="title class_">Math</span>.<span class="title function_">floor</span>(k) + d.<span class="property">day</span></span><br><span class="line">          : <span class="number">1</span> &lt;= f</span><br><span class="line">          ? <span class="title class_">Math</span>.<span class="title function_">floor</span>(f) + d.<span class="property">hour</span></span><br><span class="line">          : <span class="number">1</span> &lt;= e</span><br><span class="line">          ? <span class="title class_">Math</span>.<span class="title function_">floor</span>(e) + d.<span class="property">minute</span></span><br><span class="line">          : <span class="number">1</span> &lt;= a</span><br><span class="line">          ? <span class="title class_">Math</span>.<span class="title function_">floor</span>(a) + d.<span class="property">second</span></span><br><span class="line">          : d.<span class="property">error</span>) + d.<span class="property">ago</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">var</span> n = (<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span> || (<span class="number">0</span>, <span class="built_in">eval</span>)(<span class="string">&quot;this&quot;</span>);</span><br><span class="line">  &#125;)();</span><br><span class="line">  <span class="string">&quot;Lately&quot;</span> <span class="keyword">in</span> n || (n.<span class="property">Lately</span> = p);</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure><p>接着在 css 文件中添加:</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.datacont</span> <span class="selector-tag">img</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test1-2"><p>直接把洪哥得 heobbe.js 替换成,作者编写好得 js 链接:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">https</span>:<span class="comment">//unpkg.com/msstatic@1.0.1/js/heobber.js</span></span><br></pre></td></tr></table></figure><p>接着在 css 文件中添加:</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.datacont</span> <span class="selector-tag">img</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>]]></content>
      
      
      <categories>
          
          <category> bufferfly </category>
          
          <category> 哔哔 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> bufferfly </tag>
            
            <tag> 哔哔 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Spring的自动装配</title>
      <link href="/posts/63755f3a/"/>
      <url>/posts/63755f3a/</url>
      
        <content type="html"><![CDATA[<div class="tip home"><p>好处：大幅度减少 Spring 配置</p><p>坏处：依赖不能明确管理，可能会有多个 bean 同时符合注入规则，没有清晰的依赖关系。</p><p>在装配的时候会有两种方式，<code>byName</code>和<code>byType</code>两种。</p><p>byName：根据属性名自动装配。此选项将检查容器并根据名字查找与属性完全一致的 bean，并将其与属性自动装配。</p><p>byType：如果容器中存在一个与指定属性类型相同的 bean，那么将与该属性自动装配；如果存在多个该类型 bean，那么抛出异常，并指出不能使用 byType 方式进行自动装配；如果没有找到相匹配的 bean，则什么事都不发生，也可以通过设置</p></div><h2 id="什么是自动装配"><a class="markdownIt-Anchor" href="#什么是自动装配"></a> 什么是自动装配</h2><p>自动装配：<em>也就是 <code>Spring</code> 会在容器中自动的查找，并自动的给 <code>bean</code> 装配及其关联的属性</em></p><p>涉及到自动装配 <code>bean</code> 的<a href="https://so.csdn.net/so/search?q=%E4%BE%9D%E8%B5%96%E5%85%B3%E7%B3%BB&amp;spm=1001.2101.3001.7020">依赖关系</a>时，<code>Spring</code> 有多种处理方式。<code>Spring</code> 提供了 <code>4</code> 种自动装配策略</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">AutowireCapableBeanFactory</span> <span class="keyword">extends</span> <span class="title class_">BeanFactory</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 无需自动装配</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">AUTOWIRE_NO</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 按名称自动装配 bean 属性</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">AUTOWIRE_BY_NAME</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 按类型自动装配 bean 属性</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">AUTOWIRE_BY_TYPE</span> <span class="operator">=</span> <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 按构造器自动装配</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">AUTOWIRE_CONSTRUCTOR</span> <span class="operator">=</span> <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 过时方法，Spring3.0 之后不再支持</span></span><br><span class="line">    <span class="meta">@Deprecated</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">AUTOWIRE_AUTODETECT</span> <span class="operator">=</span> <span class="number">4</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="什么是依赖注入"><a class="markdownIt-Anchor" href="#什么是依赖注入"></a> 什么是依赖注入</h2><p>依赖注入：当一个类的实例需要另一个类的实例协助时，在传统的程序设计过程中，通常由调用者来创建被调用者的实例。然而采用依赖注入的方式，创建被调用者的工作不再由调用者来完成，创建被调用者的实例的工作由 IOC 容器来完成。然后注入调用者，称为依赖注入</p><p>控制反转：当一个类的实例需要另一个类的实例协助时，在传统的程序设计过程中，通常由调用者来创建被调用者的实例。然而采用控制反转的方式，创建被调用者的工作不再由调用者来完成，创建被调用者的实例的工作由 IOC 容器来完成。也就是把对象的创建，初始化，销毁的工作交给 spring ioc 容器来做。由 spring ioc 容器来管理对象的生命周期</p><p>依赖注入的方式有两种：构造器注入和 setter 方法注入</p><h3 id="依赖注入与自动装配的关系"><a class="markdownIt-Anchor" href="#依赖注入与自动装配的关系"></a> 依赖注入与自动装配的关系</h3><p>依赖注入的本质就是装配，装配是依赖注入的具体行为</p><p>在传统的使用 xml 文件装配 bean 是一件很繁琐的事情，而且还需要找到对应类型的 bean 才能装配，一旦 bean 很多，就不好维护了。为了解决这种问题，spring 使用注解来进行自动装配。自动装配就是开发人员不必知道具体要装配哪个 bean 的引用，这个识别的工作会由 spring 来完成。与自动装配配合的还有“自动检测”，这个动作会自动识别哪些类需要被配置成 bean，进而来进行装配</p><p>因此也可以这样理解：自动装配是为了将依赖注入“自动化”的一个简化配置的操作</p><h2 id="spring-中自动装配的策略"><a class="markdownIt-Anchor" href="#spring-中自动装配的策略"></a> <code>Spring</code> 中自动装配的策略</h2><h3 id="byname"><a class="markdownIt-Anchor" href="#byname"></a> byName</h3><p>它的意思是：把与 bean 的属性具有相同名字的其他 bean 自动装配到 bean 的对应属性中</p><p>例：在 User 的 bean 中有个属性 Role myRole，再创建一个 Role 的 bean，它的名字如果叫 myRole，那么在 User 中就可以使用 byName 来自动装配</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Role myRole;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Role</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>上面是 <code>bean</code> 的定义，再看配置文件</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;myRole&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.viewscenes.netsupervisor.entity.Role&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;id&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1001&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;管理员&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;user&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.viewscenes.netsupervisor.entity.User&quot;</span> <span class="attr">autowire</span>=<span class="string">&quot;byName&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><p>如上所述，只要属性名称和 bean 的名称可以对应，那么在 user 的 bean 中就可以使用 byName 来自动装配。那么，如果属性名称对应不上呢？</p><h3 id="bytype"><a class="markdownIt-Anchor" href="#bytype"></a> byType</h3><p>它的意思是：把与 bean 的属性具有相同类型的其他 bean 自动装配到 bean 的对应属性中</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.viewscenes.netsupervisor.entity.Role&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;id&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1001&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;管理员&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;user&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.viewscenes.netsupervisor.entity.User&quot;</span> <span class="attr">autowire</span>=<span class="string">&quot;byType&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><p>还是上面的例子，如果使用 <code>byType，Role bean</code> 的 <code>id</code> 都可以省去</p><h3 id="constructor"><a class="markdownIt-Anchor" href="#constructor"></a> constructor</h3><p>它是说：<em>把与 <code>bean</code> 的构造器入参具有相同类型的其他 <code>bean</code> 自动装配到 <code>bean</code> 构造器的对应入参中</em>。值的注意的是，具有相同类型的其他 <code>bean</code> 这句话说明它在查找入参的时候，还是通过 <code>bean</code> 的类型来确定</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Role role;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">User</span><span class="params">(Role role)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.role = role;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;user&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.viewscenes.netsupervisor.entity.User&quot;</span> <span class="attr">autowire</span>=<span class="string">&quot;constructor&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="autodetect不推荐使用了"><a class="markdownIt-Anchor" href="#autodetect不推荐使用了"></a> autodetect（不推荐使用了）</h3><p>它首先会尝试使用 <code>constructor</code> 进行自动装配，如果失败再尝试使用 <code>byType</code> 。不过，它在 <code>Spring 3.0</code> 之后已经被标记为 <code>@Deprecated</code></p><h2 id="默认的自动装配策略"><a class="markdownIt-Anchor" href="#默认的自动装配策略"></a> 默认的自动装配策略</h2><p>默认情况下，default-autowire 属性被设置为 none，标示所有的 bean 都不使用自动装配，除非 bean 上配置了 autowire 属性</p><p>如果你需要为所有的 bean 配置相同的 autowire 属性，有个办法可以简化这一操作，在根元素 beans 上增加属性</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">default-autowire</span>=<span class="string">&quot;byType&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="autowired-注解"><a class="markdownIt-Anchor" href="#autowired-注解"></a> @Autowired 注解</h2><div class="tag link"><a class="link-card" title="Autowired 注解使用" href="https://hgm.vercel.app/post/7047b0e7/"><div class="left"><img src="https://hgm.vercel.app/img/favicon.png"/></div><div class="right"><p class="text">Autowired 注解使用</p><p class="url">https://hgm.vercel.app/post/7047b0e7/</p></div></a></div><p><strong>具体的大家可以看这篇文章,这里补充一些文章没写全的内容</strong></p><p>从 <code>Spring 2.5</code> 开始，开始支持使用注解来自动装配 <code>bean</code> 的属性。它允许更细粒度的自动装配，我们可以选择性的标注某一个属性来对其应用自动装配。<code>Spring</code> 支持几种不同的应用于自动装配的注解</p><ul><li><code>Spring</code> 自带的 <code>@Autowired</code> 注解</li><li><code>JSR-330</code> 的 <code>@Inject</code> 注解</li><li><code>JSR-250</code> 的 <code>@Resource</code> 注解</li></ul><p>使用 <code>@Autowired</code> 它有几个点需要注意</p><h3 id="强制性"><a class="markdownIt-Anchor" href="#强制性"></a> 强制性</h3><p><em>默认情况下，它具有强制契约特性，其所标注的属性必须是可装配的。如果没有 <code>bean</code> 可以装配到 <code>@Autowired</code> 所标注的属性或参数中，那么你会看到 <code>NoSuchBeanDefinitionException</code> 的异常信息</em></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Object <span class="title function_">doResolveDependency</span><span class="params">(DependencyDescriptor descriptor, String beanName,</span></span><br><span class="line"><span class="params">            Set&lt;String&gt; autowiredBeanNames, TypeConverter typeConverter)</span> <span class="keyword">throws</span> BeansException &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 查找Bean</span></span><br><span class="line">    Map&lt;String, Object&gt; matchingBeans = findAutowireCandidates(beanName, type, descriptor);</span><br><span class="line">    <span class="comment">// 如果拿到的 Bean 集合为空，且 isRequired 为 true，就抛出异常</span></span><br><span class="line">    <span class="keyword">if</span> (matchingBeans.isEmpty()) &#123;</span><br><span class="line">        <span class="keyword">if</span> (descriptor.isRequired()) &#123;</span><br><span class="line">            raiseNoSuchBeanDefinitionException(type, <span class="string">&quot;&quot;</span>, descriptor);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>看到上面的源码，我们可以得到这一信息，<code>bean</code> 集合为空不要紧，关键 <code>isRequired</code> 条件不能成立，如果成立就会抛异常。那么，如果我们不确定属性是否可以装配，可以这样来使用 <code>Autowired</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired(required = false)</span></span><br><span class="line">UserService userService;</span><br></pre></td></tr></table></figure><h3 id="装配策略"><a class="markdownIt-Anchor" href="#装配策略"></a> 装配策略</h3><p>前几天看到大佬群里有个面试题是这样问的：<code>Autowired</code> 是按照什么策略来自动装配的呢？关于这个问题，不能一概而论，你不能简单的说按照类型或者按照名称。但可以确定的一点的是，它默认是按照类型来自动装配的，即 <code>byType</code></p><h4 id="默认按照类型装配"><a class="markdownIt-Anchor" href="#默认按照类型装配"></a> 默认按照类型装配</h4><p>关键点 <code>findAutowireCandidates</code> 这个方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> Map&lt;String, Object&gt; <span class="title function_">findAutowireCandidates</span><span class="params">(</span></span><br><span class="line"><span class="params">        String beanName, Class&lt;?&gt; requiredType, DependencyDescriptor descriptor)</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取给定类型的所有 bean 名称，里面实际循环所有的 beanName，获取它的实例</span></span><br><span class="line">    <span class="comment">// 再通过 isTypeMatch 方法来确定</span></span><br><span class="line">    String[] candidateNames = BeanFactoryUtils.beanNamesForTypeIncludingAncestors(</span><br><span class="line">            <span class="built_in">this</span>, requiredType, <span class="literal">true</span>, descriptor.isEager());</span><br><span class="line"></span><br><span class="line">    Map&lt;String, Object&gt; result = <span class="keyword">new</span> <span class="title class_">LinkedHashMap</span>&lt;String, Object&gt;(candidateNames.length);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 根据返回的 beanName，获取其实例返回</span></span><br><span class="line">    <span class="keyword">for</span> (String candidateName : candidateNames) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!isSelfReference(beanName, candidateName) &amp;&amp; isAutowireCandidate(candidateName, descriptor)) &#123;</span><br><span class="line">            result.put(candidateName, getBean(candidateName));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>可以看到它返回的是一个列表，那么就表明，按照类型匹配可能会查询到多个实例。到底应该装配哪个实例呢？我看有的文章里说，可以加注解以此规避。比如 <code>@qulifier、@Primary</code> 等，实际还有个简单的办法</p><p>比如，按照 <code>UserService</code> 接口类型来装配它的实现类。<code>UserService</code> 接口有多个实现类，分为 <code>UserServiceImpl、UserServiceImpl2</code>。那么我们在注入的时候，就可以把属性名称定义为 <code>bean</code> 实现类的名称</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line">UserService UserServiceImpl2;</span><br></pre></td></tr></table></figure><p>这样的话，<code>spring</code> 会按照 <code>byName</code> 来进行装配。首先，如果查到类型的多个实例，<code>spring</code> 已经做了判断</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Object <span class="title function_">doResolveDependency</span><span class="params">(DependencyDescriptor descriptor, String beanName,</span></span><br><span class="line"><span class="params">            Set&lt;String&gt; autowiredBeanNames, TypeConverter typeConverter)</span> <span class="keyword">throws</span> BeansException &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 按照类型查找 bean 实例</span></span><br><span class="line">    Map&lt;String, Object&gt; matchingBeans = findAutowireCandidates(beanName, type, descriptor);</span><br><span class="line">    <span class="comment">// 如果 bean 集合为空，且 isRequired 成立,就抛出异常</span></span><br><span class="line">    <span class="keyword">if</span> (matchingBeans.isEmpty()) &#123;</span><br><span class="line">        <span class="keyword">if</span> (descriptor.isRequired()) &#123;</span><br><span class="line">            raiseNoSuchBeanDefinitionException(type, <span class="string">&quot;&quot;</span>, descriptor);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 如果查找的 bean 实例大于 1 个</span></span><br><span class="line">    <span class="keyword">if</span> (matchingBeans.size() &gt; <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="comment">// 找到最合适的那个，如果没有合适的，也抛出异常</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">primaryBeanName</span> <span class="operator">=</span> determineAutowireCandidate(matchingBeans, descriptor);</span><br><span class="line">        <span class="keyword">if</span> (primaryBeanName == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">NoUniqueBeanDefinitionException</span>(type, matchingBeans.keySet());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (autowiredBeanNames != <span class="literal">null</span>) &#123;</span><br><span class="line">            autowiredBeanNames.add(primaryBeanName);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> matchingBeans.get(primaryBeanName);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>可以看出，如果查到多个实例，<code>determineAutowireCandidate</code> 方法就是关键。它来确定一个合适的 <code>bean</code> 返回。其中一部分就是按照 <code>bean</code> 的名称来匹配</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> String <span class="title function_">determineAutowireCandidate</span><span class="params">(Map&lt;String, Object&gt; candidateBeans,</span></span><br><span class="line"><span class="params">                DependencyDescriptor descriptor)</span> &#123;</span><br><span class="line">    <span class="comment">// 循环拿到的 bean 集合</span></span><br><span class="line">    <span class="keyword">for</span> (Map.Entry&lt;String, Object&gt; entry : candidateBeans.entrySet()) &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">candidateBeanName</span> <span class="operator">=</span> entry.getKey();</span><br><span class="line">        <span class="type">Object</span> <span class="variable">beanInstance</span> <span class="operator">=</span> entry.getValue();</span><br><span class="line">        <span class="comment">// 通过 matchesBeanName 方法来确定 bean 集合中的名称是否与属性的名称相同</span></span><br><span class="line">        <span class="keyword">if</span> (matchesBeanName(candidateBeanName, descriptor.getDependencyName())) &#123;</span><br><span class="line">            <span class="keyword">return</span> candidateBeanName;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>最后我们回到问题上，得到的答案就是：<em><code>@Autowired</code> 默认使用 <code>byType</code> 来装配属性，如果匹配到类型的多个实例，再通过 <code>byName</code> 来确定 <code>bean</code></em></p><h3 id="主和优先级"><a class="markdownIt-Anchor" href="#主和优先级"></a> 主和优先级</h3><p>上面我们已经看到了，通过 <code>byType</code> 可能会找到多个实例的 <code>bean</code>。然后再通过 <code>byName</code> 来确定一个合适的 <code>bean</code>，如果通过名称也确定不了呢？</p><p>还是 <code>determineAutowireCandidate</code> 这个方法，它还有两种方式来确定</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> String <span class="title function_">determineAutowireCandidate</span><span class="params">(Map&lt;String, Object&gt; candidateBeans,</span></span><br><span class="line"><span class="params">                DependencyDescriptor descriptor)</span> &#123;</span><br><span class="line">    Class&lt;?&gt; requiredType = descriptor.getDependencyType();</span><br><span class="line">    <span class="comment">// 通过 @Primary注解来标识 bean</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">primaryCandidate</span> <span class="operator">=</span> determinePrimaryCandidate(candidateBeans, requiredType);</span><br><span class="line">    <span class="keyword">if</span> (primaryCandidate != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> primaryCandidate;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 通过 @Priority(value = 0) 注解来标识 bean, value 为优先级大小</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">priorityCandidate</span> <span class="operator">=</span> determineHighestPriorityCandidate(candidateBeans, requiredType);</span><br><span class="line">    <span class="keyword">if</span> (priorityCandidate != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> priorityCandidate;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="primary-注解"><a class="markdownIt-Anchor" href="#primary-注解"></a> <code>@Primary</code> 注解</h4><p>它的作用是看 <code>bean</code> 上是否包含 <code>@Primary</code> 注解，如果包含就返回。当然了，你不能把多个 <code>bean</code> 都设置为 <code>@Primary</code>，不然你会得到 <code>NoUniqueBeanDefinitionException</code> 这个异常</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> String <span class="title function_">determinePrimaryCandidate</span><span class="params">(Map&lt;String, Object&gt; candidateBeans, Class&lt;?&gt; requiredType)</span> &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">primaryBeanName</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">for</span> (Map.Entry&lt;String, Object&gt; entry : candidateBeans.entrySet()) &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">candidateBeanName</span> <span class="operator">=</span> entry.getKey();</span><br><span class="line">        <span class="type">Object</span> <span class="variable">beanInstance</span> <span class="operator">=</span> entry.getValue();</span><br><span class="line">        <span class="keyword">if</span> (isPrimary(candidateBeanName, beanInstance)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (primaryBeanName != <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="type">boolean</span> <span class="variable">candidateLocal</span> <span class="operator">=</span> containsBeanDefinition(candidateBeanName);</span><br><span class="line">                <span class="type">boolean</span> <span class="variable">primaryLocal</span> <span class="operator">=</span> containsBeanDefinition(primaryBeanName);</span><br><span class="line">                <span class="keyword">if</span> (candidateLocal &amp;&amp; primaryLocal) &#123;</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">NoUniqueBeanDefinitionException</span>(requiredType, candidateBeans.size(),</span><br><span class="line">                            <span class="string">&quot;more than one &#x27;primary&#x27; bean found among candidates: &quot;</span> + candidateBeans.keySet());</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (candidateLocal) &#123;</span><br><span class="line">                    primaryBeanName = candidateBeanName;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                primaryBeanName = candidateBeanName;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> primaryBeanName;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="priority-注解"><a class="markdownIt-Anchor" href="#priority-注解"></a> <code>@Priority</code> 注解</h4><p>你也可以在 <code>bean</code>上配置<code>@Priority</code>注解，它有个 int 类型的属性 <code>value</code>，可以配置优先级大小。数字越小的，就被优先匹配。同样的，你也不能把多个 <code>bean</code>的优先级配置成相同大小的数值，否则 <code>NoUniqueBeanDefinitionException</code>异常照样出来找你</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> String <span class="title function_">determineHighestPriorityCandidate</span><span class="params">(Map&lt;String, Object&gt; candidateBeans,</span></span><br><span class="line"><span class="params">                                    Class&lt;?&gt; requiredType)</span> &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">highestPriorityBeanName</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="type">Integer</span> <span class="variable">highestPriority</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">for</span> (Map.Entry&lt;String, Object&gt; entry : candidateBeans.entrySet()) &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">candidateBeanName</span> <span class="operator">=</span> entry.getKey();</span><br><span class="line">        <span class="type">Object</span> <span class="variable">beanInstance</span> <span class="operator">=</span> entry.getValue();</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">candidatePriority</span> <span class="operator">=</span> getPriority(beanInstance);</span><br><span class="line">        <span class="keyword">if</span> (candidatePriority != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (highestPriorityBeanName != <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="comment">// 如果优先级大小相同</span></span><br><span class="line">                <span class="keyword">if</span> (candidatePriority.equals(highestPriority)) &#123;</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">NoUniqueBeanDefinitionException</span>(requiredType, candidateBeans.size(),</span><br><span class="line">                        <span class="string">&quot;Multiple beans found with the same priority (&#x27;&quot;</span> + highestPriority + <span class="string">&quot;&#x27;) &quot;</span> +</span><br><span class="line">                            <span class="string">&quot;among candidates: &quot;</span> + candidateBeans.keySet());</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (candidatePriority &lt; highestPriority) &#123;</span><br><span class="line">                    highestPriorityBeanName = candidateBeanName;</span><br><span class="line">                    highestPriority = candidatePriority;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                highestPriorityBeanName = candidateBeanName;</span><br><span class="line">                highestPriority = candidatePriority;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> highestPriorityBeanName;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>Priority</code> 的包在 <code>javax.annotation.Priority</code>，如果想使用它还要引入一个坐标</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.annotation<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax.annotation-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="总结"><a class="markdownIt-Anchor" href="#总结"></a> 总结</h2><p>本章节重点阐述了 Spring 中的自动装配的几种策略，又通过源码分析了 Autowired 注解的使用方式。<br />在 Spring3.0 之后，有效的自动装配策略分为<code>byType、byName、constructor</code>三种方式。注解<br />Autowired 默认使用 byType 来自动装配，如果存在类型的多个实例就尝试使用 byName 匹配，如果通过 byName 也确定不了，可以通过 Primary 和 Priority 注解来确定。</p>]]></content>
      
      
      <categories>
          
          <category> Spring </category>
          
          <category> Java </category>
          
          <category> Spring自动装配 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Spring </tag>
            
            <tag> Spring注解 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Spring注解-@Autowired注解使用</title>
      <link href="/posts/7047b0e7/"/>
      <url>/posts/7047b0e7/</url>
      
        <content type="html"><![CDATA[<details class="folding-tag" cyan><summary> 写在前面得话 </summary>              <div class='content'>              <div class="note info simple"><p>学习@Autowired 之前建议先学会使用 byType 和 byName</p></div><div class="tag link"><a class="link-card" title="Spring的自动装配" href="https://hgm.vercel.app/post/63755f3a/"><div class="left"><img src="https://unpkg.com/serms-assets/imgs/avatar.jpg"/></div><div class="right"><p class="text">Spring的自动装配</p><p class="url">https://hgm.vercel.app/post/63755f3a/</p></div></a></div>              </div>            </details><h2 id="autowired-详解"><a class="markdownIt-Anchor" href="#autowired-详解"></a> @Autowired 详解</h2><p>首先要知道另一个东西，default-autowire，它是在 xml 文件中进行配置的，可以设置为 byName、byType、constructor 和 autodetect；比如 byName，不用显式的在 bean 中写出依赖的对象，它会自动的匹配其它 bean 中 id 名与本 bean 的 set**相同的，并自动装载。<br />@Autowired 是用在 JavaBean 中的注解，通过 byType 形式，用来给指定的字段或方法注入所需的外部资源。<br />两者的功能是一样的，就是能减少或者消除属性或构造器参数的设置，只是配置地方不一样而已。<br />autowire 四种模式的区别<br /><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltZy5ibG9nLmNzZG4ubmV0LzIwMTYwODI0MTcyODAwMTYz?x-oss-process=image/format,png" alt="" /></p><p>先看一下 bean 实例化和@Autowired 装配过程：<br />一切都是从 bean 工厂的 getBean 方法开始的，一旦该方法调用总会返回一个 bean 实例，无论当前是否存在，不存在就实例化一个并装配，否则直接返回。（Spring MVC 是在什么时候开始执行 bean 的实例化过程的呢？其实就在组件扫描完成之后）</p><p>实例化和装配过程中会多次递归调用 getBean 方法来解决类之间的依赖。</p><p>Spring 几乎考虑了所有可能性，所以方法特别复杂但完整有条理。</p><p>@Autowired 最终是根据类型来查找和装配元素的，但是我们设置了<beans default-autowire="byName"/>后会影响最终的类型匹配查找。因为在前面有根据 BeanDefinition 的 autowire 类型设置 PropertyValue 值得一步，其中会有新实例的创建和注册。就是那个 autowireByName 方法。</p><p>下面通过@Autowired 来说明一下用法</p><h2 id="setter-方法中的-autowired"><a class="markdownIt-Anchor" href="#setter-方法中的-autowired"></a> Setter 方法中的 @Autowired</h2><p>你可以在 JavaBean 中的 setter 方法中使用 @Autowired 注解。当 Spring 遇到一个在 setter 方法中使用的 @Autowired 注解，它会在方法中执行 byType 自动装配。<br />这里是 TextEditor.java 文件的内容：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.tutorialspoint;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TextEditor</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> SpellChecker spellChecker;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setSpellChecker</span><span class="params">( SpellChecker spellChecker )</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.spellChecker = spellChecker;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> SpellChecker <span class="title function_">getSpellChecker</span><span class="params">( )</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> spellChecker;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">spellCheck</span><span class="params">()</span> &#123;</span><br><span class="line">        spellChecker.checkSpelling();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>下面是另一个依赖的类文件 SpellChecker.java 的内容：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.tutorialspoint;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpellChecker</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">SpellChecker</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Inside SpellChecker constructor.&quot;</span> );</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">checkSpelling</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Inside checkSpelling.&quot;</span> );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>下面是 MainApp.java 文件的内容：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.tutorialspoint;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainApp</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;Beans.xml&quot;</span>);</span><br><span class="line">        <span class="type">TextEditor</span> <span class="variable">te</span> <span class="operator">=</span> (TextEditor) context.getBean(<span class="string">&quot;textEditor&quot;</span>);</span><br><span class="line">        te.spellCheck();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>下面是配置文件 Beans.xml：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">                           http://www.springframework.org/schema/beans/spring-beans-3.0.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">                           http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="string"><span class="tag">                           http://www.springframework.org/schema/context/spring-context-3.0.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:annotation-config</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Definition for textEditor bean without constructor-arg  --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;textEditor&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.tutorialspoint.TextEditor&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Definition for spellChecker bean --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;spellChecker&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.tutorialspoint.SpellChecker&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><p>一旦你已经完成的创建了源文件和 bean 配置文件，让我们运行一下应用程序。如果你的应用程序一切都正常的话，这将会输出以下消息：</p><p>Inside SpellChecker constructor.<br />Inside checkSpelling.</p><h2 id="属性中的-autowired"><a class="markdownIt-Anchor" href="#属性中的-autowired"></a> 属性中的 @Autowired</h2><p>你可以在属性中使用 @Autowired 注解来除去 setter 方法。当时使用 为自动连接属性传递的时候，Spring 会将这些传递过来的值或者引用自动分配给那些属性。所以利用在属性中 @Autowired 的用法，你的 TextEditor.java 文件将变成如下所示：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.tutorialspoint;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TextEditor</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SpellChecker spellChecker;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">TextEditor</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Inside TextEditor constructor.&quot;</span> );</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> SpellChecker <span class="title function_">getSpellChecker</span><span class="params">( )</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> spellChecker;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">spellCheck</span><span class="params">()</span>&#123;</span><br><span class="line">        spellChecker.checkSpelling();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>下面是配置文件 Beans.xml：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">                           http://www.springframework.org/schema/beans/spring-beans-3.0.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">                           http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="string"><span class="tag">                           http://www.springframework.org/schema/context/spring-context-3.0.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:annotation-config</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Definition for textEditor bean --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;textEditor&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.tutorialspoint.TextEditor&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Definition for spellChecker bean --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;spellChecker&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.tutorialspoint.SpellChecker&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><p>一旦你在源文件和 bean 配置文件中完成了上面两处改变，让我们运行一下应用程序。如果你的应用程序一切都正常的话，这将会输出以下消息：</p><p>Inside TextEditor constructor.<br />Inside SpellChecker constructor.<br />Inside checkSpelling.</p><h2 id="构造函数中的-autowired"><a class="markdownIt-Anchor" href="#构造函数中的-autowired"></a> 构造函数中的 @Autowired</h2><p>你也可以在构造函数中使用 @Autowired。一个构造函数 @Autowired 说明当创建 bean 时，即使在 XML 文件中没有使用 元素配置 bean ，构造函数也会被自动连接。让我们检查一下下面的示例。<br />这里是 TextEditor.java 文件的内容：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.tutorialspoint;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TextEditor</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> SpellChecker spellChecker;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">TextEditor</span><span class="params">(SpellChecker spellChecker)</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Inside TextEditor constructor.&quot;</span> );</span><br><span class="line">        <span class="built_in">this</span>.spellChecker = spellChecker;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">spellCheck</span><span class="params">()</span>&#123;</span><br><span class="line">        spellChecker.checkSpelling();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>下面是配置文件 Beans.xml：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">                           http://www.springframework.org/schema/beans/spring-beans-3.0.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">                           http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="string"><span class="tag">                           http://www.springframework.org/schema/context/spring-context-3.0.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:annotation-config</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Definition for textEditor bean without constructor-arg  --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;textEditor&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.tutorialspoint.TextEditor&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Definition for spellChecker bean --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;spellChecker&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.tutorialspoint.SpellChecker&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><p>一旦你在源文件和 bean 配置文件中完成了上面两处改变，让我们运行一下应用程序。如果你的应用程序一切都正常的话，这将会输出以下消息：</p><p>Inside TextEditor constructor.<br />Inside SpellChecker constructor.<br />Inside checkSpelling.</p><h2 id="autowired-的requiredfalse选项"><a class="markdownIt-Anchor" href="#autowired-的requiredfalse选项"></a> @Autowired 的（required=false）选项</h2><p>默认情况下，@Autowired 注解意味着依赖是必须的，它类似于 @Required 注解，然而，你可以使用 @Autowired 的 （required=false） 选项关闭默认行为。<br />即使你不为 age 属性传递任何参数，下面的示例也会成功运行，但是对于 name 属性则需要一个参数。你可以自己尝试一下这个示例，因为除了只有 Student.java 文件被修改以外，它和 @Required 注解示例是相似的。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.tutorialspoint;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Student</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="meta">@Autowired(required=false)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAge</span><span class="params">(Integer age)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">getAge</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="其他"><a class="markdownIt-Anchor" href="#其他"></a> 其他</h2><p><strong>@Autowired 注释应用于具有任意名称和多个参数的方法:</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MovieRecommender</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> MovieCatalog movieCatalog;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> CustomerPreferenceDao customerPreferenceDao;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">prepare</span><span class="params">(MovieCatalog movieCatalog,</span></span><br><span class="line"><span class="params">                        CustomerPreferenceDao customerPreferenceDao)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.movieCatalog = movieCatalog;</span><br><span class="line">        <span class="built_in">this</span>.customerPreferenceDao = customerPreferenceDao;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>您也可以将@Autowired 应用于字段，或者将其与构造函数混合，如以下示例所示</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MovieRecommender</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> CustomerPreferenceDao customerPreferenceDao;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> MovieCatalog movieCatalog;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MovieRecommender</span><span class="params">(CustomerPreferenceDao customerPreferenceDao)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.customerPreferenceDao = customerPreferenceDao;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>将@Autowired 注释添加到需要该类型数组的字段或方法，则 spring 会从 ApplicationContext 中搜寻符合指定类型的所有 bean，如以下示例所示：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MovieRecommender</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> MovieCatalog[] movieCatalogs;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>数组可以，我们可以马上举一反三，那容器也可以吗，答案是肯定的，下面是 set 以及 map 的例子：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MovieRecommender</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Set&lt;MovieCatalog&gt; movieCatalogs;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setMovieCatalogs</span><span class="params">(Set&lt;MovieCatalog&gt; movieCatalogs)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.movieCatalogs = movieCatalogs;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MovieRecommender</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Map&lt;String, MovieCatalog&gt; movieCatalogs;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setMovieCatalogs</span><span class="params">(Map&lt;String, MovieCatalog&gt; movieCatalogs)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.movieCatalogs = movieCatalogs;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>以上就是@Autowired 注解的主要使用方式，经常使用 spring 的话应该对其中常用的几种不会感到陌生。</p><h2 id="autowired-装配不成功的几种情况"><a class="markdownIt-Anchor" href="#autowired-装配不成功的几种情况"></a> @Autowired 装配不成功的几种情况？</h2><h3 id="没有加component-注解"><a class="markdownIt-Anchor" href="#没有加component-注解"></a> 没有加@Component 注解</h3><p>在类上面忘了加@Controller、@Service、@Component、@Repository 等注解，spring 就无法完成自动装配的功能，例如：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> IUser user;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span> &#123;</span><br><span class="line">        user.say();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这种情况应该是最常见的错误了，不会因为你长得帅，就不会犯这种低级的错误。</p><h3 id="注入-filter-或-listener"><a class="markdownIt-Anchor" href="#注入-filter-或-listener"></a> 注入 Filter 或 Listener</h3><p>web 应用启动的顺序是：listener-&gt;filter-&gt;servlet。</p><p><img src="https://unpkg.com/serms-assets@1.0.13/Spring/sasasas.png" alt="img" /></p><p>接下来看看这个案例：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserFilter</span> <span class="keyword">implements</span> <span class="title class_">Filter</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> IUser user;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line">        user.say();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doFilter</span><span class="params">(ServletRequest request, ServletResponse response, FilterChain chain)</span> <span class="keyword">throws</span> IOException, ServletException &#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FilterConfig</span> &#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> FilterRegistrationBean <span class="title function_">filterRegistrationBean</span><span class="params">()</span> &#123;</span><br><span class="line">        bean = <span class="keyword">new</span> <span class="title class_">FilterRegistrationBean</span>();</span><br><span class="line">        bean.setFilter(<span class="keyword">new</span> <span class="title class_">UserFilter</span>());</span><br><span class="line">        bean.addUrlPatterns(<span class="string">&quot;/*&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> bean;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>程序启动会报错,tomcat 也无法正常启动???什么原因??</p><p>众所周知，springmvc 的启动是在 DisptachServlet 里面做的，而它是在 listener 和 filter 之后执行。如果我们想在 listener 和 filter 里面@Autowired 某个 bean，肯定是不行的，因为 filter 初始化的时候，此时 bean 还没有初始化，无法自动装配。</p><p>如果工作当中真的需要这样做，我们该如何解决这个问题呢？</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserFilter</span>  <span class="keyword">implements</span> <span class="title class_">Filter</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> IUser user;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException &#123;</span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">applicationContext</span> <span class="operator">=</span> WebApplicationContextUtils.getWebApplicationContext(</span><br><span class="line">            filterConfig.getServletContext());</span><br><span class="line">        <span class="built_in">this</span>.user = ((IUser)(applicationContext.getBean(<span class="string">&quot;user1&quot;</span>)));</span><br><span class="line">        user.say();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doFilter</span><span class="params">(ServletRequest request, ServletResponse response, FilterChain chain)</span> <span class="keyword">throws</span> IOException, ServletException &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>答案是使用 WebApplicationContextUtils.getWebApplicationContext 获取当前的 ApplicationContext，再通过它获取到 bean 实例。</p><h3 id="注解未被componentscan-扫描"><a class="markdownIt-Anchor" href="#注解未被componentscan-扫描"></a> 注解未被@ComponentScan 扫描</h3><p>通常情况下，@Controller、@Service、@Component、@Repository、@Configuration 等注解，是需要通过@ComponentScan 注解扫描，收集元数据的。</p><p>但是，如果没有加@ComponentScan 注解，或者@ComponentScan 注解扫描的路径不对，或者路径范围太小，会导致有些注解无法收集，到后面无法使用@Autowired 完成自动装配的功能。</p><p>有个好消息是，在 springboot 项目中，如果使用了@SpringBootApplication 注解，它里面内置了@ComponentScan 注解的功能。</p><h3 id="循环依赖问题"><a class="markdownIt-Anchor" href="#循环依赖问题"></a> 循环依赖问题</h3><p>如果 A 依赖于 B，B 依赖于 C，C 又依赖于 A，这样就形成了一个死循环。</p><p><img src="https://unpkg.com/serms-assets@1.0.13/Spring/ssas.png" alt="img" /></p><p>spring 的 bean 默认是单例的，如果单例 bean 使用@Autowired 自动装配，大多数情况，能解决循环依赖问题。</p><p>但是如果 bean 是多例的，会出现循环依赖问题，导致 bean 自动装配不了。</p><p>还有有些情况下，如果创建了代理对象，即使 bean 是单例的，依然会出现循环依赖问题。</p><h2 id="autowired-和resouce-的区别"><a class="markdownIt-Anchor" href="#autowired-和resouce-的区别"></a> @Autowired 和@Resouce 的区别</h2><p>@Autowired 功能虽说非常强大，但是也有些不足之处。比如：比如它跟 spring 强耦合了，如果换成了 JFinal 等其他框架，功能就会失效。而@Resource 是 JSR-250 提供的，它是 Java 标准，绝大部分框架都支持。</p><p>除此之外，有些场景使用@Autowired 无法满足的要求，改成@Resource 却能解决问题。接下来，我们重点看看@Autowired 和@Resource 的区别。</p><ul><li>@Autowired 默认按 byType 自动装配，而@Resource 默认 byName 自动装配。</li><li>@Autowired 只包含一个参数：required，表示是否开启自动准入，默认是 true。而@Resource 包含七个参数，其中最重要的两个参数是：name 和 type。</li><li>@Autowired 如果要使用 byName，需要使用@Qualifier 一起配合。而@Resource 如果指定了 name，则用 byName 自动装配，如果指定了 type，则用 byType 自动装配。</li><li>@Autowired 能够用在：构造器、方法、参数、成员变量和注解上，而@Resource 能用在：类、成员变量和方法上。</li><li>@Autowired 是 spring 定义的注解，而@Resource 是 JSR-250 定义的注解。</li></ul><p>此外，它们的装配顺序不同。</p><h3 id="autowired-的装配顺序如下"><a class="markdownIt-Anchor" href="#autowired-的装配顺序如下"></a> <strong>@Autowired 的装配顺序如下：</strong></h3><p><img src="https://unpkg.com/serms-assets@1.0.13/Spring/sdsd.png" alt="img" /></p><p><strong>@Resource 的装配顺序如下：</strong></p><p><strong>1.如果同时指定了 name 和 type：</strong></p><p><img src="https://unpkg.com/serms-assets@1.0.13/Spring/aasassa.png" alt="img" /></p><p><strong>如果指定了 name:</strong></p><p><img src="https://unpkg.com/serms-assets@1.0.13/Spring/8644ebf81a4c510f236bccbc57802424d62adc4dfb9aab2.png" alt="img" /></p><p><strong>如果指定了 type：</strong></p><p><img src="https://unpkg.com/serms-assets@1.0.13/Spring/342ac65c10385343ed8ea3ad912bd2dbd263fd54e1666998.png" alt="img" /></p><p><strong>如果既没有指定 name，也没有指定 type：</strong></p><p><img src="https://unpkg.com/serms-assets@1.0.13/Spring/7af40ad162d9f2d385020d6c9e358b8c65c069af359a71ef5.png" alt="img" /></p>]]></content>
      
      
      <categories>
          
          <category> Spring </category>
          
          <category> Spring注解 </category>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Spring </tag>
            
            <tag> Spring注解 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>为什么IDEA不推荐你使用@Autowired?</title>
      <link href="/posts/e97079a9/"/>
      <url>/posts/e97079a9/</url>
      
        <content type="html"><![CDATA[<p><code>@Autowired</code>注解相信每个 Spring 开发者都不陌生了！</p><p>但是当我们使用 IDEA 写代码的时候，经常会发现<code>@Autowired</code>注解下面是有小黄线的，我们把小鼠标悬停在上面，可以看到这个如下图所示的警告信息：</p><p><img src="https://unpkg.com/serms-assets@1.0.12/Spring/242dd42a2834eb844.png" alt="" /></p><p>那么为什么 IDEA 会给出<code>Field injection is not recommended</code>这样的警告呢？</p><p>下面带着这样的问题，一起来全面的了解下 Spring 中的三种注入方式以及他们之间在各方面的优劣。</p><h2 id="spring-中的三种依赖注入方式"><a class="markdownIt-Anchor" href="#spring-中的三种依赖注入方式"></a> Spring 中的三种依赖注入方式</h2><h3 id="field-injection"><a class="markdownIt-Anchor" href="#field-injection"></a> <strong>Field Injection</strong></h3><p><code>@Autowired</code>注解的一大使用场景就是<code>Field Injection</code>。</p><p>具体形式如下：</p><p><img src="https://unpkg.com/serms-assets@1.0.12/Spring/94cad1c8a786c9170784f2ca88ad1939c.png" alt="" /></p><p>这种注入方式通过 Java 的反射机制实现，所以 private 的成员也可以被注入具体的对象。</p><h3 id="constructor-injection"><a class="markdownIt-Anchor" href="#constructor-injection"></a> Constructor Injection</h3><p><code>Constructor Injection</code>是构造器注入，是我们日常最为推荐的一种使用方式。</p><p>具体形式如下：</p><p><img src="https://unpkg.com/serms-assets@1.0.12/Spring/2e2eb9389b504fc20e5f6adeb8f58053b8df6d7.png" alt="" /></p><p>这种注入方式很直接，通过对象构建的时候建立关系，所以这种方式对对象创建的顺序会有要求，当然 Spring 会为你搞定这样的先后顺序，除非你出现循环依赖，然后就会抛出异常。</p><h3 id="setter-injection"><a class="markdownIt-Anchor" href="#setter-injection"></a> Setter Injection</h3><p><code>Setter Injection</code>也会用到<code>@Autowired</code>注解，但使用方式与<code>Field Injection</code>有所不同，<code>Field Injection</code>是用在成员变量上，而<code>Setter Injection</code>的时候，是用在成员变量的 Setter 函数上。</p><p>具体形式如下：</p><p><img src="https://unpkg.com/serms-assets@1.0.12/Spring/a08b87d6277f9e2fd1b1ab1c4230882dsee208a50.png" alt="" /></p><p>这种注入方式也很好理解，就是通过调用成员变量的 set 方法来注入想要使用的依赖对象。</p><h3 id="三种依赖注入的对比"><a class="markdownIt-Anchor" href="#三种依赖注入的对比"></a> 三种依赖注入的对比</h3><p>在知道了 Spring 提供的三种依赖注入方式之后，我们继续回到本文开头说到的问题：IDEA 为什么不推荐使用<code>Field Injection</code>呢？</p><p>我们可以从多个开发测试的考察角度来对比一下它们之间的优劣：</p><p><strong>可靠性</strong></p><p>从对象构建过程和使用过程，看对象在各阶段的使用是否可靠来评判：</p><ul><li><code>Field Injection</code>：不可靠</li><li><code>Constructor Injection</code>：可靠</li><li><code>Setter Injection</code>：不可靠</li></ul><p>由于构造函数有严格的构建顺序和不可变性，一旦构建就可用，且不会被更改。</p><p><strong>可维护性</strong></p><p>主要从更容易阅读、分析依赖关系的角度来评判：</p><ul><li><code>Field Injection</code>：差</li><li><code>Constructor Injection</code>：好</li><li><code>Setter Injection</code>：差</li></ul><p>还是由于依赖关键的明确，从构造函数中可以显现的分析出依赖关系，对于我们如何去读懂关系和维护关系更友好。</p><p><strong>可测试性</strong></p><p>当在复杂依赖关系的情况下，考察程序是否更容易编写单元测试来评判</p><ul><li><code>Field Injection</code>：差</li><li><code>Constructor Injection</code>：好</li><li><code>Setter Injection</code>：好</li></ul><p><code>Constructor Injection</code>和<code>Setter Injection</code>的方式更容易 Mock 和注入对象，所以更容易实现单元测试。</p><p><strong>灵活性</strong></p><p>主要根据开发实现时候的编码灵活性来判断：</p><ul><li><code>Field Injection</code>：很灵活</li><li><code>Constructor Injection</code>：不灵活</li><li><code>Setter Injection</code>：很灵活</li></ul><p>由于<code>Constructor Injection</code>对 Bean 的依赖关系设计有严格的顺序要求，所以这种注入方式不太灵活。相反<code>Field Injection</code>和<code>Setter Injection</code>就非常灵活，但也因为灵活带来了局面的混乱，也是一把双刃剑。</p><p><strong>循环关系的检测</strong></p><p>对于 Bean 之间是否存在循环依赖关系的检测能力：</p><ul><li><code>Field Injection</code>：不检测</li><li><code>Constructor Injection</code>：自动检测</li><li><code>Setter Injection</code>：不检测</li></ul><p><strong>性能表现</strong></p><p>不同的注入方式，对性能的影响</p><ul><li><code>Field Injection</code>：启动快</li><li><code>Constructor Injection</code>：启动慢</li><li><code>Setter Injection</code>：启动快</li></ul><p>主要影响就是启动时间，由于<code>Constructor Injection</code>有严格的顺序要求，所以会拉长启动时间。</p><p>所以，综合上面各方面的比较，可以获得如下表格：</p><p><img src="https://unpkg.com/serms-assets@1.0.12/Spring/sc99aef1ea6ee7a3a703ba.png" alt="" /></p><p>结果一目了然，<code>Constructor Injection</code>在很多方面都是优于其他两种方式的，所以<code>Constructor Injection</code>通常都是首选方案！</p><p>而<code>Setter Injection</code>比起<code>Field Injection</code>来说，大部分都一样，但因为可测试性更好，所以当你要用<code>@Autowired</code>的时候，推荐使用<code>Setter Injection</code>的方式，这样 IDEA 也不会给出警告了。同时，也侧面也反映了，可测试性的重要地位啊！</p><h3 id="总结"><a class="markdownIt-Anchor" href="#总结"></a> 总结</h3><p>最后，对于今天的问题讨论，我们给出两个结论，方便大家记忆：</p><ol><li>依赖注入的使用上，<code>Constructor Injection</code>是首选。</li><li>使用<code>@Autowired</code>注解的时候，要使用<code>Setter Injection</code>方式，这样代码更容易编写单元测试。</li></ol>]]></content>
      
      
      <categories>
          
          <category> 奇怪的知识 </category>
          
          <category> 为什么IDEA不推荐你使用@Autowired? </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 奇怪的知识 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Spring注解-Configuration注解使用</title>
      <link href="/posts/1d0508a6/"/>
      <url>/posts/1d0508a6/</url>
      
        <content type="html"><![CDATA[<h2 id="configuration-的使用"><a class="markdownIt-Anchor" href="#configuration-的使用"></a> <a href="https://hgm.vercel.app/post/1d0508a6/">@Configuration 的使用</a></h2><p>从 Spring3.0，@Configuration 用于定义配置类，可替换 xml 配置文件，被注解的类内部包含有一个或多个被@Bean 注解的方法，这些方法将会被 AnnotationConfigApplicationContext 或 AnnotationConfigWebApplicationContext 类进行扫描，并用于构建 bean 定义，初始化 Spring 容器。也就是说使用了这个注解完全不需要我们手动去配置<code>applicationContext.xml</code>了</p><p><strong>注意</strong>：@Configuration 注解的配置类有如下要求：</p><ol><li>@Configuration 不可以是 final 类型；</li><li>@Configuration 不可以是匿名类；</li><li>嵌套的 configuration 必须是静态类。</li></ol><p><strong>@Configuation 加载 Spring 方法</strong></p><h2 id="configuration-配置-spring-并启动-spring-容器"><a class="markdownIt-Anchor" href="#configuration-配置-spring-并启动-spring-容器"></a> @Configuration 配置 spring 并启动 spring 容器</h2><p>@Configuration 标注在类上，相当于把该类作为 spring 的 xml 配置文件中的<code>&lt;beans&gt;</code>，作用为：配置 spring 容器(应用上下文)</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ms.demo.configuration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> SerMs</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2022/4/7 22:43</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestConfiguration</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//空参构造</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">TestConfiguration</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;TestConfiguration容器启动初始化。。。&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>相当于 Spring 的 xml 配置文件:</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><p>主方法进行测试：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.ms.demo.configuration.TestConfiguration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.AnnotationConfigApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> SerMs</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2022/4/7 22:46</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestMain</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">// @Configuration注解的spring容器加载方式，用AnnotationConfigApplicationContext替换ClassPathXmlApplicationContext</span></span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AnnotationConfigApplicationContext</span>(TestConfiguration.class);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 如果加载spring-context.xml文件：</span></span><br><span class="line">        <span class="comment">// ApplicationContext context = new</span></span><br><span class="line">        <span class="comment">// ClassPathXmlApplicationContext(&quot;spring-context.xml&quot;);</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>从运行主方法结果可以看出，spring 容器已经启动了：</p><p><img src="https://unpkg.com/serms-assets@1.0.11/Spring/image-20220407224716063.png" alt="" /></p><h2 id="configuration-启动容器bean-注册-beanbean-下管理-bean-的生命周期"><a class="markdownIt-Anchor" href="#configuration-启动容器bean-注册-beanbean-下管理-bean-的生命周期"></a> @Configuration 启动容器+@Bean 注册 Bean，@Bean 下管理 bean 的生命周期</h2><p>@Bean 标注在方法上(返回某个实例的方法)，等价于 spring 的 xml 配置文件中的<code>&lt;bean&gt;</code>，作用为：注册 bean 对象</p><p>bean 类：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ms.demo.configuration;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> SerMs</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2022/4/7 22:49</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestBean</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="keyword">private</span> String url;</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sayHello</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;TestBean sayHello...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;username:&quot;</span> + <span class="built_in">this</span>.username + <span class="string">&quot;,url:&quot;</span> + <span class="built_in">this</span>.url + <span class="string">&quot;,password:&quot;</span> + <span class="built_in">this</span>.password;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">start</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;TestBean 初始化。。。&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">cleanUp</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;TestBean 销毁。。。&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>配置类：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ms.demo.configuration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Scope;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> SerMs</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2022/4/7 22:43</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestConfiguration</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//空参构造</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">TestConfiguration</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;TestConfiguration容器启动初始化。。。&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// @Bean注解注册bean,同时可以指定初始化和销毁方法</span></span><br><span class="line">    <span class="comment">// @Bean(name=&quot;testBean&quot;,initMethod=&quot;start&quot;,destroyMethod=&quot;cleanUp&quot;)</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@Scope(&quot;prototype&quot;)</span>     <span class="comment">//配置作用域,默认:singleton单例模式 ;prototype:双例模式,保证每次请求都创建一次对象</span></span><br><span class="line">    <span class="keyword">public</span> TestBean <span class="title function_">testBean</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">TestBean</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>主方法测试类:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ms.demo.configuration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.AnnotationConfigApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestMain</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// @Configuration注解的spring容器加载方式，用AnnotationConfigApplicationContext替换ClassPathXmlApplicationContext</span></span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AnnotationConfigApplicationContext</span>(TestConfiguration.class);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 如果加载spring-context.xml文件：</span></span><br><span class="line">        <span class="comment">// ApplicationContext context = new</span></span><br><span class="line">        <span class="comment">// ClassPathXmlApplicationContext(&quot;spring-context.xml&quot;);</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//获取bean</span></span><br><span class="line">        <span class="type">TestBean</span> <span class="variable">tb</span> <span class="operator">=</span> (TestBean) context.getBean(<span class="string">&quot;testBean&quot;</span>);</span><br><span class="line">        tb.sayHello();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>结果:</p><p><img src="https://unpkg.com/serms-assets@1.0.11/Spring/image-20220407225446317.png" alt="" /></p><p>注：<br />(1)、@Bean 注解在返回实例的方法上，如果未通过@Bean 指定 bean 的名称，则默认与标注的方法名相同；<br />(2)、@Bean 注解默认作用域为单例 singleton 作用域，可通过@Scope(“prototype”)设置为原型作用域；<br />(3)、既然@Bean 的作用是注册 bean 对象，那么完全可以使用@Component、@Controller、@Service、@Ripository 等注解注册 bean，当然需要配置@ComponentScan 注解进行自动扫描。</p><h2 id="bean-下管理-bean-的生命周期"><a class="markdownIt-Anchor" href="#bean-下管理-bean-的生命周期"></a> <strong>@Bean 下管理 bean 的生命周期</strong></h2><p>可以使用基于 Java 的配置来管理 bean 的生命周期。<code>@Bean</code> 支持两种属性，即 <code>initMethod</code> 和<code>destroyMethod</code>，这些属性可用于定义生命周期方法。在实例化 bean 或即将销毁它时，容器便可调用生命周期方法。生命周期方法也称为回调方法，因为它将由容器调用。使用 <code>@Bean</code> 注释注册的 bean 也支持 JSR-250 规定的标准 <code>@PostConstruct</code> 和 <code>@PreDestroy</code> 注释。如果您正在使用 XML 方法来定义 bean，那么就应该使用 bean 元素来定义生命周期回调方法。以下代码显示了在 XML 配置中通常使用 bean 元素定义回调的方法。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ms.demo.configuration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.ComponentScan;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Scope;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> SerMs</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2022/4/7 22:43</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestConfiguration</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//空参构造</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">TestConfiguration</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;TestConfiguration容器启动初始化。。。&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// @Bean注解注册bean,同时可以指定初始化和销毁方法</span></span><br><span class="line">    <span class="meta">@Bean(name=&quot;testBean&quot;,initMethod=&quot;start&quot;,destroyMethod=&quot;cleanUp&quot;)</span></span><br><span class="line">    <span class="meta">@Scope(&quot;prototype&quot;)</span>     <span class="comment">//配置作用域,默认:singleton单例模式 ;prototype:双例模式,保证每次请求都创建一次对象</span></span><br><span class="line">    <span class="keyword">public</span> TestBean <span class="title function_">testBean</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">TestBean</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>启动类：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.ms.demo.configuration.TestBean;</span><br><span class="line"><span class="keyword">import</span> com.ms.demo.configuration.TestConfiguration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.AnnotationConfigApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> SerMs</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2022/4/7 22:46</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestMain</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// @Configuration注解的spring容器加载方式，用AnnotationConfigApplicationContext替换ClassPathXmlApplicationContext</span></span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AnnotationConfigApplicationContext</span>(TestConfiguration.class);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 如果加载spring-context.xml文件：</span></span><br><span class="line">        <span class="comment">// ApplicationContext context = new</span></span><br><span class="line">        <span class="comment">// ClassPathXmlApplicationContext(&quot;spring-context.xml&quot;);</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//获取bean</span></span><br><span class="line">        <span class="type">TestBean</span> <span class="variable">tb</span> <span class="operator">=</span> (TestBean) context.getBean(<span class="string">&quot;testBean&quot;</span>);</span><br><span class="line">        tb.sayHello();</span><br><span class="line">        System.out.println(tb);</span><br><span class="line"></span><br><span class="line">        <span class="type">TestBean</span> <span class="variable">tb2</span> <span class="operator">=</span> (TestBean) context.getBean(<span class="string">&quot;testBean&quot;</span>);</span><br><span class="line">        tb2.sayHello();</span><br><span class="line">        System.out.println(tb2);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>结果:</p><p><img src="https://unpkg.com/serms-assets@1.0.11/Spring/image-20220407230933661.png" alt="" /></p><h2 id="configuration-启动容器component-注册-bean"><a class="markdownIt-Anchor" href="#configuration-启动容器component-注册-bean"></a> @Configuration 启动容器+@Component 注册 Bean</h2><p>Bean 类:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ms.demo.configuration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> SerMs</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2022/4/7 22:49</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">//添加注册Bean的注解</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestBean</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="keyword">private</span> String url;</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sayHello</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;TestBean sayHello...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;username:&quot;</span> + <span class="built_in">this</span>.username + <span class="string">&quot;,url:&quot;</span> + <span class="built_in">this</span>.url + <span class="string">&quot;,password:&quot;</span> + <span class="built_in">this</span>.password;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">start</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;TestBean 初始化。。。&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">cleanUp</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;TestBean 销毁。。。&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>配置类：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.ms.demo.configuration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.ComponentScan;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Scope;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> SerMs</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2022/4/7 22:43</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="comment">//添加自动扫描注解，basePackages为TestBean包路径,也就是让SpringIOC容器扫描到刚刚添加@Component的Bean类</span></span><br><span class="line"><span class="meta">@ComponentScan(basePackages = &quot;com.ms.demo.configuration&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestConfiguration</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//空参构造</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">TestConfiguration</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;TestConfiguration容器启动初始化。。。&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>主方法测试获取 bean 对象：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.ms.demo.configuration.TestBean;</span><br><span class="line"><span class="keyword">import</span> com.ms.demo.configuration.TestConfiguration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.AnnotationConfigApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> SerMs</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2022/4/7 22:46</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestMain</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// @Configuration注解的spring容器加载方式，用AnnotationConfigApplicationContext替换ClassPathXmlApplicationContext</span></span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AnnotationConfigApplicationContext</span>(TestConfiguration.class);</span><br><span class="line">        <span class="comment">//获取bean</span></span><br><span class="line">        <span class="type">TestBean</span> <span class="variable">tb</span> <span class="operator">=</span> (TestBean) context.getBean(<span class="string">&quot;testBean&quot;</span>);</span><br><span class="line">        tb.sayHello();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>sayHello()方法都被正常调用。</p><p><img src="https://unpkg.com/serms-assets@1.0.11/Spring/image-20220407231701864.png" alt="" /></p><h2 id="使用-annotationconfigapplicationcontext-注册-appcontext-类的两种方法"><a class="markdownIt-Anchor" href="#使用-annotationconfigapplicationcontext-注册-appcontext-类的两种方法"></a> <strong>使用 AnnotationConfigApplicationContext 注册 AppContext 类的两种方法</strong></h2><ol><li>配置类的注册方式是将其传递给 <code>AnnotationConfigApplicationContext</code> 构造函数</li></ol><p><img src="https://unpkg.com/serms-assets@1.0.11/Spring/image-20220407232200976.png" alt="" /></p><ol start="2"><li><code>AnnotationConfigApplicationContext</code> 的<code>register</code> 方法传入配置类来注册配置类</li></ol><p><img src="https://unpkg.com/serms-assets@1.0.11/Spring/image-20220407232908741.png" alt="" /></p><h2 id="configuation-总结"><a class="markdownIt-Anchor" href="#configuation-总结"></a> @Configuation 总结</h2><p>@Configuation 等价于<code>&lt;Beans&gt;&lt;/Beans&gt;</code></p><p>@Bean 等价于<code>&lt;Bean&gt;&lt;/Bean&gt;</code></p><p>@ComponentScan 等价于<code>&lt;context:component-scan base-package=&quot;com.ms.demo&quot;/&gt;</code></p>]]></content>
      
      
      <categories>
          
          <category> Spring </category>
          
          <category> Spring注解 </category>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Spring </tag>
            
            <tag> Spring注解 </tag>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Spring全家桶注解解析(持续跟新ing~)</title>
      <link href="/posts/3d190b4f/"/>
      <url>/posts/3d190b4f/</url>
      
        <content type="html"><![CDATA[<div class="tip home"><p>在探究注解前先了解一下注解,何为注解？注解本质上就是一个类，开发中我们可以使用注解 取代 <a href="https://so.csdn.net/so/search?q=xml&amp;spm=1001.2101.3001.7020">xml</a>配置文件。</p></div><p><strong>注意:在使用注解开发时,请查看对应的框架是否需要开启注解支持,否则用了注解也无效!!!</strong></p><h2 id="ioc-容器相关"><a class="markdownIt-Anchor" href="#ioc-容器相关"></a> IOC 容器相关</h2><h3 id="componen"><a class="markdownIt-Anchor" href="#componen"></a> @Componen:</h3><details class="folding-tag" yellow><summary> @Component注解 </summary>              <div class='content'>              <blockquote><p><code>@component(value)</code>:用于创建对象的,作用于类.</p><p><code>value</code>：指定 bean 的 id。如果不指定 value 属性，默认 bean 的 id 是当前类的类名。首字母小写。</p><p><code>@component</code>是 spring 中的一个注解，它的作用就是实现 bean 的注入,代替了传统的 xml 方式注入 bean</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//@Component组件 等价于:&lt;bean id=&quot;user&quot; class=&quot;com.ms.pojo.User&quot;/&gt;</span></span><br><span class="line"><span class="comment">//也说明这个类被Spring接管了,注册到了容器中</span></span><br><span class="line"><span class="meta">@Component(&quot;user&quot;)</span><span class="comment">//(&quot;user&quot;)其实就是Bean id</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">   这里省略代码.....</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></blockquote><p>在 web 开发中，会按照 MVC 三层架构分层！提供 3 个<code>@Component</code>注解衍生注解（功能一样）来取代,其实就是更加语义化</p><div class="tabs" id=""><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#-1">controller注解</button></li><li class="tab"><button type="button" data-href="#-2">service注解</button></li><li class="tab"><button type="button" data-href="#-3">repository注解</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="-1"><p>@controller 控制器（表现层注解）<br />用于标注控制层，相当于 MVC 层中的 web 层</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller(&quot;userCotroller&quot;)</span><span class="comment">//value相当于Bean中的id</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserController</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="-2"><p>@service 服务（业务层注解）<br />用于标注服务层，主要用来进行业务的逻辑处理,相当于 MVC 层中的 service 层</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service(&quot;userService&quot;)</span><span class="comment">//value相当于Bean中的id</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="-3"><p>@repository（持久层注解）<br />用于标注数据访问层，也可以说用于标注数据访问组件，即 DAO 组件,相当于 MVC 层中的 dao 层</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Repository(&quot;userDao&quot;)</span> <span class="comment">//value相当于Bean中的id</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserDao</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><blockquote><p>总结:</p><p>@Component 用于把当前方法的返回值作为 bean 对象存入 spring 的 ioc 容器中<br />属性: value:用于指定 bean 的 id。当不写时，默认值是当前方法的名称<br />细节：当我们使用注解配置方法时，如果方法有参数，spring 框架会去容器中查找有没有可用的 bean 对象。<br />查找的方式和 Autowired 注解的作用是一样的</p></blockquote>              </div>            </details><h2 id="用于注入数据"><a class="markdownIt-Anchor" href="#用于注入数据"></a> <strong>用于注入数据</strong></h2><h3 id="autowiredqualifierresourcevalue"><a class="markdownIt-Anchor" href="#autowiredqualifierresourcevalue"></a> @Autowired&amp;@Qualifier&amp;@Resource&amp;@Value</h3><details class="folding-tag" cyan><summary> @Autowired&@Qualifier&@Resource&@Value </summary>              <div class='content'>              <div class="tabs" id=""><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#-1">Autowired注解</button></li><li class="tab"><button type="button" data-href="#-2">Qualifier注解</button></li><li class="tab"><button type="button" data-href="#-3">Resource注解</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="-1"><div class="tag link"><a class="link-card" title="Autowired 注解使用" href="https://serms.top/post/7047b0e7/"><div class="left"><img src="https://serms.top/img/favicon.png"/></div><div class="right"><p class="text">Autowired 注解使用</p><p class="url">https://serms.top/post/7047b0e7/</p></div></a></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="-2"><p>这是官方的介绍:</p><blockquote><p>This annotation may be used on a field or parameter as a qualifier for<br />candidate beans when autowiring. It may also be used to annotate other<br />custom annotations that can then in turn be used as qualifiers.</p></blockquote><p>简单的理解就是：<br />（1）在使用@Autowire 自动注入的时候，加上<code>@Qualifier(“test”)</code>可以指定注入哪个对象；<br />（2）可以作为筛选的限定符，我们在做自定义注解时可以在其定义上增加@Qualifier，用来筛选需要的对象。这个理解看下面的代码吧，不好解释。</p><p><strong>功能介绍</strong></p><ol><li><p><strong>首先是对（1）的理解。</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//我们定义了两个TestClass对象，分别是testClass1和testClass2</span></span><br><span class="line"><span class="comment">//我们如果在另外一个对象中直接使用@Autowire去注入的话，spring肯定不知道使用哪个对象</span></span><br><span class="line"><span class="comment">//会排除异常 required a single bean, but 2 were found</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestConfiguration</span> &#123;</span><br><span class="line">    <span class="meta">@Bean(&quot;testClass1&quot;)</span></span><br><span class="line">    TestClass <span class="title function_">testClass1</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">TestClass</span>(<span class="string">&quot;TestClass1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Bean(&quot;testClass2&quot;)</span></span><br><span class="line">    TestClass <span class="title function_">testClass2</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">TestClass</span>(<span class="string">&quot;TestClass2&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>下面是正常的引用</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//此时这两个注解的连用就类似 @Resource(name=&quot;testClass1&quot;)</span></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="meta">@Qualifier(&quot;testClass1&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> TestClass testClass;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">test</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> testClassList;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>@Autowired 和@Qualifier 这两个注解的连用在这个位置就类似 @Resource(name=“testClass1”)</p></li><li><p><strong>对(2)的理解</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestConfiguration</span> &#123;</span><br><span class="line">    <span class="comment">//我们调整下在testClass1上增加@Qualifier注解</span></span><br><span class="line">    <span class="meta">@Qualifier</span></span><br><span class="line">    <span class="meta">@Bean(&quot;testClass1&quot;)</span></span><br><span class="line">    TestClass <span class="title function_">testClass1</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">TestClass</span>(<span class="string">&quot;TestClass1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean(&quot;testClass2&quot;)</span></span><br><span class="line">    TestClass <span class="title function_">testClass2</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">TestClass</span>(<span class="string">&quot;TestClass2&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestController</span> &#123;</span><br><span class="line">    <span class="comment">//我们这里使用一个list去接收testClass的对象</span></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    List&lt;TestClass&gt; testClassList= Collections.emptyList();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/test&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">test</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> testClassList;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>我们调用得到的结果是</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">     &#123;</span><br><span class="line">        &quot;name&quot;: &quot;TestClass1&quot;</span><br><span class="line">     &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">       &quot;name&quot;: &quot;TestClass2&quot;</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>我们可以看到所有的 testclass 都获取到了。接下来我们修改下代码</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Qualifier</span> <span class="comment">//我们在这增加注解</span></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    List&lt;TestClass&gt; testClassList= Collections.emptyList();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/test&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">test</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> testClassList;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>和上面代码对比就是在接收参数上增加了@Qualifier 注解，这样看是有什么区别，我们调用下，结果如下：</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">     &#123;</span><br><span class="line">        &quot;name&quot;: &quot;TestClass1&quot;</span><br><span class="line">     &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>返回结果只剩下增加了@Qualifier 注解的 TestClass 对象，这样我们就可以理解官方说的标记筛选是什么意思了。<br />另外，@Qualifier 注解是可以指定 value 的，这样我们可以通过 values 来分类筛选想要的对象了，这里不列举代码了~</p></li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="-3"><p>@Resource 用法与<code>@Autowired</code>用法 用法相似，也是做依赖注的，从容器中自动获取 bean。但还是有一定的区别。</p><ul><li>在启动 spring 的时候，首先要启动容器；</li><li>启动 spring 容器时，会默认寻找容器扫描范围内的可加载 bean，然后查找哪些 bean 上的属性和方法上有@Resource 注解；</li><li>找到@Resource 注解后，判断@Resource 注解括号中的 name 属性是否为空，如果为空：看 spring 容器中的 bean 的 id 与@Resource 要注解的那个变量属性名是否相同，如相同，匹配成功；如果不相同，看 spring 容器中 bean 的 id 对应的类型是否与@Resource 要注解的那个变量属性对应的类型是否相等，若相等，匹配成功，若不相等，匹配失败。</li><li>如果@Resource 注解括号中的 name 属性不为空，看 name 的属性值和容器中的 bean 的 id 名是否相等，如相等，则匹配成功；如不相等，则匹配失败。<br />示例如下：</li></ul><p><strong>@Resource 注解注解的 name 属性不为空</strong></p><p><strong>首先创建 Person 类，并纳入容器中管理：</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lzj.springboot.resource;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*纳入容器中后，bean的id名字为ps*/</span></span><br><span class="line"><span class="meta">@Component(value=&quot;ps&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">say</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;------say()------&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>然后创建 Man 类，类中的属性依赖 Person 类型的 bean</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lzj.springboot.resource;</span><br><span class="line"><span class="keyword">import</span> javax.annotation.Resource;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Man</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*从容器中取id名字为ps的bean，如果找不到该bean，spring启动过程中就会报错，表示把Man类型的bean注入到容器中不成功，因为person的属性依赖注入的时候就出错了，所以创建Man的bean的时候肯定不成功。*/</span></span><br><span class="line">    <span class="meta">@Resource(name=&quot;ps&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Person person;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*依赖注入失败，因为Person类型注入到容器中的bean的id指定为ps,所以从容器中获取id为person的bean就会失败*/</span></span><br><span class="line">    <span class="comment">//  @Resource(name=&quot;person&quot;)</span></span><br><span class="line">    <span class="comment">//  private Person ps;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">work</span><span class="params">()</span>&#123;</span><br><span class="line">        person.say();</span><br><span class="line">        System.out.println(<span class="string">&quot;------work()------&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>启动类为：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication(scanBasePackages=&quot;com.lzj.springboot&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">SpringApplication</span> <span class="variable">app</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SpringApplication</span>(App.class);</span><br><span class="line">        <span class="type">ConfigurableApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> app.run(args);</span><br><span class="line">        <span class="comment">/*从容器中获取Man类型的bean，如果Man类型的bean注入到容器成功，此时就能获取到；如果注入不成功，则获取不到。注入不成功，就会有可能是Man中的@Resource注解的依赖注入没有成功*/</span></span><br><span class="line">        context.getBean(Man.class).work();</span><br><span class="line">        context.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>启动工程，输出如下：</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">------say()------</span><br><span class="line">------work()------</span><br></pre></td></tr></table></figure><p><strong>@Resource 注解注解的 name 属性为空</strong></p><p><strong>1、@Resource 要注解的那个变量属性与容器中的 bean 的 id 的名字相等</strong><br />启动类和 Person 的类与相面一样，下面直接修改 Man 类如下：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Man</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*@Resource注解的属性变量ps与容器中的bean的id名字ps相等，可以匹配*/</span></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> Person ps;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">work</span><span class="params">()</span>&#123;</span><br><span class="line">        ps.say();</span><br><span class="line">        System.out.println(<span class="string">&quot;------work()------&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>2、@Resource 要注解的那个变量属性与容器中的 bean 的 id 的名字不相等<br />启动类和 Person 的类与相面一样，下面直接修改 Man 类如下：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Man</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*@Resource注解的属性变量ps与容器中的bean的id名字ps不相等，然后通过bean的类型判断：person变量属性的类型为Person类，容器中的id为ps的bean的类型也为Person类型，因此此种情况下也可以匹配*/</span></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> Person person;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">work</span><span class="params">()</span>&#123;</span><br><span class="line">        person.say();</span><br><span class="line">        System.out.println(<span class="string">&quot;------work()------&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>              </div>            </details><h2 id="配置类相关"><a class="markdownIt-Anchor" href="#配置类相关"></a> <strong>配置类相关</strong></h2><h3 id="configuration"><a class="markdownIt-Anchor" href="#configuration"></a> @Configuration:</h3><details class="folding-tag" cyan><summary> @Configuration注解 </summary>              <div class='content'>              <p>作用：用于指定当前类是一个 spring 配置类， 当创建容器时会从该类上加载注解。 获取容器时需要使用<br /><code>AnnotationApplicationContext</code>(有<code>@Configuration</code> 注解的类.class)<br />细节:当配置类作为<code>AnnotationConfigApplicationContext</code>对象创建的参数时，该注解可以不写。</p><details class="folding-tag" blue><summary> 建议看一下这个 </summary>              <div class='content'>              <div class="tag link"><a class="link-card" title="Configuration注解使用" href="https://serms.top/post/1d0508a6/"><div class="left"><img src="https://serms.top/img/favicon.png"/></div><div class="right"><p class="text">Configuration注解使用</p><p class="url">https://serms.top/post/1d0508a6/</p></div></a></div><p>在使用@Bean 注解的时候必须配合@Configuration 来使用: <strong><a href="https://blog.csdn.net/qq_41907991/article/details/106008651?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522164933918316782092931312%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=164933918316782092931312&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-106008651.142%5Ev7%5Econtrol,157%5Ev4%5Econtrol&amp;utm_term=%40Configuration&amp;spm=1018.2226.3001.4187">原因</a></strong></p>              </div>            </details>              </div>            </details><p>未学习的注解:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Import(&#123;User.class, ByteArrayUtil.class&#125;)</span></span><br><span class="line"><span class="meta">@Configuration(proxyBeanMethods = true)</span> <span class="comment">//告诉Spring这是一个配置类 === 配置文件</span></span><br><span class="line"><span class="comment">//@ConditionalOnBean(name = &quot;tom&quot;)    //条件注解 有某个组件才注入容器</span></span><br><span class="line"><span class="meta">@ConditionalOnMissingBean(name = &quot;tom&quot;)</span>   <span class="comment">//条件注解 没有某个组件才注入容器</span></span><br><span class="line"><span class="meta">@ImportResource(&quot;classpath:beans.xml&quot;)</span></span><br><span class="line"><span class="comment">//1. 开启Car配置绑定功能</span></span><br><span class="line"><span class="meta">@EnableConfigurationProperties(&#123;Car.class&#125;)</span></span><br><span class="line"><span class="comment">//2, 把这个Car这个组件自动注册到容器中</span></span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="meta">@ConfigurationProperties(prefix = &quot;mycar&quot;)</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"> <span class="meta">@RequestMapping(&quot;/car&quot;)</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Spring </category>
          
          <category> Spring注解 </category>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Spring </tag>
            
            <tag> Spring注解 </tag>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Idea中Maven项目添加web模块</title>
      <link href="/posts/3208ee03/"/>
      <url>/posts/3208ee03/</url>
      
        <content type="html"><![CDATA[<h2 id="教程步骤"><a class="markdownIt-Anchor" href="#教程步骤"></a> 教程步骤</h2><details class="folding-tag" cyan open><summary> 点击查看教程 </summary>              <div class='content'>              <p>1.首先创建一个 Maven 项目，一路 next，起下项目名字</p><p><img src="https://unpkg.com/serms-assets@1.0.7/maven/image-20220403171155529.png" alt="" /></p><p>2.建好之后就是这个样子</p><p><img src="https://unpkg.com/serms-assets@1.0.7/maven/image-20220403171554797.png" alt="" /></p><p>3.然后右键项目找到 open modules setting (打开模块设置) 或者快捷键 ctrl+shift +alt+s 或者右上角有个类似文件夹的图标</p><p><img src="https://unpkg.com/serms-assets@1.0.7/maven/image-20220403171742797.png" alt="" /></p><p>4.打开以后点 Modules 点项目名点 add 找到 web</p><p><img src="https://unpkg.com/serms-assets@1.0.7/maven/image-20220403172017430.png" alt="" /></p><p>5.然后修改 web.xml 和 web 资源目录的路径</p><div class="tip warning faa-horizontal animated"><p>注意:路径修改如果你不懂就放我写的路径:<wavy>项目名\src\main\webapp\ …</wavy></p></div><p><img src="https://unpkg.com/serms-assets@1.0.7/maven/image-20220403172956018.png" alt="" /></p><p>xml 和资源路径应该放在同一个 webapp 下面</p><p><img src="https://unpkg.com/serms-assets@1.0.7/maven/image-20220403173108342.png" alt="" /></p><div class="tip warning faa-horizontal animated"><p>注意:修改完后点击确定,他会提示你说没有 webapp 这个项目是否创建,点击创建即可</p></div><p>创建完成的样子:</p><p><img src="https://unpkg.com/serms-assets@1.0.7/maven/image-20220403174021409.png" alt="" /></p><p>6.创建 Web application Exploded</p><p>依然还是打开模块设置&gt;选择模块&gt;点击刚刚创建好的 web 目录,如果下面有黄色三角感叹号的提示的话,咱们可以直接点击右侧的创建</p><p><img src="https://unpkg.com/serms-assets@1.0.7/maven/image-20220403174050465.png" alt="" /></p><p>如果没有的话: 点击 artifacts 点+号 选择 Web application Exploded，From Modules 选择项目。</p><p><img src="https://unpkg.com/serms-assets@1.0.7/maven/image-20220403174353863.png" alt="" /></p><p>之后即可点击应用和确定就行</p><p><img src="https://unpkg.com/serms-assets@1.0.7/maven/image-20220403174445834.png" alt="" /></p><p>7.然后添加一个 tomcat 点 fix 选择刚才新建的 artifacts</p><p><img src="https://unpkg.com/serms-assets@1.0.7/maven/image-20220403174606202.png" alt="" /></p><p><img src="https://unpkg.com/serms-assets@1.0.7/maven/image-20220403174704803.png" alt="" /></p><p>8.修改 Application context 为项目名 就完成了 去新建一个 html 页面访问一下,这里就完成了 web 模块的添加</p><p><img src="https://unpkg.com/serms-assets@1.0.7/maven/image-20220403174937843.png" alt="" /></p>              </div>            </details>]]></content>
      
      
      <categories>
          
          <category> Maven </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Maven </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>启动Tomcat出现乱码</title>
      <link href="/posts/3a723147/"/>
      <url>/posts/3a723147/</url>
      
        <content type="html"><![CDATA[<p>启动 Tomcat 的时候老出现这种<span class='p red'>淇℃伅</span>乱码问题<img no-lazy class="inline" src="https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fc-ssl.duitang.com%2Fuploads%2Fitem%2F201608%2F02%2F20160802214728_Nhytn.thumb.400_0.jpeg&refer=http%3A%2F%2Fc-ssl.duitang.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=auto?sec=1651217931&t=4a196c48ab42a6eb60cefb363f37418b" style="height:80px;"/></p><p>虽然不碍事,但是看着乱码就烦,也许是我强迫症犯了:</p><p><img src="https://unpkg.com/serms-assets@1.0.6/Tomcat/image-20220330152805998.png" alt="" /></p><h2 id="解决方案如下"><a class="markdownIt-Anchor" href="#解决方案如下"></a> 解决方案如下</h2><div class="tip success"><p>找到 tomcat 安装目录下的<span class='p red'>conf/logging.properties</span>文件夹 修改<span class='p red'>logging.properties</span> 文件</p></div><p><img src="https://unpkg.com/serms-assets@1.0.6/Tomcat/image-20220330153004409.png" alt="" /></p><div class="tip success"><p>将 java.util.logging.ConsoleHandler.encoding = <span class='p red'>utf-8</span><br />更改为 java.util.logging.ConsoleHandler.encoding = <span class='p red'>GBK</span></p></div><p><img src="https://unpkg.com/serms-assets@1.0.6/Tomcat/image-20220330152553962.png" alt="" /></p><blockquote><p>修改之后的运行结果:</p></blockquote><p><img src="https://unpkg.com/serms-assets@1.0.6/Tomcat/image-20220330153216427.png" alt="" /></p><blockquote><p>完满解决~~~</p><p>觉得有用的话,给小弟打赏一下~</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Tomcat </category>
          
      </categories>
      
      
        <tags>
            
            <tag> idea </tag>
            
            <tag> Tomcat乱码 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SpringMVC学习笔记</title>
      <link href="/posts/319c21eb/"/>
      <url>/posts/319c21eb/</url>
      
        <content type="html"><![CDATA[<details class="folding-tag" cyan><summary> 更新记录 </summary>              <div class='content'>              <div class="note blue icon modern"><i class="note-icon fas fa-bullhorn"></i><p>本人站长也正在学习当中,如果有纠错以及意见可以在下方评论区留言,我会尽快回复您,感谢您对本站的支持</p></div><div class="timeline blue"><div class='timeline-item headline'><div class='timeline-item-title'><div class='item-circle'><p>2022</p></div></div></div><div class='timeline-item'><div class='timeline-item-title'><div class='item-circle'><p>2022-04-04</p></div></div><div class='timeline-item-content'><ol><li>板块做了相应的优化</li><li>补充了一些图片和一些代码</li></ol></div></div><div class='timeline-item'><div class='timeline-item-title'><div class='item-circle'><p>2022-03-30</p></div></div><div class='timeline-item-content'><p>文章发布</p></div></div></div>              </div>            </details><details class="folding-tag" blue><summary> 参考教程 </summary>              <div class='content'>              <p><strong>注解类</strong></p><table><thead><tr><th style="text-align:center">注解名称</th><th style="text-align:center">教程贴</th></tr></thead><tbody><tr><td style="text-align:center">@Controller 注解</td><td style="text-align:center"><a href="https://www.cnblogs.com/hualishu/p/7398881.html">教程</a></td></tr></tbody></table><p><strong>其他</strong></p><table><thead><tr><th style="text-align:center">参考方向</th><th style="text-align:center">教程贴</th></tr></thead><tbody><tr><td style="text-align:center">转发和重定向的区别和使用</td><td style="text-align:center"><a href="https://blog.csdn.net/weixin_40001125/article/details/88663468">教程</a></td></tr></tbody></table>              </div>            </details><h1 id="springmvc-简介"><a class="markdownIt-Anchor" href="#springmvc-简介"></a> SpringMVC 简介</h1><details class="folding-tag" cyan><summary> 什么是MVC </summary>              <div class='content'>              <p>MVC 是一种软件架构的思想，将软件按照模型、视图、控制器来划分</p><p>M：Model，模型层，指工程中的 JavaBean，作用是处理数据</p><p>JavaBean 分为两类：</p><ul><li>一类称为实体类 Bean：专门存储业务数据的，如 Student、User 等</li><li>一类称为业务处理 Bean：指 Service 或 Dao 对象，专门用于处理业务逻辑和数据访问。</li></ul><p>V：View，视图层，指工程中的 html 或 jsp 等页面，作用是与用户进行交互，展示数据</p><p>C：Controller，控制层，指工程中的 servlet，作用是接收请求和响应浏览器</p><p>MVC 的工作流程：<br />用户通过视图层发送请求到服务器，在服务器中请求被 Controller 接收，Controller 调用相应的 Model 层处理请求，处理完毕将结果返回到 Controller，Controller 再根据请求处理的结果找到相应的 View 视图，渲染数据后最终响应给浏览器</p><div class="tip warning"><p>注：三层架构分为表述层（或表示层）、业务逻辑层、数据访问层，表述层表示前台页面和后台 servlet</p></div>              </div>            </details><details class="folding-tag" cyan><summary> 什么是SpringMVC </summary>              <div class='content'>              <p>SpringMVC 是 Spring 的一个后续产品，是 Spring 的一个子项目</p><p>SpringMVC 是 Spring 为表述层开发提供的一整套完备的解决方案。在表述层框架历经 Strust、WebWork、Strust2 等诸多产品的历代更迭之后，目前业界普遍选择了 SpringMVC 作为 Java EE 项目表述层开发的<strong>首选方案</strong>。</p>              </div>            </details><details class="folding-tag" cyan><summary> SpringMVC的特点 </summary>              <div class='content'>              <ul><li><strong>Spring 家族原生产品</strong>，与 IOC 容器等基础设施无缝对接</li><li><strong>基于原生的 Servlet</strong>，通过了功能强大的<strong>前端控制器 DispatcherServlet</strong>，对请求和响应进行统一处理</li><li>表述层各细分领域需要解决的问题<strong>全方位覆盖</strong>，提供<strong>全面解决方案</strong></li><li><strong>代码清新简洁</strong>，大幅度提升开发效率</li><li>内部组件化程度高，可插拔式组件<strong>即插即用</strong>，想要什么功能配置相应组件即可</li><li><strong>性能卓著</strong>，尤其适合现代大型、超大型互联网项目要求</li></ul>              </div>            </details><h3 id="spring-网站链接"><a class="markdownIt-Anchor" href="#spring-网站链接"></a> Spring 网站链接</h3><div class="tabs" id=""><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#-1">Spring官网</button></li><li class="tab"><button type="button" data-href="#-2">SpringMVC文档</button></li><li class="tab"><button type="button" data-href="#-3">Thymeleaf官网</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="-1"><div class="tag link"><a class="link-card" title="Spring.io" href="https://spring.io/"><div class="left"><img src="https://spring.io/images/favicon-9d25009f65637a49ac8d91eb1cf7b75e.ico"/></div><div class="right"><p class="text">Spring.io</p><p class="url">https://spring.io/</p></div></a></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="-2"><div class="tag link"><a class="link-card" title="SpringMVC" href="https://docs.spring.io/spring-framework/docs/current/reference/html/web.html#spring-web"><div class="left"><img src="https://spring.io/images/favicon-9d25009f65637a49ac8d91eb1cf7b75e.ico"/></div><div class="right"><p class="text">SpringMVC</p><p class="url">https://docs.spring.io/spring-framework/docs/current/reference/html/web.html#spring-web</p></div></a></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="-3"><div class="tag link"><a class="link-card" title="Thymeleaf" href="https://www.thymeleaf.org/"><div class="left"><img src="https://www.thymeleaf.org/images/thymeleaf.png"/></div><div class="right"><p class="text">Thymeleaf</p><p class="url">https://www.thymeleaf.org/</p></div></a></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h1 id="创建-mvc-项目及编写-helloworld"><a class="markdownIt-Anchor" href="#创建-mvc-项目及编写-helloworld"></a> 创建 MVC 项目及编写 HelloWorld</h1><details class="folding-tag" blue><summary> 开发环境 </summary>              <div class='content'>              <p><object class="ghbdage" style="margin-inline:5px" title="" standby="loading..." data="https://img.shields.io/badge/Idea%20Ultimate%20Edition-2021.3.2-orange?logo=IntelliJ IDEA&color=brightgreen&link=https://www.jetbrains.com/idea/&style=social&logoWidth=20"></object><br></p><p><object class="ghbdage" style="margin-inline:5px" title="" standby="loading..." data="https://img.shields.io/badge/maven3.8.1-%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7-orange?logo=Apache Maven&color=brightgreen&link=https://maven.apache.org/docs/3.8.1/release-notes.html&style=social&logoWidth=20"></object><br></p><p><object class="ghbdage" style="margin-inline:5px" title="" standby="loading..." data="https://img.shields.io/badge/tomcat9-%E6%9C%8D%E5%8A%A1%E5%99%A8-orange?logo=Apache Tomcat&color=yellow&link=https://tomcat.apache.org/download-90.cgi&style=social&logoWidth=20"></object><br></p><p><object class="ghbdage" style="margin-inline:5px" title="" standby="loading..." data="https://img.shields.io/badge/Spring-%E7%89%88%E6%9C%AC:3.0.1-orange?logo=Spring&color=yellow&link=https://spring.io/projects/spring-framework&style=social&logoWidth=20"></object><br></p>              </div>            </details><details class="folding-tag" green open><summary> 创建maven工程 & 配置SpringMVC </summary>              <div class='content'>              <p>1.创建 Maven 工程(简单的一匹,不会的话自行百度~)</p><p>2.给创建好的 Maven 项目添加 web 模块</p><div class="tag link"><a class="link-card" title="Idea中Maven项目添加web 模块" href="https://serms.top/post/3208ee03/"><div class="left"><img src="https://serms.top/img/favicon.png"/></div><div class="right"><p class="text">Idea中Maven项目添加web 模块</p><p class="url">https://serms.top/post/3208ee03/</p></div></a></div><p>3.配置<kbd>pom.xml</kbd>文件打包方式：war 和引入依赖</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 设置打包方式 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">packaging</span>&gt;</span>war<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- SpringMVC --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-webmvc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.3.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 日志 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>ch.qos.logback<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>logback-classic<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- ServletAPI --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax.servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.1.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Spring5和Thymeleaf整合包 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.thymeleaf<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>thymeleaf-spring5<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.0.12.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><p>编写好的 pom.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.hgm<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springMVC-demo1<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">packaging</span>&gt;</span>war<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- SpringMVC --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-webmvc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.3.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- 日志 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>ch.qos.logback<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>logback-classic<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- ServletAPI --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax.servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.1.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- Spring5和Thymeleaf整合包 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.thymeleaf<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>thymeleaf-spring5<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.0.12.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>8<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>8<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure><div class="tip warning"><p>注：由于 Maven 的传递性，我们不必将所有需要的包全部配置依赖，而是配置最顶端的依赖，其他靠传递性导入。</p><p><img src="https://unpkg.com/serms-assets@1.0.6/Spring/img001.png" alt="" /></p></div><p>4.配置 web.xml</p><p>注册 SpringMVC 的前端控制器 DispatcherServlet</p><p>打开 web.xml</p><p><img src="https://unpkg.com/serms-assets@1.0.9/Spring/image-20220403225805963.png" alt="" /></p><div class="tabs" id=""><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#-1">默认配置方式</button></li><li class="tab"><button type="button" data-href="#-2">扩展配置方式</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="-1"><p>此配置作用下，SpringMVC 的配置文件默认位于 WEB-INF 下，默认名称为&lt;servlet-name&gt;-servlet.xml，例如，以下配置所对应 SpringMVC 的配置文件位于 WEB-INF 下，文件名为 springMVC-servlet.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 配置SpringMVC的前端控制器，对浏览器发送的请求统一进行处理 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springMVC<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springMVC<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">        设置springMVC的核心控制器所能处理的请求的请求路径</span></span><br><span class="line"><span class="comment">        /所匹配的请求可以是/login或.html或.js或.css方式的请求路径</span></span><br><span class="line"><span class="comment">        但是/不能匹配.jsp请求路径的请求</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure><div class="tip warning"><p>注：</p><p>&lt;url-pattern&gt;标签中使用/和/*的区别：</p><p>/所匹配的请求可以是/login 或.html 或.js 或.css 方式的请求路径，但是/不能匹配.jsp 请求路径的请求</p><p>因此就可以避免在访问 jsp 页面时，该请求被 DispatcherServlet 处理，从而找不到相应的页面</p><p>/*则能够匹配所有请求，例如在使用过滤器时，若需要对所有请求进行过滤，就需要使用/*的写法</p></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="-2"><p><strong>可通过 init-param 标签设置 SpringMVC 配置文件的位置和名称，通过 load-on-startup 标签设置 SpringMVC 前端控制器 DispatcherServlet 的初始化时间</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 配置SpringMVC的前端控制器，对浏览器发送的请求统一进行处理 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springMVC<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 通过初始化参数指定SpringMVC配置文件的位置和名称 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- contextConfigLocation为固定值 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 使用classpath:表示从类路径查找配置文件，例如maven工程中的src/main/resources --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:springMVC.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment"> 作为框架的核心组件，在启动过程中有大量的初始化操作要做</span></span><br><span class="line"><span class="comment">而这些操作放在第一次请求时才执行会严重影响访问速度</span></span><br><span class="line"><span class="comment">因此需要通过此标签将启动控制DispatcherServlet的初始化时间提前到服务器启动时</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>1<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springMVC<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">        设置springMVC的核心控制器所能处理的请求的请求路径</span></span><br><span class="line"><span class="comment">        /所匹配的请求可以是/login或.html或.js或.css方式的请求路径</span></span><br><span class="line"><span class="comment">        但是/不能匹配.jsp请求路径的请求</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure><div class="tip warning"><p>注：</p><p><code>&lt;url-pattern&gt;</code>标签中使用/和/*的区别：</p><p>/所匹配的请求可以是/login 或.html 或.js 或.css 方式的请求路径，但是/不能匹配.jsp 请求路径的请求</p><p>因此就可以避免在访问 jsp 页面时，该请求被 DispatcherServlet 处理，从而找不到相应的页面</p><p>/*则能够匹配所有请求，例如在使用过滤器时，若需要对所有请求进行过滤，就需要使用/*的写法</p></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>配置好的 web.xml 为:</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">version</span>=<span class="string">&quot;4.0&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--配置SpringMVC的前端控制器,对浏览器发送的请求进行统一处理--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>SpringMVC<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--初始化参数 配置SpringMVC配置文件的位置和名称--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:springMVC.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--将前端控制器DispatcherServlet的初始化时间提前到服务器启动时--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>1<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>SpringMVC<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure><p>5.创建 springMVC 的配置文件</p><blockquote><p>在<wavy>resources</wavy>文件夹下创建名为 : <wavy>springMVC.xml</wavy>文件</p><p><img src="https://unpkg.com/serms-assets@1.0.10/Spring/image-20220403230416170.png" alt="" /></p><p>写入一下配置文件</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 自动扫描包 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.atguigu.mvc.controller&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 配置Thymeleaf视图解析器 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;viewResolver&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.thymeleaf.spring5.view.ThymeleafViewResolver&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;order&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;characterEncoding&quot;</span> <span class="attr">value</span>=<span class="string">&quot;UTF-8&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;templateEngine&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.thymeleaf.spring5.SpringTemplateEngine&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;templateResolver&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.thymeleaf.spring5.templateresolver.SpringResourceTemplateResolver&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                    <span class="comment">&lt;!-- 视图前缀 --&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;prefix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;/WEB-INF/templates/&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">                    <span class="comment">&lt;!-- 视图后缀 --&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;suffix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;.html&quot;</span>/&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;templateMode&quot;</span> <span class="attr">value</span>=<span class="string">&quot;HTML5&quot;</span>/&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;characterEncoding&quot;</span> <span class="attr">value</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">  这里引入可能会报错,可以先删掉,后续将会讲解此处的作用</span></span><br><span class="line"><span class="comment">   处理静态资源，例如html、js、css、jpg</span></span><br><span class="line"><span class="comment">  若只设置该标签，则只能访问静态资源，其他请求则无法访问</span></span><br><span class="line"><span class="comment">  此时必须设置&lt;mvc:annotation-driven/&gt;解决问题</span></span><br><span class="line"><span class="comment"> --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:default-servlet-handler</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 开启mvc注解驱动 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:annotation-driven</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:message-converters</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 处理响应中文内容乱码 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.http.converter.StringHttpMessageConverter&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;defaultCharset&quot;</span> <span class="attr">value</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;supportedMediaTypes&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">value</span>&gt;</span>text/html<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">value</span>&gt;</span>application/json<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mvc:message-converters</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mvc:annotation-driven</span>&gt;</span></span><br></pre></td></tr></table></figure><p>写好的 springMVC.xml 为:</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context https://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--扫描组件 自动扫描--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.atguigu.mvc.controller&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 配置Thymeleaf视图解析器 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;viewResolver&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.thymeleaf.spring5.view.ThymeleafViewResolver&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--设置视图解析器优先级--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;order&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--视图解析器编码--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;characterEncoding&quot;</span> <span class="attr">value</span>=<span class="string">&quot;UTF-8&quot;</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--视图解析器模板--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;templateEngine&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--内部Bean给templateEngine赋值--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.thymeleaf.spring5.SpringTemplateEngine&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;templateResolver&quot;</span>&gt;</span></span><br><span class="line">                    <span class="comment">&lt;!--内部Bean给templateResolver赋值--&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.thymeleaf.spring5.templateresolver.SpringResourceTemplateResolver&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                        <span class="comment">&lt;!-- 视图前缀 --&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;prefix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;/WEB-INF/templates/&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">                        <span class="comment">&lt;!-- 视图后缀 --&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;suffix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;.html&quot;</span>/&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;templateMode&quot;</span> <span class="attr">value</span>=<span class="string">&quot;HTML5&quot;</span>/&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;characterEncoding&quot;</span> <span class="attr">value</span>=<span class="string">&quot;UTF-8&quot;</span>/&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure></blockquote><p>6.创建请求控制器</p><blockquote><p>创建一个控制类(HelloController)并声明控制层注解@Controller</p></blockquote><p><img src="https://unpkg.com/serms-assets@1.0.9/Spring/image-20220403230247900.png" alt="" /></p><blockquote><p>由于前端控制器对浏览器发送的请求进行了统一的处理，但是具体的请求有不同的处理过程，因此需要创建处理具体请求的类，即请求控制器</p><p>请求控制器中每一个处理请求的方法成为控制器方法</p><p>因为 SpringMVC 的控制器由一个 POJO（普通的 Java 类）担任，因此需要通过@Controller 注解将其标识为一个控制层组件，交给 Spring 的 IoC 容器管理，此时 SpringMVC 才能够识别控制器的存在</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.mvc.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> SerMs</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2022/3/30 11:48</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span> <span class="comment">//控制器类 扫描控制层组件</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloController</span> &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" green open><summary> 测试HelloWorld </summary>              <div class='content'>              <p>在 WEB-INF 资源文件夹下面创建<wavy>templates</wavy>文件夹.并在此文件夹下创建<wavy>index.html</wavy>文件</p><div class="tip warning"><p>注:</p><p>因我们在<wavy>Thymeleaf视图解析器</wavy>中已经配置了<wavy>视图前缀</wavy>的 value 值为:value=&quot;/WEB-INF/templates/&quot;所以我们必须把静态文件创建在 WEB-INF 下的 templates 文件夹</p></div><p><img src="https://unpkg.com/serms-assets@1.0.9/Spring/image-20220403231346495.png" alt="" /></p><p>创建好之后在 index.html 写入代码</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>首页<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>首页<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><div class="tabs" id=""><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#-1">实现对首页的访问</button></li><li class="tab"><button type="button" data-href="#-2">通过超链接跳转到指定页面</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="-1"><p>在请求控制器(HelloController.java)中创建处理请求的方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// @RequestMapping注解：处理请求和控制器方法之间的映射关系</span></span><br><span class="line"><span class="comment">// @RequestMapping注解的value属性可以通过请求地址匹配请求，/表示的当前工程的上下文路径</span></span><br><span class="line"><span class="comment">// localhost:8080/springMVC/</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">index</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">//设置视图名称</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;index&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>写完之后的整个文件:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> SerMs</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2022/3/30 11:48</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span> <span class="comment">//控制器类 扫描控制层组件</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// RequestMapping注解==&gt;请求映射</span></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">index</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">//返回视图名称</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;index&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>运行 Tomcat 即可看到页面呈现 首页 字样</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="-2"><p>1.在主页 index.html 中设置超链接</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>首页<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>首页<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/hello&#125;&quot;</span>&gt;</span>HelloWorld<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>2.在 templates 下创建第二个 html 页面名为 target</p><p><img src="https://unpkg.com/serms-assets@1.0.9/Spring/image-20220403233628709.png" alt="" /></p><p>在里面写入:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    HelloWorld</span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>3.在请求控制器中创建处理请求的方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/hello&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">HelloWorld</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;target&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>写完后的控制层文件为:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> SerMs</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2022/3/30 11:48</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span> <span class="comment">//控制器类 扫描控制层组件</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// RequestMapping注解==&gt;请求映射</span></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">index</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">//返回视图名称</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;index&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/target&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toTarget</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;target&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><div class="tip success"><p>注:</p><p>此处的超链接中用到的 th:XXX 是 thymeleaf 的模板语法,而且必须在 html 标签内引入 xmlns 地址</p><p>一般写法为: th:href=&quot;@{值}&quot;</p></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><div class="tip home"><p>总结</p><p>浏览器发送请求，若请求地址符合前端控制器的 url-pattern，该请求就会被前端控制器 DispatcherServlet 处理。前端控制器会读取 SpringMVC 的核心配置文件，通过扫描组件找到控制器，将请求地址和控制器中@RequestMapping 注解的 value 属性值进行匹配，若匹配成功，该注解所标识的控制器方法就是处理请求的方法。处理请求的方法需要返回一个字符串类型的视图名称，该视图名称会被视图解析器解析，加上前缀和后缀组成视图的路径，通过 Thymeleaf 对视图进行渲染，最终转发到视图所对应页面</p></div>              </div>            </details><h1 id="requestmapping-注解"><a class="markdownIt-Anchor" href="#requestmapping-注解"></a> @RequestMapping 注解</h1><h3 id="requestmapping-注解的功能"><a class="markdownIt-Anchor" href="#requestmapping-注解的功能"></a> @RequestMapping 注解的功能</h3><p>从注解名称上我们可以看到，@RequestMapping 注解的作用就是将请求和处理请求的控制器方法关联起来，建立映射关系。</p><p>SpringMVC 接收到指定的请求，就会来找到在映射关系中对应的控制器方法来处理这个请求。</p><h3 id="requestmapping-注解的位置"><a class="markdownIt-Anchor" href="#requestmapping-注解的位置"></a> @RequestMapping 注解的位置</h3><p>@RequestMapping 标识一个类：设置映射请求的请求路径的初始信息</p><p>@RequestMapping 标识一个方法：设置映射请求请求路径的具体信息</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/test&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RequestMappingController</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">//此时请求映射所映射的请求的请求路径为：/test/testRequestMapping</span></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/testRequestMapping&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">testRequestMapping</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="requestmapping-注解的-value-属性"><a class="markdownIt-Anchor" href="#requestmapping-注解的-value-属性"></a> @RequestMapping 注解的 value 属性</h3><p>@RequestMapping 注解的 value 属性通过请求的请求地址匹配请求映射</p><p>@RequestMapping 注解的 value 属性是一个字符串类型的数组，表示该请求映射能够匹配多个请求地址所对应的请求</p><p>@RequestMapping 注解的 value 属性必须设置，至少通过请求地址匹配请求映射</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/testRequestMapping&#125;&quot;</span></span></span><br><span class="line"><span class="tag">  &gt;</span>测试@RequestMapping的value属性--&gt;/testRequestMapping&lt;/a</span><br><span class="line">&gt;<span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/test&#125;&quot;</span>&gt;</span>测试@RequestMapping的value属性--&gt;/test<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(</span></span><br><span class="line"><span class="meta">        value = &#123;&quot;/testRequestMapping&quot;, &quot;/test&quot;&#125;</span></span><br><span class="line"><span class="meta">)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">testRequestMapping</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="requestmapping-注解的-method-属性"><a class="markdownIt-Anchor" href="#requestmapping-注解的-method-属性"></a> @RequestMapping 注解的 method 属性</h3><p>@RequestMapping 注解的 method 属性通过请求的请求方式（get 或 post）匹配请求映射</p><p>@RequestMapping 注解的 method 属性是一个 RequestMethod 类型的数组，表示该请求映射能够匹配多种请求方式的请求</p><p>若当前请求的请求地址满足请求映射的 value 属性，但是请求方式不满足 method 属性，则浏览器报错 405：Request method ‘POST’ not supported</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/test&#125;&quot;</span>&gt;</span>测试@RequestMapping的value属性--&gt;/test<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">th:action</span>=<span class="string">&quot;@&#123;/test&#125;&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(</span></span><br><span class="line"><span class="meta">        value = &#123;&quot;/testRequestMapping&quot;, &quot;/test&quot;&#125;,</span></span><br><span class="line"><span class="meta">        method = &#123;RequestMethod.GET, RequestMethod.POST&#125;</span></span><br><span class="line"><span class="meta">)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">testRequestMapping</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>注：</p><p>1、对于处理指定请求方式的控制器方法，SpringMVC 中提供了@RequestMapping 的派生注解</p><p>处理 get 请求的映射–&gt;@GetMapping</p><p>处理 post 请求的映射–&gt;@PostMapping</p><p>处理 put 请求的映射–&gt;@PutMapping</p><p>处理 delete 请求的映射–&gt;@DeleteMapping</p><p>2、常用的请求方式有 get，post，put，delete</p><p>但是目前浏览器只支持 get 和 post，若在 form 表单提交时，为 method 设置了其他请求方式的字符串（put 或 delete），则按照默认的请求方式 get 处理</p><p>若要发送 put 和 delete 请求，则需要通过 spring 提供的过滤器 HiddenHttpMethodFilter，在 RESTful 部分会讲到</p></blockquote><h3 id="requestmapping-注解的-params-属性了解"><a class="markdownIt-Anchor" href="#requestmapping-注解的-params-属性了解"></a> @RequestMapping 注解的 params 属性（了解）</h3><p>@RequestMapping 注解的 params 属性通过请求的请求参数匹配请求映射</p><p>@RequestMapping 注解的 params 属性是一个字符串类型的数组，可以通过四种表达式设置请求参数和请求映射的匹配关系</p><p>“param”：要求请求映射所匹配的请求必须携带 param 请求参数</p><p>“!param”：要求请求映射所匹配的请求必须不能携带 param 请求参数</p><p>“param=value”：要求请求映射所匹配的请求必须携带 param 请求参数且 param=value</p><p>“param!=value”：要求请求映射所匹配的请求必须携带 param 请求参数但是 param!=value</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/test(username=&#x27;admin&#x27;,password=123456)&quot;</span></span></span><br><span class="line"><span class="tag">  &gt;</span>测试@RequestMapping的params属性--&gt;/test&lt;/a</span><br><span class="line">&gt;<span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(</span></span><br><span class="line"><span class="meta">        value = &#123;&quot;/testRequestMapping&quot;, &quot;/test&quot;&#125;</span></span><br><span class="line"><span class="meta">        ,method = &#123;RequestMethod.GET, RequestMethod.POST&#125;</span></span><br><span class="line"><span class="meta">        ,params = &#123;&quot;username&quot;,&quot;password!=123456&quot;&#125;</span></span><br><span class="line"><span class="meta">)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">testRequestMapping</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>注：</p><p>若当前请求满足@RequestMapping 注解的 value 和 method 属性，但是不满足 params 属性，此时页面回报错 400：Parameter conditions “username, password!=123456” not met for actual request parameters: username={admin}, password={123456}</p></blockquote><h3 id="requestmapping-注解的-headers-属性了解"><a class="markdownIt-Anchor" href="#requestmapping-注解的-headers-属性了解"></a> @RequestMapping 注解的 headers 属性（了解）</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(value = &quot;/testParamsAndHeders&quot;,</span></span><br><span class="line"><span class="meta">                headers = &#123;&quot;Host=localhost:8080&quot;&#125;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">testParamsAndHeders</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>@RequestMapping 注解的 headers 属性通过请求的请求头信息匹配请求映射</p><p>@RequestMapping 注解的 headers 属性是一个字符串类型的数组，可以通过四种表达式设置请求头信息和请求映射的匹配关系</p><p>“header”：要求请求映射所匹配的请求必须携带 header 请求头信息</p><p>“!header”：要求请求映射所匹配的请求必须不能携带 header 请求头信息</p><p>“header=value”：要求请求映射所匹配的请求必须携带 header 请求头信息且 header=value</p><p>“header!=value”：要求请求映射所匹配的请求必须携带 header 请求头信息且 header!=value</p><p>若当前请求满足@RequestMapping 注解的 value 和 method 属性，但是不满足 headers 属性，此时页面显示 404 错误，即资源未找到</p><h3 id="springmvc-支持-ant-风格的路径"><a class="markdownIt-Anchor" href="#springmvc-支持-ant-风格的路径"></a> SpringMVC 支持 ant 风格的路径</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//    @RequestMapping(&quot;/a?a/testAnt&quot;)</span></span><br><span class="line"><span class="comment">//    @RequestMapping(&quot;/a*a/testAnt&quot;)</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/**/testAnt&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">testAnt</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>？：表示任意的单个字符</p><p>*：表示任意的 0 个或多个字符</p><p>**：表示任意的一层或多层目录</p><p>注意：在使用**时，只能使用/**/xxx 的方式</p><h3 id="springmvc-支持路径中的占位符重点"><a class="markdownIt-Anchor" href="#springmvc-支持路径中的占位符重点"></a> SpringMVC 支持路径中的占位符（重点）</h3><p>原始方式：/deleteUser?id=1</p><p>rest 方式：/deleteUser/1</p><p>SpringMVC 路径中的占位符常用于 RESTful 风格中，当请求路径中将某些数据通过路径的方式传输到服务器中，就可以在相应的@RequestMapping 注解的 value 属性中通过占位符{xxx}表示传输的数据，在通过@PathVariable 注解，将占位符所表示的数据赋值给控制器方法的形参</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/testRest/1/admin&#125;&quot;</span>&gt;</span>测试路径中的占位符--&gt;/testRest<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testRest/&#123;id&#125;/&#123;username&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">testRest</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> String id, <span class="meta">@PathVariable(&quot;username&quot;)</span> String username)</span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;id:&quot;</span>+id+<span class="string">&quot;,username:&quot;</span>+username);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//最终输出的内容为--&gt;id:1,username:admin</span></span><br></pre></td></tr></table></figure><h1 id="springmvc-获取请求参数"><a class="markdownIt-Anchor" href="#springmvc-获取请求参数"></a> SpringMVC 获取请求参数</h1><h3 id="通过-servletapi-获取"><a class="markdownIt-Anchor" href="#通过-servletapi-获取"></a> 通过 ServletAPI 获取</h3><p>将 HttpServletRequest 作为控制器方法的形参，此时 HttpServletRequest 类型的参数表示封装了当前请求的请求报文的对象</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testParam&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">testParam</span><span class="params">(HttpServletRequest request)</span>&#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">    <span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;password&quot;</span>);</span><br><span class="line">    System.out.println(<span class="string">&quot;username:&quot;</span>+username+<span class="string">&quot;,password:&quot;</span>+password);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="通过控制器方法的形参获取请求参数"><a class="markdownIt-Anchor" href="#通过控制器方法的形参获取请求参数"></a> 通过控制器方法的形参获取请求参数</h3><p>在控制器方法的形参位置，设置和请求参数同名的形参，当浏览器发送请求，匹配到请求映射时，在 DispatcherServlet 中就会将请求参数赋值给相应的形参</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/testParam(username=&#x27;admin&#x27;,password=123456)&#125;&quot;</span></span></span><br><span class="line"><span class="tag">  &gt;</span>测试获取请求参数--&gt;/testParam&lt;/a</span><br><span class="line">&gt;<span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testParam&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">testParam</span><span class="params">(String username, String password)</span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;username:&quot;</span>+username+<span class="string">&quot;,password:&quot;</span>+password);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>注：</p><p>若请求所传输的请求参数中有多个同名的请求参数，此时可以在控制器方法的形参中设置字符串数组或者字符串类型的形参接收此请求参数</p><p>若使用字符串数组类型的形参，此参数的数组中包含了每一个数据</p><p>若使用字符串类型的形参，此参数的值为每个数据中间使用逗号拼接的结果</p></blockquote><h3 id="requestparam"><a class="markdownIt-Anchor" href="#requestparam"></a> @RequestParam</h3><p>@RequestParam 是将请求参数和控制器方法的形参创建映射关系</p><p>@RequestParam 注解一共有三个属性：</p><p>value：指定为形参赋值的请求参数的参数名</p><p>required：设置是否必须传输此请求参数，默认值为 true</p><p>若设置为 true 时，则当前请求必须传输 value 所指定的请求参数，若没有传输该请求参数，且没有设置 defaultValue 属性，则页面报错 400：Required String parameter ‘xxx’ is not present；若设置为 false，则当前请求不是必须传输 value 所指定的请求参数，若没有传输，则注解所标识的形参的值为 null</p><p>defaultValue：不管 required 属性值为 true 或 false，当 value 所指定的请求参数没有传输或传输的值为&quot;&quot;时，则使用默认值为形参赋值</p><h3 id="requestheader"><a class="markdownIt-Anchor" href="#requestheader"></a> @RequestHeader</h3><p>@RequestHeader 是将请求头信息和控制器方法的形参创建映射关系</p><p>@RequestHeader 注解一共有三个属性：value、required、defaultValue，用法同@RequestParam</p><h3 id="cookievalue"><a class="markdownIt-Anchor" href="#cookievalue"></a> @CookieValue</h3><p>@CookieValue 是将 cookie 数据和控制器方法的形参创建映射关系</p><p>@CookieValue 注解一共有三个属性：value、required、defaultValue，用法同@RequestParam</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">th:action</span>=<span class="string">&quot;@&#123;/testParam&#125;&quot;</span> <span class="attr">method</span>=<span class="string">&quot;get&quot;</span>&gt;</span></span><br><span class="line">  用户名:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;user_name&quot;</span> /&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">  密码:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> /&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">  爱好:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;hobby&quot;</span> <span class="attr">value</span>=<span class="string">&quot;a&quot;</span> /&gt;</span>a<span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;hobby&quot;</span> <span class="attr">value</span>=<span class="string">&quot;b&quot;</span> /&gt;</span>b<span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;hobby&quot;</span> <span class="attr">value</span>=<span class="string">&quot;c&quot;</span> /&gt;</span>c<span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;测试使用控制器形参获取请求参数&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;testParam&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">testParam</span><span class="params">(</span></span><br><span class="line"><span class="params">        <span class="meta">@RequestParam(value = &quot;user_name&quot;, required = false, defaultValue = &quot;hehe&quot;)</span> String username,</span></span><br><span class="line"><span class="params">        String password,</span></span><br><span class="line"><span class="params">        String[] hobby,</span></span><br><span class="line"><span class="params">        <span class="meta">@RequestHeader(value = &quot;sayHaha&quot;, required = false, defaultValue = &quot;haha&quot;)</span> String host,</span></span><br><span class="line"><span class="params">        <span class="meta">@CookieValue(&quot;JSESSIONID&quot;)</span> String JSESSIONID)</span> &#123;</span><br><span class="line">    <span class="comment">//若请求参数中出现多个同名的请求参数.可以在控制器方法的形参位置设置字符串类型或字符串数组接收此请求参数</span></span><br><span class="line">    <span class="comment">//若使用字符串类型的形参,最终结果为请求参数的每一个值之间使用逗号进行拼接</span></span><br><span class="line">    System.out.println(<span class="string">&quot;username:&quot;</span> + username + <span class="string">&quot;  password: &quot;</span> + password + <span class="string">&quot; hobby: &quot;</span> + Arrays.toString(hobby));</span><br><span class="line">    System.out.println(<span class="string">&quot;hsot : &quot;</span> + host);</span><br><span class="line">    System.out.println(<span class="string">&quot;JSESSIONID : &quot;</span> + JSESSIONID);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="通过-pojo-获取请求参数"><a class="markdownIt-Anchor" href="#通过-pojo-获取请求参数"></a> 通过 POJO 获取请求参数</h3><p>可以在控制器方法的形参位置设置一个实体类类型的形参，此时若浏览器传输的请求参数的参数名和实体类中的属性名一致，那么请求参数就会为此属性赋值</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">th:action</span>=<span class="string">&quot;@&#123;/testpojo&#125;&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">  用户名：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> /&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">  密码：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> /&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">  性别：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;sex&quot;</span> <span class="attr">value</span>=<span class="string">&quot;男&quot;</span> /&gt;</span>男<span class="tag">&lt;<span class="name">input</span></span></span><br><span class="line"><span class="tag">    <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">name</span>=<span class="string">&quot;sex&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">value</span>=<span class="string">&quot;女&quot;</span></span></span><br><span class="line"><span class="tag">  /&gt;</span>女<span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">  年龄：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;age&quot;</span> /&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">  邮箱：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;email&quot;</span> /&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testpojo&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">testPOJO</span><span class="params">(User user)</span>&#123;</span><br><span class="line">    System.out.println(user);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//最终结果--&gt;User&#123;id=null, username=&#x27;张三&#x27;, password=&#x27;123&#x27;, age=23, sex=&#x27;男&#x27;, email=&#x27;123@qq.com&#x27;&#125;</span></span><br></pre></td></tr></table></figure><h3 id="解决获取请求参数的乱码问题"><a class="markdownIt-Anchor" href="#解决获取请求参数的乱码问题"></a> 解决获取请求参数的乱码问题</h3><p>解决获取请求参数的乱码问题，可以使用 SpringMVC 提供的编码过滤器 CharacterEncodingFilter，但是必须在 web.xml 中进行注册</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--配置springMVC的编码过滤器--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>forceResponseEncoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>注：</p><p>SpringMVC 中处理编码的过滤器一定要配置到其他过滤器之前，否则无效</p></blockquote><h1 id="域对象共享数据"><a class="markdownIt-Anchor" href="#域对象共享数据"></a> 域对象共享数据</h1><details class="folding-tag" green><summary> 新建项目:[`SpringMVC-demo3`] </summary>              <div class='content'>              <ol><li><p>首先还是先创建 webapp 目录,将 web.xml 的路径改为<code>src\main\webapp</code>下,前面有讲到就不做阐述了~</p></li><li><p>配置 web.xml 文件</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--配置编码过滤器--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--设置请求编码--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--设置响应编码--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>forceResponseEncoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--配置spring前端控制器DispatcherServlet--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:springMVC.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 表示启动容器时先初始化该servlet的顺序 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>1<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>在<code>resources</code>下创建<code>springMVC.xml</code>文件,并配置 springMVC.xml,配置完后的 springMVC.xml 为:.</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context https://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--扫描组件--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.atguigu.mvc.controller&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 配置Thymeleaf视图解析器 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;viewResolver&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.thymeleaf.spring5.view.ThymeleafViewResolver&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;order&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;characterEncoding&quot;</span> <span class="attr">value</span>=<span class="string">&quot;UTF-8&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;templateEngine&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.thymeleaf.spring5.SpringTemplateEngine&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;templateResolver&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.thymeleaf.spring5.templateresolver.SpringResourceTemplateResolver&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                        <span class="comment">&lt;!-- 视图前缀 --&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;prefix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;/WEB-INF/templates/&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">                        <span class="comment">&lt;!-- 视图后缀 --&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;suffix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;.html&quot;</span>/&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;templateMode&quot;</span> <span class="attr">value</span>=<span class="string">&quot;HTML5&quot;</span>/&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;characterEncoding&quot;</span> <span class="attr">value</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>在📁<code>Java</code>目录下创建控制器类(TestController)</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.mvc.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@Author</span> SerMs</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@Date</span> 2022/4/4 21:50</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@Version</span> 1.0</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">index</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;index&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p>在 📁<code>WEB-INF</code> 目录下 创建 📁<code>templates</code>,并在📁templates 下创建 index.xml 文件,然后在 index.xml 下写入代码:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>首页<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>首页<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>配置<i class="iconfont icon-Tomcat"></i><code>Tomcat</code>查看是否可以运行~</p></li></ol>              </div>            </details><div class="tip warning"><p>注:</p><p><code>&lt;load-on-startup&gt;1&lt;/load-on-startup&gt;</code>解释:</p><pre><code>1. load-on-startup 元素标记容器是否应该在web应用程序启动的时候就加载这个servlet，(实例化并调用其init()方法)。2. 它的值必须是一个整数，表示servlet被加载的先后顺序。3. 如果该元素的值为负数或者没有设置，则容器会当Servlet被请求时再加载。4. 如果值为正整数或者0时，表示容器在应用启动时就加载并初始化这个servlet，值越小，servlet的优先级越高，就越先被加载。值相同时，容器就会自己选择顺序来加载</code></pre></div><h3 id="使用-servletapi-向-request-域对象共享数据"><a class="markdownIt-Anchor" href="#使用-servletapi-向-request-域对象共享数据"></a> 使用 ServletAPI 向 request 域对象共享数据</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testServletAPI&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">testServletAPI</span><span class="params">(HttpServletRequest request)</span>&#123;</span><br><span class="line">    request.setAttribute(<span class="string">&quot;testScope&quot;</span>, <span class="string">&quot;hello,servletAPI&quot;</span>);</span><br><span class="line">    <span class="comment">//此处用的是请求转发</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="使用-modelandview-向-request-域对象共享数据"><a class="markdownIt-Anchor" href="#使用-modelandview-向-request-域对象共享数据"></a> 使用 ModelAndView 向 request 域对象共享数据</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testModelAndView&quot;)</span></span><br><span class="line"><span class="keyword">public</span> ModelAndView <span class="title function_">testModelAndView</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ModelAndView有Model和View的功能</span></span><br><span class="line"><span class="comment">     * Model主要用于向请求域共享数据</span></span><br><span class="line"><span class="comment">     * View主要用于设置视图，实现页面跳转</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">ModelAndView</span> <span class="variable">mav</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ModelAndView</span>();</span><br><span class="line">    <span class="comment">//向请求域共享数据</span></span><br><span class="line">    mav.addObject(<span class="string">&quot;testScope&quot;</span>, <span class="string">&quot;hello,ModelAndView&quot;</span>);</span><br><span class="line">    <span class="comment">//设置视图，实现页面跳转</span></span><br><span class="line">    mav.setViewName(<span class="string">&quot;success&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> mav;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="使用-model-向-request-域对象共享数据"><a class="markdownIt-Anchor" href="#使用-model-向-request-域对象共享数据"></a> 使用 Model 向 request 域对象共享数据</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testModel&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">testModel</span><span class="params">(Model model)</span>&#123;</span><br><span class="line">    model.addAttribute(<span class="string">&quot;testScope&quot;</span>, <span class="string">&quot;hello,Model&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="使用-map-向-request-域对象共享数据"><a class="markdownIt-Anchor" href="#使用-map-向-request-域对象共享数据"></a> 使用 map 向 request 域对象共享数据</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testMap&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">testMap</span><span class="params">(Map&lt;String, Object&gt; map)</span>&#123;</span><br><span class="line">    map.put(<span class="string">&quot;testScope&quot;</span>, <span class="string">&quot;hello,Map&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="使用-modelmap-向-request-域对象共享数据"><a class="markdownIt-Anchor" href="#使用-modelmap-向-request-域对象共享数据"></a> 使用 ModelMap 向 request 域对象共享数据</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testModelMap&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">testModelMap</span><span class="params">(ModelMap modelMap)</span>&#123;</span><br><span class="line">    modelMap.addAttribute(<span class="string">&quot;testScope&quot;</span>, <span class="string">&quot;hello,ModelMap&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="model-modelmap-map-的关系"><a class="markdownIt-Anchor" href="#model-modelmap-map-的关系"></a> Model、ModelMap、Map 的关系</h3><p>Model、ModelMap、Map 类型的参数其实本质上都是 BindingAwareModelMap 类型的</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">public interface Model&#123;&#125;</span><br><span class="line">public class ModelMap extends LinkedHashMap&lt;String, Object&gt; &#123;&#125;</span><br><span class="line">public class ExtendedModelMap extends ModelMap implements Model &#123;&#125;</span><br><span class="line">public class BindingAwareModelMap extends ExtendedModelMap &#123;&#125;</span><br></pre></td></tr></table></figure><h3 id="向-session-域共享数据"><a class="markdownIt-Anchor" href="#向-session-域共享数据"></a> 向 session 域共享数据</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testSession&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">testSession</span><span class="params">(HttpSession session)</span>&#123;</span><br><span class="line">    session.setAttribute(<span class="string">&quot;testSessionScope&quot;</span>, <span class="string">&quot;hello,session&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="向-application-域共享数据"><a class="markdownIt-Anchor" href="#向-application-域共享数据"></a> 向 application 域共享数据</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testApplication&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">testApplication</span><span class="params">(HttpSession session)</span>&#123;</span><br><span class="line"><span class="type">ServletContext</span> <span class="variable">application</span> <span class="operator">=</span> session.getServletContext();</span><br><span class="line">    application.setAttribute(<span class="string">&quot;testApplicationScope&quot;</span>, <span class="string">&quot;hello,application&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><details class="folding-tag" cyan><summary> 全部代码: </summary>              <div class='content'>              <div class="tabs" id=""><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#-1">ScopeController.java</button></li><li class="tab"><button type="button" data-href="#-2">index.html</button></li><li class="tab"><button type="button" data-href="#-3">success.html</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.mvc.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.ui.Model;</span><br><span class="line"><span class="keyword">import</span> org.springframework.ui.ModelMap;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.ModelAndView;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletContext;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpSession;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> SerMs</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2022/4/4 22:26</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ScopeController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//1. 使用ServletAPI向request域对象共享数据</span></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/testRequestByServletAPI&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">testRequestByServletAPI</span><span class="params">(HttpServletRequest request)</span> &#123;</span><br><span class="line">        request.setAttribute(<span class="string">&quot;testRequestScope&quot;</span>, <span class="string">&quot;hello,servletAPI&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//2. 使用 ModelAndView 向 request 域对象共享数据</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 两个功能</span></span><br><span class="line"><span class="comment">     * 1.Model向request域对象共享数据</span></span><br><span class="line"><span class="comment">     * 2.设置视图名称</span></span><br><span class="line"><span class="comment">     * 注意:</span></span><br><span class="line"><span class="comment">     * 使用ModelAndView向request域对象共享数据时,返回值必须是ModelAndView,</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/testModelAndView&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> ModelAndView <span class="title function_">testModelAndView</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">ModelAndView</span> <span class="variable">mav</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ModelAndView</span>();</span><br><span class="line">        <span class="comment">//处理模型数据,即向请求域request共享数据</span></span><br><span class="line">        mav.addObject(<span class="string">&quot;testRequestScope&quot;</span>, <span class="string">&quot;hello,ModelAdnView&quot;</span>);</span><br><span class="line">        <span class="comment">//设置视图名称</span></span><br><span class="line">        mav.setViewName(<span class="string">&quot;success&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> mav;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//使用 Model 向 request 域对象共享数据</span></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/testModel&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">testModel</span><span class="params">(Model model)</span> &#123;</span><br><span class="line">        model.addAttribute(<span class="string">&quot;testRequestScope&quot;</span>, <span class="string">&quot;hello,model&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//使用 ModelMap 向 request 域对象共享数据</span></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/testMap&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">testMap</span><span class="params">(Map&lt;String, Object&gt; map)</span> &#123;</span><br><span class="line">        map.put(<span class="string">&quot;testRequestScope&quot;</span>, <span class="string">&quot;hello,map&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//使用 ModelMap 向 request 域对象共享数据</span></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/testModelMap&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">testModelMap</span><span class="params">(ModelMap modelMap)</span> &#123;</span><br><span class="line">        modelMap.addAttribute(<span class="string">&quot;testRequestScope&quot;</span>, <span class="string">&quot;hello,testModelMap&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//向 session 域共享数据</span></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/testSession&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">testSession</span><span class="params">(HttpSession session)</span> &#123;</span><br><span class="line">        session.setAttribute(<span class="string">&quot;testSessionScope&quot;</span>, <span class="string">&quot;hello,Session&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//向 application 域共享数据</span></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/testApplication&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">testApplication</span><span class="params">(HttpSession session)</span> &#123;</span><br><span class="line">        <span class="type">ServletContext</span> <span class="variable">servletContext</span> <span class="operator">=</span> session.getServletContext();</span><br><span class="line">        servletContext.setAttribute(<span class="string">&quot;testApplicationScope&quot;</span>, <span class="string">&quot;hello,testApplication&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="-2"><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>首页<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>首页<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/testRequestByServletAPI&#125;&quot;</span></span></span><br><span class="line"><span class="tag">      &gt;</span>通过ServletAPI向Request域对象共享数据&lt;/a</span><br><span class="line">    &gt;<span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/testModelAndView&#125;&quot;</span>&gt;</span>通过ModelAndView向Request域对象共享数据&lt;/a</span><br><span class="line">    &gt;<span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/testModel&#125;&quot;</span>&gt;</span>通过model向Request域对象共享数据<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/testMap&#125;&quot;</span>&gt;</span>通过map集合向Request域对象共享数据<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/testModelMap&#125;&quot;</span>&gt;</span>通过ModelMap集合向Request域对象共享数据&lt;/a</span><br><span class="line">    &gt;<span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/testSession&#125;&quot;</span>&gt;</span>通过ServletAPI向Session域对象共享数据<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/testApplication&#125;&quot;</span></span></span><br><span class="line"><span class="tag">      &gt;</span>通过ServletAPI向Application域对象共享数据&lt;/a</span><br><span class="line">    &gt;<span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="-3"><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>success<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;p th:text=&quot;$&#123;testRequestScope&#125;&quot;&gt;&lt;/p&gt;--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;#request.getAttribute(&#x27;testRequestScope&#x27;)&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;session.testSessionScope&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;application.testApplicationScope&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>              </div>            </details><h1 id="springmvc-的视图"><a class="markdownIt-Anchor" href="#springmvc-的视图"></a> SpringMVC 的视图</h1><p>SpringMVC 中的视图是 View 接口，视图的作用渲染数据，将模型 Model 中的数据展示给用户</p><p>SpringMVC 视图的种类很多，默认有转发视图(InternalResourceView)和重定向视图(RedirectView)</p><p>当工程引入 jstl 的依赖，转发视图会自动转换为 JstlView</p><p>若使用的视图技术为 Thymeleaf，在 SpringMVC 的配置文件中配置了 Thymeleaf 的视图解析器，由此视图解析器解析之后所得到的是 ThymeleafView</p><h3 id="thymeleafview"><a class="markdownIt-Anchor" href="#thymeleafview"></a> ThymeleafView</h3><p>当控制器方法中所设置的视图名称没有任何前缀时，此时的视图名称会被 SpringMVC 配置文件中所配置的视图解析器解析，视图名称拼接视图前缀和视图后缀所得到的最终路径，会通过转发的方式实现跳转</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testHello&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">testHello</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://unpkg.com/serms-assets@1.0.6/Spring/img002.png" alt="" /></p><h3 id="转发视图"><a class="markdownIt-Anchor" href="#转发视图"></a> 转发视图</h3><p>SpringMVC 中默认的转发视图是 InternalResourceView</p><p>SpringMVC 中创建转发视图的情况：</p><p>当控制器方法中所设置的视图名称以&quot;forward:&quot;为前缀时，创建 InternalResourceView 视图，此时的视图名称不会被 SpringMVC 配置文件中所配置的视图解析器解析，而是会将前缀&quot;forward:&quot;去掉，剩余部分作为最终路径通过转发的方式实现跳转</p><p>例如&quot;forward:/&quot;，“forward:/employee”</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testForward&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">testForward</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;forward:/testHello&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://unpkg.com/serms-assets@1.0.6/Spring/img003.png" alt="" /></p><h3 id="重定向视图"><a class="markdownIt-Anchor" href="#重定向视图"></a> 重定向视图</h3><p>SpringMVC 中默认的重定向视图是 RedirectView</p><p>当控制器方法中所设置的视图名称以&quot;redirect:&quot;为前缀时，创建 RedirectView 视图，此时的视图名称不会被 SpringMVC 配置文件中所配置的视图解析器解析，而是会将前缀&quot;redirect:&quot;去掉，剩余部分作为最终路径通过重定向的方式实现跳转</p><p>例如&quot;redirect:/&quot;，“redirect:/employee”</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testRedirect&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">testRedirect</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;redirect:/testHello&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://unpkg.com/serms-assets@1.0.6/Spring/img004.png" alt="" /></p><blockquote><p>注：</p><p>重定向视图在解析时，会先将 redirect:前缀去掉，然后会判断剩余部分是否以/开头，若是则会自动拼接上下文路径</p></blockquote><h3 id="视图控制器-view-controller"><a class="markdownIt-Anchor" href="#视图控制器-view-controller"></a> 视图控制器 view-controller</h3><p>当控制器方法中，仅仅用来实现页面跳转，即只需要设置视图名称时，可以将处理器方法使用 view-controller 标签进行表示</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">path：设置处理的请求地址</span></span><br><span class="line"><span class="comment">view-name：设置请求地址所对应的视图名称</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:view-controller</span> <span class="attr">path</span>=<span class="string">&quot;/testView&quot;</span> <span class="attr">view-name</span>=<span class="string">&quot;success&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">mvc:view-controller</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>注：</p><p>当 SpringMVC 中设置任何一个 view-controller 时，其他控制器中的请求映射将全部失效，此时需要在 SpringMVC 的核心配置文件中设置开启 mvc 注解驱动的标签：</p><p>&lt;mvc:annotation-driven /&gt;</p></blockquote><h3 id="jsp-视图"><a class="markdownIt-Anchor" href="#jsp-视图"></a> JSP 视图</h3><p>直接上代码:</p><div class="tabs" id=""><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#-1">JspController.java</button></li><li class="tab"><button type="button" data-href="#-2">index.html</button></li><li class="tab"><button type="button" data-href="#-3">success.html</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="-1"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.mvc.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> SerMs</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2022/4/5 23:39</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JspController</span> &#123;</span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/success&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">success</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="-2"><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;%-- Created by IntelliJ IDEA. User: 18399 Date: 2022/4/5 Time: 23:44 To change</span><br><span class="line">this template use File | Settings | File Templates. --%&gt; &lt;%@ page</span><br><span class="line">contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>首页<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;$&#123;pageContext.request.contextPath&#125;/success&quot;</span>&gt;</span>success.js<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="-3"><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;%-- Created by IntelliJ IDEA. User: 18399 Date: 2022/4/5 Time: 23:49 To change</span><br><span class="line">this template use File | Settings | File Templates. --%&gt; &lt;%@ page</span><br><span class="line">contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>成功<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h1 id="restful"><a class="markdownIt-Anchor" href="#restful"></a> RESTful</h1><h3 id="restful-简介"><a class="markdownIt-Anchor" href="#restful-简介"></a> RESTful 简介</h3><p>REST：<strong>Re</strong>presentational <strong>S</strong>tate <strong>T</strong>ransfer，表现层资源状态转移。</p><h5 id="a资源"><a class="markdownIt-Anchor" href="#a资源"></a> a&gt;资源</h5><p>资源是一种看待服务器的方式，即，将服务器看作是由很多离散的资源组成。每个资源是服务器上一个可命名的抽象概念。因为资源是一个抽象的概念，所以它不仅仅能代表服务器文件系统中的一个文件、数据库中的一张表等等具体的东西，可以将资源设计的要多抽象有多抽象，只要想象力允许而且客户端应用开发者能够理解。与面向对象设计类似，资源是以名词为核心来组织的，首先关注的是名词。一个资源可以由一个或多个 URI 来标识。URI 既是资源的名称，也是资源在 Web 上的地址。对某个资源感兴趣的客户端应用，可以通过资源的 URI 与其进行交互。</p><h5 id="b资源的表述"><a class="markdownIt-Anchor" href="#b资源的表述"></a> b&gt;资源的表述</h5><p>资源的表述是一段对于资源在某个特定时刻的状态的描述。可以在客户端-服务器端之间转移（交换）。资源的表述可以有多种格式，例如 HTML/XML/JSON/纯文本/图片/视频/音频等等。资源的表述格式可以通过协商机制来确定。请求-响应方向的表述通常使用不同的格式。</p><h5 id="c状态转移"><a class="markdownIt-Anchor" href="#c状态转移"></a> c&gt;状态转移</h5><p>状态转移说的是：在客户端和服务器端之间转移（transfer）代表资源状态的表述。通过转移和操作资源的表述，来间接实现操作资源的目的。</p><h3 id="restful-的实现"><a class="markdownIt-Anchor" href="#restful-的实现"></a> RESTful 的实现</h3><p>具体说，就是 HTTP 协议里面，四个表示操作方式的动词：GET、POST、PUT、DELETE。</p><p>它们分别对应四种基本操作：GET 用来获取资源，POST 用来新建资源，PUT 用来更新资源，DELETE 用来删除资源。</p><p>REST 风格提倡 URL 地址使用统一的风格设计，从前到后各个单词使用斜杠分开，不使用问号键值对方式携带请求参数，而是将要发送给服务器的数据作为 URL 地址的一部分，以保证整体风格的一致性。</p><table><thead><tr><th>操作</th><th>传统方式</th><th>REST 风格</th></tr></thead><tbody><tr><td>查询操作</td><td>getUserById?id=1</td><td>user/1–&gt;get 请求方式</td></tr><tr><td>保存操作</td><td>saveUser</td><td>user–&gt;post 请求方式</td></tr><tr><td>删除操作</td><td>deleteUser?id=1</td><td>user/1–&gt;delete 请求方式</td></tr><tr><td>更新操作</td><td>updateUser</td><td>user–&gt;put 请求方式</td></tr></tbody></table><h3 id="hiddenhttpmethodfilter"><a class="markdownIt-Anchor" href="#hiddenhttpmethodfilter"></a> HiddenHttpMethodFilter</h3><p>由于浏览器只支持发送 get 和 post 方式的请求，那么该如何发送 put 和 delete 请求呢？</p><p>SpringMVC 提供了 <strong>HiddenHttpMethodFilter</strong> 帮助我们<strong>将 POST 请求转换为 DELETE 或 PUT 请求</strong></p><p><strong>HiddenHttpMethodFilter</strong> 处理 put 和 delete 请求的条件：</p><p>a&gt;当前请求的请求方式必须为 post</p><p>b&gt;当前请求必须传输请求参数_method</p><p>满足以上条件，<strong>HiddenHttpMethodFilter</strong> 过滤器就会将当前请求的请求方式转换为请求参数_method 的值，因此请求参数_method 的值才是最终的请求方式</p><p>在 web.xml 中注册<strong>HiddenHttpMethodFilter</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>HiddenHttpMethodFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.HiddenHttpMethodFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>HiddenHttpMethodFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>注：</p><p>目前为止，SpringMVC 中提供了两个过滤器：CharacterEncodingFilter 和 HiddenHttpMethodFilter</p><p>在 web.xml 中注册时，必须先注册 CharacterEncodingFilter，再注册 HiddenHttpMethodFilter</p><p>原因：</p><ul><li><p>在 CharacterEncodingFilter 中通过 request.setCharacterEncoding(encoding) 方法设置字符集的</p></li><li><p>request.setCharacterEncoding(encoding) 方法要求前面不能有任何获取请求参数的操作</p></li><li><p>而 HiddenHttpMethodFilter 恰恰有一个获取请求方式的操作：</p></li><li><pre class="highlight"><code class="">String paramValue = request.getParameter(this.methodParam);<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"># RESTful 案例</span><br><span class="line"></span><br><span class="line">### 准备工作</span><br><span class="line"></span><br><span class="line">和传统 CRUD 一样，实现对员工信息的增删改查。</span><br><span class="line"></span><br><span class="line">- 搭建环境</span><br><span class="line"></span><br><span class="line">- 准备实体类</span><br><span class="line"></span><br><span class="line"> ```java</span><br><span class="line"> package com.atguigu.mvc.bean;</span><br><span class="line"></span><br><span class="line"> public class Employee &#123;</span><br><span class="line"></span><br><span class="line">    private Integer id;</span><br><span class="line">    private String lastName;</span><br><span class="line"></span><br><span class="line">    private String email;</span><br><span class="line">    //1 male, 0 female</span><br><span class="line">    private Integer gender;</span><br><span class="line"></span><br><span class="line">    public Integer getId() &#123;</span><br><span class="line">       return id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setId(Integer id) &#123;</span><br><span class="line">       this.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String getLastName() &#123;</span><br><span class="line">       return lastName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setLastName(String lastName) &#123;</span><br><span class="line">       this.lastName = lastName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String getEmail() &#123;</span><br><span class="line">       return email;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setEmail(String email) &#123;</span><br><span class="line">       this.email = email;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public Integer getGender() &#123;</span><br><span class="line">       return gender;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setGender(Integer gender) &#123;</span><br><span class="line">       this.gender = gender;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public Employee(Integer id, String lastName, String email, Integer gender) &#123;</span><br><span class="line">       super();</span><br><span class="line">       this.id = id;</span><br><span class="line">       this.lastName = lastName;</span><br><span class="line">       this.email = email;</span><br><span class="line">       this.gender = gender;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public Employee() &#123;</span><br><span class="line">    &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure></code></pre></li></ul></blockquote><ul><li><p>准备 dao 模拟数据</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.mvc.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Collection;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.atguigu.mvc.bean.Employee;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Repository;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EmployeeDao</span> &#123;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">static</span> Map&lt;Integer, Employee&gt; employees = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">static</span>&#123;</span><br><span class="line">      employees = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;Integer, Employee&gt;();</span><br><span class="line"></span><br><span class="line">      employees.put(<span class="number">1001</span>, <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="number">1001</span>, <span class="string">&quot;E-AA&quot;</span>, <span class="string">&quot;aa@163.com&quot;</span>, <span class="number">1</span>));</span><br><span class="line">      employees.put(<span class="number">1002</span>, <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="number">1002</span>, <span class="string">&quot;E-BB&quot;</span>, <span class="string">&quot;bb@163.com&quot;</span>, <span class="number">1</span>));</span><br><span class="line">      employees.put(<span class="number">1003</span>, <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="number">1003</span>, <span class="string">&quot;E-CC&quot;</span>, <span class="string">&quot;cc@163.com&quot;</span>, <span class="number">0</span>));</span><br><span class="line">      employees.put(<span class="number">1004</span>, <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="number">1004</span>, <span class="string">&quot;E-DD&quot;</span>, <span class="string">&quot;dd@163.com&quot;</span>, <span class="number">0</span>));</span><br><span class="line">      employees.put(<span class="number">1005</span>, <span class="keyword">new</span> <span class="title class_">Employee</span>(<span class="number">1005</span>, <span class="string">&quot;E-EE&quot;</span>, <span class="string">&quot;ee@163.com&quot;</span>, <span class="number">1</span>));</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">Integer</span> <span class="variable">initId</span> <span class="operator">=</span> <span class="number">1006</span>;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">save</span><span class="params">(Employee employee)</span>&#123;</span><br><span class="line">      <span class="keyword">if</span>(employee.getId() == <span class="literal">null</span>)&#123;</span><br><span class="line">         employee.setId(initId++);</span><br><span class="line">      &#125;</span><br><span class="line">      employees.put(employee.getId(), employee);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> Collection&lt;Employee&gt; <span class="title function_">getAll</span><span class="params">()</span>&#123;</span><br><span class="line">      <span class="keyword">return</span> employees.values();</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> Employee <span class="title function_">get</span><span class="params">(Integer id)</span>&#123;</span><br><span class="line">      <span class="keyword">return</span> employees.get(id);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">delete</span><span class="params">(Integer id)</span>&#123;</span><br><span class="line">      employees.remove(id);</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h3 id="功能清单"><a class="markdownIt-Anchor" href="#功能清单"></a> 功能清单</h3><table><thead><tr><th>功能</th><th>URL 地址</th><th>请求方式</th></tr></thead><tbody><tr><td>访问首页 √</td><td>/</td><td>GET</td></tr><tr><td>查询全部数据 √</td><td>/employee</td><td>GET</td></tr><tr><td>删除 √</td><td>/employee/2</td><td>DELETE</td></tr><tr><td>跳转到添加数据页面 √</td><td>/toAdd</td><td>GET</td></tr><tr><td>执行保存 √</td><td>/employee</td><td>POST</td></tr><tr><td>跳转到更新数据页面 √</td><td>/employee/2</td><td>GET</td></tr><tr><td>执行更新 √</td><td>/employee</td><td>PUT</td></tr></tbody></table><h3 id="具体功能访问首页"><a class="markdownIt-Anchor" href="#具体功能访问首页"></a> 具体功能：访问首页</h3><h5 id="a配置-view-controller"><a class="markdownIt-Anchor" href="#a配置-view-controller"></a> a&gt;配置 view-controller</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mvc:view-controller</span> <span class="attr">path</span>=<span class="string">&quot;/&quot;</span> <span class="attr">view-name</span>=<span class="string">&quot;index&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure><h5 id="b创建页面"><a class="markdownIt-Anchor" href="#b创建页面"></a> b&gt;创建页面</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>首页<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/employee&#125;&quot;</span>&gt;</span>访问员工信息<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="具体功能查询所有员工数据"><a class="markdownIt-Anchor" href="#具体功能查询所有员工数据"></a> 具体功能：查询所有员工数据</h3><h5 id="a控制器方法"><a class="markdownIt-Anchor" href="#a控制器方法"></a> a&gt;控制器方法</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(value = &quot;/employee&quot;, method = RequestMethod.GET)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">getEmployeeList</span><span class="params">(Model model)</span>&#123;</span><br><span class="line">    Collection&lt;Employee&gt; employeeList = employeeDao.getAll();</span><br><span class="line">    model.addAttribute(<span class="string">&quot;employeeList&quot;</span>, employeeList);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;employee_list&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="b创建-employee_listhtml"><a class="markdownIt-Anchor" href="#b创建-employee_listhtml"></a> b&gt;创建 employee_list.html</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Employee Info<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">th:src</span>=<span class="string">&quot;@&#123;/static/js/vue.js&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">table</span></span></span><br><span class="line"><span class="tag">      <span class="attr">border</span>=<span class="string">&quot;1&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">cellpadding</span>=<span class="string">&quot;0&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">cellspacing</span>=<span class="string">&quot;0&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">style</span>=<span class="string">&quot;text-align: center;&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">id</span>=<span class="string">&quot;dataTable&quot;</span></span></span><br><span class="line"><span class="tag">    &gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span> <span class="attr">colspan</span>=<span class="string">&quot;5&quot;</span>&gt;</span>Employee Info<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>id<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>lastName<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>email<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>gender<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>options(<span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/toAdd&#125;&quot;</span>&gt;</span>add<span class="tag">&lt;/<span class="name">a</span>&gt;</span>)<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">tr</span> <span class="attr">th:each</span>=<span class="string">&quot;employee : $&#123;employeeList&#125;&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;employee.id&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;employee.lastName&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;employee.email&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;employee.gender&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">a</span></span></span><br><span class="line"><span class="tag">            <span class="attr">class</span>=<span class="string">&quot;deleteA&quot;</span></span></span><br><span class="line"><span class="tag">            @<span class="attr">click</span>=<span class="string">&quot;deleteEmployee&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">th:href</span>=<span class="string">&quot;@&#123;&#x27;/employee/&#x27;+$&#123;employee.id&#125;&#125;&quot;</span></span></span><br><span class="line"><span class="tag">            &gt;</span>delete&lt;/a</span><br><span class="line">          &gt;</span><br><span class="line">          <span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;&#x27;/employee/&#x27;+$&#123;employee.id&#125;&#125;&quot;</span>&gt;</span>update<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="具体功能删除"><a class="markdownIt-Anchor" href="#具体功能删除"></a> 具体功能：删除</h3><h5 id="a创建处理-delete-请求方式的表单"><a class="markdownIt-Anchor" href="#a创建处理-delete-请求方式的表单"></a> a&gt;创建处理 delete 请求方式的表单</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 作用：通过超链接控制表单的提交，将post请求转换为delete请求 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">&quot;delete_form&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- HiddenHttpMethodFilter要求：必须传输_method请求参数，并且值为最终的请求方式 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;_method&quot;</span> <span class="attr">value</span>=<span class="string">&quot;delete&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><h5 id="b删除超链接绑定点击事件"><a class="markdownIt-Anchor" href="#b删除超链接绑定点击事件"></a> b&gt;删除超链接绑定点击事件</h5><p>引入 vue.js</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">th:src</span>=<span class="string">&quot;@&#123;/static/js/vue.js&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>删除超链接</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span></span></span><br><span class="line"><span class="tag">  <span class="attr">class</span>=<span class="string">&quot;deleteA&quot;</span></span></span><br><span class="line"><span class="tag">  @<span class="attr">click</span>=<span class="string">&quot;deleteEmployee&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">th:href</span>=<span class="string">&quot;@&#123;&#x27;/employee/&#x27;+$&#123;employee.id&#125;&#125;&quot;</span></span></span><br><span class="line"><span class="tag">  &gt;</span>delete&lt;/a</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure><p>通过 vue 处理点击事件</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">var</span> vue = <span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">el</span>: <span class="string">&quot;#dataTable&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">methods</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">//event表示当前事件</span></span></span><br><span class="line"><span class="language-javascript">      <span class="attr">deleteEmployee</span>: <span class="keyword">function</span> (<span class="params">event</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//通过id获取表单标签</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> delete_form = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;delete_form&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//将触发事件的超链接的href属性为表单的action属性赋值</span></span></span><br><span class="line"><span class="language-javascript">        delete_form.<span class="property">action</span> = event.<span class="property">target</span>.<span class="property">href</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//提交表单</span></span></span><br><span class="line"><span class="language-javascript">        delete_form.<span class="title function_">submit</span>();</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//阻止超链接的默认跳转行为</span></span></span><br><span class="line"><span class="language-javascript">        event.<span class="title function_">preventDefault</span>();</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h5 id="c控制器方法"><a class="markdownIt-Anchor" href="#c控制器方法"></a> c&gt;控制器方法</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(value = &quot;/employee/&#123;id&#125;&quot;, method = RequestMethod.DELETE)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">deleteEmployee</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Integer id)</span>&#123;</span><br><span class="line">    employeeDao.delete(id);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;redirect:/employee&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="具体功能跳转到添加数据页面"><a class="markdownIt-Anchor" href="#具体功能跳转到添加数据页面"></a> 具体功能：跳转到添加数据页面</h3><h5 id="a配置-view-controller-2"><a class="markdownIt-Anchor" href="#a配置-view-controller-2"></a> a&gt;配置 view-controller</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mvc:view-controller</span> <span class="attr">path</span>=<span class="string">&quot;/toAdd&quot;</span> <span class="attr">view-name</span>=<span class="string">&quot;employee_add&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">mvc:view-controller</span>&gt;</span></span><br></pre></td></tr></table></figure><h5 id="b创建-employee_addhtml"><a class="markdownIt-Anchor" href="#b创建-employee_addhtml"></a> b&gt;创建 employee_add.html</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Add Employee<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">th:action</span>=<span class="string">&quot;@&#123;/employee&#125;&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">      lastName:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;lastName&quot;</span> /&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">      email:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;email&quot;</span> /&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">      gender:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;gender&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span> /&gt;</span>male</span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;gender&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0&quot;</span> /&gt;</span>female<span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;add&quot;</span> /&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="具体功能执行保存"><a class="markdownIt-Anchor" href="#具体功能执行保存"></a> 具体功能：执行保存</h3><h5 id="a控制器方法-2"><a class="markdownIt-Anchor" href="#a控制器方法-2"></a> a&gt;控制器方法</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(value = &quot;/employee&quot;, method = RequestMethod.POST)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">addEmployee</span><span class="params">(Employee employee)</span>&#123;</span><br><span class="line">    employeeDao.save(employee);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;redirect:/employee&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="具体功能跳转到更新数据页面"><a class="markdownIt-Anchor" href="#具体功能跳转到更新数据页面"></a> 具体功能：跳转到更新数据页面</h3><h5 id="a修改超链接"><a class="markdownIt-Anchor" href="#a修改超链接"></a> a&gt;修改超链接</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;&#x27;/employee/&#x27;+$&#123;employee.id&#125;&#125;&quot;</span>&gt;</span>update<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure><h5 id="b控制器方法"><a class="markdownIt-Anchor" href="#b控制器方法"></a> b&gt;控制器方法</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(value = &quot;/employee/&#123;id&#125;&quot;, method = RequestMethod.GET)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">getEmployeeById</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Integer id, Model model)</span>&#123;</span><br><span class="line">    <span class="type">Employee</span> <span class="variable">employee</span> <span class="operator">=</span> employeeDao.get(id);</span><br><span class="line">    model.addAttribute(<span class="string">&quot;employee&quot;</span>, employee);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;employee_update&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="c创建-employee_updatehtml"><a class="markdownIt-Anchor" href="#c创建-employee_updatehtml"></a> c&gt;创建 employee_update.html</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Update Employee<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">th:action</span>=<span class="string">&quot;@&#123;/employee&#125;&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;_method&quot;</span> <span class="attr">value</span>=<span class="string">&quot;put&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;id&quot;</span> <span class="attr">th:value</span>=<span class="string">&quot;$&#123;employee.id&#125;&quot;</span> /&gt;</span></span><br><span class="line">      lastName:<span class="tag">&lt;<span class="name">input</span></span></span><br><span class="line"><span class="tag">        <span class="attr">type</span>=<span class="string">&quot;text&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">name</span>=<span class="string">&quot;lastName&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">th:value</span>=<span class="string">&quot;$&#123;employee.lastName&#125;&quot;</span></span></span><br><span class="line"><span class="tag">      /&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">      email:<span class="tag">&lt;<span class="name">input</span></span></span><br><span class="line"><span class="tag">        <span class="attr">type</span>=<span class="string">&quot;text&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">name</span>=<span class="string">&quot;email&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">th:value</span>=<span class="string">&quot;$&#123;employee.email&#125;&quot;</span></span></span><br><span class="line"><span class="tag">      /&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">      <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">        th:field=&quot;$&#123;employee.gender&#125;&quot;可用于单选框或复选框的回显</span></span><br><span class="line"><span class="comment">        若单选框的value和employee.gender的值一致，则添加checked=&quot;checked&quot;属性</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">      gender:<span class="tag">&lt;<span class="name">input</span></span></span><br><span class="line"><span class="tag">        <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">name</span>=<span class="string">&quot;gender&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">value</span>=<span class="string">&quot;1&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">th:field</span>=<span class="string">&quot;$&#123;employee.gender&#125;&quot;</span></span></span><br><span class="line"><span class="tag">      /&gt;</span>male</span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span></span></span><br><span class="line"><span class="tag">        <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">name</span>=<span class="string">&quot;gender&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">value</span>=<span class="string">&quot;0&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">th:field</span>=<span class="string">&quot;$&#123;employee.gender&#125;&quot;</span></span></span><br><span class="line"><span class="tag">      /&gt;</span>female<span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;update&quot;</span> /&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="具体功能执行更新"><a class="markdownIt-Anchor" href="#具体功能执行更新"></a> 具体功能：执行更新</h3><h5 id="a控制器方法-3"><a class="markdownIt-Anchor" href="#a控制器方法-3"></a> a&gt;控制器方法</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(value = &quot;/employee&quot;, method = RequestMethod.PUT)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">updateEmployee</span><span class="params">(Employee employee)</span>&#123;</span><br><span class="line">    employeeDao.save(employee);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;redirect:/employee&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="httpmessageconverter"><a class="markdownIt-Anchor" href="#httpmessageconverter"></a> HttpMessageConverter</h1><p>HttpMessageConverter，报文信息转换器，将请求报文转换为 Java 对象，或将 Java 对象转换为响应报文</p><p>HttpMessageConverter 提供了两个注解和两个类型：@RequestBody，@ResponseBody，RequestEntity，</p><p>ResponseEntity</p><h3 id="requestbody"><a class="markdownIt-Anchor" href="#requestbody"></a> @RequestBody</h3><p>@RequestBody 可以获取请求体，需要在控制器方法设置一个形参，使用@RequestBody 进行标识，当前请求的请求体就会为当前注解所标识的形参赋值</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">th:action</span>=<span class="string">&quot;@&#123;/testRequestBody&#125;&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">  用户名：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> /&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">  密码：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> /&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testRequestBody&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">testRequestBody</span><span class="params">(<span class="meta">@RequestBody</span> String requestBody)</span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;requestBody:&quot;</span>+requestBody);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>输出结果：</p><p>requestBody:username=admin&amp;password=123456</p><h3 id="requestentity"><a class="markdownIt-Anchor" href="#requestentity"></a> RequestEntity</h3><p>RequestEntity 封装请求报文的一种类型，需要在控制器方法的形参中设置该类型的形参，当前请求的请求报文就会赋值给该形参，可以通过 getHeaders()获取请求头信息，通过 getBody()获取请求体信息</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testRequestEntity&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">testRequestEntity</span><span class="params">(RequestEntity&lt;String&gt; requestEntity)</span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;requestHeader:&quot;</span>+requestEntity.getHeaders());</span><br><span class="line">    System.out.println(<span class="string">&quot;requestBody:&quot;</span>+requestEntity.getBody());</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>输出结果：<br />requestHeader:[host:“localhost:8080”, connection:“keep-alive”, content-length:“27”, cache-control:“max-age=0”, sec-ch-ua:&quot;&quot; Not A;Brand&quot;;v=“99”, “Chromium”;v=“90”, “Google Chrome”;v=“90&quot;”, sec-ch-ua-mobile:&quot;?0&quot;, upgrade-insecure-requests:“1”, origin:“<a href="http://localhost:8080">http://localhost:8080</a>”, user-agent:“Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36”]<br />requestBody:username=admin&amp;password=123</p><h3 id="responsebody"><a class="markdownIt-Anchor" href="#responsebody"></a> @ResponseBody</h3><p>@ResponseBody 用于标识一个控制器方法，可以将该方法的返回值直接作为响应报文的响应体响应到浏览器</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testResponseBody&quot;)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">testResponseBody</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>结果：浏览器页面显示 success</p><h3 id="springmvc-处理-json"><a class="markdownIt-Anchor" href="#springmvc-处理-json"></a> SpringMVC 处理 json</h3><p>@ResponseBody 处理 json 的步骤：</p><p>a&gt;导入 jackson 的依赖</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jackson-databind<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.12.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>b&gt;在 SpringMVC 的核心配置文件中开启 mvc 的注解驱动，此时在 HandlerAdaptor 中会自动装配一个消息转换器：MappingJackson2HttpMessageConverter，可以将响应到浏览器的 Java 对象转换为 Json 格式的字符串</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;mvc:annotation-driven /&gt;</span><br></pre></td></tr></table></figure><p>c&gt;在处理器方法上使用@ResponseBody 注解进行标识</p><p>d&gt;将 Java 对象直接作为控制器方法的返回值返回，就会自动转换为 Json 格式的字符串</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testResponseUser&quot;)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> User <span class="title function_">testResponseUser</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">User</span>(<span class="number">1001</span>,<span class="string">&quot;admin&quot;</span>,<span class="string">&quot;123456&quot;</span>,<span class="number">23</span>,<span class="string">&quot;男&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>浏览器的页面中展示的结果：</p><p>{“id”:1001,“username”:“admin”,“password”:“123456”,“age”:23,“sex”:“男”}</p><h3 id="springmvc-处理-ajax"><a class="markdownIt-Anchor" href="#springmvc-处理-ajax"></a> SpringMVC 处理 ajax</h3><p>a&gt;请求超链接：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">&quot;@&#123;/testAjax&#125;&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;testAjax&quot;</span>&gt;</span>testAjax<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>b&gt;通过 vue 和 axios 处理点击事件：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">th:src</span>=<span class="string">&quot;@&#123;/static/js/vue.js&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">th:src</span>=<span class="string">&quot;@&#123;/static/js/axios.min.js&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">var</span> vue = <span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">el</span>: <span class="string">&quot;#app&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">methods</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">testAjax</span>: <span class="keyword">function</span> (<span class="params">event</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">axios</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">method</span>: <span class="string">&quot;post&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">url</span>: event.<span class="property">target</span>.<span class="property">href</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">params</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">username</span>: <span class="string">&quot;admin&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">password</span>: <span class="string">&quot;123456&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">          &#125;,</span></span><br><span class="line"><span class="language-javascript">        &#125;).<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params">response</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="title function_">alert</span>(response.<span class="property">data</span>);</span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript">        event.<span class="title function_">preventDefault</span>();</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>c&gt;控制器方法：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testAjax&quot;)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">testAjax</span><span class="params">(String username, String password)</span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;username:&quot;</span>+username+<span class="string">&quot;,password:&quot;</span>+password);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;hello,ajax&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="restcontroller-注解"><a class="markdownIt-Anchor" href="#restcontroller-注解"></a> @RestController 注解</h3><p>@RestController 注解是 springMVC 提供的一个复合注解，标识在控制器的类上，就相当于为类添加了@Controller 注解，并且为其中的每个方法添加了@ResponseBody 注解</p><h3 id="responseentity"><a class="markdownIt-Anchor" href="#responseentity"></a> ResponseEntity</h3><p>ResponseEntity 用于控制器方法的返回值类型，该控制器方法的返回值就是响应到浏览器的响应报文</p><h1 id="文件上传和下载"><a class="markdownIt-Anchor" href="#文件上传和下载"></a> 文件上传和下载</h1><h3 id="文件下载"><a class="markdownIt-Anchor" href="#文件下载"></a> 文件下载</h3><p>使用 ResponseEntity 实现下载文件的功能</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testDown&quot;)</span></span><br><span class="line"><span class="keyword">public</span> ResponseEntity&lt;<span class="type">byte</span>[]&gt; testResponseEntity(HttpSession session) <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">    <span class="comment">//获取ServletContext对象</span></span><br><span class="line">    <span class="type">ServletContext</span> <span class="variable">servletContext</span> <span class="operator">=</span> session.getServletContext();</span><br><span class="line">    <span class="comment">//获取服务器中文件的真实路径</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">realPath</span> <span class="operator">=</span> servletContext.getRealPath(<span class="string">&quot;/static/img/1.jpg&quot;</span>);</span><br><span class="line">    <span class="comment">//创建输入流</span></span><br><span class="line">    <span class="type">InputStream</span> <span class="variable">is</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(realPath);</span><br><span class="line">    <span class="comment">//创建字节数组</span></span><br><span class="line">    <span class="type">byte</span>[] bytes = <span class="keyword">new</span> <span class="title class_">byte</span>[is.available()];</span><br><span class="line">    <span class="comment">//将流读到字节数组中</span></span><br><span class="line">    is.read(bytes);</span><br><span class="line">    <span class="comment">//创建HttpHeaders对象设置响应头信息</span></span><br><span class="line">    MultiValueMap&lt;String, String&gt; headers = <span class="keyword">new</span> <span class="title class_">HttpHeaders</span>();</span><br><span class="line">    <span class="comment">//设置要下载方式以及下载文件的名字</span></span><br><span class="line">    headers.add(<span class="string">&quot;Content-Disposition&quot;</span>, <span class="string">&quot;attachment;filename=1.jpg&quot;</span>);</span><br><span class="line">    <span class="comment">//设置响应状态码</span></span><br><span class="line">    <span class="type">HttpStatus</span> <span class="variable">statusCode</span> <span class="operator">=</span> HttpStatus.OK;</span><br><span class="line">    <span class="comment">//创建ResponseEntity对象</span></span><br><span class="line">    ResponseEntity&lt;<span class="type">byte</span>[]&gt; responseEntity = <span class="keyword">new</span> <span class="title class_">ResponseEntity</span>&lt;&gt;(bytes, headers, statusCode);</span><br><span class="line">    <span class="comment">//关闭输入流</span></span><br><span class="line">    is.close();</span><br><span class="line">    <span class="keyword">return</span> responseEntity;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="文件上传"><a class="markdownIt-Anchor" href="#文件上传"></a> 文件上传</h3><p>文件上传要求 form 表单的请求方式必须为 post，并且添加属性 enctype=“multipart/form-data”</p><p>SpringMVC 中将上传的文件封装到 MultipartFile 对象中，通过此对象可以获取文件相关信息</p><p>上传步骤：</p><p>a&gt;添加依赖：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/commons-fileupload/commons-fileupload --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-fileupload<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-fileupload<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>b&gt;在 SpringMVC 的配置文件中添加配置：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--必须通过文件解析器的解析才能将文件转换为MultipartFile对象--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;multipartResolver&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.web.multipart.commons.CommonsMultipartResolver&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><p>c&gt;控制器方法：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testUp&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">testUp</span><span class="params">(MultipartFile photo, HttpSession session)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">    <span class="comment">//获取上传的文件的文件名</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">fileName</span> <span class="operator">=</span> photo.getOriginalFilename();</span><br><span class="line">    <span class="comment">//处理文件重名问题</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">hzName</span> <span class="operator">=</span> fileName.substring(fileName.lastIndexOf(<span class="string">&quot;.&quot;</span>));</span><br><span class="line">    fileName = UUID.randomUUID().toString() + hzName;</span><br><span class="line">    <span class="comment">//获取服务器中photo目录的路径</span></span><br><span class="line">    <span class="type">ServletContext</span> <span class="variable">servletContext</span> <span class="operator">=</span> session.getServletContext();</span><br><span class="line">    <span class="type">String</span> <span class="variable">photoPath</span> <span class="operator">=</span> servletContext.getRealPath(<span class="string">&quot;photo&quot;</span>);</span><br><span class="line">    <span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(photoPath);</span><br><span class="line">    <span class="keyword">if</span>(!file.exists())&#123;</span><br><span class="line">        file.mkdir();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">String</span> <span class="variable">finalPath</span> <span class="operator">=</span> photoPath + File.separator + fileName;</span><br><span class="line">    <span class="comment">//实现上传功能</span></span><br><span class="line">    photo.transferTo(<span class="keyword">new</span> <span class="title class_">File</span>(finalPath));</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="拦截器"><a class="markdownIt-Anchor" href="#拦截器"></a> 拦截器</h1><h3 id="拦截器的配置"><a class="markdownIt-Anchor" href="#拦截器的配置"></a> 拦截器的配置</h3><p>SpringMVC 中的拦截器用于拦截控制器方法的执行</p><p>SpringMVC 中的拦截器需要实现 HandlerInterceptor</p><p>SpringMVC 的拦截器必须在 SpringMVC 的配置文件中进行配置：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;com.atguigu.interceptor.FirstInterceptor&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ref</span> <span class="attr">bean</span>=<span class="string">&quot;firstInterceptor&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">ref</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 以上两种配置方式都是对DispatcherServlet所处理的所有的请求进行拦截 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:interceptor</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:mapping</span> <span class="attr">path</span>=<span class="string">&quot;/**&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:exclude-mapping</span> <span class="attr">path</span>=<span class="string">&quot;/testRequestEntity&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ref</span> <span class="attr">bean</span>=<span class="string">&quot;firstInterceptor&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">ref</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mvc:interceptor</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">以上配置方式可以通过ref或bean标签设置拦截器，通过mvc:mapping设置需要拦截的请求，通过mvc:exclude-mapping设置需要排除的请求，即不需要拦截的请求</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br></pre></td></tr></table></figure><h3 id="拦截器的三个抽象方法"><a class="markdownIt-Anchor" href="#拦截器的三个抽象方法"></a> 拦截器的三个抽象方法</h3><p>SpringMVC 中的拦截器有三个抽象方法：</p><p>preHandle：控制器方法执行之前执行 preHandle()，其 boolean 类型的返回值表示是否拦截或放行，返回 true 为放行，即调用控制器方法；返回 false 表示拦截，即不调用控制器方法</p><p>postHandle：控制器方法执行之后执行 postHandle()</p><p>afterComplation：处理完视图和模型数据，渲染视图完毕之后执行 afterComplation()</p><h3 id="多个拦截器的执行顺序"><a class="markdownIt-Anchor" href="#多个拦截器的执行顺序"></a> 多个拦截器的执行顺序</h3><p>a&gt;若每个拦截器的 preHandle()都返回 true</p><p>此时多个拦截器的执行顺序和拦截器在 SpringMVC 的配置文件的配置顺序有关：</p><p>preHandle()会按照配置的顺序执行，而 postHandle()和 afterComplation()会按照配置的反序执行</p><p>b&gt;若某个拦截器的 preHandle()返回了 false</p><p>preHandle()返回 false 和它之前的拦截器的 preHandle()都会执行，postHandle()都不执行，返回 false 的拦截器之前的拦截器的 afterComplation()会执行</p><h1 id="异常处理器"><a class="markdownIt-Anchor" href="#异常处理器"></a> 异常处理器</h1><h3 id="基于配置的异常处理"><a class="markdownIt-Anchor" href="#基于配置的异常处理"></a> 基于配置的异常处理</h3><p>SpringMVC 提供了一个处理控制器方法执行过程中所出现的异常的接口：HandlerExceptionResolver</p><p>HandlerExceptionResolver 接口的实现类有：DefaultHandlerExceptionResolver 和 SimpleMappingExceptionResolver</p><p>SpringMVC 提供了自定义的异常处理器 SimpleMappingExceptionResolver，使用方式：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.web.servlet.handler.SimpleMappingExceptionResolver&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;exceptionMappings&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">props</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">        properties的键表示处理器方法执行过程中出现的异常</span></span><br><span class="line"><span class="comment">        properties的值表示若出现指定异常时，设置一个新的视图名称，跳转到指定页面</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;java.lang.ArithmeticException&quot;</span>&gt;</span>error<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">props</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">    exceptionAttribute属性设置一个属性名，将出现的异常信息在请求域中进行共享</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;exceptionAttribute&quot;</span> <span class="attr">value</span>=<span class="string">&quot;ex&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="基于注解的异常处理"><a class="markdownIt-Anchor" href="#基于注解的异常处理"></a> 基于注解的异常处理</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//@ControllerAdvice将当前类标识为异常处理的组件</span></span><br><span class="line"><span class="meta">@ControllerAdvice</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ExceptionController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//@ExceptionHandler用于设置所标识方法处理的异常</span></span><br><span class="line">    <span class="meta">@ExceptionHandler(ArithmeticException.class)</span></span><br><span class="line">    <span class="comment">//ex表示当前请求处理中出现的异常对象</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">handleArithmeticException</span><span class="params">(Exception ex, Model model)</span>&#123;</span><br><span class="line">        model.addAttribute(<span class="string">&quot;ex&quot;</span>, ex);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;error&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="注解配置-springmvc"><a class="markdownIt-Anchor" href="#注解配置-springmvc"></a> 注解配置 SpringMVC</h1><p>使用配置类和注解代替 web.xml 和 SpringMVC 配置文件的功能</p><h3 id="创建初始化类代替-webxml"><a class="markdownIt-Anchor" href="#创建初始化类代替-webxml"></a> 创建初始化类，代替 web.xml</h3><p>在 Servlet3.0 环境中，容器会在类路径中查找实现 javax.servlet.ServletContainerInitializer 接口的类，如果找到的话就用它来配置 Servlet 容器。<br />Spring 提供了这个接口的实现，名为 SpringServletContainerInitializer，这个类反过来又会查找实现 WebApplicationInitializer 的类并将配置的任务交给它们来完成。Spring3.2 引入了一个便利的 WebApplicationInitializer 基础实现，名为 AbstractAnnotationConfigDispatcherServletInitializer，当我们的类扩展了 AbstractAnnotationConfigDispatcherServletInitializer 并将其部署到 Servlet3.0 容器的时候，容器会自动发现它，并用它来配置 Servlet 上下文。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WebInit</span> <span class="keyword">extends</span> <span class="title class_">AbstractAnnotationConfigDispatcherServletInitializer</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 指定spring的配置类</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> Class&lt;?&gt;[] getRootConfigClasses() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;SpringConfig.class&#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 指定SpringMVC的配置类</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> Class&lt;?&gt;[] getServletConfigClasses() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;WebConfig.class&#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 指定DispatcherServlet的映射规则，即url-pattern</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> String[] getServletMappings() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">String</span>[]&#123;<span class="string">&quot;/&quot;</span>&#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 添加过滤器</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> Filter[] getServletFilters() &#123;</span><br><span class="line">        <span class="type">CharacterEncodingFilter</span> <span class="variable">encodingFilter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CharacterEncodingFilter</span>();</span><br><span class="line">        encodingFilter.setEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">        encodingFilter.setForceRequestEncoding(<span class="literal">true</span>);</span><br><span class="line">        <span class="type">HiddenHttpMethodFilter</span> <span class="variable">hiddenHttpMethodFilter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HiddenHttpMethodFilter</span>();</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Filter</span>[]&#123;encodingFilter, hiddenHttpMethodFilter&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="创建-springconfig-配置类代替-spring-的配置文件"><a class="markdownIt-Anchor" href="#创建-springconfig-配置类代替-spring-的配置文件"></a> 创建 SpringConfig 配置类，代替 spring 的配置文件</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringConfig</span> &#123;</span><br><span class="line"><span class="comment">//ssm整合之后，spring的配置信息写在此类中</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="创建-webconfig-配置类代替-springmvc-的配置文件"><a class="markdownIt-Anchor" href="#创建-webconfig-配置类代替-springmvc-的配置文件"></a> 创建 WebConfig 配置类，代替 SpringMVC 的配置文件</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="comment">//扫描组件</span></span><br><span class="line"><span class="meta">@ComponentScan(&quot;com.atguigu.mvc.controller&quot;)</span></span><br><span class="line"><span class="comment">//开启MVC注解驱动</span></span><br><span class="line"><span class="meta">@EnableWebMvc</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WebConfig</span> <span class="keyword">implements</span> <span class="title class_">WebMvcConfigurer</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//使用默认的servlet处理静态资源</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">configureDefaultServletHandling</span><span class="params">(DefaultServletHandlerConfigurer configurer)</span> &#123;</span><br><span class="line">        configurer.enable();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//配置文件上传解析器</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> CommonsMultipartResolver <span class="title function_">multipartResolver</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">CommonsMultipartResolver</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//配置拦截器</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addInterceptors</span><span class="params">(InterceptorRegistry registry)</span> &#123;</span><br><span class="line">        <span class="type">FirstInterceptor</span> <span class="variable">firstInterceptor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FirstInterceptor</span>();</span><br><span class="line">        registry.addInterceptor(firstInterceptor).addPathPatterns(<span class="string">&quot;/**&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//配置视图控制</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/*@Override</span></span><br><span class="line"><span class="comment">    public void addViewControllers(ViewControllerRegistry registry) &#123;</span></span><br><span class="line"><span class="comment">        registry.addViewController(&quot;/&quot;).setViewName(&quot;index&quot;);</span></span><br><span class="line"><span class="comment">    &#125;*/</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//配置异常映射</span></span><br><span class="line">    <span class="comment">/*@Override</span></span><br><span class="line"><span class="comment">    public void configureHandlerExceptionResolvers(List&lt;HandlerExceptionResolver&gt; resolvers) &#123;</span></span><br><span class="line"><span class="comment">        SimpleMappingExceptionResolver exceptionResolver = new SimpleMappingExceptionResolver();</span></span><br><span class="line"><span class="comment">        Properties prop = new Properties();</span></span><br><span class="line"><span class="comment">        prop.setProperty(&quot;java.lang.ArithmeticException&quot;, &quot;error&quot;);</span></span><br><span class="line"><span class="comment">        //设置异常映射</span></span><br><span class="line"><span class="comment">        exceptionResolver.setExceptionMappings(prop);</span></span><br><span class="line"><span class="comment">        //设置共享异常信息的键</span></span><br><span class="line"><span class="comment">        exceptionResolver.setExceptionAttribute(&quot;ex&quot;);</span></span><br><span class="line"><span class="comment">        resolvers.add(exceptionResolver);</span></span><br><span class="line"><span class="comment">    &#125;*/</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//配置生成模板解析器</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> ITemplateResolver <span class="title function_">templateResolver</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">WebApplicationContext</span> <span class="variable">webApplicationContext</span> <span class="operator">=</span> ContextLoader.getCurrentWebApplicationContext();</span><br><span class="line">        <span class="comment">// ServletContextTemplateResolver需要一个ServletContext作为构造参数，可通过WebApplicationContext 的方法获得</span></span><br><span class="line">        <span class="type">ServletContextTemplateResolver</span> <span class="variable">templateResolver</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ServletContextTemplateResolver</span>(</span><br><span class="line">                webApplicationContext.getServletContext());</span><br><span class="line">        templateResolver.setPrefix(<span class="string">&quot;/WEB-INF/templates/&quot;</span>);</span><br><span class="line">        templateResolver.setSuffix(<span class="string">&quot;.html&quot;</span>);</span><br><span class="line">        templateResolver.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">        templateResolver.setTemplateMode(TemplateMode.HTML);</span><br><span class="line">        <span class="keyword">return</span> templateResolver;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//生成模板引擎并为模板引擎注入模板解析器</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> SpringTemplateEngine <span class="title function_">templateEngine</span><span class="params">(ITemplateResolver templateResolver)</span> &#123;</span><br><span class="line">        <span class="type">SpringTemplateEngine</span> <span class="variable">templateEngine</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SpringTemplateEngine</span>();</span><br><span class="line">        templateEngine.setTemplateResolver(templateResolver);</span><br><span class="line">        <span class="keyword">return</span> templateEngine;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//生成视图解析器并未解析器注入模板引擎</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> ViewResolver <span class="title function_">viewResolver</span><span class="params">(SpringTemplateEngine templateEngine)</span> &#123;</span><br><span class="line">        <span class="type">ThymeleafViewResolver</span> <span class="variable">viewResolver</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ThymeleafViewResolver</span>();</span><br><span class="line">        viewResolver.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">        viewResolver.setTemplateEngine(templateEngine);</span><br><span class="line">        <span class="keyword">return</span> viewResolver;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="测试功能"><a class="markdownIt-Anchor" href="#测试功能"></a> 测试功能</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">index</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;index&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="springmvc-执行流程"><a class="markdownIt-Anchor" href="#springmvc-执行流程"></a> SpringMVC 执行流程</h1><h3 id="springmvc-常用组件"><a class="markdownIt-Anchor" href="#springmvc-常用组件"></a> SpringMVC 常用组件</h3><ul><li>DispatcherServlet：<strong>前端控制器</strong>，不需要工程师开发，由框架提供</li></ul><p>作用：统一处理请求和响应，整个流程控制的中心，由它调用其它组件处理用户的请求</p><ul><li>HandlerMapping：<strong>处理器映射器</strong>，不需要工程师开发，由框架提供</li></ul><p>作用：根据请求的 url、method 等信息查找 Handler，即控制器方法</p><ul><li>Handler：<strong>处理器</strong>，需要工程师开发</li></ul><p>作用：在 DispatcherServlet 的控制下 Handler 对具体的用户请求进行处理</p><ul><li>HandlerAdapter：<strong>处理器适配器</strong>，不需要工程师开发，由框架提供</li></ul><p>作用：通过 HandlerAdapter 对处理器（控制器方法）进行执行</p><ul><li>ViewResolver：<strong>视图解析器</strong>，不需要工程师开发，由框架提供</li></ul><p>作用：进行视图解析，得到相应的视图，例如：ThymeleafView、InternalResourceView、RedirectView</p><ul><li>View：<strong>视图</strong></li></ul><p>作用：将模型数据通过页面展示给用户</p><h3 id="dispatcherservlet-初始化过程"><a class="markdownIt-Anchor" href="#dispatcherservlet-初始化过程"></a> DispatcherServlet 初始化过程</h3><p>DispatcherServlet 本质上是一个 Servlet，所以天然的遵循 Servlet 的生命周期。所以宏观上是 Servlet 生命周期来进行调度。</p><p><img src="https://unpkg.com/serms-assets@1.0.6/Spring/img005.png" alt="" /></p><h5 id="a初始化-webapplicationcontext"><a class="markdownIt-Anchor" href="#a初始化-webapplicationcontext"></a> a&gt;初始化 WebApplicationContext</h5><p>所在类：org.springframework.web.servlet.FrameworkServlet</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> WebApplicationContext <span class="title function_">initWebApplicationContext</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">WebApplicationContext</span> <span class="variable">rootContext</span> <span class="operator">=</span></span><br><span class="line">        WebApplicationContextUtils.getWebApplicationContext(getServletContext());</span><br><span class="line">    <span class="type">WebApplicationContext</span> <span class="variable">wac</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">this</span>.webApplicationContext != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="comment">// A context instance was injected at construction time -&gt; use it</span></span><br><span class="line">        wac = <span class="built_in">this</span>.webApplicationContext;</span><br><span class="line">        <span class="keyword">if</span> (wac <span class="keyword">instanceof</span> ConfigurableWebApplicationContext) &#123;</span><br><span class="line">            <span class="type">ConfigurableWebApplicationContext</span> <span class="variable">cwac</span> <span class="operator">=</span> (ConfigurableWebApplicationContext) wac;</span><br><span class="line">            <span class="keyword">if</span> (!cwac.isActive()) &#123;</span><br><span class="line">                <span class="comment">// The context has not yet been refreshed -&gt; provide services such as</span></span><br><span class="line">                <span class="comment">// setting the parent context, setting the application context id, etc</span></span><br><span class="line">                <span class="keyword">if</span> (cwac.getParent() == <span class="literal">null</span>) &#123;</span><br><span class="line">                    <span class="comment">// The context instance was injected without an explicit parent -&gt; set</span></span><br><span class="line">                    <span class="comment">// the root application context (if any; may be null) as the parent</span></span><br><span class="line">                    cwac.setParent(rootContext);</span><br><span class="line">                &#125;</span><br><span class="line">                configureAndRefreshWebApplicationContext(cwac);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (wac == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="comment">// No context instance was injected at construction time -&gt; see if one</span></span><br><span class="line">        <span class="comment">// has been registered in the servlet context. If one exists, it is assumed</span></span><br><span class="line">        <span class="comment">// that the parent context (if any) has already been set and that the</span></span><br><span class="line">        <span class="comment">// user has performed any initialization such as setting the context id</span></span><br><span class="line">        wac = findWebApplicationContext();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (wac == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="comment">// No context instance is defined for this servlet -&gt; create a local one</span></span><br><span class="line">        <span class="comment">// 创建WebApplicationContext</span></span><br><span class="line">        wac = createWebApplicationContext(rootContext);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">this</span>.refreshEventReceived) &#123;</span><br><span class="line">        <span class="comment">// Either the context is not a ConfigurableApplicationContext with refresh</span></span><br><span class="line">        <span class="comment">// support or the context injected at construction time had already been</span></span><br><span class="line">        <span class="comment">// refreshed -&gt; trigger initial onRefresh manually here.</span></span><br><span class="line">        <span class="keyword">synchronized</span> (<span class="built_in">this</span>.onRefreshMonitor) &#123;</span><br><span class="line">            <span class="comment">// 刷新WebApplicationContext</span></span><br><span class="line">            onRefresh(wac);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">this</span>.publishContext) &#123;</span><br><span class="line">        <span class="comment">// Publish the context as a servlet context attribute.</span></span><br><span class="line">        <span class="comment">// 将IOC容器在应用域共享</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">attrName</span> <span class="operator">=</span> getServletContextAttributeName();</span><br><span class="line">        getServletContext().setAttribute(attrName, wac);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> wac;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="b创建-webapplicationcontext"><a class="markdownIt-Anchor" href="#b创建-webapplicationcontext"></a> b&gt;创建 WebApplicationContext</h5><p>所在类：org.springframework.web.servlet.FrameworkServlet</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> WebApplicationContext <span class="title function_">createWebApplicationContext</span><span class="params">(<span class="meta">@Nullable</span> ApplicationContext parent)</span> &#123;</span><br><span class="line">    Class&lt;?&gt; contextClass = getContextClass();</span><br><span class="line">    <span class="keyword">if</span> (!ConfigurableWebApplicationContext.class.isAssignableFrom(contextClass)) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">ApplicationContextException</span>(</span><br><span class="line">            <span class="string">&quot;Fatal initialization error in servlet with name &#x27;&quot;</span> + getServletName() +</span><br><span class="line">            <span class="string">&quot;&#x27;: custom WebApplicationContext class [&quot;</span> + contextClass.getName() +</span><br><span class="line">            <span class="string">&quot;] is not of type ConfigurableWebApplicationContext&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 通过反射创建 IOC 容器对象</span></span><br><span class="line">    <span class="type">ConfigurableWebApplicationContext</span> <span class="variable">wac</span> <span class="operator">=</span></span><br><span class="line">        (ConfigurableWebApplicationContext) BeanUtils.instantiateClass(contextClass);</span><br><span class="line"></span><br><span class="line">    wac.setEnvironment(getEnvironment());</span><br><span class="line">    <span class="comment">// 设置父容器</span></span><br><span class="line">    wac.setParent(parent);</span><br><span class="line">    <span class="type">String</span> <span class="variable">configLocation</span> <span class="operator">=</span> getContextConfigLocation();</span><br><span class="line">    <span class="keyword">if</span> (configLocation != <span class="literal">null</span>) &#123;</span><br><span class="line">        wac.setConfigLocation(configLocation);</span><br><span class="line">    &#125;</span><br><span class="line">    configureAndRefreshWebApplicationContext(wac);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> wac;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="cdispatcherservlet-初始化策略"><a class="markdownIt-Anchor" href="#cdispatcherservlet-初始化策略"></a> c&gt;DispatcherServlet 初始化策略</h5><p>FrameworkServlet 创建 WebApplicationContext 后，刷新容器，调用 onRefresh(wac)，此方法在 DispatcherServlet 中进行了重写，调用了 initStrategies(context)方法，初始化策略，即初始化 DispatcherServlet 的各个组件</p><p>所在类：org.springframework.web.servlet.DispatcherServlet</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">initStrategies</span><span class="params">(ApplicationContext context)</span> &#123;</span><br><span class="line">   initMultipartResolver(context);</span><br><span class="line">   initLocaleResolver(context);</span><br><span class="line">   initThemeResolver(context);</span><br><span class="line">   initHandlerMappings(context);</span><br><span class="line">   initHandlerAdapters(context);</span><br><span class="line">   initHandlerExceptionResolvers(context);</span><br><span class="line">   initRequestToViewNameTranslator(context);</span><br><span class="line">   initViewResolvers(context);</span><br><span class="line">   initFlashMapManager(context);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="dispatcherservlet-调用组件处理请求"><a class="markdownIt-Anchor" href="#dispatcherservlet-调用组件处理请求"></a> DispatcherServlet 调用组件处理请求</h3><h5 id="aprocessrequest"><a class="markdownIt-Anchor" href="#aprocessrequest"></a> a&gt;processRequest()</h5><p>FrameworkServlet 重写 HttpServlet 中的 service()和 doXxx()，这些方法中调用了 processRequest(request, response)</p><p>所在类：org.springframework.web.servlet.FrameworkServlet</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title function_">processRequest</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line">    <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">long</span> <span class="variable">startTime</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">    <span class="type">Throwable</span> <span class="variable">failureCause</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">LocaleContext</span> <span class="variable">previousLocaleContext</span> <span class="operator">=</span> LocaleContextHolder.getLocaleContext();</span><br><span class="line">    <span class="type">LocaleContext</span> <span class="variable">localeContext</span> <span class="operator">=</span> buildLocaleContext(request);</span><br><span class="line"></span><br><span class="line">    <span class="type">RequestAttributes</span> <span class="variable">previousAttributes</span> <span class="operator">=</span> RequestContextHolder.getRequestAttributes();</span><br><span class="line">    <span class="type">ServletRequestAttributes</span> <span class="variable">requestAttributes</span> <span class="operator">=</span> buildRequestAttributes(request, response, previousAttributes);</span><br><span class="line"></span><br><span class="line">    <span class="type">WebAsyncManager</span> <span class="variable">asyncManager</span> <span class="operator">=</span> WebAsyncUtils.getAsyncManager(request);</span><br><span class="line">    asyncManager.registerCallableInterceptor(FrameworkServlet.class.getName(), <span class="keyword">new</span> <span class="title class_">RequestBindingInterceptor</span>());</span><br><span class="line"></span><br><span class="line">    initContextHolders(request, localeContext, requestAttributes);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line"><span class="comment">// 执行服务，doService()是一个抽象方法，在DispatcherServlet中进行了重写</span></span><br><span class="line">        doService(request, response);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (ServletException | IOException ex) &#123;</span><br><span class="line">        failureCause = ex;</span><br><span class="line">        <span class="keyword">throw</span> ex;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (Throwable ex) &#123;</span><br><span class="line">        failureCause = ex;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">NestedServletException</span>(<span class="string">&quot;Request processing failed&quot;</span>, ex);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">finally</span> &#123;</span><br><span class="line">        resetContextHolders(request, previousLocaleContext, previousAttributes);</span><br><span class="line">        <span class="keyword">if</span> (requestAttributes != <span class="literal">null</span>) &#123;</span><br><span class="line">            requestAttributes.requestCompleted();</span><br><span class="line">        &#125;</span><br><span class="line">        logResult(request, response, failureCause, asyncManager);</span><br><span class="line">        publishRequestHandledEvent(request, response, startTime, failureCause);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="bdoservice"><a class="markdownIt-Anchor" href="#bdoservice"></a> b&gt;doService()</h5><p>所在类：org.springframework.web.servlet.DispatcherServlet</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doService</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    logRequest(request);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Keep a snapshot of the request attributes in case of an include,</span></span><br><span class="line">    <span class="comment">// to be able to restore the original attributes after the include.</span></span><br><span class="line">    Map&lt;String, Object&gt; attributesSnapshot = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">if</span> (WebUtils.isIncludeRequest(request)) &#123;</span><br><span class="line">        attributesSnapshot = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        Enumeration&lt;?&gt; attrNames = request.getAttributeNames();</span><br><span class="line">        <span class="keyword">while</span> (attrNames.hasMoreElements()) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">attrName</span> <span class="operator">=</span> (String) attrNames.nextElement();</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">this</span>.cleanupAfterInclude || attrName.startsWith(DEFAULT_STRATEGIES_PREFIX)) &#123;</span><br><span class="line">                attributesSnapshot.put(attrName, request.getAttribute(attrName));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Make framework objects available to handlers and view objects.</span></span><br><span class="line">    request.setAttribute(WEB_APPLICATION_CONTEXT_ATTRIBUTE, getWebApplicationContext());</span><br><span class="line">    request.setAttribute(LOCALE_RESOLVER_ATTRIBUTE, <span class="built_in">this</span>.localeResolver);</span><br><span class="line">    request.setAttribute(THEME_RESOLVER_ATTRIBUTE, <span class="built_in">this</span>.themeResolver);</span><br><span class="line">    request.setAttribute(THEME_SOURCE_ATTRIBUTE, getThemeSource());</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">this</span>.flashMapManager != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="type">FlashMap</span> <span class="variable">inputFlashMap</span> <span class="operator">=</span> <span class="built_in">this</span>.flashMapManager.retrieveAndUpdate(request, response);</span><br><span class="line">        <span class="keyword">if</span> (inputFlashMap != <span class="literal">null</span>) &#123;</span><br><span class="line">            request.setAttribute(INPUT_FLASH_MAP_ATTRIBUTE, Collections.unmodifiableMap(inputFlashMap));</span><br><span class="line">        &#125;</span><br><span class="line">        request.setAttribute(OUTPUT_FLASH_MAP_ATTRIBUTE, <span class="keyword">new</span> <span class="title class_">FlashMap</span>());</span><br><span class="line">        request.setAttribute(FLASH_MAP_MANAGER_ATTRIBUTE, <span class="built_in">this</span>.flashMapManager);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">RequestPath</span> <span class="variable">requestPath</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">this</span>.parseRequestPath &amp;&amp; !ServletRequestPathUtils.hasParsedRequestPath(request)) &#123;</span><br><span class="line">        requestPath = ServletRequestPathUtils.parseAndCache(request);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// 处理请求和响应</span></span><br><span class="line">        doDispatch(request, response);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (!WebAsyncUtils.getAsyncManager(request).isConcurrentHandlingStarted()) &#123;</span><br><span class="line">            <span class="comment">// Restore the original attribute snapshot, in case of an include.</span></span><br><span class="line">            <span class="keyword">if</span> (attributesSnapshot != <span class="literal">null</span>) &#123;</span><br><span class="line">                restoreAttributesAfterInclude(request, attributesSnapshot);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (requestPath != <span class="literal">null</span>) &#123;</span><br><span class="line">            ServletRequestPathUtils.clearParsedRequestPath(request);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="cdodispatch"><a class="markdownIt-Anchor" href="#cdodispatch"></a> c&gt;doDispatch()</h5><p>所在类：org.springframework.web.servlet.DispatcherServlet</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doDispatch</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    <span class="type">HttpServletRequest</span> <span class="variable">processedRequest</span> <span class="operator">=</span> request;</span><br><span class="line">    <span class="type">HandlerExecutionChain</span> <span class="variable">mappedHandler</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="type">boolean</span> <span class="variable">multipartRequestParsed</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">WebAsyncManager</span> <span class="variable">asyncManager</span> <span class="operator">=</span> WebAsyncUtils.getAsyncManager(request);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="type">ModelAndView</span> <span class="variable">mv</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">Exception</span> <span class="variable">dispatchException</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            processedRequest = checkMultipart(request);</span><br><span class="line">            multipartRequestParsed = (processedRequest != request);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Determine handler for the current request.</span></span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">            mappedHandler：调用链</span></span><br><span class="line"><span class="comment">                包含handler、interceptorList、interceptorIndex</span></span><br><span class="line"><span class="comment">            handler：浏览器发送的请求所匹配的控制器方法</span></span><br><span class="line"><span class="comment">            interceptorList：处理控制器方法的所有拦截器集合</span></span><br><span class="line"><span class="comment">            interceptorIndex：拦截器索引，控制拦截器afterCompletion()的执行</span></span><br><span class="line"><span class="comment">            */</span></span><br><span class="line">            mappedHandler = getHandler(processedRequest);</span><br><span class="line">            <span class="keyword">if</span> (mappedHandler == <span class="literal">null</span>) &#123;</span><br><span class="line">                noHandlerFound(processedRequest, response);</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Determine handler adapter for the current request.</span></span><br><span class="line">           <span class="comment">// 通过控制器方法创建相应的处理器适配器，调用所对应的控制器方法</span></span><br><span class="line">            <span class="type">HandlerAdapter</span> <span class="variable">ha</span> <span class="operator">=</span> getHandlerAdapter(mappedHandler.getHandler());</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Process last-modified header, if supported by the handler.</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">method</span> <span class="operator">=</span> request.getMethod();</span><br><span class="line">            <span class="type">boolean</span> <span class="variable">isGet</span> <span class="operator">=</span> <span class="string">&quot;GET&quot;</span>.equals(method);</span><br><span class="line">            <span class="keyword">if</span> (isGet || <span class="string">&quot;HEAD&quot;</span>.equals(method)) &#123;</span><br><span class="line">                <span class="type">long</span> <span class="variable">lastModified</span> <span class="operator">=</span> ha.getLastModified(request, mappedHandler.getHandler());</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">new</span> <span class="title class_">ServletWebRequest</span>(request, response).checkNotModified(lastModified) &amp;&amp; isGet) &#123;</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 调用拦截器的preHandle()</span></span><br><span class="line">            <span class="keyword">if</span> (!mappedHandler.applyPreHandle(processedRequest, response)) &#123;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Actually invoke the handler.</span></span><br><span class="line">            <span class="comment">// 由处理器适配器调用具体的控制器方法，最终获得ModelAndView对象</span></span><br><span class="line">            mv = ha.handle(processedRequest, response, mappedHandler.getHandler());</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (asyncManager.isConcurrentHandlingStarted()) &#123;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            applyDefaultViewName(processedRequest, mv);</span><br><span class="line">            <span class="comment">// 调用拦截器的postHandle()</span></span><br><span class="line">            mappedHandler.applyPostHandle(processedRequest, response, mv);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (Exception ex) &#123;</span><br><span class="line">            dispatchException = ex;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (Throwable err) &#123;</span><br><span class="line">            <span class="comment">// As of 4.3, we&#x27;re processing Errors thrown from handler methods as well,</span></span><br><span class="line">            <span class="comment">// making them available for @ExceptionHandler methods and other scenarios.</span></span><br><span class="line">            dispatchException = <span class="keyword">new</span> <span class="title class_">NestedServletException</span>(<span class="string">&quot;Handler dispatch failed&quot;</span>, err);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 后续处理：处理模型数据和渲染视图</span></span><br><span class="line">        processDispatchResult(processedRequest, response, mappedHandler, mv, dispatchException);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (Exception ex) &#123;</span><br><span class="line">        triggerAfterCompletion(processedRequest, response, mappedHandler, ex);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (Throwable err) &#123;</span><br><span class="line">        triggerAfterCompletion(processedRequest, response, mappedHandler,</span><br><span class="line">                               <span class="keyword">new</span> <span class="title class_">NestedServletException</span>(<span class="string">&quot;Handler processing failed&quot;</span>, err));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (asyncManager.isConcurrentHandlingStarted()) &#123;</span><br><span class="line">            <span class="comment">// Instead of postHandle and afterCompletion</span></span><br><span class="line">            <span class="keyword">if</span> (mappedHandler != <span class="literal">null</span>) &#123;</span><br><span class="line">                mappedHandler.applyAfterConcurrentHandlingStarted(processedRequest, response);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// Clean up any resources used by a multipart request.</span></span><br><span class="line">            <span class="keyword">if</span> (multipartRequestParsed) &#123;</span><br><span class="line">                cleanupMultipart(processedRequest);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="dprocessdispatchresult"><a class="markdownIt-Anchor" href="#dprocessdispatchresult"></a> d&gt;processDispatchResult()</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">processDispatchResult</span><span class="params">(HttpServletRequest request, HttpServletResponse response,</span></span><br><span class="line"><span class="params">                                   <span class="meta">@Nullable</span> HandlerExecutionChain mappedHandler, <span class="meta">@Nullable</span> ModelAndView mv,</span></span><br><span class="line"><span class="params">                                   <span class="meta">@Nullable</span> Exception exception)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">boolean</span> <span class="variable">errorView</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (exception != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (exception <span class="keyword">instanceof</span> ModelAndViewDefiningException) &#123;</span><br><span class="line">            logger.debug(<span class="string">&quot;ModelAndViewDefiningException encountered&quot;</span>, exception);</span><br><span class="line">            mv = ((ModelAndViewDefiningException) exception).getModelAndView();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="type">Object</span> <span class="variable">handler</span> <span class="operator">=</span> (mappedHandler != <span class="literal">null</span> ? mappedHandler.getHandler() : <span class="literal">null</span>);</span><br><span class="line">            mv = processHandlerException(request, response, handler, exception);</span><br><span class="line">            errorView = (mv != <span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Did the handler return a view to render?</span></span><br><span class="line">    <span class="keyword">if</span> (mv != <span class="literal">null</span> &amp;&amp; !mv.wasCleared()) &#123;</span><br><span class="line">        <span class="comment">// 处理模型数据和渲染视图</span></span><br><span class="line">        render(mv, request, response);</span><br><span class="line">        <span class="keyword">if</span> (errorView) &#123;</span><br><span class="line">            WebUtils.clearErrorRequestAttributes(request);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (logger.isTraceEnabled()) &#123;</span><br><span class="line">            logger.trace(<span class="string">&quot;No view rendering, null ModelAndView returned.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (WebAsyncUtils.getAsyncManager(request).isConcurrentHandlingStarted()) &#123;</span><br><span class="line">        <span class="comment">// Concurrent handling started during a forward</span></span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (mappedHandler != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="comment">// Exception (if any) is already handled..</span></span><br><span class="line">        <span class="comment">// 调用拦截器的afterCompletion()</span></span><br><span class="line">        mappedHandler.triggerAfterCompletion(request, response, <span class="literal">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="springmvc-的执行流程"><a class="markdownIt-Anchor" href="#springmvc-的执行流程"></a> SpringMVC 的执行流程</h3><ol><li><p>用户向服务器发送请求，请求被 SpringMVC 前端控制器 DispatcherServlet 捕获。</p></li><li><p>DispatcherServlet 对请求 URL 进行解析，得到请求资源标识符（URI），判断请求 URI 对应的映射：</p></li></ol><p>a) 不存在</p><p>i. 再判断是否配置了 mvc:default-servlet-handler</p><p>ii. 如果没配置，则控制台报映射查找不到，客户端展示 404 错误</p><p><img src="https://unpkg.com/serms-assets@1.0.6/Spring/img006.png" alt="" /></p><p><img src="https://unpkg.com/serms-assets@1.0.6/Spring/img007.png" alt="" /></p><p>iii. 如果有配置，则访问目标资源（一般为静态资源，如：JS,CSS,HTML），找不到客户端也会展示 404 错误</p><p><img src="https://unpkg.com/serms-assets@1.0.6/Spring/img008.png" alt="" /></p><p><img src="https://unpkg.com/serms-assets@1.0.6/Spring/img009.png" alt="" /></p><p>b) 存在则执行下面的流程</p><ol><li><p>根据该 URI，调用 HandlerMapping 获得该 Handler 配置的所有相关的对象（包括 Handler 对象以及 Handler 对象对应的拦截器），最后以 HandlerExecutionChain 执行链对象的形式返回。</p></li><li><p>DispatcherServlet 根据获得的 Handler，选择一个合适的 HandlerAdapter。</p></li><li><p>如果成功获得 HandlerAdapter，此时将开始执行拦截器的 preHandler(…)方法【正向】</p></li><li><p>提取 Request 中的模型数据，填充 Handler 入参，开始执行 Handler（Controller)方法，处理请求。在填充 Handler 的入参过程中，根据你的配置，Spring 将帮你做一些额外的工作：</p></li></ol><p>a) HttpMessageConveter： 将请求消息（如 Json、xml 等数据）转换成一个对象，将对象转换为指定的响应信息</p><p>b) 数据转换：对请求消息进行数据转换。如 String 转换成 Integer、Double 等</p><p>c) 数据格式化：对请求消息进行数据格式化。 如将字符串转换成格式化数字或格式化日期等</p><p>d) 数据验证： 验证数据的有效性（长度、格式等），验证结果存储到 BindingResult 或 Error 中</p><ol start="7"><li><p>Handler 执行完成后，向 DispatcherServlet 返回一个 ModelAndView 对象。</p></li><li><p>此时将开始执行拦截器的 postHandle(…)方法【逆向】。</p></li><li><p>根据返回的 ModelAndView（此时会判断是否存在异常：如果存在异常，则执行 HandlerExceptionResolver 进行异常处理）选择一个适合的 ViewResolver 进行视图解析，根据 Model 和 View，来渲染视图。</p></li><li><p>渲染视图完毕执行拦截器的 afterCompletion(…)方法【逆向】。</p></li><li><p>将渲染结果返回给客户端。</p></li></ol>]]></content>
      
      
      <categories>
          
          <category> Spring </category>
          
          <category> 编程笔记 </category>
          
          <category> Java </category>
          
          <category> SpringMVC笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Spring </tag>
            
            <tag> 编程笔记 </tag>
            
            <tag> MVC </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Mybatis注解开发</title>
      <link href="/posts/6e9321d6/"/>
      <url>/posts/6e9321d6/</url>
      
        <content type="html"><![CDATA[<h2 id="mybatis-的常用注解"><a class="markdownIt-Anchor" href="#mybatis-的常用注解"></a> mybatis 的常用注解</h2><table><thead><tr><th style="text-align:center">注解</th><th style="text-align:center">说明<br/></th></tr></thead><tbody><tr><td style="text-align:center">@Insert</td><td style="text-align:center">实现新增<br/></td></tr><tr><td style="text-align:center">@Delete</td><td style="text-align:center">实现删除<br/></td></tr><tr><td style="text-align:center">@Update</td><td style="text-align:center">实现更新<br/></td></tr><tr><td style="text-align:center">@Select</td><td style="text-align:center">实现查询<br/></td></tr><tr><td style="text-align:center">@Result</td><td style="text-align:center">实现结果集封装<br/></td></tr><tr><td style="text-align:center">@Results</td><td style="text-align:center">可以与@Result 一起使用，封装多个结果集<br/></td></tr><tr><td style="text-align:center">@ResultMap</td><td style="text-align:center">实现引用@Results 定义的封装<br/></td></tr><tr><td style="text-align:center">@One</td><td style="text-align:center">实现一对一结果集封装<br/></td></tr><tr><td style="text-align:center">@Many</td><td style="text-align:center">实现一对多结果集封装<br/></td></tr><tr><td style="text-align:center">@SelectProvider</td><td style="text-align:center">实现动态 SQL 映射<br/></td></tr><tr><td style="text-align:center">@CacheNamespace</td><td style="text-align:center">实现注解二级缓存的使用<br/></td></tr></tbody></table><hr /><h2 id="使用-mybatis-注解实现基本-crud"><a class="markdownIt-Anchor" href="#使用-mybatis-注解实现基本-crud"></a> 使用 Mybatis 注解实现基本 CRUD</h2><h3 id="项目目录结构"><a class="markdownIt-Anchor" href="#项目目录结构"></a> 项目目录结构</h3><p><img src="https://img-blog.csdnimg.cn/20210217022346823.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80Mzg4MzkxNw==,size_16,color_FFFFFF,t_70" alt="" /></p><h3 id="编写实体类"><a class="markdownIt-Anchor" href="#编写实体类"></a> 编写实体类</h3><p><strong>User：</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.keafmd.domain;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Keafmd</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@ClassName</span>: User</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: User实体类</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>: SerMs</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span>: 2022-02-16 20:28</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="keyword">private</span> String address;</span><br><span class="line">    <span class="keyword">private</span> String sex;</span><br><span class="line">    <span class="keyword">private</span> Date birthday;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">getId</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setId</span><span class="params">(Integer id)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getUsername</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> username;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUsername</span><span class="params">(String username)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.username = username;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getAddress</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAddress</span><span class="params">(String address)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.address = address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getSex</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> sex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setSex</span><span class="params">(String sex)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.sex = sex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Date <span class="title function_">getBirthday</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> birthday;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setBirthday</span><span class="params">(Date birthday)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.birthday = birthday;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;User&#123;&quot;</span> +</span><br><span class="line">            <span class="string">&quot;id=&quot;</span> + id +</span><br><span class="line">            <span class="string">&quot;, username=&#x27;&quot;</span> + username + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">            <span class="string">&quot;, address=&#x27;&quot;</span> + address + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">            <span class="string">&quot;, sex=&#x27;&quot;</span> + sex + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">            <span class="string">&quot;, birthday=&quot;</span> + birthday +</span><br><span class="line">            <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="使用注解方式开发持久层接口"><a class="markdownIt-Anchor" href="#使用注解方式开发持久层接口"></a> 使用注解方式开发持久层接口</h3><p><strong>IUserDao：</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.keafmd.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.keafmd.domain.User;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Delete;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Insert;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Select;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Update;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Keafmd</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@ClassName</span>: IUserDao</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>:</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>: SerMs</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span>: 2022-02-16 20:30</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 在mybatis中针对CRUD一共有四个注解</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Select</span> <span class="doctag">@Insert</span> <span class="doctag">@Update</span> <span class="doctag">@Delete</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">IUserDao</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 查询所有用户</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Select(&quot;select * from user&quot;)</span></span><br><span class="line">    List&lt;User&gt; <span class="title function_">findAll</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 保存用户</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> user</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Insert(&quot;insert into user(username,address,sex,birthday)values(#&#123;username&#125;,#&#123;address&#125;,#&#123;sex&#125;,#&#123;birthday&#125;)&quot;)</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">saveUser</span><span class="params">(User user)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 更新用户</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> user</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Update(&quot;update user set username=#&#123;username&#125;,sex=#&#123;sex&#125;,birthday=#&#123;birthday&#125;,address=#&#123;address&#125; where id=#&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">updateUser</span><span class="params">(User user)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 删除用户</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> userId</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Delete(&quot;delete from user where id=#&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">deleteUser</span><span class="params">(Integer userId)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根据id查询用户</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> userId</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Select(&quot;select * from user where id=#&#123;id&#125;&quot;)</span></span><br><span class="line">    User <span class="title function_">findById</span><span class="params">(Integer userId)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根据用户名称模糊查询</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> username</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">//@Select(&quot;select * from user where username like #&#123;username&#125;&quot;) //占位符</span></span><br><span class="line">    <span class="meta">@Select(&quot;select * from user where username like &#x27;%$&#123;value&#125;%&#x27;&quot;)</span>  <span class="comment">//字符串拼接</span></span><br><span class="line">    List&lt;User&gt; <span class="title function_">findByName</span><span class="params">(String username)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 查询总数量</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Select(&quot;select count(*) from user&quot;)</span></span><br><span class="line">    <span class="type">int</span> <span class="title function_">findTotal</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><div class="tip home"><p>通过注解方式，就不需要再去编写 UserDao.xml 映射文件了。</p></div><h3 id="编写-sqlmapconfigxml-配置文件"><a class="markdownIt-Anchor" href="#编写-sqlmapconfigxml-配置文件"></a> 编写 SqlMapConfig.xml 配置文件</h3><p><strong>SqlMapConfig.xml：</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">configuration</span></span></span><br><span class="line"><span class="meta">    <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">    <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--引入外部配置文件--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span> <span class="attr">resource</span>=<span class="string">&quot;jdbcConfig.properties&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--配置别名--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">&quot;com.keafmd.domain&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--配置环境--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">&quot;mysql&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">&quot;mysql&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">&quot;JDBC&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">transactionManager</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">&quot;POOLED&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driver&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.driver&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.url&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.username&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.password&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--指定带有注解的dao接口所在位置--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">&quot;com.keafmd.dao&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">package</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="编写测试代码"><a class="markdownIt-Anchor" href="#编写测试代码"></a> 编写测试代码</h3><p><strong>AnnotationCRUDTest：</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.keafmd.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.keafmd.dao.IUserDao;</span><br><span class="line"><span class="keyword">import</span> com.keafmd.domain.User;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.io.Resources;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"><span class="keyword">import</span> org.junit.After;</span><br><span class="line"><span class="keyword">import</span> org.junit.Before;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Keafmd</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@ClassName</span>: AnnotationCRUDTest</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: 注解开发CRUD测试</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>: SerMs</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span>: 2022-02-16 21:05</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AnnotationCRUDTest</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> InputStream in;</span><br><span class="line">    <span class="keyword">private</span> SqlSessionFactory factory;</span><br><span class="line">    <span class="keyword">private</span> SqlSession session;</span><br><span class="line">    <span class="keyword">private</span> IUserDao userDao;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">()</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        in = Resources.getResourceAsStream(<span class="string">&quot;SqlMapConfig.xml&quot;</span>);</span><br><span class="line">        factory = <span class="keyword">new</span> <span class="title class_">SqlSessionFactoryBuilder</span>().build(in);</span><br><span class="line">        session = factory.openSession();</span><br><span class="line">        userDao = session.getMapper(IUserDao.class);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@After</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destory</span><span class="params">()</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        session.commit();</span><br><span class="line">        session.close();</span><br><span class="line">        in.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testSave</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">        user.setUsername(<span class="string">&quot;mybatis annotation&quot;</span>);</span><br><span class="line">        user.setAddress(<span class="string">&quot;北京&quot;</span>);</span><br><span class="line"></span><br><span class="line">        userDao.saveUser(user);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testUpdate</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">        user.setId(<span class="number">55</span>);</span><br><span class="line">        user.setUsername(<span class="string">&quot;mybatis annotation&quot;</span>);</span><br><span class="line">        user.setAddress(<span class="string">&quot;北京&quot;</span>);</span><br><span class="line">        user.setSex(<span class="string">&quot;男&quot;</span>);</span><br><span class="line">        user.setBirthday(<span class="keyword">new</span> <span class="title class_">Date</span>());</span><br><span class="line"></span><br><span class="line">        userDao.updateUser(user);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testDelete</span><span class="params">()</span>&#123;</span><br><span class="line">        userDao.deleteUser(<span class="number">54</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testFindOne</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userDao.findById(<span class="number">55</span>);</span><br><span class="line">        System.out.println(user);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testFindByName</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">//List&lt;User&gt; users = userDao.findByName(&quot;%Keafmd%&quot;);</span></span><br><span class="line">        List&lt;User&gt; users = userDao.findByName(<span class="string">&quot;Keafmd&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (User user : users) &#123;</span><br><span class="line">            System.out.println(user);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testFindTotal</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">total</span> <span class="operator">=</span> userDao.findTotal();</span><br><span class="line">        System.out.println(total);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="使用注解实现复杂关系映射开发"><a class="markdownIt-Anchor" href="#使用注解实现复杂关系映射开发"></a> 使用注解实现复杂关系映射开发</h3><div class="tip "><p>实现复杂关系映射之前我们可以在映射文件中通过配置<code>&lt;resultMap&gt;</code>来实现，在使用注解开发时我们需要借助@Results 注解，@Result 注解，@One 注解，@Many 注解。</p></div><h3 id="复杂关系映射的注解说明"><a class="markdownIt-Anchor" href="#复杂关系映射的注解说明"></a> 复杂关系映射的注解说明</h3><blockquote><p><strong>@Results 注解<br />代替的是标签<code>&lt;resultMap&gt;</code><br />该注解中可以使用单个@Result 注解，也可以使用@Result 集合<br />@Results（{@Result（），@Result（）}）或@Results（@Result（））</strong></p></blockquote><blockquote><p><strong>@Resutl 注解<br />代替了<code>&lt;id&gt;</code> 标签和<code>&lt;result&gt;</code>标签<br />@Result 中的属性介绍：</strong></p></blockquote><table><thead><tr><th>@Result 中的属性</th><th>介绍</th></tr></thead><tbody><tr><td>id</td><td>是否是主键字段</td></tr><tr><td>column</td><td>数据库的列名</td></tr><tr><td>property</td><td>需要装配的属性名</td></tr><tr><td>one</td><td>需要使用的@One 注解（@Result（one=@One）（）））</td></tr><tr><td>many</td><td>需要使用的@Many 注解（@Result（many=@many）（）））</td></tr></tbody></table><blockquote><p>@One 注解（一对一）<br />代替了<assocation>标签，是多表查询的关键，在注解中用来指定子查询返回单一对象。<br />@One 注解属性介绍：<br />select 指定用来多表查询的 sqlmapper<br />fetchType 会覆盖全局的配置参数 lazyLoadingEnabled。<br />使用格式：@Result(column=&quot; “,property=”&quot;,one=@One(select=&quot;&quot;))</p></blockquote><blockquote><p>@Many 注解（多对一）<br />代替了<collection>标签,是是多表查询的关键，在注解中用来指定子查询返回对象集合。<br />注意：聚集元素用来处理“一对多”的关系。需要指定映射的 Java 实体类的属性，属性的 javaType（一般为 ArrayList）但是注解中可以不定义。<br />使用格式：@Result(property=&quot;&quot;,column=&quot;&quot;,many=@Many(select=&quot;&quot;))</p></blockquote><h2 id="项目目录"><a class="markdownIt-Anchor" href="#项目目录"></a> 项目目录</h2><p><img src="https://img-blog.csdnimg.cn/20210217024602241.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80Mzg4MzkxNw==,size_16,color_FFFFFF,t_70" alt="" /></p><h2 id="使用注解实现一对一复杂关系映射及立即加载"><a class="markdownIt-Anchor" href="#使用注解实现一对一复杂关系映射及立即加载"></a> 使用注解实现一对一复杂关系映射及立即加载</h2><div class="tip "><p><strong>需求：加载账户信息时并且加载该账户的用户信息，根据情况可实现立即加载。（注解方式实现）</strong></p></div><h3 id="添加-user-实体类及-account-实体类"><a class="markdownIt-Anchor" href="#添加-user-实体类及-account-实体类"></a> 添加 User 实体类及 Account 实体类</h3><p><strong>User：</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.keafmd.domain;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Keafmd</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@ClassName</span>: User</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: User实体类</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>: SerMs</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span>: 2022-02-16 20:28</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Integer userId;</span><br><span class="line">    <span class="keyword">private</span> String userName;</span><br><span class="line">    <span class="keyword">private</span> String userAddress;</span><br><span class="line">    <span class="keyword">private</span> String userSex;</span><br><span class="line">    <span class="keyword">private</span> Date userBirthday;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">getUserId</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> userId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUserId</span><span class="params">(Integer userId)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.userId = userId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getUserName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> userName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUserName</span><span class="params">(String userName)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.userName = userName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getUserAddress</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> userAddress;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUserAddress</span><span class="params">(String userAddress)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.userAddress = userAddress;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getUserSex</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> userSex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUserSex</span><span class="params">(String userSex)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.userSex = userSex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Date <span class="title function_">getUserBirthday</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> userBirthday;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUserBirthday</span><span class="params">(Date userBirthday)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.userBirthday = userBirthday;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;User&#123;&quot;</span> +</span><br><span class="line">            <span class="string">&quot;userId=&quot;</span> + userId +</span><br><span class="line">            <span class="string">&quot;, userName=&#x27;&quot;</span> + userName + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">            <span class="string">&quot;, userAddress=&#x27;&quot;</span> + userAddress + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">            <span class="string">&quot;, userSex=&#x27;&quot;</span> + userSex + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">            <span class="string">&quot;, userBirthday=&quot;</span> + userBirthday +</span><br><span class="line">            <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>Account：</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.keafmd.domain;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Keafmd</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@ClassName</span>: Account</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: 账户实体类</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>: SerMs</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span>: 2022-02-16 22:51</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Account</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> Integer uid;</span><br><span class="line">    <span class="keyword">private</span> Double money;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//多对一（mybatis中称之为一对一）的映射，一个账户只能属于一个用户 *</span></span><br><span class="line">    <span class="keyword">private</span> User user;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> User <span class="title function_">getUser</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> user;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUser</span><span class="params">(User user)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.user = user;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">getId</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setId</span><span class="params">(Integer id)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">getUid</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> uid;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUid</span><span class="params">(Integer uid)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.uid = uid;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Double <span class="title function_">getMoney</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> money;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setMoney</span><span class="params">(Double money)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.money = money;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Account&#123;&quot;</span> +</span><br><span class="line">            <span class="string">&quot;id=&quot;</span> + id +</span><br><span class="line">            <span class="string">&quot;, uid=&quot;</span> + uid +</span><br><span class="line">            <span class="string">&quot;, money=&quot;</span> + money +</span><br><span class="line">            <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="添加账户的持久层接口并使用注解配置"><a class="markdownIt-Anchor" href="#添加账户的持久层接口并使用注解配置"></a> 添加账户的持久层接口并使用注解配置</h3><p><strong>IAccountDao：</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.keafmd.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.keafmd.domain.Account;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.One;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Result;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Results;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Select;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.mapping.FetchType;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Keafmd</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@ClassName</span>: IAccountDao</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>:</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>: SerMs</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span>: 2021-02-16 22:54</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">IAccountDao</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 查询所有账户，并且获取每个账户下的用户信息,一对一</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Select(&quot;select * from account&quot;)</span></span><br><span class="line">    <span class="meta">@Results(id=&quot;accountMap&quot;,value = &#123;</span></span><br><span class="line"><span class="meta">        @Result(id = true,column = &quot;id&quot;,property = &quot;id&quot;),</span></span><br><span class="line"><span class="meta">        @Result(column = &quot;uid&quot;,property = &quot;uid&quot;),</span></span><br><span class="line"><span class="meta">        @Result(column = &quot;money&quot;,property = &quot;money&quot;),</span></span><br><span class="line"><span class="meta">        @Result(property = &quot;user&quot;,column = &quot;uid&quot;,one=@One(select=&quot;com.keafmd.dao.IUserDao.findById&quot;,fetchType= FetchType.EAGER))</span></span><br><span class="line"><span class="meta">    &#125;)</span></span><br><span class="line">    List&lt;Account&gt; <span class="title function_">findAll</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="添加用户的持久层接口并使用注解配置"><a class="markdownIt-Anchor" href="#添加用户的持久层接口并使用注解配置"></a> 添加用户的持久层接口并使用注解配置</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.keafmd.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.keafmd.domain.User;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.*;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.mapping.FetchType;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Keafmd</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@ClassName</span>: IUserDao</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>:</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>: SerMs</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span>: 2022-02-16 20:30</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 在mybatis中针对CRUD一共有四个注解</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Select</span> <span class="doctag">@Insert</span> <span class="doctag">@Update</span> <span class="doctag">@Delete</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">IUserDao</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 查询所有用户</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Select(&quot;select * from user&quot;)</span></span><br><span class="line">    <span class="meta">@Results(id=&quot;userMap&quot;,value=&#123;</span></span><br><span class="line"><span class="meta">        @Result(id = true,column = &quot;id&quot;,property = &quot;userId&quot;),</span></span><br><span class="line"><span class="meta">        @Result(column = &quot;id&quot;,property = &quot;userId&quot;),</span></span><br><span class="line"><span class="meta">        @Result(column = &quot;username&quot;,property = &quot;userName&quot;),</span></span><br><span class="line"><span class="meta">        @Result(column = &quot;sex&quot;,property = &quot;userSex&quot;),</span></span><br><span class="line"><span class="meta">        @Result(column = &quot;birthday&quot;,property = &quot;userBirthday&quot;)</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">    &#125;)</span></span><br><span class="line">    List&lt;User&gt; <span class="title function_">findAll</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根据id查询用户</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> userId</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Select(&quot;select * from user where id=#&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="comment">//@ResultMap(value=&#123;&quot;userMap&quot;&#125;)</span></span><br><span class="line">    <span class="meta">@ResultMap(&quot;userMap&quot;)</span></span><br><span class="line">    User <span class="title function_">findById</span><span class="params">(Integer userId)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根据用户名称模糊查询</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> username</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Select(&quot;select * from user where username like #&#123;username&#125;&quot;)</span> <span class="comment">//占位符</span></span><br><span class="line">    <span class="meta">@ResultMap(&quot;userMap&quot;)</span></span><br><span class="line">    List&lt;User&gt; <span class="title function_">findByName</span><span class="params">(String username)</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="测试一对一关联及立即加载"><a class="markdownIt-Anchor" href="#测试一对一关联及立即加载"></a> 测试一对一关联及立即加载</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.keafmd.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.keafmd.dao.IAccountDao;</span><br><span class="line"><span class="keyword">import</span> com.keafmd.dao.IUserDao;</span><br><span class="line"><span class="keyword">import</span> com.keafmd.domain.Account;</span><br><span class="line"><span class="keyword">import</span> com.keafmd.domain.User;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.io.Resources;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"><span class="keyword">import</span> org.junit.After;</span><br><span class="line"><span class="keyword">import</span> org.junit.Before;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Keafmd</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@ClassName</span>: AnnotationCRUDTest</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: 注解开发CRUD测试</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>: SerMs</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span>: 2022-02-16 21:05</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AccountTest</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> InputStream in;</span><br><span class="line">    <span class="keyword">private</span> SqlSessionFactory factory;</span><br><span class="line">    <span class="keyword">private</span> SqlSession session;</span><br><span class="line">    <span class="keyword">private</span> IAccountDao accountDao;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">()</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        in = Resources.getResourceAsStream(<span class="string">&quot;SqlMapConfig.xml&quot;</span>);</span><br><span class="line">        factory = <span class="keyword">new</span> <span class="title class_">SqlSessionFactoryBuilder</span>().build(in);</span><br><span class="line">        session = factory.openSession();</span><br><span class="line">        accountDao = session.getMapper(IAccountDao.class);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@After</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destory</span><span class="params">()</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        session.commit();</span><br><span class="line">        session.close();</span><br><span class="line">        in.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testFindAll</span><span class="params">()</span>&#123;</span><br><span class="line">        List&lt;Account&gt; accounts = accountDao.findAll();</span><br><span class="line">        <span class="keyword">for</span> (Account account : accounts) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;-----每个账户信息-----&quot;</span>);</span><br><span class="line">            System.out.println(account);</span><br><span class="line">            System.out.println(account.getUser());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>运行结果：</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">2021-02-17 03:04:39,939 163    [           main] DEBUG ansaction.jdbc.JdbcTransaction  - Opening JDBC Connection</span><br><span class="line">2021-02-17 03:04:40,190 414    [           main] DEBUG source.pooled.PooledDataSource  - Created connection 1176735295.</span><br><span class="line">2021-02-17 03:04:40,190 414    [           main] DEBUG ansaction.jdbc.JdbcTransaction  - Setting autocommit to false on JDBC Connection [com.mysql.jdbc.JDBC4Connection@46238e3f]</span><br><span class="line">2021-02-17 03:04:40,195 419    [           main] DEBUG keafmd.dao.IAccountDao.findAll  - ==&gt;  Preparing: select * from account</span><br><span class="line">2021-02-17 03:04:40,226 450    [           main] DEBUG keafmd.dao.IAccountDao.findAll  - ==&gt; Parameters:</span><br><span class="line">2021-02-17 03:04:40,267 491    [           main] DEBUG m.keafmd.dao.IUserDao.findById  - ====&gt;  Preparing: select * from user where id=?</span><br><span class="line">2021-02-17 03:04:40,268 492    [           main] DEBUG m.keafmd.dao.IUserDao.findById  - ====&gt; Parameters: 41(Integer)</span><br><span class="line">2021-02-17 03:04:40,270 494    [           main] DEBUG m.keafmd.dao.IUserDao.findById  - &lt;====      Total: 1</span><br><span class="line">2021-02-17 03:04:40,271 495    [           main] DEBUG m.keafmd.dao.IUserDao.findById  - ====&gt;  Preparing: select * from user where id=?</span><br><span class="line">2021-02-17 03:04:40,271 495    [           main] DEBUG m.keafmd.dao.IUserDao.findById  - ====&gt; Parameters: 45(Integer)</span><br><span class="line">2021-02-17 03:04:40,272 496    [           main] DEBUG m.keafmd.dao.IUserDao.findById  - &lt;====      Total: 1</span><br><span class="line">2021-02-17 03:04:40,273 497    [           main] DEBUG keafmd.dao.IAccountDao.findAll  - &lt;==      Total: 3</span><br><span class="line">-----每个账户信息-----</span><br><span class="line">Account&#123;id=1, uid=41, money=1000.0&#125;</span><br><span class="line">User&#123;userId=41, userName=&#x27;update user clear cache&#x27;, userAddress=&#x27;null&#x27;, userSex=&#x27;男&#x27;, userBirthday=Tue Feb 27 17:47:08 CST 2018&#125;</span><br><span class="line">-----每个账户信息-----</span><br><span class="line">Account&#123;id=2, uid=45, money=1000.0&#125;</span><br><span class="line">User&#123;userId=45, userName=&#x27;新一&#x27;, userAddress=&#x27;null&#x27;, userSex=&#x27;男&#x27;, userBirthday=Sun Mar 04 12:04:06 CST 2018&#125;</span><br><span class="line">-----每个账户信息-----</span><br><span class="line">Account&#123;id=3, uid=41, money=2000.0&#125;</span><br><span class="line">User&#123;userId=41, userName=&#x27;update user clear cache&#x27;, userAddress=&#x27;null&#x27;, userSex=&#x27;男&#x27;, userBirthday=Tue Feb 27 17:47:08 CST 2018&#125;</span><br><span class="line">2021-02-17 03:04:40,274 498    [           main] DEBUG ansaction.jdbc.JdbcTransaction  - Resetting autocommit to true on JDBC Connection [com.mysql.jdbc.JDBC4Connection@46238e3f]</span><br><span class="line">2021-02-17 03:04:40,274 498    [           main] DEBUG ansaction.jdbc.JdbcTransaction  - Closing JDBC Connection [com.mysql.jdbc.JDBC4Connection@46238e3f]</span><br><span class="line">2021-02-17 03:04:40,274 498    [           main] DEBUG source.pooled.PooledDataSource  - Returned connection 1176735295 to pool.</span><br><span class="line"></span><br><span class="line">Process finished with exit code 0</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="使用注解实现一对多复杂关系映射及延迟加载"><a class="markdownIt-Anchor" href="#使用注解实现一对多复杂关系映射及延迟加载"></a> 使用注解实现一对多复杂关系映射及延迟加载</h2><blockquote><p><strong>需求：查询用户信息时，也要查询他的账户列表。使用注解方式实现。<br />分析：一个用户具有多个账户信息，所以形成了用户(User)与账户(Account)之间的一对多关系。</strong></p></blockquote><h3 id="user-实体类加入-listaccount"><a class="markdownIt-Anchor" href="#user-实体类加入-listaccount"></a> User 实体类加入 List<code>&lt;Account&gt;</code></h3><p><strong>User：</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.keafmd.domain;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Keafmd</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@ClassName</span>: User</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: User实体类</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>: SerMs</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span>: 2021-02-16 20:28</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Integer userId;</span><br><span class="line">    <span class="keyword">private</span> String userName;</span><br><span class="line">    <span class="keyword">private</span> String userAddress;</span><br><span class="line">    <span class="keyword">private</span> String userSex;</span><br><span class="line">    <span class="keyword">private</span> Date userBirthday;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//一对多关系映射：一个用户对应多个账户</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;Account&gt; accounts;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> List&lt;Account&gt; <span class="title function_">getAccounts</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> accounts;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAccounts</span><span class="params">(List&lt;Account&gt; accounts)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.accounts = accounts;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">getUserId</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> userId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUserId</span><span class="params">(Integer userId)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.userId = userId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getUserName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> userName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUserName</span><span class="params">(String userName)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.userName = userName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getUserAddress</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> userAddress;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUserAddress</span><span class="params">(String userAddress)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.userAddress = userAddress;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getUserSex</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> userSex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUserSex</span><span class="params">(String userSex)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.userSex = userSex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Date <span class="title function_">getUserBirthday</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> userBirthday;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUserBirthday</span><span class="params">(Date userBirthday)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.userBirthday = userBirthday;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;User&#123;&quot;</span> +</span><br><span class="line">            <span class="string">&quot;userId=&quot;</span> + userId +</span><br><span class="line">            <span class="string">&quot;, userName=&#x27;&quot;</span> + userName + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">            <span class="string">&quot;, userAddress=&#x27;&quot;</span> + userAddress + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">            <span class="string">&quot;, userSex=&#x27;&quot;</span> + userSex + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">            <span class="string">&quot;, userBirthday=&quot;</span> + userBirthday +</span><br><span class="line">            <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="编写用户的持久层接口并使用注解配置"><a class="markdownIt-Anchor" href="#编写用户的持久层接口并使用注解配置"></a> 编写用户的持久层接口并使用注解配置</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.keafmd.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.keafmd.domain.User;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.*;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.mapping.FetchType;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Keafmd</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@ClassName</span>: IUserDao</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>:</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>: SerMs</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span>: 2021-02-16 20:30</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 在mybatis中针对CRUD一共有四个注解</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Select</span> <span class="doctag">@Insert</span> <span class="doctag">@Update</span> <span class="doctag">@Delete</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">IUserDao</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 查询所有用户</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Select(&quot;select * from user&quot;)</span></span><br><span class="line">    <span class="meta">@Results(id=&quot;userMap&quot;,value=&#123;</span></span><br><span class="line"><span class="meta">        @Result(id = true,column = &quot;id&quot;,property = &quot;userId&quot;),</span></span><br><span class="line"><span class="meta">        @Result(column = &quot;id&quot;,property = &quot;userId&quot;),</span></span><br><span class="line"><span class="meta">        @Result(column = &quot;username&quot;,property = &quot;userName&quot;),</span></span><br><span class="line"><span class="meta">        @Result(column = &quot;sex&quot;,property = &quot;userSex&quot;),</span></span><br><span class="line"><span class="meta">        @Result(column = &quot;birthday&quot;,property = &quot;userBirthday&quot;),</span></span><br><span class="line"><span class="meta">        @Result(property = &quot;accounts&quot; ,column = &quot;id&quot;,</span></span><br><span class="line"><span class="meta">                many = @Many(select = &quot;com.keafmd.dao.IAccountDao.findAccountByUid&quot;,</span></span><br><span class="line"><span class="meta">                             fetchType = FetchType.LAZY))</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">    &#125;)</span></span><br><span class="line">    List&lt;User&gt; <span class="title function_">findAll</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根据id查询用户</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> userId</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Select(&quot;select * from user where id=#&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="comment">//@ResultMap(value=&#123;&quot;userMap&quot;&#125;)</span></span><br><span class="line">    <span class="meta">@ResultMap(&quot;userMap&quot;)</span></span><br><span class="line">    User <span class="title function_">findById</span><span class="params">(Integer userId)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根据用户名称模糊查询</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> username</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Select(&quot;select * from user where username like #&#123;username&#125;&quot;)</span> <span class="comment">//占位符</span></span><br><span class="line">    <span class="meta">@ResultMap(&quot;userMap&quot;)</span></span><br><span class="line">    List&lt;User&gt; <span class="title function_">findByName</span><span class="params">(String username)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="编写账户的持久层接口并使用注解配置"><a class="markdownIt-Anchor" href="#编写账户的持久层接口并使用注解配置"></a> 编写账户的持久层接口并使用注解配置</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.keafmd.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.keafmd.domain.Account;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.One;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Result;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Results;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Select;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.mapping.FetchType;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Keafmd</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@ClassName</span>: IAccountDao</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>:</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>: SerMs</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span>: 2021-02-16 22:54</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">IAccountDao</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 查询所有账户，并且获取每个账户下的用户信息,一对一 ，* 这里用不到这个findAll()</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Select(&quot;select * from account&quot;)</span></span><br><span class="line">    <span class="meta">@Results(id=&quot;accountMap&quot;,value = &#123;</span></span><br><span class="line"><span class="meta">        @Result(id = true,column = &quot;id&quot;,property = &quot;id&quot;),</span></span><br><span class="line"><span class="meta">        @Result(column = &quot;uid&quot;,property = &quot;uid&quot;),</span></span><br><span class="line"><span class="meta">        @Result(column = &quot;money&quot;,property = &quot;money&quot;),</span></span><br><span class="line"><span class="meta">        @Result(property = &quot;user&quot;,column = &quot;uid&quot;,one=@One(select=&quot;com.keafmd.dao.IUserDao.findById&quot;,fetchType= FetchType.EAGER))</span></span><br><span class="line"><span class="meta">    &#125;)</span></span><br><span class="line">    List&lt;Account&gt; <span class="title function_">findAll</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根据用户id查询账户信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> userId</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Select(&quot;select * from account where uid = #&#123;userId&#125;&quot;)</span></span><br><span class="line">    List&lt;Account&gt; <span class="title function_">findAccountByUid</span><span class="params">(Integer userId)</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="编写测试代码-2"><a class="markdownIt-Anchor" href="#编写测试代码-2"></a> 编写测试代码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.keafmd.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.keafmd.dao.IUserDao;</span><br><span class="line"><span class="keyword">import</span> com.keafmd.domain.User;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.io.Resources;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"><span class="keyword">import</span> org.junit.After;</span><br><span class="line"><span class="keyword">import</span> org.junit.Before;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Keafmd</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@ClassName</span>: AnnotationCRUDTest</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: 注解开发CRUD测试</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>: SerMs</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span>: 2021-02-16 21:05</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserTest</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> InputStream in;</span><br><span class="line">    <span class="keyword">private</span> SqlSessionFactory factory;</span><br><span class="line">    <span class="keyword">private</span> SqlSession session;</span><br><span class="line">    <span class="keyword">private</span> IUserDao userDao;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">()</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        in = Resources.getResourceAsStream(<span class="string">&quot;SqlMapConfig.xml&quot;</span>);</span><br><span class="line">        factory = <span class="keyword">new</span> <span class="title class_">SqlSessionFactoryBuilder</span>().build(in);</span><br><span class="line">        session = factory.openSession();</span><br><span class="line">        userDao = session.getMapper(IUserDao.class);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@After</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destory</span><span class="params">()</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        session.commit();</span><br><span class="line">        session.close();</span><br><span class="line">        in.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testFindAll</span><span class="params">()</span>&#123;</span><br><span class="line">        List&lt;User&gt; users = userDao.findAll();</span><br><span class="line">        <span class="keyword">for</span> (User user : users) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;-----每个用户的信息&quot;</span>);</span><br><span class="line">            System.out.println(user);</span><br><span class="line">            System.out.println(user.getAccounts());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>运行 testFindAll()的结果：</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">2021-02-17 03:14:19,655 378    [           main] DEBUG ansaction.jdbc.JdbcTransaction  - Opening JDBC Connection</span><br><span class="line">2021-02-17 03:14:20,124 847    [           main] DEBUG source.pooled.PooledDataSource  - Created connection 1176735295.</span><br><span class="line">2021-02-17 03:14:20,124 847    [           main] DEBUG ansaction.jdbc.JdbcTransaction  - Setting autocommit to false on JDBC Connection [com.mysql.jdbc.JDBC4Connection@46238e3f]</span><br><span class="line">2021-02-17 03:14:20,135 858    [           main] DEBUG om.keafmd.dao.IUserDao.findAll  - ==&gt;  Preparing: select * from user</span><br><span class="line">2021-02-17 03:14:20,183 906    [           main] DEBUG om.keafmd.dao.IUserDao.findAll  - ==&gt; Parameters:</span><br><span class="line">2021-02-17 03:14:20,471 1194   [           main] DEBUG om.keafmd.dao.IUserDao.findAll  - &lt;==      Total: 9</span><br><span class="line">-----每个用户的信息</span><br><span class="line">2021-02-17 03:14:20,473 1196   [           main] DEBUG o.IAccountDao.findAccountByUid  - ==&gt;  Preparing: select * from account where uid = ?</span><br><span class="line">2021-02-17 03:14:20,474 1197   [           main] DEBUG o.IAccountDao.findAccountByUid  - ==&gt; Parameters: 41(Integer)</span><br><span class="line">2021-02-17 03:14:20,475 1198   [           main] DEBUG o.IAccountDao.findAccountByUid  - &lt;==      Total: 2</span><br><span class="line">User&#123;userId=41, userName=&#x27;update user clear cache&#x27;, userAddress=&#x27;null&#x27;, userSex=&#x27;男&#x27;, userBirthday=Tue Feb 27 17:47:08 CST 2018&#125;</span><br><span class="line">[Account&#123;id=1, uid=41, money=1000.0&#125;, Account&#123;id=3, uid=41, money=2000.0&#125;]</span><br><span class="line">-----每个用户的信息</span><br><span class="line">2021-02-17 03:14:20,476 1199   [           main] DEBUG o.IAccountDao.findAccountByUid  - ==&gt;  Preparing: select * from account where uid = ?</span><br><span class="line">2021-02-17 03:14:20,476 1199   [           main] DEBUG o.IAccountDao.findAccountByUid  - ==&gt; Parameters: 42(Integer)</span><br><span class="line">2021-02-17 03:14:20,477 1200   [           main] DEBUG o.IAccountDao.findAccountByUid  - &lt;==      Total: 0</span><br><span class="line">User&#123;userId=42, userName=&#x27;update&#x27;, userAddress=&#x27;null&#x27;, userSex=&#x27;男&#x27;, userBirthday=Mon Feb 08 19:37:31 CST 2021&#125;</span><br><span class="line">[]</span><br><span class="line">-----每个用户的信息</span><br><span class="line">2021-02-17 03:14:20,479 1202   [           main] DEBUG o.IAccountDao.findAccountByUid  - ==&gt;  Preparing: select * from account where uid = ?</span><br><span class="line">2021-02-17 03:14:20,480 1203   [           main] DEBUG o.IAccountDao.findAccountByUid  - ==&gt; Parameters: 43(Integer)</span><br><span class="line">2021-02-17 03:14:20,481 1204   [           main] DEBUG o.IAccountDao.findAccountByUid  - &lt;==      Total: 0</span><br><span class="line">User&#123;userId=43, userName=&#x27;小二王&#x27;, userAddress=&#x27;null&#x27;, userSex=&#x27;女&#x27;, userBirthday=Sun Mar 04 11:34:34 CST 2018&#125;</span><br><span class="line">[]</span><br><span class="line">-----每个用户的信息</span><br><span class="line">2021-02-17 03:14:20,481 1204   [           main] DEBUG o.IAccountDao.findAccountByUid  - ==&gt;  Preparing: select * from account where uid = ?</span><br><span class="line">2021-02-17 03:14:20,482 1205   [           main] DEBUG o.IAccountDao.findAccountByUid  - ==&gt; Parameters: 45(Integer)</span><br><span class="line">2021-02-17 03:14:20,483 1206   [           main] DEBUG o.IAccountDao.findAccountByUid  - &lt;==      Total: 1</span><br><span class="line">User&#123;userId=45, userName=&#x27;新一&#x27;, userAddress=&#x27;null&#x27;, userSex=&#x27;男&#x27;, userBirthday=Sun Mar 04 12:04:06 CST 2018&#125;</span><br><span class="line">[Account&#123;id=2, uid=45, money=1000.0&#125;]</span><br><span class="line">-----每个用户的信息</span><br><span class="line">2021-02-17 03:14:20,484 1207   [           main] DEBUG o.IAccountDao.findAccountByUid  - ==&gt;  Preparing: select * from account where uid = ?</span><br><span class="line">2021-02-17 03:14:20,484 1207   [           main] DEBUG o.IAccountDao.findAccountByUid  - ==&gt; Parameters: 50(Integer)</span><br><span class="line">2021-02-17 03:14:20,484 1207   [           main] DEBUG o.IAccountDao.findAccountByUid  - &lt;==      Total: 0</span><br><span class="line">User&#123;userId=50, userName=&#x27;Keafmd&#x27;, userAddress=&#x27;null&#x27;, userSex=&#x27;男&#x27;, userBirthday=Mon Feb 08 15:44:01 CST 2021&#125;</span><br><span class="line">[]</span><br><span class="line">-----每个用户的信息</span><br><span class="line">2021-02-17 03:14:20,485 1208   [           main] DEBUG o.IAccountDao.findAccountByUid  - ==&gt;  Preparing: select * from account where uid = ?</span><br><span class="line">2021-02-17 03:14:20,485 1208   [           main] DEBUG o.IAccountDao.findAccountByUid  - ==&gt; Parameters: 51(Integer)</span><br><span class="line">2021-02-17 03:14:20,486 1209   [           main] DEBUG o.IAccountDao.findAccountByUid  - &lt;==      Total: 0</span><br><span class="line">User&#123;userId=51, userName=&#x27;update DAO&#x27;, userAddress=&#x27;null&#x27;, userSex=&#x27;男&#x27;, userBirthday=Tue Feb 09 11:31:38 CST 2021&#125;</span><br><span class="line">[]</span><br><span class="line">-----每个用户的信息</span><br><span class="line">2021-02-17 03:14:20,488 1211   [           main] DEBUG o.IAccountDao.findAccountByUid  - ==&gt;  Preparing: select * from account where uid = ?</span><br><span class="line">2021-02-17 03:14:20,489 1212   [           main] DEBUG o.IAccountDao.findAccountByUid  - ==&gt; Parameters: 52(Integer)</span><br><span class="line">2021-02-17 03:14:20,491 1214   [           main] DEBUG o.IAccountDao.findAccountByUid  - &lt;==      Total: 0</span><br><span class="line">User&#123;userId=52, userName=&#x27;Keafmd DAO&#x27;, userAddress=&#x27;null&#x27;, userSex=&#x27;男&#x27;, userBirthday=Tue Feb 09 11:29:41 CST 2021&#125;</span><br><span class="line">[]</span><br><span class="line">-----每个用户的信息</span><br><span class="line">2021-02-17 03:14:20,491 1214   [           main] DEBUG o.IAccountDao.findAccountByUid  - ==&gt;  Preparing: select * from account where uid = ?</span><br><span class="line">2021-02-17 03:14:20,492 1215   [           main] DEBUG o.IAccountDao.findAccountByUid  - ==&gt; Parameters: 53(Integer)</span><br><span class="line">2021-02-17 03:14:20,493 1216   [           main] DEBUG o.IAccountDao.findAccountByUid  - &lt;==      Total: 0</span><br><span class="line">User&#123;userId=53, userName=&#x27;Keafmd laset insertid 1&#x27;, userAddress=&#x27;null&#x27;, userSex=&#x27;男&#x27;, userBirthday=Fri Feb 12 20:53:46 CST 2021&#125;</span><br><span class="line">[]</span><br><span class="line">-----每个用户的信息</span><br><span class="line">2021-02-17 03:14:20,493 1216   [           main] DEBUG o.IAccountDao.findAccountByUid  - ==&gt;  Preparing: select * from account where uid = ?</span><br><span class="line">2021-02-17 03:14:20,493 1216   [           main] DEBUG o.IAccountDao.findAccountByUid  - ==&gt; Parameters: 55(Integer)</span><br><span class="line">2021-02-17 03:14:20,494 1217   [           main] DEBUG o.IAccountDao.findAccountByUid  - &lt;==      Total: 0</span><br><span class="line">User&#123;userId=55, userName=&#x27;mybatis annotation&#x27;, userAddress=&#x27;null&#x27;, userSex=&#x27;男&#x27;, userBirthday=Tue Feb 16 22:15:36 CST 2021&#125;</span><br><span class="line">[]</span><br><span class="line">2021-02-17 03:14:20,495 1218   [           main] DEBUG ansaction.jdbc.JdbcTransaction  - Resetting autocommit to true on JDBC Connection [com.mysql.jdbc.JDBC4Connection@46238e3f]</span><br><span class="line">2021-02-17 03:14:20,495 1218   [           main] DEBUG ansaction.jdbc.JdbcTransaction  - Closing JDBC Connection [com.mysql.jdbc.JDBC4Connection@46238e3f]</span><br><span class="line">2021-02-17 03:14:20,495 1218   [           main] DEBUG source.pooled.PooledDataSource  - Returned connection 1176735295 to pool.</span><br><span class="line"></span><br><span class="line">Process finished with exit code 0</span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p><strong>可以看出来延迟加载，在每次加载每个用户时都会查询一次。</strong></p></blockquote><p><strong>修改测试代码：</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testFindAll</span><span class="params">()</span>&#123;</span><br><span class="line">    List&lt;User&gt; users = userDao.findAll();</span><br><span class="line">    <span class="comment">/*for (User user : users) &#123;</span></span><br><span class="line"><span class="comment">        System.out.println(&quot;-----每个用户的信息&quot;);</span></span><br><span class="line"><span class="comment">        System.out.println(user);</span></span><br><span class="line"><span class="comment">        System.out.println(user.getAccounts());</span></span><br><span class="line"><span class="comment">    &#125;*/</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>运行结果：</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">2021-02-17 03:17:26,203 166    [           main] DEBUG ansaction.jdbc.JdbcTransaction  - Opening JDBC Connection</span><br><span class="line">2021-02-17 03:17:26,500 463    [           main] DEBUG source.pooled.PooledDataSource  - Created connection 1176735295.</span><br><span class="line">2021-02-17 03:17:26,500 463    [           main] DEBUG ansaction.jdbc.JdbcTransaction  - Setting autocommit to false on JDBC Connection [com.mysql.jdbc.JDBC4Connection@46238e3f]</span><br><span class="line">2021-02-17 03:17:26,505 468    [           main] DEBUG om.keafmd.dao.IUserDao.findAll  - ==&gt;  Preparing: select * from user</span><br><span class="line">2021-02-17 03:17:26,540 503    [           main] DEBUG om.keafmd.dao.IUserDao.findAll  - ==&gt; Parameters:</span><br><span class="line">2021-02-17 03:17:26,613 576    [           main] DEBUG om.keafmd.dao.IUserDao.findAll  - &lt;==      Total: 9</span><br><span class="line">2021-02-17 03:17:26,614 577    [           main] DEBUG ansaction.jdbc.JdbcTransaction  - Resetting autocommit to true on JDBC Connection [com.mysql.jdbc.JDBC4Connection@46238e3f]</span><br><span class="line">2021-02-17 03:17:26,614 577    [           main] DEBUG ansaction.jdbc.JdbcTransaction  - Closing JDBC Connection [com.mysql.jdbc.JDBC4Connection@46238e3f]</span><br><span class="line">2021-02-17 03:17:26,614 577    [           main] DEBUG source.pooled.PooledDataSource  - Returned connection 1176735295 to pool.</span><br><span class="line"></span><br><span class="line">Process finished with exit code 0</span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p><strong>这样通过对比就可以很明显的看出来延迟加载的效果。</strong></p></blockquote><h2 id="回顾下一级缓存"><a class="markdownIt-Anchor" href="#回顾下一级缓存"></a> 回顾下一级缓存</h2><p><strong>运行代码：</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testFindOne</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userDao.findById(<span class="number">55</span>);</span><br><span class="line">    System.out.println(user);</span><br><span class="line"></span><br><span class="line">    <span class="type">User</span> <span class="variable">user2</span> <span class="operator">=</span> userDao.findById(<span class="number">55</span>);</span><br><span class="line">    System.out.println(user2);</span><br><span class="line"></span><br><span class="line">    System.out.println(user==user2);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>运行结果：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">2021-02-17 03:26:22,736 164    [           main] DEBUG ansaction.jdbc.JdbcTransaction  - Opening JDBC Connection</span><br><span class="line">2021-02-17 03:26:22,970 398    [           main] DEBUG source.pooled.PooledDataSource  - Created connection 85445963.</span><br><span class="line">2021-02-17 03:26:22,971 399    [           main] DEBUG ansaction.jdbc.JdbcTransaction  - Setting autocommit to false on JDBC Connection [com.mysql.jdbc.JDBC4Connection@517cd4b]</span><br><span class="line">2021-02-17 03:26:22,975 403    [           main] DEBUG m.keafmd.dao.IUserDao.findById  - ==&gt;  Preparing: select * from user where id=?</span><br><span class="line">2021-02-17 03:26:23,001 429    [           main] DEBUG m.keafmd.dao.IUserDao.findById  - ==&gt; Parameters: 55(Integer)</span><br><span class="line">2021-02-17 03:26:23,054 482    [           main] DEBUG m.keafmd.dao.IUserDao.findById  - &lt;==      Total: 1</span><br><span class="line">2021-02-17 03:26:23,055 483    [           main] DEBUG o.IAccountDao.findAccountByUid  - ==&gt;  Preparing: select * from account where uid = ?</span><br><span class="line">2021-02-17 03:26:23,055 483    [           main] DEBUG o.IAccountDao.findAccountByUid  - ==&gt; Parameters: 55(Integer)</span><br><span class="line">2021-02-17 03:26:23,056 484    [           main] DEBUG o.IAccountDao.findAccountByUid  - &lt;==      Total: 0</span><br><span class="line">User&#123;userId=55, userName=&#x27;mybatis annotation&#x27;, userAddress=&#x27;null&#x27;, userSex=&#x27;男&#x27;, userBirthday=Tue Feb 16 22:15:36 CST 2021&#125;</span><br><span class="line">User&#123;userId=55, userName=&#x27;mybatis annotation&#x27;, userAddress=&#x27;null&#x27;, userSex=&#x27;男&#x27;, userBirthday=Tue Feb 16 22:15:36 CST 2021&#125;</span><br><span class="line">true</span><br><span class="line">2021-02-17 03:26:23,056 484    [           main] DEBUG ansaction.jdbc.JdbcTransaction  - Resetting autocommit to true on JDBC Connection [com.mysql.jdbc.JDBC4Connection@517cd4b]</span><br><span class="line">2021-02-17 03:26:23,056 484    [           main] DEBUG ansaction.jdbc.JdbcTransaction  - Closing JDBC Connection [com.mysql.jdbc.JDBC4Connection@517cd4b]</span><br><span class="line">2021-02-17 03:26:23,057 485    [           main] DEBUG source.pooled.PooledDataSource  - Returned connection 85445963 to pool.</span><br></pre></td></tr></table></figure><h2 id="mybatis-基于注解的二级缓存"><a class="markdownIt-Anchor" href="#mybatis-基于注解的二级缓存"></a> mybatis 基于注解的二级缓存</h2><h3 id="在-sqlmapconfigxml-中开启二级缓存支持"><a class="markdownIt-Anchor" href="#在-sqlmapconfigxml-中开启二级缓存支持"></a> 在 SqlMapConfig.xml 中开启二级缓存支持</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--配置开启二级缓存--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;cacheEnabled&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="在持久层接口中使用注解配置二级缓存"><a class="markdownIt-Anchor" href="#在持久层接口中使用注解配置二级缓存"></a> 在持久层接口中使用注解配置二级缓存</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.keafmd.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.keafmd.domain.User;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.*;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.mapping.FetchType;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Keafmd</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@ClassName</span>: IUserDao</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>:</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>: SerMs</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span>: 2021-02-16 20:30</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 在mybatis中针对CRUD一共有四个注解</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Select</span> <span class="doctag">@Insert</span> <span class="doctag">@Update</span> <span class="doctag">@Delete</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@CacheNamespace(blocking = true)</span> <span class="comment">//mybatis 基于注解方式实现配置二级缓存 *这里*</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">IUserDao</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 查询所有用户</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Select(&quot;select * from user&quot;)</span></span><br><span class="line">    <span class="meta">@Results(id=&quot;userMap&quot;,value=&#123;</span></span><br><span class="line"><span class="meta">        @Result(id = true,column = &quot;id&quot;,property = &quot;userId&quot;),</span></span><br><span class="line"><span class="meta">        @Result(column = &quot;id&quot;,property = &quot;userId&quot;),</span></span><br><span class="line"><span class="meta">        @Result(column = &quot;username&quot;,property = &quot;userName&quot;),</span></span><br><span class="line"><span class="meta">        @Result(column = &quot;sex&quot;,property = &quot;userSex&quot;),</span></span><br><span class="line"><span class="meta">        @Result(column = &quot;birthday&quot;,property = &quot;userBirthday&quot;),</span></span><br><span class="line"><span class="meta">        @Result(property = &quot;accounts&quot; ,column = &quot;id&quot;,</span></span><br><span class="line"><span class="meta">                many = @Many(select = &quot;com.keafmd.dao.IAccountDao.findAccountByUid&quot;,</span></span><br><span class="line"><span class="meta">                             fetchType = FetchType.LAZY))</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">    &#125;)</span></span><br><span class="line">    List&lt;User&gt; <span class="title function_">findAll</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根据id查询用户</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> userId</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Select(&quot;select * from user where id=#&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="comment">//@ResultMap(value=&#123;&quot;userMap&quot;&#125;)</span></span><br><span class="line">    <span class="meta">@ResultMap(&quot;userMap&quot;)</span></span><br><span class="line">    User <span class="title function_">findById</span><span class="params">(Integer userId)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根据用户名称模糊查询</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> username</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Select(&quot;select * from user where username like #&#123;username&#125;&quot;)</span> <span class="comment">//占位符</span></span><br><span class="line">    <span class="meta">@ResultMap(&quot;userMap&quot;)</span></span><br><span class="line">    List&lt;User&gt; <span class="title function_">findByName</span><span class="params">(String username)</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="编写测试二级缓存的测试类"><a class="markdownIt-Anchor" href="#编写测试二级缓存的测试类"></a> 编写测试二级缓存的测试类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.keafmd.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.keafmd.dao.IUserDao;</span><br><span class="line"><span class="keyword">import</span> com.keafmd.domain.User;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.io.Resources;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"><span class="keyword">import</span> org.junit.After;</span><br><span class="line"><span class="keyword">import</span> org.junit.Before;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Keafmd</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@ClassName</span>: SecondLevelCatchTest</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: 二级缓存测试</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>: SerMs</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span>: 2022-02-16 23:37</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SecondLevelCatchTest</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> InputStream in;</span><br><span class="line">    <span class="keyword">private</span> SqlSessionFactory factory;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">()</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        in = Resources.getResourceAsStream(<span class="string">&quot;SqlMapConfig.xml&quot;</span>);</span><br><span class="line">        factory = <span class="keyword">new</span> <span class="title class_">SqlSessionFactoryBuilder</span>().build(in);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@After</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destory</span><span class="params">()</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        in.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testFindOne</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">SqlSession</span> <span class="variable">session</span> <span class="operator">=</span> factory.openSession();</span><br><span class="line">        <span class="type">IUserDao</span> <span class="variable">userDao</span> <span class="operator">=</span> session.getMapper(IUserDao.class);</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userDao.findById(<span class="number">55</span>);</span><br><span class="line">        System.out.println(user);</span><br><span class="line"></span><br><span class="line">        session.close();<span class="comment">//释放一级缓存</span></span><br><span class="line"></span><br><span class="line">        <span class="type">SqlSession</span> <span class="variable">session1</span> <span class="operator">=</span> factory.openSession();<span class="comment">//再次打开session</span></span><br><span class="line">        <span class="type">IUserDao</span> <span class="variable">userDao1</span> <span class="operator">=</span> session1.getMapper(IUserDao.class);</span><br><span class="line"></span><br><span class="line">        <span class="type">User</span> <span class="variable">user2</span> <span class="operator">=</span> userDao1.findById(<span class="number">55</span>);</span><br><span class="line">        System.out.println(user2);</span><br><span class="line"></span><br><span class="line">        System.out.println(user==user2);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>不开启二级缓存配置的运行结果：</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2021</span><span class="literal">-02-17</span> <span class="number">03</span>:<span class="number">31</span>:<span class="number">32</span>,<span class="number">119</span> <span class="number">320</span>    [           <span class="type">main</span>] DEBUG ansaction.jdbc.JdbcTransaction  - Opening JDBC Connection</span><br><span class="line"><span class="number">2021</span><span class="literal">-02-17</span> <span class="number">03</span>:<span class="number">31</span>:<span class="number">32</span>,<span class="number">509</span> <span class="number">710</span>    [           <span class="type">main</span>] DEBUG source.pooled.PooledDataSource  - Created connection <span class="number">85445963</span>.</span><br><span class="line"><span class="number">2021</span><span class="literal">-02-17</span> <span class="number">03</span>:<span class="number">31</span>:<span class="number">32</span>,<span class="number">510</span> <span class="number">711</span>    [           <span class="type">main</span>] DEBUG ansaction.jdbc.JdbcTransaction  - Setting autocommit to false on JDBC Connection [<span class="type">com.mysql.jdbc.JDBC4Connection</span>@<span class="number">517</span><span class="type">cd4b</span>]</span><br><span class="line"><span class="number">2021</span><span class="literal">-02-17</span> <span class="number">03</span>:<span class="number">31</span>:<span class="number">32</span>,<span class="number">514</span> <span class="number">715</span>    [           <span class="type">main</span>] DEBUG m.keafmd.dao.IUserDao.findById  - ==&gt;  Preparing: <span class="built_in">select</span> * from user <span class="built_in">where</span> id=?</span><br><span class="line"><span class="number">2021</span><span class="literal">-02-17</span> <span class="number">03</span>:<span class="number">31</span>:<span class="number">32</span>,<span class="number">551</span> <span class="number">752</span>    [           <span class="type">main</span>] DEBUG m.keafmd.dao.IUserDao.findById  - ==&gt; Parameters: <span class="number">55</span>(Integer)</span><br><span class="line"><span class="number">2021</span><span class="literal">-02-17</span> <span class="number">03</span>:<span class="number">31</span>:<span class="number">32</span>,<span class="number">633</span> <span class="number">834</span>    [           <span class="type">main</span>] DEBUG m.keafmd.dao.IUserDao.findById  - &lt;==      Total: <span class="number">1</span></span><br><span class="line"><span class="number">2021</span><span class="literal">-02-17</span> <span class="number">03</span>:<span class="number">31</span>:<span class="number">32</span>,<span class="number">634</span> <span class="number">835</span>    [           <span class="type">main</span>] DEBUG o.IAccountDao.findAccountByUid  - ==&gt;  Preparing: <span class="built_in">select</span> * from account <span class="built_in">where</span> uid = ?</span><br><span class="line"><span class="number">2021</span><span class="literal">-02-17</span> <span class="number">03</span>:<span class="number">31</span>:<span class="number">32</span>,<span class="number">634</span> <span class="number">835</span>    [           <span class="type">main</span>] DEBUG o.IAccountDao.findAccountByUid  - ==&gt; Parameters: <span class="number">55</span>(Integer)</span><br><span class="line"><span class="number">2021</span><span class="literal">-02-17</span> <span class="number">03</span>:<span class="number">31</span>:<span class="number">32</span>,<span class="number">635</span> <span class="number">836</span>    [           <span class="type">main</span>] DEBUG o.IAccountDao.findAccountByUid  - &lt;==      Total: <span class="number">0</span></span><br><span class="line">User&#123;userId=<span class="number">55</span>, userName=<span class="string">&#x27;mybatis annotation&#x27;</span>, userAddress=<span class="string">&#x27;null&#x27;</span>, userSex=<span class="string">&#x27;男&#x27;</span>, userBirthday=Tue Feb <span class="number">16</span> <span class="number">22</span>:<span class="number">15</span>:<span class="number">36</span> CST <span class="number">2021</span>&#125;</span><br><span class="line"><span class="number">2021</span><span class="literal">-02-17</span> <span class="number">03</span>:<span class="number">31</span>:<span class="number">32</span>,<span class="number">635</span> <span class="number">836</span>    [           <span class="type">main</span>] DEBUG ansaction.jdbc.JdbcTransaction  - Resetting autocommit to true on JDBC Connection [<span class="type">com.mysql.jdbc.JDBC4Connection</span>@<span class="number">517</span><span class="type">cd4b</span>]</span><br><span class="line"><span class="number">2021</span><span class="literal">-02-17</span> <span class="number">03</span>:<span class="number">31</span>:<span class="number">32</span>,<span class="number">636</span> <span class="number">837</span>    [           <span class="type">main</span>] DEBUG ansaction.jdbc.JdbcTransaction  - Closing JDBC Connection [<span class="type">com.mysql.jdbc.JDBC4Connection</span>@<span class="number">517</span><span class="type">cd4b</span>]</span><br><span class="line"><span class="number">2021</span><span class="literal">-02-17</span> <span class="number">03</span>:<span class="number">31</span>:<span class="number">32</span>,<span class="number">636</span> <span class="number">837</span>    [           <span class="type">main</span>] DEBUG source.pooled.PooledDataSource  - Returned connection <span class="number">85445963</span> to pool.</span><br><span class="line"><span class="number">2021</span><span class="literal">-02-17</span> <span class="number">03</span>:<span class="number">31</span>:<span class="number">32</span>,<span class="number">636</span> <span class="number">837</span>    [           <span class="type">main</span>] DEBUG ansaction.jdbc.JdbcTransaction  - Opening JDBC Connection</span><br><span class="line"><span class="number">2021</span><span class="literal">-02-17</span> <span class="number">03</span>:<span class="number">31</span>:<span class="number">32</span>,<span class="number">636</span> <span class="number">837</span>    [           <span class="type">main</span>] DEBUG source.pooled.PooledDataSource  - Checked out connection <span class="number">85445963</span> from pool.</span><br><span class="line"><span class="number">2021</span><span class="literal">-02-17</span> <span class="number">03</span>:<span class="number">31</span>:<span class="number">32</span>,<span class="number">636</span> <span class="number">837</span>    [           <span class="type">main</span>] DEBUG ansaction.jdbc.JdbcTransaction  - Setting autocommit to false on JDBC Connection [<span class="type">com.mysql.jdbc.JDBC4Connection</span>@<span class="number">517</span><span class="type">cd4b</span>]</span><br><span class="line"><span class="number">2021</span><span class="literal">-02-17</span> <span class="number">03</span>:<span class="number">31</span>:<span class="number">32</span>,<span class="number">636</span> <span class="number">837</span>    [           <span class="type">main</span>] DEBUG m.keafmd.dao.IUserDao.findById  - ==&gt;  Preparing: <span class="built_in">select</span> * from user <span class="built_in">where</span> id=?</span><br><span class="line"><span class="number">2021</span><span class="literal">-02-17</span> <span class="number">03</span>:<span class="number">31</span>:<span class="number">32</span>,<span class="number">637</span> <span class="number">838</span>    [           <span class="type">main</span>] DEBUG m.keafmd.dao.IUserDao.findById  - ==&gt; Parameters: <span class="number">55</span>(Integer)</span><br><span class="line"><span class="number">2021</span><span class="literal">-02-17</span> <span class="number">03</span>:<span class="number">31</span>:<span class="number">32</span>,<span class="number">639</span> <span class="number">840</span>    [           <span class="type">main</span>] DEBUG m.keafmd.dao.IUserDao.findById  - &lt;==      Total: <span class="number">1</span></span><br><span class="line"><span class="number">2021</span><span class="literal">-02-17</span> <span class="number">03</span>:<span class="number">31</span>:<span class="number">32</span>,<span class="number">641</span> <span class="number">842</span>    [           <span class="type">main</span>] DEBUG o.IAccountDao.findAccountByUid  - ==&gt;  Preparing: <span class="built_in">select</span> * from account <span class="built_in">where</span> uid = ?</span><br><span class="line"><span class="number">2021</span><span class="literal">-02-17</span> <span class="number">03</span>:<span class="number">31</span>:<span class="number">32</span>,<span class="number">641</span> <span class="number">842</span>    [           <span class="type">main</span>] DEBUG o.IAccountDao.findAccountByUid  - ==&gt; Parameters: <span class="number">55</span>(Integer)</span><br><span class="line"><span class="number">2021</span><span class="literal">-02-17</span> <span class="number">03</span>:<span class="number">31</span>:<span class="number">32</span>,<span class="number">642</span> <span class="number">843</span>    [           <span class="type">main</span>] DEBUG o.IAccountDao.findAccountByUid  - &lt;==      Total: <span class="number">0</span></span><br><span class="line">User&#123;userId=<span class="number">55</span>, userName=<span class="string">&#x27;mybatis annotation&#x27;</span>, userAddress=<span class="string">&#x27;null&#x27;</span>, userSex=<span class="string">&#x27;男&#x27;</span>, userBirthday=Tue Feb <span class="number">16</span> <span class="number">22</span>:<span class="number">15</span>:<span class="number">36</span> CST <span class="number">2021</span>&#125;</span><br><span class="line">false</span><br><span class="line"></span><br><span class="line"><span class="keyword">Process</span> finished with <span class="keyword">exit</span> code <span class="number">0</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>开启二级缓存配置的运行结果：</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2021</span><span class="literal">-02-17</span> <span class="number">03</span>:<span class="number">29</span>:<span class="number">23</span>,<span class="number">197</span> <span class="number">373</span>    [           <span class="type">main</span>] DEBUG ansaction.jdbc.JdbcTransaction  - Opening JDBC Connection</span><br><span class="line"><span class="number">2021</span><span class="literal">-02-17</span> <span class="number">03</span>:<span class="number">29</span>:<span class="number">23</span>,<span class="number">605</span> <span class="number">781</span>    [           <span class="type">main</span>] DEBUG source.pooled.PooledDataSource  - Created connection <span class="number">500179317</span>.</span><br><span class="line"><span class="number">2021</span><span class="literal">-02-17</span> <span class="number">03</span>:<span class="number">29</span>:<span class="number">23</span>,<span class="number">606</span> <span class="number">782</span>    [           <span class="type">main</span>] DEBUG ansaction.jdbc.JdbcTransaction  - Setting autocommit to false on JDBC Connection [<span class="type">com.mysql.jdbc.JDBC4Connection</span>@<span class="number">1</span><span class="type">dd02175</span>]</span><br><span class="line"><span class="number">2021</span><span class="literal">-02-17</span> <span class="number">03</span>:<span class="number">29</span>:<span class="number">23</span>,<span class="number">617</span> <span class="number">793</span>    [           <span class="type">main</span>] DEBUG m.keafmd.dao.IUserDao.findById  - ==&gt;  Preparing: <span class="built_in">select</span> * from user <span class="built_in">where</span> id=?</span><br><span class="line"><span class="number">2021</span><span class="literal">-02-17</span> <span class="number">03</span>:<span class="number">29</span>:<span class="number">23</span>,<span class="number">668</span> <span class="number">844</span>    [           <span class="type">main</span>] DEBUG m.keafmd.dao.IUserDao.findById  - ==&gt; Parameters: <span class="number">55</span>(Integer)</span><br><span class="line"><span class="number">2021</span><span class="literal">-02-17</span> <span class="number">03</span>:<span class="number">29</span>:<span class="number">23</span>,<span class="number">777</span> <span class="number">953</span>    [           <span class="type">main</span>] DEBUG m.keafmd.dao.IUserDao.findById  - &lt;==      Total: <span class="number">1</span></span><br><span class="line"><span class="number">2021</span><span class="literal">-02-17</span> <span class="number">03</span>:<span class="number">29</span>:<span class="number">23</span>,<span class="number">781</span> <span class="number">957</span>    [           <span class="type">main</span>] DEBUG o.IAccountDao.findAccountByUid  - ==&gt;  Preparing: <span class="built_in">select</span> * from account <span class="built_in">where</span> uid = ?</span><br><span class="line"><span class="number">2021</span><span class="literal">-02-17</span> <span class="number">03</span>:<span class="number">29</span>:<span class="number">23</span>,<span class="number">782</span> <span class="number">958</span>    [           <span class="type">main</span>] DEBUG o.IAccountDao.findAccountByUid  - ==&gt; Parameters: <span class="number">55</span>(Integer)</span><br><span class="line"><span class="number">2021</span><span class="literal">-02-17</span> <span class="number">03</span>:<span class="number">29</span>:<span class="number">23</span>,<span class="number">782</span> <span class="number">958</span>    [           <span class="type">main</span>] DEBUG o.IAccountDao.findAccountByUid  - &lt;==      Total: <span class="number">0</span></span><br><span class="line">User&#123;userId=<span class="number">55</span>, userName=<span class="string">&#x27;mybatis annotation&#x27;</span>, userAddress=<span class="string">&#x27;null&#x27;</span>, userSex=<span class="string">&#x27;男&#x27;</span>, userBirthday=Tue Feb <span class="number">16</span> <span class="number">22</span>:<span class="number">15</span>:<span class="number">36</span> CST <span class="number">2021</span>&#125;</span><br><span class="line"><span class="number">2021</span><span class="literal">-02-17</span> <span class="number">03</span>:<span class="number">29</span>:<span class="number">23</span>,<span class="number">790</span> <span class="number">966</span>    [           <span class="type">main</span>] DEBUG ansaction.jdbc.JdbcTransaction  - Resetting autocommit to true on JDBC Connection [<span class="type">com.mysql.jdbc.JDBC4Connection</span>@<span class="number">1</span><span class="type">dd02175</span>]</span><br><span class="line"><span class="number">2021</span><span class="literal">-02-17</span> <span class="number">03</span>:<span class="number">29</span>:<span class="number">23</span>,<span class="number">791</span> <span class="number">967</span>    [           <span class="type">main</span>] DEBUG ansaction.jdbc.JdbcTransaction  - Closing JDBC Connection [<span class="type">com.mysql.jdbc.JDBC4Connection</span>@<span class="number">1</span><span class="type">dd02175</span>]</span><br><span class="line"><span class="number">2021</span><span class="literal">-02-17</span> <span class="number">03</span>:<span class="number">29</span>:<span class="number">23</span>,<span class="number">791</span> <span class="number">967</span>    [           <span class="type">main</span>] DEBUG source.pooled.PooledDataSource  - Returned connection <span class="number">500179317</span> to pool.</span><br><span class="line"><span class="number">2021</span><span class="literal">-02-17</span> <span class="number">03</span>:<span class="number">29</span>:<span class="number">23</span>,<span class="number">800</span> <span class="number">976</span>    [           <span class="type">main</span>] DEBUG        com.keafmd.dao.IUserDao  - Cache Hit Ratio [<span class="type">com.keafmd.dao.IUserDao</span>]: <span class="number">0.5</span></span><br><span class="line">User&#123;userId=<span class="number">55</span>, userName=<span class="string">&#x27;mybatis annotation&#x27;</span>, userAddress=<span class="string">&#x27;null&#x27;</span>, userSex=<span class="string">&#x27;男&#x27;</span>, userBirthday=Tue Feb <span class="number">16</span> <span class="number">22</span>:<span class="number">15</span>:<span class="number">36</span> CST <span class="number">2021</span>&#125;</span><br><span class="line">false</span><br><span class="line"></span><br><span class="line"><span class="keyword">Process</span> finished with <span class="keyword">exit</span> code <span class="number">0</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p><strong>效果很明显，开启使用二级缓存时第二次并没有发起查询，证明使用的就是二级缓存。</strong></p></blockquote><blockquote><p><strong>以上就是 Mybatis 注解开发（超详细）的全部内容。</strong></p><p><strong>看完如果对你有帮助，感谢赞助支持！</strong></p><p><img src="https://img-blog.csdnimg.cn/20210115230629703.gif#pic_center" alt="" /></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
          <category> Mybatis </category>
          
          <category> 注解开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> Mybatis </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>单项链表</title>
      <link href="/posts/e72b5a3a/"/>
      <url>/posts/e72b5a3a/</url>
      
        <content type="html"><![CDATA[<h2 id="单向链表"><a class="markdownIt-Anchor" href="#单向链表"></a> 单向链表</h2><h3 id="链表linked-list介绍"><a class="markdownIt-Anchor" href="#链表linked-list介绍"></a> 链表(Linked  List)介绍</h3><blockquote><p>链表在内存中的存储<br /><img src="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200617221622.png" alt="" /></p><p><strong>特点</strong></p><ul><li>链表是以节点的方式来存储,<strong>是链式存储</strong></li><li>每个节点包含 data 域 和 next 域。next域用来指向下一个节点</li><li>链表的各个节点不一定是连续存储的</li><li>链表分<strong>带头节点的链表</strong>和<strong>没有头节点的链表</strong>，根据实际的需求来确定</li></ul><p>带头结点的单列表<strong>逻辑示意图</strong></p><p><img src="https://img-blog.csdn.net/20160928205306919?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="" /></p><p><img src="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200617221632.png" alt="" /></p></blockquote><h3 id="单向链表的优缺点"><a class="markdownIt-Anchor" href="#单向链表的优缺点"></a> 单向链表的优缺点</h3><blockquote><p>和普通的线性结构（如数组）相比，链表结构有以下特点：<br />（1）单个结点创建非常灵活，普通的线性内存通常在创建的时候就需要设定数据的大小<br />（2）结点的删除、插入非常方便，不需要像线性结构那样移动剩下的数据<br />（3）结点的访问方便，可以通过循环或者递归的方法访问到任意数据，但是平均的访问效率低于线性表</p></blockquote><h3 id="实现思路实现链表的增删改查"><a class="markdownIt-Anchor" href="#实现思路实现链表的增删改查"></a> 实现思路(实现链表的增删改查)</h3><h4 id="创建添加"><a class="markdownIt-Anchor" href="#创建添加"></a> <strong>创建（添加）</strong></h4><blockquote><ul><li>先创建一个Head头节点，表示单链表的头</li><li>后面我们每添加一个节点，就放在链表的最后</li></ul></blockquote><h4 id="遍历"><a class="markdownIt-Anchor" href="#遍历"></a> <strong>遍历</strong></h4><blockquote><p>通过一个辅助变量，来遍历整个链表</p></blockquote><h4 id="有序插入"><a class="markdownIt-Anchor" href="#有序插入"></a> <strong>有序插入</strong></h4><blockquote><ul><li>先遍历链表，找到应该插入的位置</li><li>要插入的节点的next指向插入位置的后一个节点</li><li>插入位置的前一个节点的next指向要插入节点</li><li>插入前要判断是否在队尾插入</li></ul></blockquote><h4 id="根据某个属性节点修改值"><a class="markdownIt-Anchor" href="#根据某个属性节点修改值"></a> <strong>根据某个属性节点修改值</strong></h4><blockquote><ul><li>先遍历节点，找到修改的位置</li><li>如果未找到修改节点，则不修改</li></ul></blockquote><h4 id="删除某个节点"><a class="markdownIt-Anchor" href="#删除某个节点"></a> <strong>删除某个节点</strong></h4><blockquote><ul><li>先遍历节点，找到要删除节点的前一个节点</li><li>进行删除操作</li></ul></blockquote><h4 id="求倒数第n个节点的信息"><a class="markdownIt-Anchor" href="#求倒数第n个节点的信息"></a> <strong>求倒数第n个节点的信息</strong></h4><blockquote><ul><li>遍历链表，求出链表的<strong>有效长度</strong>length（不算头结点）</li><li>遍历链表到第length-n的节点</li></ul></blockquote><h4 id="翻转链表"><a class="markdownIt-Anchor" href="#翻转链表"></a> <strong>翻转链表</strong></h4><p><img src="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200616112143.png" alt="" /></p><blockquote><ul><li><p>创建一个新的头结点，作为新链表的头</p></li><li><p>从头遍历旧链表，将遍历到的节点插入新链表的头结点之后</p></li><li><p>注意需要用到</p></li></ul><p>两个暂存节点</p><ul><li>一个用来保存正在遍历的节点</li><li>一个用来保存正在遍历节点的下一个节点</li></ul></blockquote><p><img src="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200616142843.png" alt="img" /></p><p><img src="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200616142931.png" alt="img" /></p><p><img src="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200616142248.png" alt="img" /></p><p><img src="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200617221646.png" alt="img" /></p><h4 id="逆序打印"><a class="markdownIt-Anchor" href="#逆序打印"></a> <strong>逆序打印</strong></h4><blockquote><ul><li>遍历链表，将遍历到的节点入栈</li><li>遍历完后，进行出栈操作，<strong>同时打印出栈元素</strong></li></ul></blockquote><h3 id="代码"><a class="markdownIt-Anchor" href="#代码"></a> <strong>代码</strong></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo1</span> &#123;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"><span class="type">LinkedList</span> <span class="variable">linkedList</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">LinkedList</span>();</span><br><span class="line">linkedList.traverseNode();</span><br><span class="line">System.out.println();</span><br><span class="line"><span class="comment">//创建学生节点，并插入链表</span></span><br><span class="line"><span class="type">StudentNode</span> <span class="variable">student1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StudentNode</span>(<span class="number">1</span>, <span class="string">&quot;Nyima&quot;</span>);</span><br><span class="line"><span class="type">StudentNode</span> <span class="variable">student3</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StudentNode</span>(<span class="number">3</span>, <span class="string">&quot;Lulu&quot;</span>);</span><br><span class="line">linkedList.addNode(student1);</span><br><span class="line">linkedList.addNode(student3);</span><br><span class="line">linkedList.traverseNode();</span><br><span class="line">System.out.println();</span><br><span class="line"></span><br><span class="line"><span class="comment">//按id大小插入</span></span><br><span class="line">System.out.println(<span class="string">&quot;有序插入&quot;</span>);</span><br><span class="line"><span class="type">StudentNode</span> <span class="variable">student2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StudentNode</span>(<span class="number">0</span>, <span class="string">&quot;Wenwen&quot;</span>);</span><br><span class="line">linkedList.addByOrder(student2);</span><br><span class="line">linkedList.traverseNode();</span><br><span class="line">System.out.println();</span><br><span class="line"></span><br><span class="line"><span class="comment">//按id修改学生信息</span></span><br><span class="line">System.out.println(<span class="string">&quot;修改学生信息&quot;</span>);</span><br><span class="line">student2 = <span class="keyword">new</span> <span class="title class_">StudentNode</span>(<span class="number">1</span>, <span class="string">&quot;Hulu&quot;</span>);</span><br><span class="line">linkedList.changeNode(student2);</span><br><span class="line">linkedList.traverseNode();</span><br><span class="line">System.out.println();</span><br><span class="line"></span><br><span class="line"><span class="comment">//根据id删除学生信息</span></span><br><span class="line">System.out.println(<span class="string">&quot;删除学生信息&quot;</span>);</span><br><span class="line">student2 = <span class="keyword">new</span> <span class="title class_">StudentNode</span>(<span class="number">1</span>, <span class="string">&quot;Hulu&quot;</span>);</span><br><span class="line">linkedList.deleteNode(student2);</span><br><span class="line">linkedList.traverseNode();</span><br><span class="line">System.out.println();</span><br><span class="line"></span><br><span class="line"><span class="comment">//获得倒数第几个节点</span></span><br><span class="line">System.out.println(<span class="string">&quot;获得倒数节点&quot;</span>);</span><br><span class="line">System.out.println(linkedList.getStuByRec(<span class="number">2</span>));</span><br><span class="line">System.out.println();</span><br><span class="line"></span><br><span class="line"><span class="comment">//翻转链表</span></span><br><span class="line">System.out.println(<span class="string">&quot;翻转链表&quot;</span>);</span><br><span class="line"><span class="type">LinkedList</span> <span class="variable">newLinkedList</span> <span class="operator">=</span> linkedList.reverseList();</span><br><span class="line">newLinkedList.traverseNode();</span><br><span class="line">System.out.println();</span><br><span class="line"></span><br><span class="line"><span class="comment">//倒叙遍历链表</span></span><br><span class="line">System.out.println(<span class="string">&quot;倒序遍历链表&quot;</span>);</span><br><span class="line">newLinkedList.reverseTraverse();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 创建链表</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">LinkedList</span> &#123;</span><br><span class="line"><span class="comment">//头节点，防止被修改，设置为私有的</span></span><br><span class="line"><span class="keyword">private</span> <span class="type">StudentNode</span> <span class="variable">head</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StudentNode</span>(<span class="number">0</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 添加节点</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> node 要添加的节点</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addNode</span><span class="params">(StudentNode node)</span> &#123;</span><br><span class="line"><span class="comment">//因为头节点不能被修改，所以创建一个辅助节点</span></span><br><span class="line"><span class="type">StudentNode</span> <span class="variable">temp</span> <span class="operator">=</span> head;</span><br><span class="line"><span class="comment">//找到最后一个节点</span></span><br><span class="line"><span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line"><span class="comment">//temp是尾节点就停止循环</span></span><br><span class="line"><span class="keyword">if</span>(temp.next == <span class="literal">null</span>) &#123;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//不是尾结点就向后移动</span></span><br><span class="line">temp = temp.next;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//现在temp是尾节点了，再次插入</span></span><br><span class="line">temp.next = node;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 遍历链表</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">traverseNode</span><span class="params">()</span> &#123;</span><br><span class="line">System.out.println(<span class="string">&quot;开始遍历链表&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(head.next == <span class="literal">null</span>) &#123;</span><br><span class="line">System.out.println(<span class="string">&quot;链表为空&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//创建辅助节点</span></span><br><span class="line"><span class="type">StudentNode</span> <span class="variable">temp</span> <span class="operator">=</span> head.next;</span><br><span class="line"><span class="keyword">while</span>(<span class="literal">true</span>) &#123;</span><br><span class="line"><span class="comment">//遍历完成就停止循环</span></span><br><span class="line"><span class="keyword">if</span>(temp == <span class="literal">null</span>) &#123;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">System.out.println(temp);</span><br><span class="line">temp = temp.next;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 按id顺序插入节点</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> node</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addByOrder</span><span class="params">(StudentNode node)</span> &#123;</span><br><span class="line"><span class="comment">//如果没有首节点，就直接插入</span></span><br><span class="line"><span class="keyword">if</span>(head.next == <span class="literal">null</span>) &#123;</span><br><span class="line">head.next = node;</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//辅助节点，用于找到插入位置和插入操作</span></span><br><span class="line"><span class="type">StudentNode</span> <span class="variable">temp</span> <span class="operator">=</span> head;</span><br><span class="line"><span class="comment">//节点的下一个节点存在，且它的id小于要插入节点的id，就继续下移</span></span><br><span class="line"><span class="keyword">while</span> (temp.next!=<span class="literal">null</span> &amp;&amp; temp.next.id &lt; node.id) &#123;</span><br><span class="line">temp = temp.next;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//如果temp的下一个节点存在，则执行该操作</span></span><br><span class="line"><span class="comment">//且插入操作，顺序不能换</span></span><br><span class="line"><span class="keyword">if</span>(temp.next != <span class="literal">null</span>) &#123;</span><br><span class="line">node.next = temp.next;</span><br><span class="line">&#125;</span><br><span class="line">temp.next = node;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 根据id来修改节点信息</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> node 修改信息的节点</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">changeNode</span><span class="params">(StudentNode node)</span> &#123;</span><br><span class="line"><span class="keyword">if</span>(head == <span class="literal">null</span>) &#123;</span><br><span class="line">System.out.println(<span class="string">&quot;链表为空，请先加入该学生信息&quot;</span>);</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">StudentNode</span> <span class="variable">temp</span> <span class="operator">=</span> head;</span><br><span class="line"><span class="comment">//遍历链表，找到要修改的节点</span></span><br><span class="line"><span class="keyword">while</span> (temp.next!= <span class="literal">null</span> &amp;&amp; temp.id != node.id) &#123;</span><br><span class="line">temp = temp.next;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//如果temp已经是最后一个节点，判断id是否相等</span></span><br><span class="line"><span class="keyword">if</span>(temp.id != node.id) &#123;</span><br><span class="line">System.out.println(<span class="string">&quot;未找到该学生的信息，请先创建该学生的信息&quot;</span>);</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//修改学生信息</span></span><br><span class="line">temp.name = node.name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 根据id删除节点</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> node 要删除的节点</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">deleteNode</span><span class="params">(StudentNode node)</span> &#123;</span><br><span class="line"> <span class="keyword">if</span>(head.next == <span class="literal">null</span>) &#123;</span><br><span class="line">System.out.println(<span class="string">&quot;链表为空&quot;</span>);</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"> <span class="type">StudentNode</span> <span class="variable">temp</span> <span class="operator">=</span> head.next;</span><br><span class="line"> <span class="comment">//遍历链表，找到要删除的节点</span></span><br><span class="line"> <span class="keyword">if</span>(temp.next!=<span class="literal">null</span> &amp;&amp; temp.next.id!=node.id) &#123;</span><br><span class="line"> temp = temp.next;</span><br><span class="line">&#125;</span><br><span class="line"> <span class="comment">//判断最后一个节点的是否要删除的节点</span></span><br><span class="line"> <span class="keyword">if</span>(temp.next.id != node.id) &#123;</span><br><span class="line">System.out.println(<span class="string">&quot;请先插入该学生信息&quot;</span>);</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"> <span class="comment">//删除该节点</span></span><br><span class="line"> temp.next = temp.next.next;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 得到倒数的节点</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> index 倒数第几个数</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> StudentNode <span class="title function_">getStuByRec</span><span class="params">(<span class="type">int</span> index)</span> &#123;</span><br><span class="line"><span class="keyword">if</span>(head.next == <span class="literal">null</span>) &#123;</span><br><span class="line">System.out.println(<span class="string">&quot;链表为空!&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">StudentNode</span> <span class="variable">temp</span> <span class="operator">=</span> head.next;</span><br><span class="line"><span class="comment">//用户记录链表长度，因为head.next不为空，此时已经有一个节点了</span></span><br><span class="line"><span class="comment">//所以length初始化为1</span></span><br><span class="line"><span class="type">int</span> <span class="variable">length</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span>(temp.next != <span class="literal">null</span>) &#123;</span><br><span class="line">temp = temp.next;</span><br><span class="line">length++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(length &lt; index) &#123;</span><br><span class="line"><span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;链表越界&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">temp = head.next;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i&lt;length-index; i++) &#123;</span><br><span class="line">temp = temp.next;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> temp;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 翻转链表</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> 反转后的链表</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> LinkedList <span class="title function_">reverseList</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="comment">//链表为空或者只有一个节点，无需翻转</span></span><br><span class="line"><span class="keyword">if</span>(head.next == <span class="literal">null</span> || head.next.next == <span class="literal">null</span>) &#123;</span><br><span class="line">System.out.println(<span class="string">&quot;无需翻转&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">LinkedList</span> <span class="variable">newLinkedList</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">LinkedList</span>();</span><br><span class="line"><span class="comment">//给新链表创建新的头结点</span></span><br><span class="line">newLinkedList.head = <span class="keyword">new</span> <span class="title class_">StudentNode</span>(<span class="number">0</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line"><span class="comment">//用于保存正在遍历的节点</span></span><br><span class="line"><span class="type">StudentNode</span> <span class="variable">temp</span> <span class="operator">=</span> head.next;</span><br><span class="line"><span class="comment">//用于保存正在遍历节点的下一个节点</span></span><br><span class="line"><span class="type">StudentNode</span> <span class="variable">nextNode</span> <span class="operator">=</span> temp.next;</span><br><span class="line"><span class="keyword">while</span>(<span class="literal">true</span>) &#123;</span><br><span class="line"><span class="comment">//插入新链表</span></span><br><span class="line">temp.next = newLinkedList.head.next;</span><br><span class="line">newLinkedList.head.next = temp;</span><br><span class="line"><span class="comment">//移动到下一个节点</span></span><br><span class="line">temp = nextNode;</span><br><span class="line">nextNode = nextNode.next;</span><br><span class="line"><span class="keyword">if</span>(temp.next == <span class="literal">null</span>) &#123;</span><br><span class="line"><span class="comment">//插入最后一个节点</span></span><br><span class="line">temp.next = newLinkedList.head.next;</span><br><span class="line">newLinkedList.head.next = temp;</span><br><span class="line">head.next = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">return</span> newLinkedList;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">reverseTraverse</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">if</span>(head == <span class="literal">null</span>) &#123;</span><br><span class="line">System.out.println(<span class="string">&quot;链表为空&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">StudentNode</span> <span class="variable">temp</span> <span class="operator">=</span> head.next;</span><br><span class="line"><span class="comment">//创建栈，用于存放遍历到的节点</span></span><br><span class="line">Stack&lt;StudentNode&gt; stack = <span class="keyword">new</span> <span class="title class_">Stack</span>&lt;&gt;();</span><br><span class="line"><span class="keyword">while</span>(temp != <span class="literal">null</span>) &#123;</span><br><span class="line">stack.push(temp);</span><br><span class="line">temp = temp.next;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (!stack.isEmpty()) &#123;</span><br><span class="line">System.out.println(stack.pop());</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 定义节点</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">StudentNode</span> &#123;</span><br><span class="line"><span class="type">int</span> id;</span><br><span class="line">String name;</span><br><span class="line"><span class="comment">//用于保存下一个节点的地址</span></span><br><span class="line">StudentNode next;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">StudentNode</span><span class="params">(<span class="type">int</span> id, String name)</span> &#123;</span><br><span class="line"><span class="built_in">this</span>.id = id;</span><br><span class="line"><span class="built_in">this</span>.name = name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="string">&quot;StudentNode&#123;&quot;</span> +</span><br><span class="line"><span class="string">&quot;id=&quot;</span> + id +</span><br><span class="line"><span class="string">&quot;, name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line"><span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="结果"><a class="markdownIt-Anchor" href="#结果"></a> 结果</h3><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">开始遍历链表</span><br><span class="line">链表为空</span><br><span class="line"></span><br><span class="line">开始遍历链表</span><br><span class="line">StudentNode&#123;id=1, name=&#x27;Nyima&#x27;&#125;</span><br><span class="line">StudentNode&#123;id=3, name=&#x27;Lulu&#x27;&#125;</span><br><span class="line"></span><br><span class="line">有序插入</span><br><span class="line">开始遍历链表</span><br><span class="line">StudentNode&#123;id=0, name=&#x27;Wenwen&#x27;&#125;</span><br><span class="line">StudentNode&#123;id=1, name=&#x27;Nyima&#x27;&#125;</span><br><span class="line">StudentNode&#123;id=3, name=&#x27;Lulu&#x27;&#125;</span><br><span class="line"></span><br><span class="line">修改学生信息</span><br><span class="line">开始遍历链表</span><br><span class="line">StudentNode&#123;id=0, name=&#x27;Wenwen&#x27;&#125;</span><br><span class="line">StudentNode&#123;id=1, name=&#x27;Hulu&#x27;&#125;</span><br><span class="line">StudentNode&#123;id=3, name=&#x27;Lulu&#x27;&#125;</span><br><span class="line"></span><br><span class="line">删除学生信息</span><br><span class="line">开始遍历链表</span><br><span class="line">StudentNode&#123;id=0, name=&#x27;Wenwen&#x27;&#125;</span><br><span class="line">StudentNode&#123;id=3, name=&#x27;Lulu&#x27;&#125;</span><br><span class="line"></span><br><span class="line">获得倒数节点</span><br><span class="line">StudentNode&#123;id=0, name=&#x27;Wenwen&#x27;&#125;</span><br><span class="line"></span><br><span class="line">翻转链表</span><br><span class="line">开始遍历链表</span><br><span class="line">StudentNode&#123;id=3, name=&#x27;Lulu&#x27;&#125;</span><br><span class="line">StudentNode&#123;id=0, name=&#x27;Wenwen&#x27;&#125;</span><br><span class="line"></span><br><span class="line">倒序遍历链表</span><br><span class="line">StudentNode&#123;id=0, name=&#x27;Wenwen&#x27;&#125;</span><br><span class="line">StudentNode&#123;id=3, name=&#x27;Lulu&#x27;&#125;</span><br></pre></td></tr></table></figure><h2 id="双向链表"><a class="markdownIt-Anchor" href="#双向链表"></a> 双向链表</h2><p><img src="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200616170404.png" alt="img" /></p><h3 id="实现思路"><a class="markdownIt-Anchor" href="#实现思路"></a> 实现思路</h3><h3 id="遍历-2"><a class="markdownIt-Anchor" href="#遍历-2"></a> <strong>遍历</strong></h3><ul><li>和单向链表的遍历相同，需要一个辅助节点来保存当前正在遍历的节点</li></ul><h3 id="添加"><a class="markdownIt-Anchor" href="#添加"></a> <strong>添加</strong></h3><ul><li>双向链表多出了一个frnot，所以在添加时，要让新增节点的front指向链表尾节点</li></ul><h3 id="修改"><a class="markdownIt-Anchor" href="#修改"></a> <strong>修改</strong></h3><ul><li>和单向链表的修改相同</li></ul><h3 id="删除"><a class="markdownIt-Anchor" href="#删除"></a> <strong>删除</strong></h3><ul><li>使用temp来保存要删除的节点</li><li>temp.pre.next指向temp.next</li><li>temp.next指向temp.pre</li></ul><h3 id="代码-2"><a class="markdownIt-Anchor" href="#代码-2"></a> <strong>代码</strong></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo2</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">BidirectionalList</span> <span class="variable">bidirectionalList</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BidirectionalList</span>();</span><br><span class="line">        bidirectionalList.addNode(<span class="keyword">new</span> <span class="title class_">PersonNode</span>(<span class="number">1</span>, <span class="string">&quot;Nyima&quot;</span>));</span><br><span class="line">        bidirectionalList.addNode(<span class="keyword">new</span> <span class="title class_">PersonNode</span>(<span class="number">2</span>, <span class="string">&quot;Lulu&quot;</span>));</span><br><span class="line">        bidirectionalList.traverseNode();</span><br><span class="line">        System.out.println();</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;修改节点信息&quot;</span>);</span><br><span class="line">        bidirectionalList.changeNode(<span class="keyword">new</span> <span class="title class_">PersonNode</span>(<span class="number">2</span>, <span class="string">&quot;Wenwen&quot;</span>));</span><br><span class="line">        bidirectionalList.traverseNode();</span><br><span class="line">        System.out.println();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//删除节点</span></span><br><span class="line">        System.out.println(<span class="string">&quot;删除节点&quot;</span>);</span><br><span class="line">        bidirectionalList.deleteNode(<span class="keyword">new</span> <span class="title class_">PersonNode</span>(<span class="number">1</span>, <span class="string">&quot;Nyima&quot;</span>));</span><br><span class="line">        bidirectionalList.traverseNode();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">BidirectionalList</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">PersonNode</span> <span class="variable">head</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PersonNode</span>(-<span class="number">1</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 判断双向链表是否为空</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return</span> 判空结果</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isEmpty</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> head.next == <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 添加将诶点</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> node 要被添加的节点</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addNode</span><span class="params">(PersonNode node)</span> &#123;</span><br><span class="line">        <span class="type">PersonNode</span> <span class="variable">temp</span> <span class="operator">=</span> head;</span><br><span class="line">        <span class="keyword">if</span>(temp.next != <span class="literal">null</span>) &#123;</span><br><span class="line">            temp = temp.next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//插入在最后一个节点的后面</span></span><br><span class="line">        temp.next = node;</span><br><span class="line">        node.front = temp;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">traverseNode</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;遍历链表&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (isEmpty()) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;链表为空&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">PersonNode</span> <span class="variable">temp</span> <span class="operator">=</span> head.next;</span><br><span class="line">        <span class="keyword">while</span>(temp != <span class="literal">null</span>) &#123;</span><br><span class="line">            System.out.println(temp);</span><br><span class="line">            temp = temp.next;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 修改节点信息</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> node 要修改的节点</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">changeNode</span><span class="params">(PersonNode node)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(isEmpty()) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;链表为空&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">PersonNode</span> <span class="variable">temp</span> <span class="operator">=</span> head.next;</span><br><span class="line">        <span class="comment">//用于判定是否做了修改</span></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">flag</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">while</span> (temp != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span>(temp.id == node.id) &#123;</span><br><span class="line">                <span class="comment">//匹配到节点，替换节点</span></span><br><span class="line">                temp.front.next = node;</span><br><span class="line">                node.next = temp.next;</span><br><span class="line">                flag = <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            temp = temp.next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(!flag) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;未匹配到改人信息&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 删除节点</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> node 要删除的节点</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">deleteNode</span><span class="params">(PersonNode node)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(isEmpty())&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;链表为空&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">PersonNode</span> <span class="variable">temp</span> <span class="operator">=</span> head.next;</span><br><span class="line">        <span class="comment">//查看是否删除成功</span></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">flag</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">while</span>(temp != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span>(temp.id == node.id) &#123;</span><br><span class="line">                temp.front.next = temp.next;</span><br><span class="line">                temp.next = <span class="literal">null</span>;</span><br><span class="line">                flag = <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            temp = temp.next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(!flag) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;未找到该节点&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">PersonNode</span> &#123;</span><br><span class="line">    <span class="type">int</span> id;</span><br><span class="line">    String name;</span><br><span class="line">    <span class="comment">//指向下一个节点</span></span><br><span class="line">    PersonNode next;</span><br><span class="line">    <span class="comment">//指向前一个节点</span></span><br><span class="line">    PersonNode front;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">PersonNode</span><span class="params">(<span class="type">int</span> id, String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.id = id;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;PersonNode&#123;&quot;</span> +</span><br><span class="line">            <span class="string">&quot;id=&quot;</span> + id +</span><br><span class="line">            <span class="string">&quot;, name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">            <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="输出"><a class="markdownIt-Anchor" href="#输出"></a> <strong>输出</strong></h3><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">遍历链表</span><br><span class="line">PersonNode&#123;id=1, name=&#x27;Nyima&#x27;&#125;</span><br><span class="line">PersonNode&#123;id=2, name=&#x27;Lulu&#x27;&#125;</span><br><span class="line"></span><br><span class="line">修改节点信息</span><br><span class="line">遍历链表</span><br><span class="line">PersonNode&#123;id=1, name=&#x27;Nyima&#x27;&#125;</span><br><span class="line">PersonNode&#123;id=2, name=&#x27;Wenwen&#x27;&#125;</span><br><span class="line"></span><br><span class="line">删除节点</span><br><span class="line">遍历链表</span><br><span class="line">PersonNode&#123;id=2, name=&#x27;Wenwen&#x27;&#125;</span><br></pre></td></tr></table></figure><blockquote><p>我的博客即将同步至腾讯云+社区，邀请大家一同入驻：<a href="https://cloud.tencent.com/developer/support-plan?invite_code=39jvp4pqpw2ss">https://cloud.tencent.com/developer/support-plan?invite_code=39jvp4pqpw2ss</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 数据结构 </category>
          
          <category> 链表 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数据结构 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>循环队列</title>
      <link href="/posts/b66774c1/"/>
      <url>/posts/b66774c1/</url>
      
        <content type="html"><![CDATA[<blockquote><p><strong>循环队列</strong>是 队列的一种特殊形式。首先介绍队列，然后引申出循环队列。<br />队列又称为“先进先出”<strong>FIFO</strong>线性表<br />限定插入操作只能在队尾进行，而删除操作只能在队首进行<br />队列也可以采用<strong>顺序存储结构或链表结构</strong>来实现，分别称为顺序队列和链队列</p><p><strong>队列的顺序表示—顺序队列</strong></p><p>用一组连续的<strong>存储单元</strong>依次存放从队首到队尾的元素，附设两个指针 head 和 tail 分别指向队首元素和队尾元素的位置，<br />(有的地方用 front 和 rear 表示)</p><p><img src="https://unpkg.com/serms-assets@1.0.6/queue/SouthEast.png" alt="img" /></p><p><strong>当 head = tail = 0 时表示空队列</strong></p><p><img src="https://unpkg.com/serms-assets@1.0.6/queue/01.png" alt="这里写图片描述" /></p><p><strong>当插入新元素到队尾时，tail 加 1</strong></p><p><img src="https://unpkg.com/serms-assets@1.0.6/queue/02.png" alt="这里写图片描述" /></p><p><strong>当删除队首元素时，head 加 1，上图如果把 C 也删掉，那么就 head = tail 了</strong></p><p><strong>tail 始终指向队列元素的下一个位置</strong></p><p>对应的操作：<br />队空：head=tail<br />求队长：tail - head<br />入队：新元素按 tail 指示位置加入，再将队尾指针加 1 ，即 tail = tail + 1<br />出队：将 head 指示的元素取出，再将队头指针加 1，即 head = head + 1</p><p><img src="https://unpkg.com/serms-assets@1.0.6/queue/03.png" alt="这里写图片描述" /></p><p><strong>下面引入循环队列</strong></p><p><img src="https://unpkg.com/serms-assets@1.0.6/queue/04.png" alt="这里写图片描述" /></p><p><img src="https://unpkg.com/serms-assets@1.0.6/queue/05.png" alt="这里写图片描述" /></p><p><strong>入队，tail 指针变化：</strong> &gt;<strong>tail ＝ （tail ＋ 1）％maxsize</strong></p><p><img src="https://unpkg.com/serms-assets@1.0.6/queue/06.png" alt="这里写图片描述" /></p><p><strong>出队，head 指针变化：</strong> &gt;<strong>head ＝（ head ＋ 1）％maxsize</strong></p><p>删除数据 C，队列为空</p><p><img src="https://unpkg.com/serms-assets@1.0.6/queue/07.png" alt="这里写图片描述" /></p><p>依次插入数据 D,E,F,G,H,I,J,K<br />队列满：head = tail</p><p><img src="https://unpkg.com/serms-assets@1.0.6/queue/08.png" alt="这里写图片描述" /></p><p>队满和队空时，均有 head=tail<br />因此，只凭 head=tail 还无法区分是满还是空。</p><p>如何判定队列满还是空？</p><p>方法 1：<br />用一个计数变量来记载队列中的元素个数<br />初始化队列时 c=0;<br />当入队时，计数变量＋ 1（ c=c+1 ）<br />当出队时，计数变量－1 （c=c-1）<br />当计数变量＝ maxsize 时，队满<br />当计数变量＝ 0 时，队空</p><p>方法 2：<br />牺牲一个元素空间，来区别队空或队满。<br />入队前，先判 Q.rear+1 是否等于 Q.front，<br />若是则为队满。<br />而当 Q.front=Q.rear 时，为队空。<br />上图中：当数据 J 入队后，就认为队已满，<br />而当数据 K 再要入队时，就拒绝入队。</p><p>当队列已经满了，如果允许覆盖之前的数据：<br /><img src="https://unpkg.com/serms-assets@1.0.6/queue/09.png" alt="这里写图片描述" /></p><p>队列已经满了之后，<br />继续插入数据 L,M,N，<br />之前的数据 D,E,F 被覆盖<br />此时，队列已经满了，<br />最新的数据是：G,H,I，J，K,L,M,N</p><p>在程序中，取队列的数据的时候，如果检测到 队列满了，<br />此时，需要一次性取出队列中的数据，一次性取出数据的时候，不用管 head 指针，直接按照 tail 指针指向的位置开始取数据，直到循环取到 tail-1 位置停止。最终取出的数据的个数是 队列的长度 maxsize<br />取出之后，可以对队列指针 head 和 tail 初始化为 0，需要将队列满整个标志设置为 False.</p><p>当应该用场景如下的时候：</p><ol><li>数据是一条一条的进入队列的</li><li>队列中的数据是一次性读取的<br />一次性读取出队列中的所有数据的方式：<br />因为允许覆盖，有两种情况：<br />当队列满了之后，<br />需要根据 tail,从 tail 所在位置的数据，绕一圈到 tail-1 位置所在的数据，都按照顺序取出来，这些数据是按照顺序，最新的数据。<br />当队列没有满的时候，<br />队列中所有的数据是 Head 到 tail 之间的所有数据。</li></ol><p><strong>这里采用方式 2 来进行代码演示</strong></p><p>参考代码：</p><p>分析:</p><ol><li>当队列满时,条件是(rear + 1) % maxSize = front</li><li>队列为空的条件: rear == front</li><li>队列有效数据个数:(rear + maxSize - front) % maxSize</li></ol></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> SerMs</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2022/3/20 18:39</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CircleArrayQueueDemo</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;测试数组模拟环形队列的案例~~~~~&quot;</span>);</span><br><span class="line">        <span class="comment">//创建一个队列</span></span><br><span class="line">        <span class="type">CircleArray</span> <span class="variable">circleArray</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CircleArray</span>(<span class="number">4</span>); <span class="comment">//说明设置4.其队列的有效数据最大是3</span></span><br><span class="line">        <span class="type">char</span> <span class="variable">key</span> <span class="operator">=</span> <span class="string">&#x27; &#x27;</span>; <span class="comment">//接收用户输入</span></span><br><span class="line">        <span class="type">Scanner</span> <span class="variable">scanner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">loop</span> <span class="operator">=</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="comment">//输出一个菜单</span></span><br><span class="line">        <span class="keyword">while</span> (loop) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;s(show): 显示队列&quot;</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;e(exit): 推出队列&quot;</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;a(add): 添加数据到队列&quot;</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;g(get): 从队列取出数据&quot;</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;h(head): 查看队列头的数据&quot;</span>);</span><br><span class="line">            key = scanner.next().charAt(<span class="number">0</span>); <span class="comment">//接收一个字符</span></span><br><span class="line">            <span class="keyword">switch</span> (key) &#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;s&#x27;</span>:</span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                        circleArray.showQueue();</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                        System.out.println(e.getMessage());</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;a&#x27;</span>:</span><br><span class="line">                    System.out.println(<span class="string">&quot;请输入一个数&quot;</span>);</span><br><span class="line">                    <span class="type">int</span> <span class="variable">value</span> <span class="operator">=</span> scanner.nextInt();</span><br><span class="line">                    circleArray.addQueue(value);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;g&#x27;</span>: <span class="comment">//取出数据</span></span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                        <span class="type">int</span> <span class="variable">res</span> <span class="operator">=</span> circleArray.getQueue();</span><br><span class="line">                        System.out.printf(<span class="string">&quot;取出的数据是: %d\n&quot;</span>, res);</span><br><span class="line">                    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                        System.out.println(e.getMessage());</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;h&#x27;</span>:</span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                        <span class="type">int</span> <span class="variable">res</span> <span class="operator">=</span> circleArray.headQueue();</span><br><span class="line">                        System.out.printf(<span class="string">&quot;队列头数据是:%d\n&quot;</span>, res);</span><br><span class="line">                    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                        System.out.println(e.getMessage());</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;e&#x27;</span>:</span><br><span class="line">                    scanner.close();</span><br><span class="line">                    loop = <span class="literal">false</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">default</span>:</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;退出队列~~~&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CircleArray</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> maxSize;  <span class="comment">//表示数组的最大容量</span></span><br><span class="line">    <span class="comment">//front的初始值=0 也就是说arr[front]就是队列的第一个元素</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> front;  <span class="comment">//队列头</span></span><br><span class="line">    <span class="comment">//rear的初始值=0 rear指向队列的最后一个元素的后一个位置,因为希望空出一个空间作为约定</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> rear;   <span class="comment">//队列尾</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span>[] arr; <span class="comment">//该数组用于存放数据,模拟队列</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//创建队列构造器</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">CircleArray</span><span class="params">(<span class="type">int</span> arrMaxSize)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.maxSize = arrMaxSize;</span><br><span class="line">        <span class="built_in">this</span>.arr = <span class="keyword">new</span> <span class="title class_">int</span>[<span class="built_in">this</span>.maxSize];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//判断队列是否满</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isFull</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> (rear + <span class="number">1</span>) % maxSize == front;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//判断队列是否为空</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isEmpty</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">return</span> <span class="variable">rear</span> <span class="operator">=</span>= front;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//添加数据到队列</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addQueue</span><span class="params">(<span class="type">int</span> n)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (isFull()) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;队列满,不能加入数据~~~&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//直接将数据加入</span></span><br><span class="line">        arr[rear] = n;</span><br><span class="line">        <span class="comment">//将rear后移,必须考虑取模</span></span><br><span class="line">        rear = (rear + <span class="number">1</span>) % maxSize;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//获取队列的数据,出队列</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getQueue</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">//判断队列是否为空</span></span><br><span class="line">        <span class="keyword">if</span> (isEmpty()) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;队列为空,不能获取数据&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//分析出front是指向队列的第一个元素</span></span><br><span class="line">        <span class="comment">//1.先把front对应的值保存到临时变量</span></span><br><span class="line">        <span class="comment">//2.将front后移 考虑取模</span></span><br><span class="line">        <span class="comment">//3.将临时保存的变量返回</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">value</span> <span class="operator">=</span> arr[front];</span><br><span class="line">        front = (front + <span class="number">1</span>) % maxSize;</span><br><span class="line">        <span class="keyword">return</span> value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//显示所有数据</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">showQueue</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">//遍历</span></span><br><span class="line">        <span class="keyword">if</span> (isEmpty()) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;队列为空,不能获取数据&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//思路:从front开始遍历,遍历多少个元素</span></span><br><span class="line">        <span class="comment">//</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> front; i &lt; front + size(); i++) &#123;</span><br><span class="line">            System.out.printf(<span class="string">&quot;arr[%d] = %d\n&quot;</span>, i % maxSize, arr[i % maxSize]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//求出当前队列有效数据的个数</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">size</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> (rear + maxSize - front) % maxSize;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//显示队列头数据,不是取出数据</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">headQueue</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">//判断</span></span><br><span class="line">        <span class="keyword">if</span> (isEmpty()) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;队列为空,没有数据~~~~&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> arr[front];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 数据结构 </category>
          
          <category> 循环队列 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数据结构 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>OJ1024</title>
      <link href="/posts/9b97716e/"/>
      <url>/posts/9b97716e/</url>
      
        <content type="html"><![CDATA[<p>ps:<code>算法打卡第一天</code></p><h2 id="金币"><a class="markdownIt-Anchor" href="#金币"></a> 金币</h2><blockquote><h3 id="描述"><a class="markdownIt-Anchor" href="#描述"></a> 描述</h3><p>国王将金币作为工资，发放给忠诚的骑士。第一天，骑士收到一枚金币；之后两天（第二天和第三天），每天收到两枚金币；之后三天（第四、五、六天），每天收到三枚金币；之后四天（第七、八、九、十天），每天收到四枚金币……；这种工资发放模式会一直这样延续下去：当连续 N 天每天收到 N 枚金币后，骑士会在之后的连续 N+1 天里，每天收到 N+1 枚金币。</p><p>请计算在前 K 天里，骑士一共获得了多少金币。</p><h3 id="输入"><a class="markdownIt-Anchor" href="#输入"></a> 输入</h3><p>输入只有 1 行，包含一个正整数 K，表示发放金币的天数。</p><h3 id="输出"><a class="markdownIt-Anchor" href="#输出"></a> 输出</h3><p>输出文件只有 1 行，包含一个正整数，即骑士收到的金币数。</p><p><img src="https://unpkg.com/serms-assets@1.0.6/oj/image-20220317235542863.png" alt="" /></p></blockquote><h2 id="分析"><a class="markdownIt-Anchor" href="#分析"></a> 分析</h2><blockquote><p>骑士收的金币数写成以下形式，更容易想到解题方法<br />以前 10 天（包括第 10 天）收到的金币数为例，则收到的金币数为：<br />1 （第一天）<br />2 2 （第二、三天）<br />3 3 3 （第四、五、六天）<br />4 4 4 4 （第七、八、九、十天）<br />若想打印上面的这个数字三角形的话，只需两个 for 循环即可：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>;i&lt;=<span class="number">4</span>; i++) &#123;</span><br><span class="line">   <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">1</span>; j &lt;= i; j++) &#123;</span><br><span class="line">       System.out.println(i);</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>类比这段代码，内层 for 循环可以代表天数，那只需修改循环终止的条件，当天数 day==k 时，终止循环即可。<br />该题解决代码如下：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* <span class="doctag">@Author</span> SerMs</span></span><br><span class="line"><span class="comment">* <span class="doctag">@Date</span> 2022/3/17 23:15</span></span><br><span class="line"><span class="comment">* <span class="doctag">@Version</span> 1.0</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main1024</span> &#123;</span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">       <span class="type">Scanner</span> <span class="variable">sc</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line"></span><br><span class="line">       <span class="type">int</span> <span class="variable">day</span> <span class="operator">=</span> sc.nextInt(), days = <span class="number">0</span>, sum = <span class="number">0</span>;</span><br><span class="line">       <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>;; i++) &#123;</span><br><span class="line">           <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">1</span>; j &lt;= i; j++) &#123;</span><br><span class="line">               days++;</span><br><span class="line">               sum += i;</span><br><span class="line">               <span class="keyword">if</span> (day==days)&#123;</span><br><span class="line">                   System.out.println(sum);</span><br><span class="line">                   <span class="keyword">return</span>;</span><br><span class="line">               &#125;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></blockquote>]]></content>
      
      
      <categories>
          
          <category> OJ </category>
          
          <category> HNKJZYXY_OJ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HNKJZYXY_OJ </tag>
            
            <tag> OJ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Spring Aop详细介绍</title>
      <link href="/posts/9dadefec/"/>
      <url>/posts/9dadefec/</url>
      
        <content type="html"><![CDATA[<h2 id="什么是-aop"><a class="markdownIt-Anchor" href="#什么是-aop"></a> 什么是 AOP</h2><blockquote><p>​ <a href="https://baike.baidu.com/item/AOP/1332219?fr=aladdin">AOP</a>（Aspect-OrientedProgramming，面向切面编程），可以说是 OOP（Object-Oriented Programing，面向对象编程）的补充和完善。OOP 引入封装、继承和多态性等概念来建立一种对象层次结构，用以模拟公共行为的一个集合。当我们需要为分散的对象引入公共行为的时候，OOP 则显得无能为力。也就是说，OOP 允许你定义从上到下的关系，但并不适合定义从左到右的关系。例如日志功能。日志代码往往水平地散布在所有对象层次中，而与它所散布到的对象的核心功能毫无关系。对于其他类型的代码，如安全性、异常处理和透明的持续性也是如此。这种散布在各处的无关的代码被称为横切（cross-cutting）代码，在 OOP 设计中，它导致了大量代码的重复，而不利于各个模块的重用。</p><p>​ 而 AOP 技术则恰恰相反，它利用一种称为“横切”的技术，剖解开封装的对象内部，并将那些影响了多个类的公共行为封装到一个可重用模块，并将其名为“Aspect”，即方面。所谓“方面”，简单地说，就是将那些与业务无关，却为业务模块所共同调用的逻辑或责任封装起来，便于减少系统的重复代码，降低模块间的耦合度，并有利于未来的可操作性和可维护性。AOP 代表的是一个横向的关系，如果说“对象”是一个空心的圆柱体，其中封装的是对象的属性和行为；那么面向方面编程的方法，就仿佛一把利刃，将这些空心圆柱体剖开，以获得其内部的消息。而剖开的切面，也就是所谓的“方面”了。然后它又以巧夺天功的妙手将这些剖开的切面复原，不留痕迹。</p></blockquote><hr /><h2 id="aop-的基本概念"><a class="markdownIt-Anchor" href="#aop-的基本概念"></a> AOP 的基本概念</h2><blockquote><ul><li>(1)Aspect(切面):通常是一个类，里面可以定义切入点和通知</li><li>(2)JointPoint(连接点):程序执行过程中明确的点，一般是方法的调用</li><li>(3)Advice(通知):AOP 在特定的切入点上执行的增强处理，有 before,after,afterReturning,afterThrowing,around</li><li>(4)Pointcut(切入点):就是带有通知的连接点，在程序中主要体现为书写切入点表达式</li><li>(5)AOP 代理：AOP 框架创建的对象，代理就是目标对象的加强。Spring 中的 AOP 代理可以使 JDK 动态代理，也可以是 CGLIB 代理，前者基于接口，后者基于子类</li></ul></blockquote><p><strong>通知方法:</strong></p><blockquote><ol><li>前置通知:在我们执行目标方法之前运行(<strong>@Before</strong>)</li><li>后置通知:在我们目标方法运行结束之后 ,不管有没有异常****(@After)****</li><li>返回通知:在我们的目标方法正常返回值后运行****(@AfterReturning)****</li><li>异常通知:在我们的目标方法出现异常后运行****(@AfterThrowing)****</li><li>环绕通知:动态代理, 需要手动执行 joinPoint.procced()(其实就是执行我们的目标方法执行之前相当于前置通知, 执行之后就相当于我们后置通知**(@Around)**</li></ol></blockquote><hr /><h2 id="spring-aop"><a class="markdownIt-Anchor" href="#spring-aop"></a> Spring AOP</h2><blockquote><p>​ Spring 中的 AOP 代理还是离不开 Spring 的 IOC 容器，代理的生成，管理及其依赖关系都是由 IOC 容器负责，Spring 默认使用 JDK 动态代理，在需要代理类而不是代理接口的时候，Spring 会自动切换为使用 CGLIB 代理，不过现在的项目都是面向接口编程，所以 JDK 动态代理相对来说用的还是多一些。</p></blockquote><h3 id="advice-的类型"><a class="markdownIt-Anchor" href="#advice-的类型"></a> advice 的类型</h3><blockquote><ul><li>before advice, 在 join point 前被执行的 advice. 虽然 before advice 是在 join point 前被执行, 但是它并不能够阻止 join point 的执行, 除非发生了异常(即我们在 before advice 代码中, 不能人为地决定是否继续执行 join point 中的代码)</li><li>after return advice, 在一个 join point 正常返回后执行的 advice</li><li>after throwing advice, 当一个 join point 抛出异常后执行的 advice</li><li>after(final) advice, 无论一个 join point 是正常退出还是发生了异常, 都会被执行的 advice.</li><li>around advice, 在 join point 前和 joint point 退出后都执行的 advice. 这个是最常用的 advice</li></ul></blockquote><h3 id="关于-aop-proxy"><a class="markdownIt-Anchor" href="#关于-aop-proxy"></a> 关于 AOP Proxy</h3><p>Spring AOP 默认使用标准的 JDK 动态代理(dynamic proxy)技术来实现 AOP 代理, 通过它, 我们可以为任意的接口实现代理. <code>如果需要为一个类实现代理, 那么可以使用 CGLIB 代理.</code> 当一个业务逻辑对象没有实现接口时, 那么 Spring AOP 就默认使用 CGLIB 来作为 AOP 代理了. 即如果我们需要为一个方法织入 advice, 但是这个方法不是一个接口所提供的方法, 则此时 Spring AOP 会使用 CGLIB 来实现动态代理. 鉴于此, Spring AOP 建议基于接口编程, 对接口进行 AOP 而不是类.</p><h3 id=""><a class="markdownIt-Anchor" href="#"></a> <a href="https://dunwu.github.io/spring-tutorial/core/spring-aop.html#%E5%BD%BB%E5%BA%95%E7%90%86%E8%A7%A3-aspect-join-point-point-cut-advice">#</a>彻底理解 aspect, join point, point cut, advice</h3><p>看完了上面的理论部分知识, 我相信还是会有不少朋友感觉到 AOP 的概念还是很模糊, 对 AOP 中的各种概念理解的还不是很透彻. 其实这很正常, 因为 AOP 中的概念是在是太多了, 我当时也是花了老大劲才梳理清楚的. 下面我以一个简单的例子来比喻一下 AOP 中 aspect, jointpoint, pointcut 与 advice 之间的关系.</p><p>让我们来假设一下, 从前有一个叫爪哇的小县城, 在一个月黑风高的晚上, 这个县城中发生了命案. 作案的凶手十分狡猾, 现场没有留下什么有价值的线索. 不过万幸的是, 刚从隔壁回来的老王恰好在这时候无意中发现了凶手行凶的过程, 但是由于天色已晚, 加上凶手蒙着面, 老王并没有看清凶手的面目, 只知道凶手是个男性, 身高约七尺五寸. 爪哇县的县令根据老王的描述, 对守门的士兵下命令说: 凡是发现有身高七尺五寸的男性, 都要抓过来审问. 士兵当然不敢违背县令的命令, 只好把进出城的所有符合条件的人都抓了起来.</p><p>来让我们看一下上面的一个小故事和 AOP 到底有什么对应关系. 首先我们知道, 在 Spring AOP 中 join point 指代的是所有方法的执行点, 而 point cut 是一个描述信息, 它修饰的是 join point, 通过 point cut, 我们就可以确定哪些 join point 可以被织入 Advice. 对应到我们在上面举的例子, 我们可以做一个简单的类比, join point 就相当于 <strong>爪哇的小县城里的百姓</strong>, point cut 就相当于 <strong>老王所做的指控, 即凶手是个男性, 身高约七尺五寸</strong>, 而 advice 则是施加在符合老王所描述的嫌疑人的动作: <strong>抓过来审问</strong>. 为什么可以这样类比呢?</p><ul><li>join point --&gt; 爪哇的小县城里的百姓: 因为根据定义, join point 是所有可能被织入 advice 的候选的点, 在 Spring AOP 中, 则可以认为所有方法执行点都是 join point. 而在我们上面的例子中, 命案发生在小县城中, 按理说在此县城中的所有人都有可能是嫌疑人.</li><li>point cut --&gt; 男性, 身高约七尺五寸: 我们知道, 所有的方法(joint point) 都可以织入 advice, 但是我们并不希望在所有方法上都织入 advice, 而 pointcut 的作用就是提供一组规则来匹配 joinpoint, 给满足规则的 joinpoint 添加 advice. 同理, 对于县令来说, 他再昏庸, 也知道不能把县城中的所有百姓都抓起来审问, 而是根据<code>凶手是个男性, 身高约七尺五寸</code>, 把符合条件的人抓起来. 在这里<code>凶手是个男性, 身高约七尺五寸</code> 就是一个修饰谓语, 它限定了凶手的范围, 满足此修饰规则的百姓都是嫌疑人, 都需要抓起来审问.</li><li>advice --&gt; 抓过来审问, advice 是一个动作, 即一段 Java 代码, 这段 Java 代码是作用于 point cut 所限定的那些 join point 上的. 同理, 对比到我们的例子中, <code>抓过来审问</code> 这个动作就是对作用于那些满足 <code>男性, 身高约七尺五寸</code> 的<code>爪哇的小县城里的百姓</code>.</li><li>aspect: aspect 是 point cut 与 advice 的组合, 因此在这里我们就可以类比: <strong>“根据老王的线索, 凡是发现有身高七尺五寸的男性, 都要抓过来审问”</strong> 这一整个动作可以被认为是一个 aspect.</li></ul><p>或则我们也可以从语法的角度来简单类比一下. 我们在学英语时, 经常会接触什么 <code>定语</code>, <code>被动句</code> 之类的概念, 那么可以做一个不严谨的类比, 即 <code>joinpoint</code> 可以认为是一个 <code>宾语</code>, 而 <code>pointcut</code> 则可以类比为修饰 <code>joinpoint</code> 的定语, 那么整个 <code>aspect</code> 就可以描述为: <code>满足 pointcut 规则的 joinpoint 会被添加相应的 advice 操作.</code></p><hr /><h2 id="aspectj-支持"><a class="markdownIt-Anchor" href="#aspectj-支持"></a> @AspectJ 支持</h2><p><strong><code>@AspectJ</code></strong> 是一种使用 Java 注解来实现 AOP 的编码风格。</p><p>@AspectJ 风格的 AOP 是 AspectJ Project 在 AspectJ 5 中引入的, 并且 Spring 也支持 @AspectJ 的 AOP 风格.</p><h3 id="使能-aspectj-支持"><a class="markdownIt-Anchor" href="#使能-aspectj-支持"></a> 使能 @AspectJ 支持</h3><p>@AspectJ 可以以 XML 的方式或以注解的方式来使能, 并且不论以哪种方式使能@ASpectJ, 我们都必须保证 aspectjweaver.jar 在 classpath 中.</p><h4 id="使用-java-configuration-方式使能aspectj"><a class="markdownIt-Anchor" href="#使用-java-configuration-方式使能aspectj"></a> 使用 Java Configuration 方式使能@AspectJ</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableAspectJAutoProxy</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AppConfig</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="使用-xml-方式使能aspectj"><a class="markdownIt-Anchor" href="#使用-xml-方式使能aspectj"></a> 使用 XML 方式使能@AspectJ</h4><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;aop:aspectj-autoproxy/&gt;</span><br></pre></td></tr></table></figure><h3 id="定义-aspect切面"><a class="markdownIt-Anchor" href="#定义-aspect切面"></a> 定义 aspect(切面)</h3><p>当使用注解 <strong>@Aspect</strong> 标注一个 Bean 后, 那么 Spring 框架会自动收集这些 Bean, 并添加到 Spring AOP 中, 例如:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyTest</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line">注意, 仅仅使用<span class="meta">@Aspect</span> 注解, 并不能将一个 Java 对象转换为 Bean, 因此我们还需要使用类似 <span class="meta">@Component</span> 之类的注解.` `注意, 如果一个 类被<span class="meta">@Aspect</span> 标注, 则这个类就不能是其他 aspect 的 **advised object** 了, 因为使用 <span class="meta">@Aspect</span> 后, 这个类就会被排除在 auto-proxying 机制之外.</span><br></pre></td></tr></table></figure><h3 id="声明-pointcut"><a class="markdownIt-Anchor" href="#声明-pointcut"></a> 声明 pointcut</h3><p>一个 pointcut 的声明由两部分组成:</p><ul><li>一个方法签名, 包括方法名和相关参数</li><li>一个 pointcut 表达式, 用来指定哪些方法执行是我们感兴趣的(即因此可以织入 advice).</li></ul><p>在@AspectJ 风格的 AOP 中, 我们使用一个方法来描述 pointcut, 即:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Pointcut(&quot;execution(* com.xys.service.UserService.*(..))&quot;)</span> <span class="comment">// 切点表达式</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">dataAccessOperation</span><span class="params">()</span> &#123;&#125; <span class="comment">// 切点前面</span></span><br></pre></td></tr></table></figure><p><code>这个方法必须无返回值.</code> <code>这个方法本身就是 pointcut signature, pointcut 表达式使用@Pointcut 注解指定.</code> 上面我们简单地定义了一个 pointcut, 这个 pointcut 所描述的是: 匹配所有在包 <strong>com.xys.service.UserService</strong> 下的所有方法的执行.</p><h4 id="切点标志符designator"><a class="markdownIt-Anchor" href="#切点标志符designator"></a> 切点标志符(designator)</h4><p>AspectJ5 的切点表达式由标志符(designator)和操作参数组成. 如 “execution(* greetTo(…))” 的切点表达式, <strong>execution</strong> 就是 标志符, 而圆括号里的 *****greetTo(…) 就是操作参数</p><h5 id="execution"><a class="markdownIt-Anchor" href="#execution"></a> execution</h5><p>匹配 join point 的执行, 例如 “execution(* hello(…))” 表示匹配所有目标类中的 hello() 方法. 这个是最基本的 pointcut 标志符.</p><h5 id="within"><a class="markdownIt-Anchor" href="#within"></a> within</h5><p>匹配特定包下的所有 join point, 例如 <code>within(com.xys.*)</code> 表示 com.xys 包中的所有连接点, 即包中的所有类的所有方法. 而<code>within(com.xys.service.*Service)</code> 表示在 com.xys.service 包中所有以 Service 结尾的类的所有的连接点.</p><h5 id="this-与-target"><a class="markdownIt-Anchor" href="#this-与-target"></a> this 与 target</h5><p>this 的作用是匹配一个 bean, 这个 bean(Spring AOP proxy) 是一个给定类型的实例(instance of). 而 target 匹配的是一个目标对象(target object, 即需要织入 advice 的原始的类), 此对象是一个给定类型的实例(instance of).</p><h5 id="bean"><a class="markdownIt-Anchor" href="#bean"></a> bean</h5><p>匹配 bean 名字为指定值的 bean 下的所有方法, 例如:</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">bean(*Service) // 匹配名字后缀为 Service 的 bean 下的所有方法</span><br><span class="line">bean(myService) // 匹配名字为 myService 的 bean 下的所有方法</span><br></pre></td></tr></table></figure><h5 id="args"><a class="markdownIt-Anchor" href="#args"></a> args</h5><p>匹配参数满足要求的的方法. 例如:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Pointcut(&quot;within(com.xys.demo2.*)&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">pointcut2</span><span class="params">()</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Before(value = &quot;pointcut2()  &amp;&amp;  args(name)&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doSomething</span><span class="params">(String name)</span> &#123;</span><br><span class="line">    logger.info(<span class="string">&quot;---page: &#123;&#125;---&quot;</span>, name);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">NormalService</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">Logger</span> <span class="variable">logger</span> <span class="operator">=</span> LoggerFactory.getLogger(getClass());</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">someMethod</span><span class="params">()</span> &#123;</span><br><span class="line">        logger.info(<span class="string">&quot;---NormalService: someMethod invoked---&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">test</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        logger.info(<span class="string">&quot;---NormalService: test invoked---&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;服务一切正常&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>当 NormalService.test 执行时, 则 advice <code>doSomething</code> 就会执行, test 方法的参数 name 就会传递到 <code>doSomething</code> 中.</p><p>常用例子:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 匹配只有一个参数 name 的方法</span></span><br><span class="line"><span class="meta">@Before(value = &quot;aspectMethod()  &amp;&amp;  args(name)&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doSomething</span><span class="params">(String name)</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 匹配第一个参数为 name 的方法</span></span><br><span class="line"><span class="meta">@Before(value = &quot;aspectMethod()  &amp;&amp;  args(name, ..)&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doSomething</span><span class="params">(String name)</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 匹配第二个参数为 name 的方法</span></span><br><span class="line">Before(value = <span class="string">&quot;aspectMethod()  &amp;&amp;  args(*, name, ..)&quot;</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doSomething</span><span class="params">(String name)</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="annotation"><a class="markdownIt-Anchor" href="#annotation"></a> @annotation</h5><p>匹配由指定注解所标注的方法, 例如:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Pointcut(&quot;@annotation(com.xys.demo1.AuthChecker)&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">pointcut</span><span class="params">()</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>则匹配由注解 <code>AuthChecker</code> 所标注的方法.</p><h4 id="常见的切点表达式"><a class="markdownIt-Anchor" href="#常见的切点表达式"></a> 常见的切点表达式</h4><h5 id="匹配方法签名"><a class="markdownIt-Anchor" href="#匹配方法签名"></a> 匹配方法签名</h5><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">// 匹配指定包中的所有的方法</span><br><span class="line">execution(* com.xys.service.*(..))</span><br><span class="line"></span><br><span class="line">// 匹配当前包中的指定类的所有方法</span><br><span class="line">execution(* UserService.*(..))</span><br><span class="line"></span><br><span class="line">// 匹配指定包中的所有 public 方法</span><br><span class="line">execution(public * com.xys.service.*(..))</span><br><span class="line"></span><br><span class="line">// 匹配指定包中的所有 public 方法, 并且返回值是 int 类型的方法</span><br><span class="line">execution(public int com.xys.service.*(..))</span><br><span class="line"></span><br><span class="line">// 匹配指定包中的所有 public 方法, 并且第一个参数是 String, 返回值是 int 类型的方法</span><br><span class="line">execution(public int com.xys.service.*(String name, ..))</span><br></pre></td></tr></table></figure><h5 id="匹配类型签名"><a class="markdownIt-Anchor" href="#匹配类型签名"></a> 匹配类型签名</h5><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">// 匹配指定包中的所有的方法, 但不包括子包</span><br><span class="line">within(com.xys.service.*)</span><br><span class="line"></span><br><span class="line">// 匹配指定包中的所有的方法, 包括子包</span><br><span class="line">within(com.xys.service..*)</span><br><span class="line"></span><br><span class="line">// 匹配当前包中的指定类中的方法</span><br><span class="line">within(UserService)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// 匹配一个接口的所有实现类中的实现的方法</span><br><span class="line">within(UserDao+)</span><br></pre></td></tr></table></figure><h5 id="匹配-bean-名字"><a class="markdownIt-Anchor" href="#匹配-bean-名字"></a> 匹配 Bean 名字</h5><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 匹配以指定名字结尾的 Bean 中的所有方法</span><br><span class="line">bean(*Service)</span><br></pre></td></tr></table></figure><h5 id="切点表达式组合"><a class="markdownIt-Anchor" href="#切点表达式组合"></a> 切点表达式组合</h5><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// 匹配以 Service 或 ServiceImpl 结尾的 bean</span><br><span class="line">bean(*Service || *ServiceImpl)</span><br><span class="line"></span><br><span class="line">// 匹配名字以 Service 结尾, 并且在包 com.xys.service 中的 bean</span><br><span class="line">bean(*Service) &amp;&amp; within(com.xys.service.*)</span><br></pre></td></tr></table></figure><h3 id="声明-advice"><a class="markdownIt-Anchor" href="#声明-advice"></a> 声明 advice</h3><p>advice 是和一个 pointcut 表达式关联在一起的, 并且会在匹配的 join point 的方法执行的前/后/周围 运行. <code>pointcut 表达式可以是简单的一个 pointcut 名字的引用, 或者是完整的 pointcut 表达式</code>. 下面我们以几个简单的 advice 为例子, 来看一下一个 advice 是如何声明的.</p><h4 id="before-advice"><a class="markdownIt-Anchor" href="#before-advice"></a> Before advice</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> xiongyongshun</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@created</span> 16/9/9 13:13</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BeforeAspectTest</span> &#123;</span><br><span class="line">    <span class="comment">// 定义一个 Pointcut, 使用 切点表达式函数 来描述对哪些 Join point 使用 advise.</span></span><br><span class="line">    <span class="meta">@Pointcut(&quot;execution(* com.xys.service.UserService.*(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">dataAccessOperation</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AdviseDefine</span> &#123;</span><br><span class="line">    <span class="comment">// 定义 advise</span></span><br><span class="line">    <span class="meta">@Before(&quot;com.xys.aspect.PointcutDefine.dataAccessOperation()&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doBeforeAccessCheck</span><span class="params">(JoinPoint joinPoint)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;*****Before advise, method: &quot;</span> + joinPoint.getSignature().toShortString() + <span class="string">&quot; *****&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这里, <strong>@Before</strong> 引用了一个 pointcut, 即 “com.xys.aspect.PointcutDefine.dataAccessOperation()” 是一个 pointcut 的名字. 如果我们在 advice 在内置 pointcut, 则可以:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AdviseDefine</span> &#123;</span><br><span class="line">    <span class="comment">// 将 pointcut 和 advice 同时定义</span></span><br><span class="line">    <span class="meta">@Before(&quot;within(com.xys.service..*)&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doAccessCheck</span><span class="params">(JoinPoint joinPoint)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;*****doAccessCheck, Before advise, method: &quot;</span> + joinPoint.getSignature().toShortString() + <span class="string">&quot; *****&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="around-advice"><a class="markdownIt-Anchor" href="#around-advice"></a> around advice</h4><p>around advice 比较特别, 它可以在一个方法的之前之前和之后添加不同的操作, 并且甚至可以决定何时, 如何, 是否调用匹配到的方法.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AdviseDefine</span> &#123;</span><br><span class="line">    <span class="comment">// 定义 advise</span></span><br><span class="line">    <span class="meta">@Around(&quot;com.xys.aspect.PointcutDefine.dataAccessOperation()&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">doAroundAccessCheck</span><span class="params">(ProceedingJoinPoint pjp)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">        <span class="type">StopWatch</span> <span class="variable">stopWatch</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StopWatch</span>();</span><br><span class="line">        stopWatch.start();</span><br><span class="line">        <span class="comment">// 开始</span></span><br><span class="line">        <span class="type">Object</span> <span class="variable">retVal</span> <span class="operator">=</span> pjp.proceed();</span><br><span class="line">        stopWatch.stop();</span><br><span class="line">        <span class="comment">// 结束</span></span><br><span class="line">        System.out.println(<span class="string">&quot;invoke method: &quot;</span> + pjp.getSignature().getName() + <span class="string">&quot;, elapsed time: &quot;</span> + stopWatch.getTotalTimeMillis());</span><br><span class="line">        <span class="keyword">return</span> retVal;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>around advice 和前面的 before advice 差不多, 只是我们把注解 <strong>@Before</strong> 改为了 <strong>@Around</strong> 了.</p><hr /><h2 id="基于注解的-aop-配置方式"><a class="markdownIt-Anchor" href="#基于注解的-aop-配置方式"></a> 基于注解的 AOP 配置方式</h2><p><strong>切面类：</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.enjoy.cap10.aop;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.ProceedingJoinPoint;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.After;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.AfterReturning;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.AfterThrowing;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Before;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Pointcut;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Around;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Aspect;</span><br><span class="line"></span><br><span class="line"><span class="comment">//日志切面类</span></span><br><span class="line"><span class="meta">@Aspect</span><span class="comment">//什么这个类是一个切面类</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LogAspects</span> &#123;</span><br><span class="line">    <span class="comment">//@Pointcut声明切入点</span></span><br><span class="line"><span class="meta">@Pointcut(&quot;execution(public int com.enjoy.cap10.aop.Calculator.*(..))&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">pointCut</span><span class="params">()</span>&#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//@before代表在目标方法执行前切入, 并指定在哪个方法前切入</span></span><br><span class="line"><span class="meta">@Before(&quot;pointCut()&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">logStart</span><span class="params">()</span>&#123;</span><br><span class="line">System.out.println(<span class="string">&quot;除法运行....参数列表是:&#123;&#125;&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@After(&quot;pointCut()&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">logEnd</span><span class="params">()</span>&#123;</span><br><span class="line">System.out.println(<span class="string">&quot;除法结束......&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@AfterReturning(&quot;pointCut()&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">logReturn</span><span class="params">()</span>&#123;</span><br><span class="line">System.out.println(<span class="string">&quot;除法正常返回......运行结果是:&#123;&#125;&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@AfterThrowing(&quot;pointCut()&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">logException</span><span class="params">()</span>&#123;</span><br><span class="line">System.out.println(<span class="string">&quot;运行异常......异常信息是:&#123;&#125;&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Around(&quot;pointCut()&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Object <span class="title function_">Around</span><span class="params">(ProceedingJoinPoint proceedingJoinPoint)</span> <span class="keyword">throws</span> Throwable&#123;</span><br><span class="line">System.out.println(<span class="string">&quot;@Arount:执行目标方法之前...&quot;</span>);</span><br><span class="line"><span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> proceedingJoinPoint.proceed();<span class="comment">//相当于开始调div地</span></span><br><span class="line">System.out.println(<span class="string">&quot;@Arount:执行目标方法之后...&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> obj;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>目标方法：</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.enjoy.cap10.aop;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Calculator</span> &#123;</span><br><span class="line"><span class="comment">//业务逻辑方法</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">div</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> j)</span>&#123;</span><br><span class="line">System.out.println(<span class="string">&quot;--------&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> i/j;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>配置类：</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.enjoy.cap10.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.EnableAspectJAutoProxy;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.enjoy.cap10.aop.Calculator;</span><br><span class="line"><span class="keyword">import</span> com.enjoy.cap10.aop.LogAspects;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableAspectJAutoProxy</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Cap10MainConfig</span> &#123;</span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> Calculator <span class="title function_">calculator</span><span class="params">()</span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Calculator</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> LogAspects <span class="title function_">logAspects</span><span class="params">()</span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">LogAspects</span>();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>测试类：</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Cap10Test</span> &#123;</span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test01</span><span class="params">()</span>&#123;</span><br><span class="line"><span class="type">AnnotationConfigApplicationContext</span> <span class="variable">app</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AnnotationConfigApplicationContext</span>(Cap10MainConfig.class);</span><br><span class="line"><span class="type">Calculator</span> <span class="variable">c</span> <span class="operator">=</span> app.getBean(Calculator.class);</span><br><span class="line"><span class="type">int</span> <span class="variable">result</span> <span class="operator">=</span> c.div(<span class="number">4</span>, <span class="number">3</span>);</span><br><span class="line">System.out.println(result);</span><br><span class="line">app.close();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>结果：</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">@Arount:执行目标方法之前...</span><br><span class="line">除法运行....参数列表是:&#123;&#125;</span><br><span class="line">--------</span><br><span class="line">@Arount:执行目标方法之后...</span><br><span class="line">除法结束......</span><br><span class="line">除法正常返回......运行结果是:&#123;&#125;</span><br><span class="line">1</span><br></pre></td></tr></table></figure><hr /><h2 id="aop-源码赏析"><a class="markdownIt-Anchor" href="#aop-源码赏析"></a> AOP 源码赏析</h2><blockquote><p>在这个注解比较流行的年代里,当我们想要使用 spring 的某些功能时只需要加上一行代码就可以了,比如:</p><ul><li>@EnableAspectJAutoProxy 开启 AOP</li><li>@EnableTransactionManagement 开启 spring 事务管理,</li><li>@EnableCaching 开启 spring 缓存</li><li>@EnableWebMvc 开启 webMvc</li></ul><p>对于我们使用者而言十分简单便利,然而,其背后所做的事,却远远比一个注解复杂的多了,本篇只是简略的介绍一下@EnableAspectJAutoProxy 背后所发生的那些事,了解其工作原理,才能更好的运用,并从中领略大师的智慧.</p></blockquote><p>废话不多说,先来看一下源码:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target(ElementType.TYPE)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Import(AspectJAutoProxyRegistrar.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> EnableAspectJAutoProxy &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Indicate whether subclass-based (CGLIB) proxies are to be created as opposed</span></span><br><span class="line"><span class="comment">     * to standard Java interface-based proxies. The default is &#123;<span class="doctag">@code</span> false&#125;.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">proxyTargetClass</span><span class="params">()</span> <span class="keyword">default</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Indicate that the proxy should be exposed by the AOP framework as a &#123;<span class="doctag">@code</span> ThreadLocal&#125;</span></span><br><span class="line"><span class="comment">     * for retrieval via the &#123;<span class="doctag">@link</span> org.springframework.aop.framework.AopContext&#125; class.</span></span><br><span class="line"><span class="comment">     * Off by default, i.e. no guarantees that &#123;<span class="doctag">@code</span> AopContext&#125; access will work.</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@since</span> 4.3.1</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">exposeProxy</span><span class="params">()</span> <span class="keyword">default</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>英文注解已经很详细了,这里简单介绍一下两个参数,一个是控制 aop 的具体实现方式,为 true 的话使用 cglib,为 false 的话使用 java 的 Proxy,默认为 false,第二个参数控制代理的暴露方式,解决内部调用不能使用代理的场景，默认为 false.</p><p>这里核心是@Import(AspectJAutoProxyRegistrar.class);在 AspectJAutoProxyRegistrar 里,核心的地方是</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AopConfigUtils.registerAspectJAnnotationAutoProxyCreatorIfNecessary(registry);</span><br></pre></td></tr></table></figure><blockquote><p>一个 AOP 的工具类,这个工具类的主要作用是把 AnnotationAwareAspectJAutoProxyCreator 这个类定义为 BeanDefinition 放到 spring 容器中,这是通过实现 ImportBeanDefinitionRegistrar 接口来装载的,具体装载过程不是本篇的重点,这里就不赘述,我们重点看 AnnotationAwareAspectJAutoProxyCreator 这个类.</p><p>首先看看这个类图:</p><p><img src="https://unpkg.com/serms-assets@1.0.6/Spring/20190415091218213.png" alt="" /></p><p><strong>从类图是可以大致了解 AnnotationAwareAspectJAutoProxyCreator 这个类的功能.它实现了一系列 Aware 的接口,在 Bean 装载的时候获取 BeanFactory(Bean 容器),Bean 的 ClassLoader,还实现了 order 接口,继承了 PorxyConfig,ProxyConfig 中主要封装了代理的通用处理逻辑,比如设置目标类,设置使用 cglib 还是 java proxy 等一些基础配置.</strong></p><p>而能够让这个类参与到 bean 初始化功能,并为 bean 添加代理功能的还是因为它实现了 BeanPostProcessor 这个接口.这个接口的 postProcessAfterInitialization 方法会在 bean 初始化结束后(赋值完成)被调用*。*</p><p>这里先看一下最顶部的抽象类:AbstractAutoProxyCreator,这个抽象类主要抽象了实现代理的逻辑:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> Object <span class="title function_">postProcessBeforeInitialization</span><span class="params">(Object bean, String beanName)</span> &#123;</span><br><span class="line"><span class="keyword">return</span> bean;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 主要看这个方法，在bean初始化之后对生产出的bean进行包装</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> Object <span class="title function_">postProcessAfterInitialization</span><span class="params">(Object bean, String beanName)</span> <span class="keyword">throws</span> BeansException &#123;</span><br><span class="line"><span class="keyword">if</span> (bean != <span class="literal">null</span>) &#123;</span><br><span class="line"><span class="type">Object</span> <span class="variable">cacheKey</span> <span class="operator">=</span> getCacheKey(bean.getClass(), beanName);</span><br><span class="line"><span class="keyword">if</span> (!<span class="built_in">this</span>.earlyProxyReferences.contains(cacheKey)) &#123;</span><br><span class="line"><span class="keyword">return</span> wrapIfNecessary(bean, beanName, cacheKey);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> bean;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// wrapIfNecessary</span></span><br><span class="line"><span class="keyword">protected</span> Object <span class="title function_">wrapIfNecessary</span><span class="params">(Object bean, String beanName, Object cacheKey)</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (beanName != <span class="literal">null</span> &amp;&amp; <span class="built_in">this</span>.targetSourcedBeans.contains(beanName)) &#123;</span><br><span class="line"><span class="keyword">return</span> bean;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (Boolean.FALSE.equals(<span class="built_in">this</span>.advisedBeans.get(cacheKey))) &#123;</span><br><span class="line"><span class="keyword">return</span> bean;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (isInfrastructureClass(bean.getClass()) || shouldSkip(bean.getClass(), beanName)) &#123;</span><br><span class="line"><span class="built_in">this</span>.advisedBeans.put(cacheKey, Boolean.FALSE);</span><br><span class="line"><span class="keyword">return</span> bean;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Create proxy if we have advice.</span></span><br><span class="line">        <span class="comment">// 意思就是如果该类有advice则创建proxy，</span></span><br><span class="line">Object[] specificInterceptors = getAdvicesAndAdvisorsForBean(bean.getClass(), beanName, <span class="literal">null</span>);</span><br><span class="line"><span class="keyword">if</span> (specificInterceptors != DO_NOT_PROXY) &#123;</span><br><span class="line"><span class="built_in">this</span>.advisedBeans.put(cacheKey, Boolean.TRUE);</span><br><span class="line">            <span class="comment">// 1.通过方法名也能简单猜测到，这个方法就是把bean包装为proxy的主要方法，</span></span><br><span class="line"><span class="type">Object</span> <span class="variable">proxy</span> <span class="operator">=</span> createProxy(</span><br><span class="line">bean.getClass(), beanName, specificInterceptors, <span class="keyword">new</span> <span class="title class_">SingletonTargetSource</span>(bean));</span><br><span class="line"><span class="built_in">this</span>.proxyTypes.put(cacheKey, proxy.getClass());</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 2.返回该proxy代替原来的bean</span></span><br><span class="line"><span class="keyword">return</span> proxy;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">this</span>.advisedBeans.put(cacheKey, Boolean.FALSE);</span><br><span class="line"><span class="keyword">return</span> bean;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></blockquote><h3 id="总结"><a class="markdownIt-Anchor" href="#总结"></a> 总结：</h3><ul><li><strong>1）将 AnnotationAwareAspectJAutoProxyCreator 注册到 Spring 容器中</strong></li><li><strong>2）AnnotationAwareAspectJAutoProxyCreator 类的 postProcessAfterInitialization()方法将所有有 advice 的 bean 重新包装成 proxy</strong></li></ul><hr /><h2 id="创建-proxy-过程分析"><a class="markdownIt-Anchor" href="#创建-proxy-过程分析"></a> 创建 proxy 过程分析</h2><p>​ 通过之前的代码结构分析，我们知道，所有的 bean 在返回给用户使用之前都需要经过 AnnotationAwareAspectJAutoProxyCreator 类的 postProcessAfterInitialization()方法，而该方法的主要作用也就是将所有拥有 advice 的 bean 重新包装为 proxy，那么我们接下来直接分析这个包装为 proxy 的方法即可，看一下 bean 如何被包装为 proxy，proxy 在被调用方法时，是具体如何执行的</p><p><strong>以下是 AbstractAutoProxyCreator.wrapIfNecessary(Object bean, String beanName, Object cacheKey)中的 createProxy()代码片段分析</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> Object <span class="title function_">createProxy</span><span class="params">(</span></span><br><span class="line"><span class="params">Class&lt;?&gt; beanClass, String beanName, Object[] specificInterceptors, TargetSource targetSource)</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">this</span>.beanFactory <span class="keyword">instanceof</span> ConfigurableListableBeanFactory) &#123;</span><br><span class="line">AutoProxyUtils.exposeTargetClass((ConfigurableListableBeanFactory) <span class="built_in">this</span>.beanFactory, beanName, beanClass);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 1.创建proxyFactory，proxy的生产主要就是在proxyFactory做的</span></span><br><span class="line"><span class="type">ProxyFactory</span> <span class="variable">proxyFactory</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ProxyFactory</span>();</span><br><span class="line">proxyFactory.copyFrom(<span class="built_in">this</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!proxyFactory.isProxyTargetClass()) &#123;</span><br><span class="line"><span class="keyword">if</span> (shouldProxyTargetClass(beanClass, beanName)) &#123;</span><br><span class="line">proxyFactory.setProxyTargetClass(<span class="literal">true</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">evaluateProxyInterfaces(beanClass, proxyFactory);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2.将当前bean适合的advice，重新封装下，封装为Advisor类，然后添加到ProxyFactory中</span></span><br><span class="line">Advisor[] advisors = buildAdvisors(beanName, specificInterceptors);</span><br><span class="line"><span class="keyword">for</span> (Advisor advisor : advisors) &#123;</span><br><span class="line">proxyFactory.addAdvisor(advisor);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">proxyFactory.setTargetSource(targetSource);</span><br><span class="line">customizeProxyFactory(proxyFactory);</span><br><span class="line"></span><br><span class="line">proxyFactory.setFrozen(<span class="built_in">this</span>.freezeProxy);</span><br><span class="line"><span class="keyword">if</span> (advisorsPreFiltered()) &#123;</span><br><span class="line">proxyFactory.setPreFiltered(<span class="literal">true</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 3.调用getProxy获取bean对应的proxy</span></span><br><span class="line"><span class="keyword">return</span> proxyFactory.getProxy(getProxyClassLoader());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>TargetSource 中存放被代理的对象,这段代码主要是为了构建 ProxyFactory,将配置信息(是否使用 java proxy,是否 threadlocal 等),目标类,切面,传入 ProxyFactory 中</p></blockquote><h3 id="创建何种类型的-proxyjdkproxy-还是-cglibproxy"><a class="markdownIt-Anchor" href="#创建何种类型的-proxyjdkproxy-还是-cglibproxy"></a> <strong>创建何种类型的 Proxy？JDKProxy 还是 CGLIBProxy？</strong></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// getProxy()方法</span></span><br><span class="line"><span class="keyword">public</span> Object <span class="title function_">getProxy</span><span class="params">(ClassLoader classLoader)</span> &#123;</span><br><span class="line"><span class="keyword">return</span> createAopProxy().getProxy(classLoader);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// createAopProxy()方法就是决定究竟创建何种类型的proxy</span></span><br><span class="line"><span class="keyword">protected</span> <span class="keyword">final</span> <span class="keyword">synchronized</span> AopProxy <span class="title function_">createAopProxy</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (!<span class="built_in">this</span>.active) &#123;</span><br><span class="line">activate();</span><br><span class="line">&#125;</span><br><span class="line">        <span class="comment">// 关键方法createAopProxy()</span></span><br><span class="line"><span class="keyword">return</span> getAopProxyFactory().createAopProxy(<span class="built_in">this</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// createAopProxy()</span></span><br><span class="line"><span class="keyword">public</span> AopProxy <span class="title function_">createAopProxy</span><span class="params">(AdvisedSupport config)</span> <span class="keyword">throws</span> AopConfigException &#123;</span><br><span class="line">        <span class="comment">// 1.config.isOptimize()是否使用优化的代理策略，目前使用与CGLIB</span></span><br><span class="line">        <span class="comment">// config.isProxyTargetClass() 是否目标类本身被代理而不是目标类的接口</span></span><br><span class="line">        <span class="comment">// hasNoUserSuppliedProxyInterfaces()是否存在代理接口</span></span><br><span class="line"><span class="keyword">if</span> (config.isOptimize() || config.isProxyTargetClass() || hasNoUserSuppliedProxyInterfaces(config)) &#123;</span><br><span class="line">Class&lt;?&gt; targetClass = config.getTargetClass();</span><br><span class="line"><span class="keyword">if</span> (targetClass == <span class="literal">null</span>) &#123;</span><br><span class="line"><span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">AopConfigException</span>(<span class="string">&quot;TargetSource cannot determine target class: &quot;</span> +</span><br><span class="line"><span class="string">&quot;Either an interface or a target is required for proxy creation.&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 2.如果目标类是接口或者是代理类，则直接使用JDKproxy</span></span><br><span class="line"><span class="keyword">if</span> (targetClass.isInterface() || Proxy.isProxyClass(targetClass)) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">JdkDynamicAopProxy</span>(config);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 3.其他情况则使用CGLIBproxy</span></span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ObjenesisCglibAopProxy</span>(config);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">JdkDynamicAopProxy</span>(config);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="getproxy方法"><a class="markdownIt-Anchor" href="#getproxy方法"></a> <strong>getProxy()方法</strong></h3><blockquote><p>由上面可知，通过 createAopProxy()方法来确定具体使用何种类型的 Proxy，针对于该示例，我们具体使用的为 JdkDynamicAopProxy，下面来看下 JdkDynamicAopProxy.getProxy()方法</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">JdkDynamicAopProxy</span> <span class="keyword">implements</span> <span class="title class_">AopProxy</span>, InvocationHandler, Serializable<span class="comment">// JdkDynamicAopProxy类结构，由此可知，其实现了InvocationHandler，则必定有invoke方法，来被调用，也就是用户调用bean相关方法时，此invoke()被真正调用</span></span><br><span class="line">    <span class="comment">// getProxy()</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">getProxy</span><span class="params">(ClassLoader classLoader)</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (logger.isDebugEnabled()) &#123;</span><br><span class="line">logger.debug(<span class="string">&quot;Creating JDK dynamic proxy: target source is &quot;</span> + <span class="built_in">this</span>.advised.getTargetSource());</span><br><span class="line">&#125;</span><br><span class="line">Class&lt;?&gt;[] proxiedInterfaces = AopProxyUtils.completeProxiedInterfaces(<span class="built_in">this</span>.advised, <span class="literal">true</span>);</span><br><span class="line">findDefinedEqualsAndHashCodeMethods(proxiedInterfaces);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// JDK proxy 动态代理的标准用法</span></span><br><span class="line"><span class="keyword">return</span> Proxy.newProxyInstance(classLoader, proxiedInterfaces, <span class="built_in">this</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="invoke方法"><a class="markdownIt-Anchor" href="#invoke方法"></a> <strong>invoke()方法</strong></h3><blockquote><p>以上的代码模式可以很明确的看出来，使用了 JDK 动态代理模式，真正的方法执行在 invoke()方法里，下面我们来看下该方法，来看下 bean 方法如何被代理执行的</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Object <span class="title function_">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">MethodInvocation invocation;</span><br><span class="line"><span class="type">Object</span> <span class="variable">oldProxy</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"><span class="type">boolean</span> <span class="variable">setProxyContext</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">TargetSource</span> <span class="variable">targetSource</span> <span class="operator">=</span> <span class="built_in">this</span>.advised.targetSource;</span><br><span class="line">Class&lt;?&gt; targetClass = <span class="literal">null</span>;</span><br><span class="line"><span class="type">Object</span> <span class="variable">target</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">           <span class="comment">// 1.以下的几个判断，主要是为了判断method是否为equals、hashCode等Object的方法</span></span><br><span class="line"><span class="keyword">if</span> (!<span class="built_in">this</span>.equalsDefined &amp;&amp; AopUtils.isEqualsMethod(method)) &#123;</span><br><span class="line"><span class="comment">// The target does not implement the equals(Object) method itself.</span></span><br><span class="line"><span class="keyword">return</span> equals(args[<span class="number">0</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (!<span class="built_in">this</span>.hashCodeDefined &amp;&amp; AopUtils.isHashCodeMethod(method)) &#123;</span><br><span class="line"><span class="comment">// The target does not implement the hashCode() method itself.</span></span><br><span class="line"><span class="keyword">return</span> hashCode();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (method.getDeclaringClass() == DecoratingProxy.class) &#123;</span><br><span class="line"><span class="comment">// There is only getDecoratedClass() declared -&gt; dispatch to proxy config.</span></span><br><span class="line"><span class="keyword">return</span> AopProxyUtils.ultimateTargetClass(<span class="built_in">this</span>.advised);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (!<span class="built_in">this</span>.advised.opaque &amp;&amp; method.getDeclaringClass().isInterface() &amp;&amp;</span><br><span class="line">method.getDeclaringClass().isAssignableFrom(Advised.class)) &#123;</span><br><span class="line"><span class="comment">// Service invocations on ProxyConfig with the proxy config...</span></span><br><span class="line"><span class="keyword">return</span> AopUtils.invokeJoinpointUsingReflection(<span class="built_in">this</span>.advised, method, args);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Object retVal;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">this</span>.advised.exposeProxy) &#123;</span><br><span class="line"><span class="comment">// Make invocation available if necessary.</span></span><br><span class="line">oldProxy = AopContext.setCurrentProxy(proxy);</span><br><span class="line">setProxyContext = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// May be null. Get as late as possible to minimize the time we &quot;own&quot; the target,</span></span><br><span class="line"><span class="comment">// in case it comes from a pool.</span></span><br><span class="line">target = targetSource.getTarget();</span><br><span class="line"><span class="keyword">if</span> (target != <span class="literal">null</span>) &#123;</span><br><span class="line">targetClass = target.getClass();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.获取当前bean被拦截方法链表</span></span><br><span class="line">List&lt;Object&gt; chain = <span class="built_in">this</span>.advised.getInterceptorsAndDynamicInterceptionAdvice(method, targetClass);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3.如果为空，则直接调用target的method</span></span><br><span class="line"><span class="keyword">if</span> (chain.isEmpty()) &#123;</span><br><span class="line">Object[] argsToUse = AopProxyUtils.adaptArgumentsIfNecessary(method, args);</span><br><span class="line">retVal = AopUtils.invokeJoinpointUsingReflection(target, method, argsToUse);</span><br><span class="line">&#125;</span><br><span class="line">           <span class="comment">// 4.不为空，则逐一调用chain中的每一个拦截方法的proceed</span></span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line"><span class="comment">// We need to create a method invocation...</span></span><br><span class="line">invocation = <span class="keyword">new</span> <span class="title class_">ReflectiveMethodInvocation</span>(proxy, target, method, args, targetClass, chain);</span><br><span class="line"><span class="comment">// Proceed to the joinpoint through the interceptor chain.</span></span><br><span class="line">retVal = invocation.proceed();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"><span class="keyword">return</span> retVal;</span><br><span class="line">&#125;</span><br><span class="line">...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="拦截方法真正被执行调用-invocationproceed"><a class="markdownIt-Anchor" href="#拦截方法真正被执行调用-invocationproceed"></a> <strong>拦截方法真正被执行调用 invocation.proceed()</strong></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Object <span class="title function_">proceed</span><span class="params">()</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line"><span class="comment">//We start with an index of -1 and increment early.</span></span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">this</span>.currentInterceptorIndex == <span class="built_in">this</span>.interceptorsAndDynamicMethodMatchers.size() - <span class="number">1</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> invokeJoinpoint();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">Object</span> <span class="variable">interceptorOrInterceptionAdvice</span> <span class="operator">=</span></span><br><span class="line"><span class="built_in">this</span>.interceptorsAndDynamicMethodMatchers.get(++<span class="built_in">this</span>.currentInterceptorIndex);</span><br><span class="line"><span class="keyword">if</span> (interceptorOrInterceptionAdvice <span class="keyword">instanceof</span> InterceptorAndDynamicMethodMatcher) &#123;</span><br><span class="line"><span class="comment">// Evaluate dynamic method matcher here: static part will already have</span></span><br><span class="line"><span class="comment">// been evaluated and found to match.</span></span><br><span class="line"><span class="type">InterceptorAndDynamicMethodMatcher</span> <span class="variable">dm</span> <span class="operator">=</span></span><br><span class="line">(InterceptorAndDynamicMethodMatcher) interceptorOrInterceptionAdvice;</span><br><span class="line"><span class="keyword">if</span> (dm.methodMatcher.matches(<span class="built_in">this</span>.method, <span class="built_in">this</span>.targetClass, <span class="built_in">this</span>.arguments)) &#123;</span><br><span class="line"><span class="keyword">return</span> dm.interceptor.invoke(<span class="built_in">this</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line"><span class="comment">// Dynamic matching failed.</span></span><br><span class="line"><span class="comment">// Skip this interceptor and invoke the next in the chain.</span></span><br><span class="line"><span class="keyword">return</span> proceed();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line"><span class="comment">// It&#x27;s an interceptor, so we just invoke it: The pointcut will have</span></span><br><span class="line"><span class="comment">// been evaluated statically before this object was constructed.</span></span><br><span class="line"><span class="keyword">return</span> ((MethodInterceptor) interceptorOrInterceptionAdvice).invoke(<span class="built_in">this</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>总结 4：依次遍历拦截器链的每个元素，然后调用其实现，将真正调用工作委托给各个增强器</p></blockquote><h3 id="总结-2"><a class="markdownIt-Anchor" href="#总结-2"></a> <strong>总结：</strong></h3><p>纵观以上过程可知：实际就是为 bean 创建一个 proxy，JDKproxy 或者 CGLIBproxy，然后在调用 bean 的方法时，会通过 proxy 来调用 bean 方法</p><p>重点过程可分为：</p><p><strong>1）将 AnnotationAwareAspectJAutoProxyCreator 注册到 Spring 容器中</strong></p><p><strong>2）AnnotationAwareAspectJAutoProxyCreator 类的 postProcessAfterInitialization()方法将所有有 advice 的 bean 重新包装成 proxy</strong></p><p><strong>3）调用 bean 方法时通过 proxy 来调用，proxy 依次调用增强器的相关方法，来实现方法切入</strong></p><p><img src="https://unpkg.com/serms-assets@1.0.6/Spring/20190415112857658.png" alt="" /></p>]]></content>
      
      
      <categories>
          
          <category> Spring </category>
          
          <category> Java </category>
          
          <category> SpringAop介绍 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Spring </tag>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Spring5注解</title>
      <link href="/posts/b6dbc3f5/"/>
      <url>/posts/b6dbc3f5/</url>
      
        <content type="html"><![CDATA[<h2 id="前言"><a class="markdownIt-Anchor" href="#前言"></a> 前言</h2><blockquote><p>最近在看 B 站颜群老师的课程，Javaweb&gt;spring&gt;springMVC&gt;mybatis&gt;spring 高级，一路走来，跌跌撞撞，发现 spring 也不过尔尔，说白了，spring 就是想尽办法将 new 做的更简单，更完美，更可配置。</p><p>Spring 的一个核心功能是 IOC，就是将 Bean 初始化加载到容器中，Bean 是如何加载到容器的，可以使用 Spring 注解方式或者 Spring XML 配置方式。</p><p>Spring 注解方式减少了配置文件内容，更加便于管理，并且使用注解可以大大提高了开发效率！</p><p>注解本身是没有功能的，和 xml 一样，注解和 xml 都是一种元数据，元数据即解释数据的数据，也就是所谓的配置。</p></blockquote><h3 id="xml-和注解的最佳实践"><a class="markdownIt-Anchor" href="#xml-和注解的最佳实践"></a> xml 和注解的最佳实践：</h3><blockquote><ul><li>xml 用来管理 bean；</li><li>注解只负责完成属性的注入；</li></ul></blockquote><h3 id="使用注解唯一需要注意的就是必须开启注解的支持"><a class="markdownIt-Anchor" href="#使用注解唯一需要注意的就是必须开启注解的支持"></a> 使用注解唯一需要注意的就是，必须开启注解的支持：</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">//扫描指定包下的全部的标有@Component的类，并注册成bean.</span><br><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.guo&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:annotation-config</span>/&gt;</span></span><br></pre></td></tr></table></figure><hr /><h2 id="spring-的常用注解"><a class="markdownIt-Anchor" href="#spring-的常用注解"></a> Spring 的常用注解</h2><h3 id="给容器中注入组件"><a class="markdownIt-Anchor" href="#给容器中注入组件"></a> 给容器中注入组件</h3><blockquote><p>包扫描+组件标注注解</p><p>@<strong>Component</strong>：泛指各种组件</p><p>@<strong>Controller</strong>、@<strong>Service</strong>、@<strong>Repository</strong>都可以称为@<strong>Component</strong>。</p><p>@<strong>Controller</strong>：控制层</p><p>@<strong>Service</strong>：业务层</p><p>@<strong>Repository</strong>：数据访问层</p><p>@<strong>Bean</strong>: 导入第三方包里面的注解</p><p>@<strong>Import</strong>(要导入到容器中的组件)；</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Import(&#123;Color.class, MyImportSelector.class, MyImportBeanDefinitionRegistrar.class&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainConfig2</span> &#123;</span><br><span class="line"><span class="meta">@Scope(&quot;prototype&quot;)</span></span><br><span class="line"><span class="meta">@Bean(&quot;person&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Person <span class="title function_">person</span><span class="params">()</span> &#123;</span><br><span class="line">System.out.println(<span class="string">&quot;我是Person&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&quot;素小暖&quot;</span>,<span class="number">25</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>@<strong>ImportSelector</strong>：返回需要导入的组件的全类名数组；</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyImportBeanDefinitionRegistrar</span> <span class="keyword">implements</span> <span class="title class_">ImportBeanDefinitionRegistrar</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    * AnnotationMetadata：当前类的注解信息</span></span><br><span class="line"><span class="comment">    * BeanDefinitionRegistry：BeanDefinition注册类</span></span><br><span class="line"><span class="comment">    * 把所有需要添加到容器中的bean，调用BeanDefinitionRegistry.registerBeanDefinition手动注入</span></span><br><span class="line"><span class="comment">    *</span></span><br><span class="line"><span class="comment">    * */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">registerBeanDefinitions</span><span class="params">(AnnotationMetadata importingClassMetadata, BeanDefinitionRegistry registry)</span> &#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">definition</span> <span class="operator">=</span> registry.containsBeanDefinition(<span class="string">&quot;com.atguigu.bean.Red&quot;</span>);</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">definition2</span> <span class="operator">=</span> registry.containsBeanDefinition(<span class="string">&quot;com.atguigu.bean.Blue&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(definition &amp;&amp; definition2)&#123;</span><br><span class="line">            <span class="comment">//指定bean定义信息（bean的类型，bean的scope）</span></span><br><span class="line">            <span class="type">RootBeanDefinition</span> <span class="variable">rootBeanDefinition</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">RootBeanDefinition</span>(RainBow.class);</span><br><span class="line">            <span class="comment">//注册一个bean，指定bean名</span></span><br><span class="line">            registry.registerBeanDefinition(<span class="string">&quot;rainBow&quot;</span>,rootBeanDefinition);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>使用 spring 提供的<strong>FactoryBean</strong>（工厂 Bean）</p><ul><li>默认获取到的是工厂<strong>Bean</strong>调用<strong>getObject</strong>创建的对象</li><li>要获取工厂<strong>Bean</strong>本身，需要在 id 前面加一个&amp;</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> ColorFactoryBean <span class="title function_">colorFactoryBean</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ColorFactoryBean</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//创建一个spring定义的FactoryBean</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ColorFactoryBean</span> <span class="keyword">implements</span> <span class="title class_">FactoryBean</span>&lt;Color&gt; &#123;</span><br><span class="line">    <span class="comment">//返回一个Color对象，并将Color添加到容器中</span></span><br><span class="line">    <span class="keyword">public</span> Color <span class="title function_">getObject</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ColorFactoryBean,getObject()&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Color</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Class&lt;?&gt; getObjectType() &#123;</span><br><span class="line">        <span class="keyword">return</span> Color.class;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isSingleton</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></blockquote><h3 id="注入-bean-的注解"><a class="markdownIt-Anchor" href="#注入-bean-的注解"></a> 注入 bean 的注解</h3><blockquote><p>@<strong>Autowired</strong>：由 bean 提供</p><ul><li>@Autowired 可以作用在变量、setter 方法、构造函数上；</li><li>有个属性为 required，可以配置为 false；</li></ul><p>@<strong>Inject</strong>：由 JSR-330 提供</p><ul><li>@Inject 用法和@Autowired 一样。</li></ul><p>@<strong>Resource</strong>：由 JSR-250 提供</p><p>@<strong>Autowired</strong>、@<strong>Inject</strong>是默认按照类型匹配的，@<strong>Resource</strong>是按照名称匹配的，@<strong>Autowired</strong>如果需要按照名称匹配需要和@<strong>Qualifier</strong>一起使用，@Inject 和@Name 一起使用。</p><p>@<strong>Primary</strong></p><p>让<strong>spring</strong>进行自动装配的时候，默认使用首选的<strong>bean</strong>，和@<strong>Qualifier</strong>一个效果。</p></blockquote><h3 id="jsonignore"><a class="markdownIt-Anchor" href="#jsonignore"></a> @JsonIgnore</h3><blockquote><ol><li>作用: 在 json 序列化时将 java bean 中的一些属性忽略掉，序列化和反序列化都受影响。</li><li>使用方法: 一般标记在属性或者方法上，返回的 json 数据即不包含该属性。</li><li>注解失效:如果注解失效，可能是因为你使用的是 fastJson，尝试使用对应的注解来忽略字段，注解为：@JSONField(serialize = false)，使用方法一样。</li></ol></blockquote><h3 id="初始化和销毁方法"><a class="markdownIt-Anchor" href="#初始化和销毁方法"></a> 初始化和销毁方法</h3><blockquote><ol><li>通过@Bean(initMethod=“init”,destoryMethod=“destory”)方法</li><li>通过 bean 实现 InitializingBean 来定义初始化逻辑，DisposableBean 定义销毁逻辑</li><li>可以使用 JSR250：@PostConstruct：初始化方法；@PreDestory：销毁方法。</li><li>BeanPostProcessor：bean 的后置处理器，在 bean 初始化前后进行一些处理工作</li><li>postProcessBeforeInitialization：在初始化之前工作；</li><li>postProcessAfterInitialization：在初始化工作之后工作；</li></ol></blockquote><p>Java 配置类相关注解</p><blockquote><p>@<strong>Configuration</strong></p><p>声明当前类为配置类；</p><p>@<strong>Bean</strong></p><p>注解在方法上，声明当前方法的返回值为一个 bean，替代 xml 中的方式；</p><p>@<strong>ComponentScan</strong></p><p>用于对<strong>Component</strong>进行扫描；</p></blockquote><h3 id="切面aop相关注解"><a class="markdownIt-Anchor" href="#切面aop相关注解"></a> 切面（AOP）<strong>相关注解</strong></h3><blockquote><p><a href="https://ser-mingshao.github.io/post/a528d135">Spring AOP 详细介绍</a></p><p>Spring 支持<strong>AspectJ</strong>的注解式切面编程。</p><p>@<strong>Aspect</strong> 声明一个切面</p><p>@<strong>After</strong> 在方法执行之后执行（方法上）</p><p>@<strong>Before</strong> 在方法执行之前执行（方法上）</p><p>@<strong>Around</strong> 在方法执行之前与之后执行（方法上）</p><p>@<strong>PointCut</strong> 声明切点</p><p>在 java 配置类中使用@<strong>EnableAspectJAutoProxy</strong>注解开启<strong>Spring</strong>对<strong>AspectJ</strong>代理的支持</p></blockquote><p>@Bean 的属性支持</p><blockquote><p>@<strong>Scope</strong>设置类型包括：</p><p>设置 Spring 容器如何新建 Bean 实例（方法上，得有@<strong>Bean</strong>）</p><p>① <strong>Singleton</strong></p><p>（单例,一个 Spring 容器中只有一个 bean 实例，默认模式）,</p><p>② <strong>Protetype</strong></p><p>（每次调用新建一个 bean）,</p><p>③ <strong>Request</strong></p><p>（web 项目中，给每个 http request 新建一个 bean）,</p><p>④ <strong>Session</strong></p><p>（web 项目中，给每个 http session 新建一个 bean）,</p><p>⑤ <strong>GlobalSession</strong></p><p>（给每一个 global http session 新建一个 Bean 实例）</p></blockquote><h3 id="value-注解"><a class="markdownIt-Anchor" href="#value-注解"></a> @Value 注解</h3><blockquote><p>支持如下方式的注入：</p><ul><li>注入普通字符</li><li>注入操作系统属性</li><li>注入表达式结果</li><li>注入其它 bean 属性</li><li>注入文件资源</li><li>注入网站资源</li><li>注入配置文件</li></ul><p>@<strong>Value</strong>三种情况的用法。</p><ol><li>${}是去找外部配置的参数，将值赋过来</li><li>#{}是 SpEL 表达式，去寻找对应变量的内容</li><li>#{}直接写字符串就是将字符串的值注入进去</li></ol></blockquote><h3 id="环境切换"><a class="markdownIt-Anchor" href="#环境切换"></a> 环境切换</h3><blockquote><p>@<strong>Profile</strong></p><p>指定组件在哪个环境的情况下才能被注册到容器中，不指定，任何环境下都能注册这个组件。</p><p>@<strong>Conditional</strong></p><p>通过实现 Condition 接口，并重写 matches 方法，从而决定该 bean 是否被实例化。</p></blockquote><h3 id="异步相关"><a class="markdownIt-Anchor" href="#异步相关"></a> 异步相关</h3><blockquote><p>@<strong>EnableAsync</strong></p><p>配置类中通过此注解开启对异步任务的支持；</p><p>@<strong>Async</strong></p><p>在实际执行的 bean 方法使用该注解来声明其是一个异步任务（方法上或类上所有的方法都将异步，需要@EnableAsync 开启异步任务）</p></blockquote><h3 id="定时任务相关"><a class="markdownIt-Anchor" href="#定时任务相关"></a> 定时任务相关</h3><blockquote><p>@<strong>EnableScheduling</strong></p><p>在配置类上使用，开启计划任务的支持（类上）</p><p>@<strong>Scheduled</strong></p><p>来申明这是一个任务，包括 cron,fixDelay,fixRate 等类型（方法上，需先开启计划任务的支持）</p></blockquote><h2 id="springmvc-常用注解"><a class="markdownIt-Anchor" href="#springmvc-常用注解"></a> SpringMVC 常用注解</h2><blockquote><h3 id="1-enablewebmvc"><a class="markdownIt-Anchor" href="#1-enablewebmvc"></a> 1、@EnableWebMvc</h3><p>在配置类中开启 Web MVC 的配置支持。</p><h3 id="2-controller"><a class="markdownIt-Anchor" href="#2-controller"></a> 2、@Controller</h3><p>3、@RequestMapping<br />用于映射 web 请求，包括访问路径和参数。</p><h3 id="4-responsebody"><a class="markdownIt-Anchor" href="#4-responsebody"></a> 4、@ResponseBody</h3><p>支持将返回值放到 response 内，而不是一个页面，通常用户返回 json 数据。</p><h3 id="5-requestbody"><a class="markdownIt-Anchor" href="#5-requestbody"></a> 5、@RequestBody</h3><p>允许 request 的参数在 request 体中，而不是在直接连接的地址后面。（放在参数前）</p><h3 id="6-pathvariable"><a class="markdownIt-Anchor" href="#6-pathvariable"></a> 6、@PathVariable</h3><p>用于接收路径参数，比如@RequestMapping(“/hello/{name}”)声明的路径，将注解放在参数前，即可获取该值，通常作为 Restful 的接口实现方法。</p><h3 id="7-restcontroller"><a class="markdownIt-Anchor" href="#7-restcontroller"></a> 7、@RestController</h3><p>该注解为一个组合注解，相当于@Controller 和@ResponseBody 的组合，注解在类上，意味着，该 Controller 的所有方法都默认加上了@ResponseBody。</p><h3 id="8-controlleradvice"><a class="markdownIt-Anchor" href="#8-controlleradvice"></a> 8、@ControllerAdvice</h3><p>全局异常处理<br />全局数据绑定<br />全局数据预处理</p><h3 id="9-exceptionhandler"><a class="markdownIt-Anchor" href="#9-exceptionhandler"></a> 9、@ExceptionHandler</h3><p>用于全局处理控制器里的异常。</p><h3 id="10-initbinder"><a class="markdownIt-Anchor" href="#10-initbinder"></a> 10、@InitBinder</h3><p>用来设置 WebDataBinder，WebDataBinder 用来自动绑定前台请求参数到 Model 中。</p><h3 id="11-modelattribute"><a class="markdownIt-Anchor" href="#11-modelattribute"></a> 11、@ModelAttribute</h3><p>（1）@ModelAttribute 注释方法</p><p>如果把@ModelAttribute 放在方法的注解上时，代表的是：该 Controller 的所有方法在调用前，先执行此@ModelAttribute 方法。可以把这个@ModelAttribute 特性，应用在 BaseController 当中，所有的 Controller 继承 BaseController，即可实现在调用 Controller 时，先执行@ModelAttribute 方法。比如权限的验证（也可以使用 Interceptor）等。</p><p>（2）@ModelAttribute 注释一个方法的参数</p><p>当作为方法的参数使用，指示的参数应该从模型中检索。如果不存在，它应该首先实例化，然后添加到模型中，一旦出现在模型中，参数字段应该从具有匹配名称的所有请求参数中填充。</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Spring </category>
          
          <category> Spring注解 </category>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Spring </tag>
            
            <tag> Spring注解 </tag>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SpringDi四种依赖注入方式</title>
      <link href="/posts/7a5d2d7e/"/>
      <url>/posts/7a5d2d7e/</url>
      
        <content type="html"><![CDATA[<p><img src="https://unpkg.com/serms-assets/Spring/20200712213350.png" alt="" /></p><h2 id="springdi依赖注入"><a class="markdownIt-Anchor" href="#springdi依赖注入"></a> SpringDI（依赖注入）</h2><hr /><h3 id="di-概述"><a class="markdownIt-Anchor" href="#di-概述"></a> DI 概述</h3><blockquote><h3 id="dependency-injection即为依赖注入简称-di"><a class="markdownIt-Anchor" href="#dependency-injection即为依赖注入简称-di"></a> <code>Dependency Injection</code><strong>即为依赖注入，简称 DI</strong> 。</h3><p>简单来说，在 Spring 创建对象的同时，为其属性赋值，称之为依赖注入。</p><p>形象来说，组件之间依赖关系由容器在运行期决定的，即由容器动态的将某个依赖关系注入到组件之中。</p></blockquote><h3 id="什么是-di"><a class="markdownIt-Anchor" href="#什么是-di"></a> 什么是 DI</h3><h4 id="了解-di-的思想"><a class="markdownIt-Anchor" href="#了解-di-的思想"></a> 了解 DI 的思想</h4><blockquote><p>简单了解了 DI（依赖注入），在看依赖注入这个词，我们也可以将依赖注入以 IOC（控制反转）的形式拆分它。</p><p>顾名思义，依赖注入是由“依赖”和“注入”两个词汇组合而成，那么我们再一次顺藤摸瓜，分别分析这两个词语!</p></blockquote><h4 id="依赖"><a class="markdownIt-Anchor" href="#依赖"></a> 依赖</h4><blockquote><p>依赖一词，可以拆分成很多元素。比如说，达成依赖条件必须是<strong>两个对象</strong> ，<strong>谁依赖谁</strong> ，<strong>某一个对象依赖另一个对象的什么</strong> 。这里我们可以根据这几个条件列举出这几种情况：</p><ol><li>关于谁依赖与谁，当然是应用程序依赖于 IOC 容器。因为应用程序依赖于 IOC 容器提供的对象所需外部资源，所以就产生了这种依赖关系。（可以理解为入口，虽然不是这么严谨吧！）</li></ol></blockquote><h4 id="注入"><a class="markdownIt-Anchor" href="#注入"></a> 注入</h4><blockquote><p>注入一次，可以也可以拆分成很多元素。比如说，注入可以分解成<strong>谁注入谁</strong> ，<strong>注入了什么</strong> 。这里我们也可以根据这两个条件来列举出这几种情况：</p><ol><li>关于谁注入谁，身为容器的 IOC 肯定是被注入的对象，也就是说我们将所需要的对象注入到 IOC 容器中。至于注入了什么，很明显，就是我们项目中所需要的对象、资源、数据等等。简单来说，我们需要外部的资源既可以注入到 IOC 容器中，并由 IOC 容器来实现注入对象的控制反转！</li><li>IOC 的是在系统运行中，动态的向某个对象提供它所需要的其他对象。这一点是通过 DI（Dependency Injection，依赖注入）来实现的。</li></ol></blockquote><h3 id="注入方式"><a class="markdownIt-Anchor" href="#注入方式"></a> 注入方式</h3><h4 id="setter-方法注入"><a class="markdownIt-Anchor" href="#setter-方法注入"></a> Setter 方法注入</h4><blockquote><p>Setter 方法注入，它只需要提供对应的 Setter 方法接口实现注入，由于 JavaBean 一般都实现了 Setter 方法，所以 Setter 方法注入也成为了我们常用的注入方法之一。</p></blockquote><h5 id="定义-javabean"><a class="markdownIt-Anchor" href="#定义-javabean"></a> 定义 JavaBean</h5><blockquote><p>定义一个 JavaBean 并赋予其 Setter 方法</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.mylifes1110.bean;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.AllArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> lombok.NoArgsConstructor;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Lombok@Data注解提供了Setter方法</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Integer             id;</span><br><span class="line">    <span class="keyword">private</span> String              password;</span><br><span class="line">    <span class="keyword">private</span> String              sex;</span><br><span class="line">    <span class="keyword">private</span> Integer             age;</span><br><span class="line">    <span class="keyword">private</span> Date                bornDate;</span><br><span class="line">    <span class="keyword">private</span> String[]            hobbys;</span><br><span class="line">    <span class="keyword">private</span> Set&lt;String&gt;         phones;</span><br><span class="line">    <span class="keyword">private</span> List&lt;String&gt;        names;</span><br><span class="line">    <span class="keyword">private</span> Map&lt;String, String&gt; countries;</span><br><span class="line">    <span class="keyword">private</span> Properties          files;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="注入各种数据类型"><a class="markdownIt-Anchor" href="#注入各种数据类型"></a> 注入各种数据类型</h5><blockquote><p>注意：Spring 底层对 Date 日期类型做了处理，默认处理格式为“yyyy/MM/dd”</p></blockquote><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;User&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.mylifes1110.bean.User&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--注入基本数据类型--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;id&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;123456&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;sex&quot;</span> <span class="attr">value</span>=<span class="string">&quot;male&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;age&quot;</span> <span class="attr">value</span>=<span class="string">&quot;18&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--注入日期类型--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;bornDate&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1999/09/09&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--注入数组类型--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;hobbys&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">array</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>Run<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>Jump<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>Climb<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">array</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--注入List集合类型--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;names&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>Ziph<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>Join<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>Marry<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--注入Set集合类型--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;phones&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>110<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>119<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>120<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--注入Properties类型--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;files&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">props</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;first&quot;</span>&gt;</span>One<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;second&quot;</span>&gt;</span>Two<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;third&quot;</span>&gt;</span>Three<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">props</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--注入Map集合类型--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;countries&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">map</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">&quot;CHINA&quot;</span> <span class="attr">value</span>=<span class="string">&quot;中国&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">&quot;USA&quot;</span> <span class="attr">value</span>=<span class="string">&quot;美国&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">&quot;UK&quot;</span> <span class="attr">value</span>=<span class="string">&quot;英国&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">map</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h5 id="注入自建类型数据"><a class="markdownIt-Anchor" href="#注入自建类型数据"></a> 注入自建类型数据</h5><blockquote><p>将 Service 层需要一个 Dao 层实现类对象，我们可以使用注入方式来实现对 Service 层和 Dao 层的对象关联</p></blockquote><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;UserDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.mylifes1110.dao.impl.UserDaoImpl&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;UserService&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.mylifes1110.service.impl.UserServiceImpl&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;userDao&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;UserDao&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>将创建的 Bean 对象注入到另一个对象中，比如一个 JavaBean 对象中作为了另一个 JavaBean 对象的属性</p></blockquote><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--次要bean,被作为属性--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;address&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.mylifes1110.bean.Address&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;position&quot;</span> <span class="attr">value</span>=<span class="string">&quot;上海市&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;zipCode&quot;</span> <span class="attr">value</span>=<span class="string">&quot;100001&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--主要bean,操作的主体--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;user&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.mylifes1110.bean.User&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--address属性引用address对象--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;address&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;address&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="构造方法注入"><a class="markdownIt-Anchor" href="#构造方法注入"></a> 构造方法注入</h4><blockquote><p>创建对象时，Spring 工厂会通过构造方法为对象的属性赋值。由于某些框架或者项目中并没有为 JavaBean 提供 Setter 方法，我们就可以利用其构造方法来注入。不要和我说，没有提供构造方法哈！（开个玩笑！）</p></blockquote><h5 id="定义-javabean-2"><a class="markdownIt-Anchor" href="#定义-javabean-2"></a> 定义 JavaBean</h5><blockquote><p>定义一个 JavaBean 对象，为其提供构造方法</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Student</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String sex;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//Constructors</span></span><br><span class="line">      <span class="keyword">public</span> <span class="title function_">Student</span><span class="params">(Integer id , String name , String sex , Integer age)</span>&#123;</span><br><span class="line">          <span class="built_in">this</span>.id = id;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">          <span class="built_in">this</span>.sex = sex;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="构造方法注入-2"><a class="markdownIt-Anchor" href="#构造方法注入-2"></a> 构造方法注入</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">&lt;!--构造注入--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;u3&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.mylifes1110.bean.Student&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 除标签名称有变化,其他均和Set注入一致 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;id&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1234&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;tom&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;age&quot;</span> <span class="attr">value</span>=<span class="string">&quot;20&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;sex&quot;</span> <span class="attr">value</span>=<span class="string">&quot;male&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="自动注入"><a class="markdownIt-Anchor" href="#自动注入"></a> 自动注入</h4><blockquote><p>不用在配置中 指定为哪个属性赋值，及赋什么值。由 spring 自动根据某个 “原则” ，在工厂中查找一个 bean，为属性注入属性值。</p></blockquote><h5 id="注入场景"><a class="markdownIt-Anchor" href="#注入场景"></a> 注入场景</h5><blockquote><p>将 Dao 层实现类对象注入到 Service 层并调用方法得以测试</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.mylifes1110.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.mylifes1110.bean.User;</span><br><span class="line"><span class="keyword">import</span> com.mylifes1110.dao.UserDao;</span><br><span class="line"><span class="keyword">import</span> com.mylifes1110.service.UserService;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> UserDao userDao;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUserDao</span><span class="params">(UserDao userDao)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.userDao = userDao;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">insertUser</span><span class="params">(User user)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;------insertUser and UserService------&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> userDao.insertUser(<span class="literal">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="自动注入的两种方式"><a class="markdownIt-Anchor" href="#自动注入的两种方式"></a> 自动注入的两种方式</h5><blockquote><p>基于名称自动注入值</p></blockquote><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;UserDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.mylifes1110.dao.impl.UserDaoImpl&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--为UserServiceImpl中的属性基于名称自动注入值--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userService&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.mylifes1110.service.impl.userServiceImpl&quot;</span> <span class="attr">autowire</span>=<span class="string">&quot;byName&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>基于类型自动注入值，根据实现的接口来判断并自动注入值，如果实现此接口的实现类太多，它会在很多实现此接口的实现类中选择名字相同的实现类进行注入。（现根据判断，如果不成功，则根据名称注入）</p></blockquote><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.mylifes1110.dao.UserDaoImpl&quot;</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--为UserServiceImpl中的属性基于类型自动注入值--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userService&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.mylifes1110.service.impl.UserServiceImpl&quot;</span> <span class="attr">autowire</span>=<span class="string">&quot;byType&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="注解自动注入"><a class="markdownIt-Anchor" href="#注解自动注入"></a> 注解自动注入</h4><table><thead><tr><th style="text-align:left">注解名称</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left">@Autowired</td><td style="text-align:left">基于类型自动注入</td></tr><tr><td style="text-align:left">@Resource</td><td style="text-align:left">基于名称自动注入</td></tr><tr><td style="text-align:left">@Qualifier(“userDAO”)</td><td style="text-align:left">限定要自动注入的 bean 的 id，一般和@Autowired 联用</td></tr><tr><td style="text-align:left">@Value</td><td style="text-align:left">注入简单类型数据 （jdk8 种基本数据类型+String 类型）</td></tr></tbody></table><blockquote><p>使用基于类型自动注入，将 Dao 层注入到 Service 层</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">UserService</span> &#123;   </span><br><span class="line">    <span class="meta">@Autowired</span> <span class="comment">//注入类型为UserDao的bean</span></span><br><span class="line">    <span class="meta">@Qualifier(&quot;userDao&quot;)</span> <span class="comment">//如果有多个类型为UserDao的bean,可以用此注解从中指定一个</span></span><br><span class="line">    <span class="keyword">private</span> UserDao userDao;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>使用基于名称自动注入，将 Dao 层注入到 Serivce 层</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">UserService</span> &#123;   </span><br><span class="line">    <span class="meta">@Resource(&quot;userDao&quot;)</span> <span class="comment">//注入id=“userDao”的bean</span></span><br><span class="line">    <span class="keyword">private</span> UserDao userDao;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>使用注入简单类型数据注解来完成简单注入 JavaBean</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span>&#123;</span><br><span class="line">    <span class="meta">@Value(&quot;1&quot;)</span>    <span class="comment">//注入数字</span></span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="meta">@Value(&quot;Ziph&quot;)</span> <span class="comment">//注入String</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Spring </category>
          
          <category> 四种依赖注入 </category>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Spring </tag>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Spring-动态代理实现AOP(进阶)</title>
      <link href="/posts/a528d135/"/>
      <url>/posts/a528d135/</url>
      
        <content type="html"><![CDATA[<table><thead><tr><th style="text-align:center">相关推荐</th></tr></thead><tbody><tr><td style="text-align:center"><a href="https://spring.io/">Spring 官网</a></td></tr><tr><td style="text-align:center"><a href="https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/index.html">Spring Framework 官方文档</a></td></tr><tr><td style="text-align:center"><a href="https://github.com/spring-projects/spring-framework">spring-framework Github</a></td></tr><tr><td style="text-align:center"><a href="https://serms.top/post/841c624e/">SpringIOC 详解</a></td></tr><tr><td style="text-align:center"><a href="https://serms.top/post/9dadefec/">SpringAOP 详解</a></td></tr><tr><td style="text-align:center"></td></tr></tbody></table><h2 id="什么是动态代理"><a class="markdownIt-Anchor" href="#什么是动态代理"></a> 什么是动态代理</h2><blockquote><p>动态代理其实就是<code>Java</code>中的一个方法，这个方法可以实现：</p><p><strong>动态创建一组指定的接口的实现对象（在运行时，创建实现了指定的一组接口的对象）</strong><br />例如：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">A</span> &#123;&#125;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">B</span> &#123;&#125;</span><br><span class="line"><span class="comment">//obj对象的类型实现了A和B两个接口</span></span><br><span class="line"><span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> 方法(<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;A.class, B.class&#125;)</span><br></pre></td></tr></table></figure></blockquote><hr /><h2 id="动态代理初体验"><a class="markdownIt-Anchor" href="#动态代理初体验"></a> 动态代理初体验</h2><blockquote><p>我们根据上面的思路来体验一下 Java 中的动态代理吧，首先我们要先写两个接口。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">A</span> &#123;</span><br><span class="line">       <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">a</span><span class="params">()</span>;</span><br><span class="line">&#125;<span class="keyword">interface</span> <span class="title class_">B</span> &#123;</span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">b</span><span class="params">()</span>;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><p>然后我们就先来看一下动态代理的代码：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title function_">newProxyInstance</span><span class="params">(ClassLoader loader,</span></span><br><span class="line"><span class="params">                                     Class&lt;?&gt;[] interfaces,</span></span><br><span class="line"><span class="params">                                          InvocationHandler h)</span></span><br><span class="line">    ```</span><br><span class="line"></span><br><span class="line">上面这个就是动态代理类（Proxy）类中的创建代理对象的方法，下面介绍一下方法的三个参数：</span><br><span class="line"></span><br><span class="line">+ `ClassLoader loader`：方法需要动态生成一个类，这个类实现了A和B两个接口，然后创建这个类的对象。需要生成一个类，而且这个类也需要加载到方法区中，所以我们需要一个`ClassLoader`来加载该类</span><br><span class="line">+ `Class&lt;?&gt;[] interfaces`：我们需要代理对象实现的数组</span><br><span class="line">+ `InvocationHandler h`：调用处理器</span><br><span class="line"></span><br><span class="line">这里你可能对`InvocationHandler`有疑惑，这里先买个关子，下面马上揭晓。</span><br><span class="line">我们现在就使用动态代理创建一个代理对象吧。</span><br><span class="line"></span><br><span class="line">```java</span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test1</span><span class="params">()</span> &#123;</span><br><span class="line">       <span class="comment">/**</span></span><br><span class="line"><span class="comment">        * 三个参数</span></span><br><span class="line"><span class="comment">        * 1、ClassLoader</span></span><br><span class="line"><span class="comment">        * 方法需要动态生成一个类，这个类实现了A和B两个接口，然后创建这个类的对象</span></span><br><span class="line"><span class="comment">        * 需要生成一个类，这个类也需要加载到方法区中，所以我们需要一个ClassLoader来加载该类</span></span><br><span class="line"><span class="comment">        *</span></span><br><span class="line"><span class="comment">        * 2、Class[] interfaces</span></span><br><span class="line"><span class="comment">        * 我们需要代理对象实现的数组</span></span><br><span class="line"><span class="comment">        *</span></span><br><span class="line"><span class="comment">        * 3、InvocationHandler</span></span><br><span class="line"><span class="comment">        * 调用处理器</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">       <span class="type">ClassLoader</span> <span class="variable">classLoader</span> <span class="operator">=</span> <span class="built_in">this</span>.getClass().getClassLoader();</span><br><span class="line">       <span class="comment">//这里创建一个空实现的调用处理器。</span></span><br><span class="line">       <span class="type">InvocationHandler</span> <span class="variable">invocationHandler</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InvocationHandler</span>() &#123;</span><br><span class="line">           <span class="meta">@Override</span></span><br><span class="line">           <span class="keyword">public</span> Object <span class="title function_">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">               <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;;</span><br><span class="line">       <span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> Proxy.newProxyInstance(classLoader, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;A.class, B.class&#125;, invocationHandler);</span><br><span class="line">       <span class="comment">//强转为A和B接口类型，说明生成的代理对象实现了A和B接口</span></span><br><span class="line">       <span class="type">A</span> <span class="variable">a</span> <span class="operator">=</span> (A) obj;</span><br><span class="line">       <span class="type">B</span> <span class="variable">b</span> <span class="operator">=</span> (B) obj;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><p>经过测试代码运行成功，说明生成的代理对象确实实现了 A 接口和 B 接口，但是我想你一定会对代理对象如何实现了 A 接口和 B 接口感兴趣，你一定想知道如果使用代理对象调用相应接口的方法会发生什么感兴趣，下面我们一起来探究一下：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">上面代码的基础上加上下面的代码</span><br><span class="line">a.a();</span><br><span class="line">b.b();</span><br></pre></td></tr></table></figure><p><img src="https://unpkg.com/serms-assets@1.0.6/Spring/webp.png" alt="" /></p><p>我们可以发现什么也没有发生。这是因为我们根本没有为代理对象添加实现逻辑。可是实现逻辑添加在哪里呢？哈哈，当然是<code>InvocationHandler</code>中了。下面就看一看添加了实现逻辑的代码：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test2</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">        * 三个参数</span></span><br><span class="line"><span class="comment">        * 1、ClassLoader</span></span><br><span class="line"><span class="comment">        * 方法需要动态生成一个类，这个类实现了A和B两个接口，然后创建这个类的对象</span></span><br><span class="line"><span class="comment">        * 需要生成一个类，这个类也需要加载到方法区中，所以我们需要一个ClassLoader来加载该类</span></span><br><span class="line"><span class="comment">        *</span></span><br><span class="line"><span class="comment">        * 2、Class[] interfaces</span></span><br><span class="line"><span class="comment">        * 我们需要代理对象实现的数组</span></span><br><span class="line"><span class="comment">        *</span></span><br><span class="line"><span class="comment">        * 3、InvocationHandler</span></span><br><span class="line"><span class="comment">        * 调用处理器</span></span><br><span class="line"><span class="comment">        *</span></span><br><span class="line"><span class="comment">        * 代理对象实现的所有接口中的方法，内容都是调用InvocationHandler的invoke()方法</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">    <span class="type">ClassLoader</span> <span class="variable">classLoader</span> <span class="operator">=</span> <span class="built_in">this</span>.getClass().getClassLoader();</span><br><span class="line">    <span class="comment">//这里创建一个空实现的调用处理器。</span></span><br><span class="line">    <span class="type">InvocationHandler</span> <span class="variable">invocationHandler</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InvocationHandler</span>() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> Object <span class="title function_">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;你好！！！！&quot;</span>);<span class="comment">//注意这里添加了一点小逻辑</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> Proxy.newProxyInstance(classLoader, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;A.class, B.class&#125;, invocationHandler);</span><br><span class="line">    <span class="comment">//强转为A和B接口类型，说明生成的代理对象实现了A和B接口</span></span><br><span class="line">    <span class="type">A</span> <span class="variable">a</span> <span class="operator">=</span> (A) obj;</span><br><span class="line">    <span class="type">B</span> <span class="variable">b</span> <span class="operator">=</span> (B) obj;</span><br><span class="line"></span><br><span class="line">   a.a();</span><br><span class="line">    b.b();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>截图如下：</p><p><img src="https://unpkg.com/serms-assets@1.0.6/Spring/02.png" alt="" /></p><p>这里我们发现 A 接口和 B 接口的实现逻辑都是调用了<code>invoke</code>这个方法中的逻辑，其实除了调用代理对象的<code>native</code>方法，调用代理对象的其他所有方法本质都是调用了<code>invoke</code>方法，下面我们再来看第三个实例，让我们对动态代理有更深刻的认识。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test3</span><span class="params">()</span> &#123;</span><br><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment">        * 三个参数</span></span><br><span class="line"><span class="comment">        * 1、ClassLoader</span></span><br><span class="line"><span class="comment">        * 方法需要动态生成一个类，这个类实现了A和B两个接口，然后创建这个类的对象</span></span><br><span class="line"><span class="comment">        * 需要生成一个类，这个类也需要加载到方法区中，所以我们需要一个ClassLoader来加载该类</span></span><br><span class="line"><span class="comment">        *</span></span><br><span class="line"><span class="comment">        * 2、Class[] interfaces</span></span><br><span class="line"><span class="comment">        * 我们需要代理对象实现的数组</span></span><br><span class="line"><span class="comment">        *</span></span><br><span class="line"><span class="comment">        * 3、InvocationHandler</span></span><br><span class="line"><span class="comment">        * 调用处理器</span></span><br><span class="line"><span class="comment">        *</span></span><br><span class="line"><span class="comment">        * 代理对象实现的所有接口中的方法，内容都是调用InvocationHandler的invoke()方法</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">    <span class="type">ClassLoader</span> <span class="variable">classLoader</span> <span class="operator">=</span> <span class="built_in">this</span>.getClass().getClassLoader();</span><br><span class="line">    <span class="comment">//这里创建一个空实现的调用处理器。</span></span><br><span class="line">    <span class="type">InvocationHandler</span> <span class="variable">invocationHandler</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InvocationHandler</span>() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> Object <span class="title function_">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;你好！！！！&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Hello&quot;</span>;<span class="comment">//这里改为返回&quot;Hello&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> Proxy.newProxyInstance(classLoader, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;A.class, B.class&#125;, invocationHandler);</span><br><span class="line">    <span class="comment">//强转为A和B接口类型，说明生成的代理对象实现了A和B接口</span></span><br><span class="line">    <span class="type">A</span> <span class="variable">a</span> <span class="operator">=</span> (A) obj;</span><br><span class="line">    <span class="type">B</span> <span class="variable">b</span> <span class="operator">=</span> (B) obj;</span><br><span class="line">    a.toString();<span class="comment">//注意这里调用了toString()方法</span></span><br><span class="line">    b.getClass();<span class="comment">//注意这里调用了getClass()方法</span></span><br><span class="line">    <span class="comment">//这里在A接口中添加了一个方法public Object aaa(String s1, int i);</span></span><br><span class="line">    <span class="type">Object</span> <span class="variable">hello</span> <span class="operator">=</span> a.aaa(<span class="string">&quot;Hello&quot;</span>, <span class="number">100</span>);</span><br><span class="line">    System.out.println(obj.getClass());<span class="comment">//这里看一下代理对象是什么</span></span><br><span class="line">    System.out.println(hello);<span class="comment">//这里看一下返回值是什么</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://unpkg.com/serms-assets@1.0.6/Spring/03.png" alt="" /></p><p>通过代码的结果我们大胆的猜测一下，代理对象方法的返回值其实就是<code>invoke</code>方法的返回值，代理对象其实就是使用反射机制实现的一个运行时对象。哈哈，当然这些肯定不是猜测了，其实确实就是这样。下面是时候总结一下<code>InvocationHandler</code>的<code>invoke</code>方法了。如下图所示：</p><p><img src="https://unpkg.com/serms-assets@1.0.6/Spring/06.png" alt="" /></p><p>当我们调用代理对象的方法时，其对应关系就如上图所示。</p></blockquote><hr /><h2 id="初步实现-aop"><a class="markdownIt-Anchor" href="#初步实现-aop"></a> 初步实现 AOP</h2><blockquote><p>在我们对动态代理有了一定的认识之后，我们就可以实现最基本版本的 AOP 了，当然，这是一个非常残缺的 AOP 实现，甚至都不能称之为 AOP 实现。<br />我们先写一个接口：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> demo2;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* Created by Yifan Jia on 2018/6/5.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">//服务生</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Waiter</span> &#123;</span><br><span class="line">    <span class="comment">//服务方法</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">server</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后给出该接口的实现类：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> demo2;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* Created by Yifan Jia on 2018/6/5.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ManWaiter</span> <span class="keyword">implements</span> <span class="title class_">Waiter</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">server</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;服务中&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后我们就通过动态代理来对上面的<code>ManWaiter</code>进行增强：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> demo2;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationHandler;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Proxy;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* Created by Yifan Jia on 2018/6/5.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo2</span> &#123;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test1</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">Waiter</span> <span class="variable">waiter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ManWaiter</span>();</span><br><span class="line">        waiter.server();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test2</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">Waiter</span> <span class="variable">manWaiter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ManWaiter</span>();</span><br><span class="line">        <span class="type">ClassLoader</span> <span class="variable">classLoader</span> <span class="operator">=</span> <span class="built_in">this</span>.getClass().getClassLoader();</span><br><span class="line">        Class[] interfaces = &#123;Waiter.class&#125;;</span><br><span class="line">        <span class="type">InvocationHandler</span> <span class="variable">invocationHandler</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">WaiterInvocationHandler</span>(manWaiter);</span><br><span class="line">        <span class="comment">//得到代理对象，代理对象就是在目标对象的基础上进行了增强的对象</span></span><br><span class="line">        <span class="type">Waiter</span> <span class="variable">waiter</span> <span class="operator">=</span> (Waiter) Proxy.newProxyInstance(classLoader, interfaces, invocationHandler);</span><br><span class="line">        waiter.server();<span class="comment">//前面添加“你好”，后面添加“再见”</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">WaiterInvocationHandler</span> <span class="keyword">implements</span> <span class="title class_">InvocationHandler</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Waiter waiter;</span><br><span class="line"></span><br><span class="line">    WaiterInvocationHandler(Waiter waiter) &#123;</span><br><span class="line">        <span class="built_in">this</span>.waiter = waiter;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;你好&quot;</span>);</span><br><span class="line">        waiter.server();<span class="comment">//调用目标对象的方法</span></span><br><span class="line">        System.out.println(<span class="string">&quot;再见&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>结果如下：</p><p><img src="https://unpkg.com/serms-assets@1.0.6/Spring/04.png" alt="" /></p><p>你肯定要说了，这算什么 AOP，增强的代码都是硬编码到<code>invoke</code>方法中的，大家稍安勿躁，我们不是已经对需要增强的对象做了增强吗。这里可以的目标对象为<code>manWaiter</code>，增强为<code>System.out.println(&quot;你好&quot;);</code>和<code>System.out.println(&quot;再见&quot;);</code>，切点为<code>server()</code>方法调用。其实还是可以看做一下原始的 AOP 的。</p></blockquote><h2 id="完善的-aop-实现"><a class="markdownIt-Anchor" href="#完善的-aop-实现"></a> 完善的 AOP 实现</h2><blockquote><p>我们从初步实现的 AOP 中可以发现很多问题，比如我们不能把增强的逻辑硬编码到代码中，我们需要实现可变的增强，下面我们就解决一下这些问题，来实现一个比较完善的 AOP。<br />我们仍然引用上面的<code>Waiter</code>接口和<code>Manwaiter</code>实现类。<br />然后我们添加一个前置增强接口：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 前置增强</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">BeforeAdvice</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">before</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>再添加一个后置增强接口：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">AfterAdvice</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">after</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>我们把产生代理对象的代码封装为一个类：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> demo3;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.regexp.internal.RE;</span><br><span class="line"><span class="keyword">import</span> org.junit.After;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationHandler;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Proxy;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* ProxFactory用来生成代理对象</span></span><br><span class="line"><span class="comment">* 它需要所有的参数：目标对象，增强，</span></span><br><span class="line"><span class="comment">* Created by Yifan Jia on 2018/6/5.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 1、创建代理工厂</span></span><br><span class="line"><span class="comment">* 2、给工厂设置目标对象、前置增强、后置增强</span></span><br><span class="line"><span class="comment">* 3、调用creatProxy()得到代理对象</span></span><br><span class="line"><span class="comment">* 4、执行代理对象方法时，先执行前置增强，然后是目标方法，最后是后置增强</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">//其实在Spring中的AOP的动态代理实现的一个织入器也是叫做ProxyFactory</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ProxyFactory</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Object targetObject;<span class="comment">//目标对象</span></span><br><span class="line">    <span class="keyword">private</span> BeforeAdvice beforeAdvice;<span class="comment">//前值增强</span></span><br><span class="line">    <span class="keyword">private</span> AfterAdvice afterAdvice;<span class="comment">//后置增强</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 用来生成代理对象</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">creatProxy</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">        * 给出三个参数</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        <span class="type">ClassLoader</span> <span class="variable">classLoader</span> <span class="operator">=</span> <span class="built_in">this</span>.getClass().getClassLoader();</span><br><span class="line">        <span class="comment">//获取当前类型所实现的所有接口类型</span></span><br><span class="line">        Class[] interfaces = targetObject.getClass().getInterfaces();</span><br><span class="line"></span><br><span class="line">        <span class="type">InvocationHandler</span> <span class="variable">invocationHandler</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InvocationHandler</span>() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> Object <span class="title function_">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">                <span class="comment">/**</span></span><br><span class="line"><span class="comment">                * 在调用代理对象的方法时，会执行这里的内容</span></span><br><span class="line"><span class="comment">                */</span></span><br><span class="line">                <span class="keyword">if</span>(beforeAdvice != <span class="literal">null</span>) &#123;</span><br><span class="line">                    beforeAdvice.before();</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="type">Object</span> <span class="variable">result</span> <span class="operator">=</span> method.invoke(targetObject, args);<span class="comment">//调用目标对象的目标方法</span></span><br><span class="line">                <span class="comment">//执行后续增强</span></span><br><span class="line">                afterAdvice.after();</span><br><span class="line"></span><br><span class="line">                <span class="comment">//返回目标对象的返回值</span></span><br><span class="line">                <span class="keyword">return</span> result;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">        * 2、得到代理对象</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        <span class="type">Object</span> <span class="variable">proxyObject</span> <span class="operator">=</span> Proxy.newProxyInstance(classLoader, interfaces, invocationHandler);</span><br><span class="line">        <span class="keyword">return</span> proxyObject;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">   <span class="comment">//get和set方法略</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后我们将相关的参数注入到<code>ProxyFactory</code>后就可以通过<code>creatProxy()</code>方法获取代理对象了，代码如下：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> demo3;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* Created by Yifan Jia on 2018/6/5.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo3</span> &#123;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">tset1</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">ProxyFactory</span> <span class="variable">proxyFactory</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ProxyFactory</span>();<span class="comment">//创建工厂</span></span><br><span class="line">        proxyFactory.setTargetObject(<span class="keyword">new</span> <span class="title class_">ManWaiter</span>());<span class="comment">//设置目标对象</span></span><br><span class="line">        <span class="comment">//设置前置增强</span></span><br><span class="line">        proxyFactory.setBeforeAdvice(<span class="keyword">new</span> <span class="title class_">BeforeAdvice</span>() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">before</span><span class="params">()</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;客户你好&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="comment">//设置后置增强</span></span><br><span class="line">        proxyFactory.setAfterAdvice(<span class="keyword">new</span> <span class="title class_">AfterAdvice</span>() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">after</span><span class="params">()</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;客户再见&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="type">Waiter</span> <span class="variable">waiter</span> <span class="operator">=</span> (Waiter) proxyFactory.creatProxy();</span><br><span class="line">        waiter.server();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>结果如下：</p><p><img src="https://unpkg.com/serms-assets@1.0.6/Spring/05.png" alt="" /></p><p>这时候我们已经可以自定义任意的增强逻辑了，是不是很神奇。</p></blockquote><h2 id="动态代理实现-aop-总结"><a class="markdownIt-Anchor" href="#动态代理实现-aop-总结"></a> 动态代理实现 AOP 总结</h2><blockquote><p>通过上面的内容，我们已经通过动态代理实现了一个非常简陋的 AOP，这里的 AOP 实现还是有很多的不足之处。下面我把 Spring 中的<code>ProxyFactory</code>实现贴出来，大家可以研究一下 Spring 中的<code>ProxyFactory</code>的优势在哪里，另外，Spring 中还有其他的基于动态代理实现的织入器，<code>ProxyFactory</code>只是其中最基础的版本，大家有兴趣可以研究一下。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ProxyFactory</span> <span class="keyword">extends</span> <span class="title class_">ProxyCreatorSupport</span> &#123;</span><br><span class="line">       <span class="keyword">public</span> <span class="title function_">ProxyFactory</span><span class="params">()</span> &#123;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">public</span> <span class="title function_">ProxyFactory</span><span class="params">(Object target)</span> &#123;</span><br><span class="line">            Assert.notNull(target, <span class="string">&quot;Target object must not be null&quot;</span>);</span><br><span class="line">            <span class="built_in">this</span>.setInterfaces(ClassUtils.getAllInterfaces(target));</span><br><span class="line">            <span class="built_in">this</span>.setTarget(target);</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">public</span> <span class="title function_">ProxyFactory</span><span class="params">(Class... proxyInterfaces)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.setInterfaces(proxyInterfaces);</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">public</span> <span class="title function_">ProxyFactory</span><span class="params">(Class&lt;?&gt; proxyInterface, Interceptor interceptor)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.addInterface(proxyInterface);</span><br><span class="line">            <span class="built_in">this</span>.addAdvice(interceptor);</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">public</span> <span class="title function_">ProxyFactory</span><span class="params">(Class&lt;?&gt; proxyInterface, TargetSource targetSource)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.addInterface(proxyInterface);</span><br><span class="line">            <span class="built_in">this</span>.setTargetSource(targetSource);</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">public</span> Object <span class="title function_">getProxy</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">this</span>.createAopProxy().getProxy();</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">public</span> Object <span class="title function_">getProxy</span><span class="params">(ClassLoader classLoader)</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">this</span>.createAopProxy().getProxy(classLoader);</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; T <span class="title function_">getProxy</span><span class="params">(Class&lt;T&gt; proxyInterface, Interceptor interceptor)</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> (<span class="keyword">new</span> <span class="title class_">ProxyFactory</span>(proxyInterface, interceptor)).getProxy();</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; T <span class="title function_">getProxy</span><span class="params">(Class&lt;T&gt; proxyInterface, TargetSource targetSource)</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> (<span class="keyword">new</span> <span class="title class_">ProxyFactory</span>(proxyInterface, targetSource)).getProxy();</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title function_">getProxy</span><span class="params">(TargetSource targetSource)</span> &#123;</span><br><span class="line">            <span class="keyword">if</span>(targetSource.getTargetClass() == <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;Cannot create class proxy for TargetSource with null target class&quot;</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="type">ProxyFactory</span> <span class="variable">proxyFactory</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ProxyFactory</span>();</span><br><span class="line">                proxyFactory.setTargetSource(targetSource);</span><br><span class="line">                proxyFactory.setProxyTargetClass(<span class="literal">true</span>);</span><br><span class="line">                <span class="keyword">return</span> proxyFactory.getProxy();</span><br><span class="line">            &#125;</span><br><span class="line">       &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></blockquote>]]></content>
      
      
      <categories>
          
          <category> Spring </category>
          
          <category> Java </category>
          
          <category> SpringAop进阶 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Spring </tag>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Navicat Premium15安装与激活(完整激活版)</title>
      <link href="/posts/b6bbba88/"/>
      <url>/posts/b6bbba88/</url>
      
        <content type="html"><![CDATA[<h2 id="首先需要到官网进行下载"><a class="markdownIt-Anchor" href="#首先需要到官网进行下载"></a> <strong>首先需要到官网进行下载</strong></h2><hr /><blockquote><p>破解安装的是 15 版本的别下错了</p><p>官网目前最高版本是<code>V16</code>版本,如果找不到 15 版的话,对应的下载链接已经安利在下面了</p><p>下载安装的步骤就不多说了,直接 next 下一步 --跳过~</p></blockquote><p>Windows10 64bit: <a href="http://download.navicat.com/download/navicat150_premium_cs_x64.exe">http://download.navicat.com/download/navicat150_premium_cs_x64.exe</a></p><hr /><p><em>免责声明：本人学生党一枚，本篇博客是从网络中搜集借鉴整理的，仅供个人学习使用，未用于商业用途，对于产生的一切不良后果概不负责，进来借鉴学习的朋友也仅供个人学习，如果侵害了您的权益请立即联系博主，博主会立即删除本文，谢谢(O ^ ~ ^ O)。</em></p><hr /><h2 id="navicat-premium15-破解过程"><a class="markdownIt-Anchor" href="#navicat-premium15-破解过程"></a> <strong>Navicat Premium15 破解过程</strong></h2><h3 id="首先需要下载注册工具"><a class="markdownIt-Anchor" href="#首先需要下载注册工具"></a> 首先需要下载注册工具</h3><p><img src="https://unpkg.com/serms-assets@1.0.6/Navicat/01.png" alt="" /></p><blockquote><p>注册工具: <a href="https://pan.baidu.com/s/1nsYWtBmnBa4Y25ntK-AQ6A?pwd=yyds">https://pan.baidu.com/s/1nsYWtBmnBa4Y25ntK-AQ6A?pwd=yyds</a></p><p>直接双击运行注册工具（本人在未断网未关闭防火墙情况下成功），选择对应的 navicat 版本，此处为 v15,点击 Path 选择刚才安装 navicat 目录下的 navicat.exe 文件</p><p><img src="https://unpkg.com/serms-assets@1.0.6/Navicat/02.png" alt="" /></p><p><img src="https://unpkg.com/serms-assets@1.0.6/Navicat/03png" alt="" /></p><p><strong>出现此界面表示成功</strong></p></blockquote><p><img src="https://unpkg.com/serms-assets@1.0.6/Navicat/04.png" alt="" /></p><blockquote><p>此处有部分朋友反应解压时工具会被自动删除，因为工具的特殊性，可能会被防护软件监测为病毒删除</p><p>为了保险起见可关闭网络和防火强，若安装了其他防护软件如电脑管家也要一并关闭，并将 windows 的实时保护关闭</p></blockquote><p><img src="https://unpkg.com/serms-assets@1.0.6/Navicat/05.png" alt="" /></p><blockquote><p><strong>选择对应的版本和语言，输入 Your Name 和 Your Organization（可随意输入，也可以不修改使用默认的）,点击生成注册码，然后运行 Navicat 将注册码复制到软注册栏</strong></p></blockquote><p><img src="https://unpkg.com/serms-assets@1.0.6/Navicat/06.png" alt="" /></p><p><img src="https://unpkg.com/serms-assets@1.0.6/Navicat/07.png" alt="" /></p><blockquote><p><strong>点击激活</strong></p><p>此处部分人的激活码后面显示的是红叉，可能是由于上面步骤操作不规范</p><p>未显示 cracked 就启动了 navicate、版本选择不匹配，Patch 未选择等原因，可删除软件和安装目录后重新按照步骤安装</p></blockquote><p><img src="https://unpkg.com/serms-assets@1.0.6/Navicat/08.png" alt="" /></p><p><strong>选择手动激活</strong></p><p><img src="https://unpkg.com/serms-assets@1.0.6/Navicat/09.png" alt="" /></p><p><img src="https://unpkg.com/serms-assets@1.0.6/Navicat/10.png" alt="" /></p><p><strong>将请求码复制到注册工具的 Request Code 中，点击 Generate</strong></p><p><img src="https://unpkg.com/serms-assets@1.0.6/Navicat/11.png" alt="" /></p><p><strong>返回 activation code 即为成功</strong></p><p><img src="https://unpkg.com/serms-assets@1.0.6/Navicat/12.png" alt="" /></p><p><strong>此时手动激活页面的激活码会被自动填充，点击激活即可</strong></p><p><img src="https://unpkg.com/serms-assets@1.0.6/Navicat/13.png" alt="" /></p><p>​ <strong>至此，Navicat Premium15 的激活已经完成</strong></p><p><strong>若激活失败可以卸载 Navicat Premium 删除安装目录后重新尝试几次</strong></p><p><img src="https://unpkg.com/serms-assets@1.0.6/Navicat/14.png" alt="" /></p><p><img src="https://unpkg.com/serms-assets@1.0.6/Navicat/15.png" alt="" /></p><p><strong>激活完成就可以开始使用 Navicat 了 (~ v *)</strong></p><p><img src="https://unpkg.com/serms-assets@1.0.6/Navicat/16.png" alt="" /></p>]]></content>
      
      
      <categories>
          
          <category> 软件合集 </category>
          
          <category> Navicats </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Navicat </tag>
            
            <tag> 数据库 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>idea安装Ultimate最新版[破解]</title>
      <link href="/posts/bb6ff07f/"/>
      <url>/posts/bb6ff07f/</url>
      
        <content type="html"><![CDATA[<blockquote><p>前言:</p><p>前段时间电脑重装了,于是去 Intellij 官网下了一个 IntelliJ IDEA Edu 版本,但是 Edu 的这个版本好想没有 Spring config,经过我一番查询,发现只有 Ultimate 版本才有…而且不管是社区版还是 Edu 版很多功能都是不齐全的,所以索性就弄个终极版算了</p><p><img src="https://unpkg.com/serms-assets@1.0.6/pojie/01.png" alt="01" /></p><p>在网上找了半天发现很多破解的都不行,什么注册码,什么破解器,而且有的套路都好深…让你加公众号回复 6666 领取破解码…一次就算了,没想到他把破解码分两次,第二段破解码在另外一个公众号,害,真是一言难尽,后面终于还是通过不懈的努力给破解了,今天就把这个方法分享给大家</p><p>破解过程:是通过屏蔽官方的网络校验，达到永久激活的目的。亲测有效，方法也比较简单，下面是详细的图文教程</p><p>声明：本 IntellIj IDEA 激活破解教程，用到的激活补丁均来自网络，请勿商用，仅供个人使用，如有侵权，请联系作者删除。大家如果资金允许的话，最好购买正版</p><p>教程适用 2021.3.2 版本,更新日期在文本头部,后面如果出了 3.3 的版本就不知道能不能适用了,但目前最高版本是 3.2</p></blockquote><hr /><p>idea 版本类别:</p><table><thead><tr><th style="text-align:center">版本类别</th><th style="text-align:center">注解</th></tr></thead><tbody><tr><td style="text-align:center">Ultimate</td><td style="text-align:center">终极版</td></tr><tr><td style="text-align:center">Community</td><td style="text-align:center">社区版</td></tr><tr><td style="text-align:center">IDEA Edu</td><td style="text-align:center">学生教育版</td></tr></tbody></table><blockquote><p>目前最高版本是 2021.3.2 的版本</p></blockquote><p><img src="https://unpkg.com/serms-assets@1.0.6/pojie/idea%E7%89%88%E6%9C%AC.png" alt="image-20220310090056430" /></p><hr /><h2 id="1下载-idea"><a class="markdownIt-Anchor" href="#1下载-idea"></a> 1.下载 Idea</h2><blockquote><p>直接去官方下载最新版就行了,注意是 Ultimate 版本,别下错了</p><p><img src="https://unpkg.com/serms-assets@1.0.6/pojie/02.png" alt="02" /></p></blockquote><p>如果还分不清那个是 Ultimate 版,就 <a class="btn-beautify outline blue larger" href="https://www.jetbrains.com/idea/download/download-thanks.html?platform=windows"   title="点我下载"><i class="far fa-hand-point-right"></i><span>点我下载</span></a></p><p><img src="https://unpkg.com/serms-assets@1.0.6/pojie/image-20220309215122241.png" alt="" /></p><hr /><h2 id="2-下载激活破解补丁"><a class="markdownIt-Anchor" href="#2-下载激活破解补丁"></a> 2. 下载激活破解补丁</h2><blockquote><p>为了方便适用,我打包放到了百度网盘里面</p></blockquote><a class="btn-beautify outline blue larger" href="https://pan.baidu.com/s/14ebA6x85epkUECJsigA-2Q?pwd=yyds"   title="点我下载补丁"><i class="far fa-hand-point-right"></i><span>点我下载补丁</span></a><hr /><h2 id="3解压"><a class="markdownIt-Anchor" href="#3解压"></a> 3.解压</h2><blockquote><p>下载之后进行解压，会看到如下一个目录（建议将整个目录移动到一个稳定的地方，不会被误删的）<mark class="hl-label blue">不要放在有中文的目录下</mark> </p></blockquote><p><img src="https://unpkg.com/serms-assets@1.0.6/pojie/03.png" alt="03" /></p><blockquote><p><code>ja-netfilter.jar</code> <mark class="hl-label blue">这个文件后面激活破解IDEA的时候要用到，注意一下</mark> </p></blockquote><hr /><h2 id="4-开始破解"><a class="markdownIt-Anchor" href="#4-开始破解"></a> 4. 开始破解</h2><h3 id="激活之前需要先进入到-idea-中"><a class="markdownIt-Anchor" href="#激活之前需要先进入到-idea-中"></a> 激活之前需要先进入到 IDEA 中</h3><blockquote><p>很多小伙伴说新版的已经没有试用 30 天了，其实只要注册个账号登录授权一下，IDEA 就会送你 30 天的试用时间</p><p>有些小伙伴可能之前已经试用了 30 天，进不去 IDEA 了，没关系 后面会给出解决办法<br />选择 <mark class="hl-label red">`Start trial`</mark> 然后点击<code>Log In to JetBrains Account</code></p><p><img src="https://unpkg.com/serms-assets@1.0.6/pojie/image-20220310092151939.png" alt="image-20220310092151939" /></p><p>这个时候会自动打开你的浏览器，你只需要登录你的账号（没有的话可以去注册，或者使用 GitHub、GitLab、Google 账号登录）</p></blockquote><h3 id="登录之后会提示授权成功"><a class="markdownIt-Anchor" href="#登录之后会提示授权成功"></a> 登录之后，会提示授权成功</h3><p><img src="https://pic.imgdb.cn/item/61d5aed52ab3f51d918c2df8.jpg" alt="img" /></p><blockquote><p>之后，回到 IDEA 界面中，点击下图中标注的<code>Start Trial</code>，然后就可以免费试用 30 天了。</p><p><img src="https://unpkg.com/serms-assets@1.0.6/pojie/61d5aed52ab3f51d918c2df8.jpg" alt="image-20220310092419734" /></p></blockquote><blockquote><p>然后随便创建一个项目，进入到 IDEA 界面中，点击菜单栏中的<code>Help</code>，然后点击<code>Edit Custom VM Options</code><br />然后在打开的 vmoptions 文件中进行配置</p><p><img src="https://unpkg.com/serms-assets@1.0.6/pojie/image-20220309222921ss898.png" alt="image-20220309222921ss898" /></p></blockquote><blockquote><h2 id="配置-idea-激活破解补丁重要"><a class="markdownIt-Anchor" href="#配置-idea-激活破解补丁重要"></a> 配置 IDEA 激活破解补丁&gt;&gt;&gt;&gt;重要</h2><p>在上面打开的文件中，配置下载的补丁文件中的 <code>ja-netfilter</code> 路径<br />语法为</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ja-netfilter:[ja-netfilter.jar路径]</span><br></pre></td></tr></table></figure></blockquote><blockquote><p>举个例子:比如我解压到了 E 盘，如下图所示</p><p><img src="https://unpkg.com/serms-assets@1.0.6/pojie/image-20220310093046362.png" alt="image-20220310093046362" /></p><p>那我配置的内容就应该是</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-<span class="attr">javaagent</span>:<span class="attr">E</span>:\<span class="title class_">Program</span> <span class="title class_">Files</span>\<span class="title class_">JetBrains</span>\ja-netfilter\\ja-netfilter.<span class="property">jar</span></span><br></pre></td></tr></table></figure><p><img src="https://unpkg.com/serms-assets@1.0.6/pojie/image-20220310093432046.png" alt="image-20220310093432046" /></p><p>配置完之后保存（ctrl + s） ，关闭 IDEA（重启），再次打开 IDEA</p><p>打开之后我们在检查一下是否激活成功:</p><p><img src="https://unpkg.com/serms-assets@1.0.6/pojie/image-20220310093624328.png" alt="image-20220310093624328" /></p><p>可以看到我已经激活到了 9 万年,也不知道我能不能活这么久</p><p>总结一句话:用到死…</p><p>最后我们在看一下,有没有 Spring config:</p><p><img src="https://unpkg.com/serms-assets@1.0.6/pojie/image-20220309222921898.png" alt="image-20220309222921898" /></p><p>好像还多了很多东西呢哈哈哈~</p></blockquote><h2 id="5补充"><a class="markdownIt-Anchor" href="#5补充"></a> 5.补充</h2><p>从上面可以看到我激活到了 9 万年？ Licensed 的名字为 NoBug，其实这个都可以自定义的。<br />大家直接打开下载的 IDEA 激活补丁中的<code>janf_config.txt</code> 在里面修改就可以啦</p><p>最后，祝大家都可以成功的激活 IDEA!</p>]]></content>
      
      
      <categories>
          
          <category> 软件合集 </category>
          
          <category> idea </category>
          
      </categories>
      
      
        <tags>
            
            <tag> idea </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Mybatis学习笔记</title>
      <link href="/posts/7fd48667/"/>
      <url>/posts/7fd48667/</url>
      
        <content type="html"><![CDATA[<h2 id="一-mybatis-简介"><a class="markdownIt-Anchor" href="#一-mybatis-简介"></a> 一、MyBatis 简介</h2><hr /><h3 id="1-mybatis-历史"><a class="markdownIt-Anchor" href="#1-mybatis-历史"></a> 1. MyBatis 历史</h3><p>MyBatis 最初是 Apache 的一个开源项目 iBatis, 2010 年 6 月这个项目由 Apache Software Foundation 迁 移到了 Google Code。随着开发团队转投 Google Code 旗下， iBatis3.x 正式更名为 MyBatis。代码于 2013 年 11 月迁移到 Github。</p><p>iBatis 一词来源于“internet”和“abatis”的组合，是一个基于 Java 的持久层框架。 iBatis 提供的持久层框架 包括 SQL Maps 和 Data Access Objects（DAO）。</p><hr /><h3 id="2-mybatis-特性"><a class="markdownIt-Anchor" href="#2-mybatis-特性"></a> 2. MyBatis 特性</h3><p>1） MyBatis 是支持定制化 SQL、存储过程以及高级映射的优秀的持久层框架</p><p>2） MyBatis 避免了几乎所有的 JDBC 代码和手动设置参数以及获取结果集</p><p>3） MyBatis 可以使用简单的 XML 或注解用于配置和原始映射，将接口和 Java 的 POJO（Plain Old Java Objects，普通的 Java 对象）映射成数据库中的记录</p><p>4） MyBatis 是一个 半自动的 ORM（Object Relation Mapping）框架</p><hr /><h3 id="3-mybatis-下载"><a class="markdownIt-Anchor" href="#3-mybatis-下载"></a> 3. MyBatis 下载</h3><blockquote><a class="btn-beautify outline blue larger" href="https://github.com/mybatis/mybatis-3"   title="点我下载"><i class="far fa-hand-point-right"></i><span>点我下载</span></a></blockquote><hr /><h3 id="4-和其它持久化层技术对比"><a class="markdownIt-Anchor" href="#4-和其它持久化层技术对比"></a> 4. 和其它持久化层技术对比</h3><ul><li>JDBC<ul><li>SQL 夹杂在 Java 代码中耦合度高，导致硬编码内伤</li><li>维护不易且实际开发需求中 SQL 有变化，频繁修改的情况多见</li><li>代码冗长，开发效率低</li></ul></li><li>Hibernate 和 JPA<ul><li>操作简便，开发效率高</li><li>程序中的长难复杂 SQL 需要绕过框架</li><li>内部自动生产的 SQL，不容易做特殊优化</li><li>基于全映射的全自动框架，大量字段的 POJO 进行部分映射时比较困难</li><li>反射操作太多，导致数据库性能下降</li></ul></li><li>MyBatis<ul><li>轻量级，性能出色</li><li>SQL 和 Java 编码分开，功能边界清晰。Java 代码专注业务、SQL 语句专注数据</li><li>开发效率稍逊于 HIbernate，但是完全能够接受</li></ul></li></ul><hr /><h2 id="二-搭建-mybatis"><a class="markdownIt-Anchor" href="#二-搭建-mybatis"></a> 二、搭建 MyBatis</h2><h3 id="1-开发环境"><a class="markdownIt-Anchor" href="#1-开发环境"></a> 1. 开发环境</h3><blockquote><p>IDE：idea 2019.2</p></blockquote><blockquote><p>构建工具：maven 3.5.4</p></blockquote><blockquote><p>MySQL 版本：MySQL 5.7</p></blockquote><blockquote><p>MyBatis 版本：MyBatis 3.5.7</p></blockquote><hr /><h3 id="2-创建-maven-工程"><a class="markdownIt-Anchor" href="#2-创建-maven-工程"></a> 2. 创建 maven 工程</h3><p>​ a&gt;打包方式：jar</p><p>​ b&gt;引入依赖</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- Mybatis核心 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.7<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- junit测试 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- MySQL驱动 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span>将来整合Spring 之后,这个配置文件可以省略，所以大家操作时可以直接复制、粘贴, 核心配置文件主要用于配置连接数据库的环境以及MyBatis的全局配置信息</span><br></pre></td></tr></table></figure><hr /><h3 id="3-创建-mybatis-的核心配置文件"><a class="markdownIt-Anchor" href="#3-创建-mybatis-的核心配置文件"></a> 3. 创建 MyBatis 的核心配置文件</h3><mark class="hl-label mybatis-config.xml,这个文件名仅仅只是建议,并非强制要求。将来整合">习惯上命名为</mark> <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">configuration</span></span></span><br><span class="line"><span class="meta"><span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta"><span class="string">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--设置连接数据库的环境--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">&quot;development&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">&quot;development&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">&quot;JDBC&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">&quot;POOLED&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driver&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">value</span>=<span class="string">&quot;jdbc:mysql://localhost:3306/MyBatis&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;123456&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--引入映射文件--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">&quot;mappers/UserMapper.xml&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><hr /><h3 id="4-创建-mapper-接口"><a class="markdownIt-Anchor" href="#4-创建-mapper-接口"></a> 4、创建 mapper 接口</h3><blockquote><p>MyBatis 中的 mapper 接口相当于以前的 dao。但是区别在于，mapper 仅仅是接口，我们不需要 提供实现类。</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserMapper</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 添加用户信息</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="type">int</span> <span class="title function_">insertUser</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr /><h3 id="5-创建-mybatis-的映射文件"><a class="markdownIt-Anchor" href="#5-创建-mybatis-的映射文件"></a> 5、创建 MyBatis 的映射文件</h3><p>相关概念：ORM（Object Relationship Mapping）对象关系映射。</p><ol><li>对象：Java 的实体类对象</li><li>关系：关系型数据库</li><li>映射：二者之间的对应关系</li></ol><table><thead><tr><th>Java 概念</th><th>数据库概念</th></tr></thead><tbody><tr><td>类</td><td>表</td></tr><tr><td>属性</td><td>字段/列</td></tr><tr><td>对象</td><td>记录/行</td></tr></tbody></table><blockquote><p>1、映射文件的命名规则： 表所对应的实体类的类名+Mapper.xml 例如：表 t_user，映射的实体类为 User，所对应的映射文件为 UserMapper.xml 因此一个映射文件对应一个实体类，对应一张表的操作 MyBatis 映射文件用于编写 SQL，访问以及操作表中的数据 MyBatis 映射文件存放的位置是 src/main/resources/mappers 目录下</p><p>2、MyBatis 中可以面向接口操作数据，要保证两个一致： a&gt;mapper 接口的全类名和映射文件的命名空间（namespace）保持一致 b&gt;mapper 接口中方法的方法名和映射文件中编写 SQL 的标签的 id 属性保持一致</p></blockquote><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">mapper</span></span></span><br><span class="line"><span class="meta"><span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta"><span class="string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.atguigu.mybatis.mapper.UserMapper&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--int insertUser();--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;insertUser&quot;</span>&gt;</span></span><br><span class="line">insert into t_user values(null,&#x27;张三&#x27;,&#x27;123&#x27;,23,&#x27;女&#x27;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure><hr /><h3 id="6-通过-junit-测试功能"><a class="markdownIt-Anchor" href="#6-通过-junit-测试功能"></a> 6、通过 junit 测试功能</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//读取MyBatis的核心配置文件</span></span><br><span class="line"><span class="type">InputStream</span> <span class="variable">is</span> <span class="operator">=</span> Resources.getResourceAsStream(<span class="string">&quot;mybatis-config.xml&quot;</span>);</span><br><span class="line"><span class="comment">//创建SqlSessionFactoryBuilder对象</span></span><br><span class="line"><span class="type">SqlSessionFactoryBuilder</span> <span class="variable">sqlSessionFactoryBuilder</span> <span class="operator">=</span> <span class="keyword">new</span></span><br><span class="line"><span class="title class_">SqlSessionFactoryBuilder</span>();</span><br><span class="line"><span class="comment">//通过核心配置文件所对应的字节输入流创建工厂类SqlSessionFactory，生产SqlSession对象</span></span><br><span class="line"><span class="type">SqlSessionFactory</span> <span class="variable">sqlSessionFactory</span> <span class="operator">=</span> sqlSessionFactoryBuilder.build(is);</span><br><span class="line"><span class="comment">//创建SqlSession对象，此时通过SqlSession对象所操作的sql都必须手动提交或回滚事务</span></span><br><span class="line"><span class="comment">//SqlSession sqlSession = sqlSessionFactory.openSession();</span></span><br><span class="line"><span class="comment">//创建SqlSession对象，此时通过SqlSession对象所操作的sql都会自动提交</span></span><br><span class="line"><span class="type">SqlSession</span> <span class="variable">sqlSession</span> <span class="operator">=</span> sqlSessionFactory.openSession(<span class="literal">true</span>);</span><br><span class="line"><span class="comment">//通过代理模式创建UserMapper接口的代理实现类对象</span></span><br><span class="line"><span class="type">UserMapper</span> <span class="variable">userMapper</span> <span class="operator">=</span> sqlSession.getMapper(UserMapper.class);</span><br><span class="line"><span class="comment">//调用UserMapper接口中的方法，就可以根据UserMapper的全类名匹配元素文件，通过调用的方法名匹配</span></span><br><span class="line">映射文件中的SQL标签，并执行标签中的SQL语句</span><br><span class="line"><span class="type">int</span> <span class="variable">result</span> <span class="operator">=</span> userMapper.insertUser();</span><br><span class="line"><span class="comment">//sqlSession.commit();</span></span><br><span class="line">System.out.println(<span class="string">&quot;结果：&quot;</span>+result);</span><br></pre></td></tr></table></figure><blockquote><ul><li>SqlSession：代表 Java 程序和数据库之间的会话。（HttpSession 是 Java 程序和浏览器之间的 会话）</li><li>SqlSessionFactory：是“生产”SqlSession 的“工厂”。</li><li>工厂模式：如果创建某一个对象，使用的过程基本固定，那么我们就可以把创建这个对象的 相关代码封装到一个“工厂类”中，以后都使用这个工厂类来“生产”我们需要的对象。</li></ul></blockquote><hr /><h3 id="7-加入-log4j-日志功能"><a class="markdownIt-Anchor" href="#7-加入-log4j-日志功能"></a> 7、加入 log4j 日志功能</h3><h4 id="a加入依赖"><a class="markdownIt-Anchor" href="#a加入依赖"></a> a&gt;加入依赖</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- log4j日志 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.17<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="b加入-log4j-的配置文件"><a class="markdownIt-Anchor" href="#b加入-log4j-的配置文件"></a> b&gt;加入 log4j 的配置文件</h4><blockquote><mark class="hl-label default">log4j的配置文件名为log4j.xml，存放的位置是src/main/resources目录下</mark> </blockquote><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">log4j</span>:configuration <span class="keyword">SYSTEM</span> <span class="string">&quot;log4j.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">log4j:configuration</span> <span class="attr">xmlns:log4j</span>=<span class="string">&quot;http://jakarta.apache.org/log4j/&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">&quot;STDOUT&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.apache.log4j.ConsoleAppender&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;Encoding&quot;</span> <span class="attr">value</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">layout</span> <span class="attr">class</span>=<span class="string">&quot;org.apache.log4j.PatternLayout&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">&quot;ConversionPattern&quot;</span> <span class="attr">value</span>=<span class="string">&quot;%-5p %d&#123;MM-dd HH:mm:ss,SSS&#125;</span></span></span><br><span class="line"><span class="string"><span class="tag">%m (%F:%L) \n&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">logger</span> <span class="attr">name</span>=<span class="string">&quot;java.sql&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">level</span> <span class="attr">value</span>=<span class="string">&quot;debug&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">logger</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">logger</span> <span class="attr">name</span>=<span class="string">&quot;org.apache.ibatis&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">level</span> <span class="attr">value</span>=<span class="string">&quot;info&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">logger</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">root</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">level</span> <span class="attr">value</span>=<span class="string">&quot;debug&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;STDOUT&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">log4j:configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><h3 id="日志的级别"><a class="markdownIt-Anchor" href="#日志的级别"></a> 日志的级别</h3><mark class="hl-label 从左到右打印的内容越来越详细">FATAL(致命)>ERROR(错误)>WARN(警告)>INFO(信息)>DEBUG(调试)</mark> </blockquote><hr /><h2 id="三-核心配置文件详解"><a class="markdownIt-Anchor" href="#三-核心配置文件详解"></a> 三、核心配置文件详解</h2><blockquote><p>核心配置文件中的标签必须按照固定的顺序：</p><p><mark>properties?,settings?,typeAliases?,typeHandlers?,objectFactory?,objectWrapperFactory?,reflectorF actory?,plugins?,environments?,databaseIdProvider?,mappers?</mark></p></blockquote><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">configuration</span></span></span><br><span class="line"><span class="meta"><span class="keyword">PUBLIC</span> <span class="string">&quot;-//MyBatis.org//DTD Config 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta"><span class="string">&quot;http://MyBatis.org/dtd/MyBatis-3-config.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--引入properties文件，此时就可以$&#123;属性名&#125;的方式访问属性值--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span> <span class="attr">resource</span>=<span class="string">&quot;jdbc.properties&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--将表中字段的下划线自动转换为驼峰--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;mapUnderscoreToCamelCase&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--开启延迟加载--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;lazyLoadingEnabled&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">    typeAlias：设置某个具体的类型的别名</span></span><br><span class="line"><span class="comment">    属性：</span></span><br><span class="line"><span class="comment">    type：需要设置别名的类型的全类名</span></span><br><span class="line"><span class="comment">    alias：设置此类型的别名，若不设置此属性，该类型拥有默认的别名，即类名且不区分大小</span></span><br><span class="line"><span class="comment">    写</span></span><br><span class="line"><span class="comment">    若设置此属性，此时该类型的别名只能使用alias所设置的值</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;typeAlias type=&quot;com.atguigu.mybatis.bean.User&quot;&gt;&lt;/typeAlias&gt;--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;typeAlias type=&quot;com.atguigu.mybatis.bean.User&quot; alias=&quot;abc&quot;&gt;</span></span><br><span class="line"><span class="comment">    &lt;/typeAlias&gt;--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--以包为单位，设置改包下所有的类型都拥有默认的别名，即类名且不区分大小写--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">&quot;com.atguigu.mybatis.bean&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">    environments：设置多个连接数据库的环境</span></span><br><span class="line"><span class="comment">    属性：</span></span><br><span class="line"><span class="comment">    default：设置默认使用的环境的id</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">&quot;mysql_test&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">    environment：设置具体的连接数据库的环境信息</span></span><br><span class="line"><span class="comment">    属性：</span></span><br><span class="line"><span class="comment">    id：设置环境的唯一标识，可通过environments标签中的default设置某一个环境的id，</span></span><br><span class="line"><span class="comment">    表示默认使用的环境</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">&quot;mysql_test&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">    transactionManager：设置事务管理方式</span></span><br><span class="line"><span class="comment">    属性：</span></span><br><span class="line"><span class="comment">    type：设置事务管理方式，type=&quot;JDBC|MANAGED&quot;</span></span><br><span class="line"><span class="comment">    type=&quot;JDBC&quot;：设置当前环境的事务管理都必须手动处理</span></span><br><span class="line"><span class="comment">    type=&quot;MANAGED&quot;：设置事务被管理，例如spring中的AOP</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">&quot;JDBC&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">    dataSource：设置数据源</span></span><br><span class="line"><span class="comment">    属性：</span></span><br><span class="line"><span class="comment">    type：设置数据源的类型，type=&quot;POOLED|UNPOOLED|JNDI&quot;</span></span><br><span class="line"><span class="comment">    type=&quot;POOLED&quot;：使用数据库连接池，即会将创建的连接进行缓存，下次使用可以从</span></span><br><span class="line"><span class="comment">    缓存中直接获取，不需要重新创建</span></span><br><span class="line"><span class="comment">    type=&quot;UNPOOLED&quot;：不使用数据库连接池，即每次使用连接都需要重新创建</span></span><br><span class="line"><span class="comment">    type=&quot;JNDI&quot;：调用上下文中的数据源</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">&quot;POOLED&quot;</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--设置驱动类的全类名--&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driver&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.driver&#125;&quot;</span>/&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--设置连接数据库的连接地址--&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.url&#125;&quot;</span>/&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--设置连接数据库的用户名--&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.username&#125;&quot;</span>/&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--设置连接数据库的密码--&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.password&#125;&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--引入映射文件--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">&quot;UserMapper.xml&quot;</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">        以包为单位，将包下所有的映射文件引入核心配置文件</span></span><br><span class="line"><span class="comment">        注意：此方式必须保证mapper接口和mapper映射文件必须在相同的包下</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">&quot;com.atguigu.mybatis.mapper&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="四-mybatis-的增删改查"><a class="markdownIt-Anchor" href="#四-mybatis-的增删改查"></a> 四、MyBatis 的增删改查</h2><h3 id="1-添加"><a class="markdownIt-Anchor" href="#1-添加"></a> 1、添加</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--int insertUser();--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;insertUser&quot;</span>&gt;</span></span><br><span class="line">insert into t_user values(null,&#x27;admin&#x27;,&#x27;123456&#x27;,23,&#x27;男&#x27;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="2-删除"><a class="markdownIt-Anchor" href="#2-删除"></a> 2、删除</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--int deleteUser();--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">&quot;deleteUser&quot;</span>&gt;</span></span><br><span class="line">delete from t_user where id = 7</span><br><span class="line"><span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="3-修改"><a class="markdownIt-Anchor" href="#3-修改"></a> 3、修改</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--int updateUser();--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">&quot;updateUser&quot;</span>&gt;</span></span><br><span class="line">update t_user set username=&#x27;ybc&#x27;,password=&#x27;123&#x27; where id = 6</span><br><span class="line">&lt;/update</span><br></pre></td></tr></table></figure><h3 id="4-查询一个实体类对象"><a class="markdownIt-Anchor" href="#4-查询一个实体类对象"></a> 4、查询一个实体类对象</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--User getUserById();--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getUserById&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.atguigu.mybatis.bean.User&quot;</span>&gt;</span></span><br><span class="line">select * from t_user where id = 2</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="5-查询集合"><a class="markdownIt-Anchor" href="#5-查询集合"></a> 5、查询集合</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--List&lt;User&gt; getUserList();--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getUserList&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.atguigu.mybatis.bean.User&quot;</span>&gt;</span></span><br><span class="line">select * from t_user</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>注意：</p><p>1、查询的标签 select 必须设置属性 resultType 或 resultMap，用于设置实体类和数据库表的映射关系</p><blockquote><p>resultType：自动映射，用于属性名和表中字段名一致的情况</p></blockquote><blockquote><p>resultMap：自定义映射，用于一对多或多对一或字段名和属性名不一致的情况</p></blockquote><p>2、当查询的数据为多条时，不能使用实体类作为返回值，只能使用集合，否则会抛出异常 TooManyResultsException；但是若查询的数据只有一条，可以使用实体类或集合作为返回值</p></blockquote><hr /><h2 id="五-mybatis-获取参数值的两种方式重点"><a class="markdownIt-Anchor" href="#五-mybatis-获取参数值的两种方式重点"></a> 五、MyBatis 获取参数值的两种方式（重点）</h2><blockquote><p>MyBatis 获取参数值的两种方式：${}和#{}</p><p>${}的本质就是字符串拼接，#{}的本质就是占位符赋值</p><p>${}使用字符串拼接的方式拼接 sql，若为字符串类型或日期类型的字段进行赋值时，需要手动加单引 号；但是#{}使用占位符赋值的方式拼接 sql，此时为字符串类型或日期类型的字段进行赋值时，可以自 动添加单引号</p></blockquote><h3 id="1-单个字面量类型的参数"><a class="markdownIt-Anchor" href="#1-单个字面量类型的参数"></a> 1、单个字面量类型的参数</h3><blockquote><p>若 mapper 接口中的方法参数为单个的字面量类型 此时可以使用<span class='katex-error' title='ParseError: KaTeX parse error: Expected &#039;EOF&#039;, got &#039;#&#039; at position 4: {}和#̲{}以任意的名称获取参数的值，…'>{}和#{}以任意的名称获取参数的值，注意</span>{}需要手动加单引号</p></blockquote><h3 id="2-多个字面量类型的参数"><a class="markdownIt-Anchor" href="#2-多个字面量类型的参数"></a> 2、多个字面量类型的参数</h3><blockquote><p>若 mapper 接口中的方法参数为多个时 此时 MyBatis 会自动将这些参数放在一个 map 集合中，以 arg0,arg1…为键，以参数为值；以 param1,param2…为键，以参数为值；因此只需要通过<span class='katex-error' title='ParseError: KaTeX parse error: Expected &#039;EOF&#039;, got &#039;#&#039; at position 4: {}和#̲{}访问map集合的键就可以获…'>{}和#{}访问map集合的键就可以获取相对应的 值，注意</span>{}需要手动加单引号</p></blockquote><h3 id="3-map-集合类型的参数"><a class="markdownIt-Anchor" href="#3-map-集合类型的参数"></a> 3、map 集合类型的参数</h3><blockquote><p>若 mapper 接口中的方法需要的参数为多个时，此时可以手动创建 map 集合，将这些数据放在 map 中 只需要通过<span class='katex-error' title='ParseError: KaTeX parse error: Expected &#039;EOF&#039;, got &#039;#&#039; at position 4: {}和#̲{}访问map集合的键就可以获…'>{}和#{}访问map集合的键就可以获取相对应的值，注意</span>{}需要手动加单引号</p></blockquote><h3 id="4-实体类类型的参数"><a class="markdownIt-Anchor" href="#4-实体类类型的参数"></a> 4、实体类类型的参数</h3><blockquote><p>若 mapper 接口中的方法参数为实体类对象时 此时可以使用<span class='katex-error' title='ParseError: KaTeX parse error: Expected &#039;EOF&#039;, got &#039;#&#039; at position 4: {}和#̲{}，通过访问实体类对象中的属…'>{}和#{}，通过访问实体类对象中的属性名获取属性值，注意</span>{}需要手动加单引号</p></blockquote><h3 id="5-使用param-标识参数"><a class="markdownIt-Anchor" href="#5-使用param-标识参数"></a> 5、使用@Param 标识参数</h3><blockquote><p>可以通过@Param 注解标识 mapper 接口中的方法参数</p><p>此时，会将这些参数放在 map 集合中，以@Param 注解的 value 属性值为键，以参数为值；以 param1,param2…为键，以参数为值；只需要通过<span class='katex-error' title='ParseError: KaTeX parse error: Expected &#039;EOF&#039;, got &#039;#&#039; at position 4: {}和#̲{}访问map集合的键就可以获…'>{}和#{}访问map集合的键就可以获取相对应的值， 注意</span>{}需要手动加单引号</p></blockquote><h2 id="六-mybatis-的各种查询功能"><a class="markdownIt-Anchor" href="#六-mybatis-的各种查询功能"></a> 六、MyBatis 的各种查询功能</h2><h3 id="1-查询一个实体类对象"><a class="markdownIt-Anchor" href="#1-查询一个实体类对象"></a> 1、查询一个实体类对象</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 根据用户id查询用户信息</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment">* <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">User <span class="title function_">getUserById</span><span class="params">(<span class="meta">@Param(&quot;id&quot;)</span> <span class="type">int</span> id)</span>;</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--User getUserById(@Param(&quot;id&quot;) int id);--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getUserById&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">select * from t_user where id = #&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="2-查询一个-list-集合"><a class="markdownIt-Anchor" href="#2-查询一个-list-集合"></a> 2、查询一个 list 集合</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 查询所有用户信息</span></span><br><span class="line"><span class="comment">* <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">List&lt;User&gt; <span class="title function_">getUserList</span><span class="params">()</span>;</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--List&lt;User&gt; getUserList();--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getUserList&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">select * from t_user</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="3-查询单个数据"><a class="markdownIt-Anchor" href="#3-查询单个数据"></a> 3、查询单个数据</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 查询用户的总记录数</span></span><br><span class="line"><span class="comment">* <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">* 在MyBatis中，对于Java中常用的类型都设置了类型别名</span></span><br><span class="line"><span class="comment">* 例如：java.lang.Integer--&gt;int|integer</span></span><br><span class="line"><span class="comment">* 例如：int--&gt;_int|_integer</span></span><br><span class="line"><span class="comment">* 例如：Map--&gt;map,List--&gt;list</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">getCount</span><span class="params">()</span>;</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--int getCount();--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getCount&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;_integer&quot;</span>&gt;</span></span><br><span class="line">select count(id) from t_user</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="4-查询一条数据为-map-集合"><a class="markdownIt-Anchor" href="#4-查询一条数据为-map-集合"></a> 4、查询一条数据为 map 集合</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 根据用户id查询用户信息为map集合</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment">* <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">Map&lt;String, Object&gt; <span class="title function_">getUserToMap</span><span class="params">(<span class="meta">@Param(&quot;id&quot;)</span> <span class="type">int</span> id)</span>;</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--Map&lt;String, Object&gt; getUserToMap(@Param(&quot;id&quot;) int id);--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getUserToMap&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;map&quot;</span>&gt;</span></span><br><span class="line">select * from t_user where id = #&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--结果：&#123;password=123456, sex=男, id=1, age=23, username=admin&#125;--&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="5-查询多条数据为-map-集合"><a class="markdownIt-Anchor" href="#5-查询多条数据为-map-集合"></a> 5、查询多条数据为 map 集合</h3><h4 id="方式一"><a class="markdownIt-Anchor" href="#方式一"></a> 方式一：</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 查询所有用户信息为map集合</span></span><br><span class="line"><span class="comment">* <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">* 将表中的数据以map集合的方式查询，一条数据对应一个map；若有多条数据，就会产生多个map集合，此</span></span><br><span class="line"><span class="comment">时可以将这些map放在一个list集合中获取</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">List&lt;Map&lt;String, Object&gt;&gt; <span class="title function_">getAllUserToMap</span><span class="params">()</span>;</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line">* 查询所有用户信息为map集合</span><br><span class="line">* @return</span><br><span class="line">* 将表中的数据以map集合的方式查询，一条数据对应一个map；若有多条数据，就会产生多个map集合，此</span><br><span class="line">时可以将这些map放在一个list集合中获取</span><br><span class="line">*/</span><br><span class="line">List&lt;Map&lt;String, Object&gt;&gt; getAllUserToMap();</span><br></pre></td></tr></table></figure><h4 id="方式二"><a class="markdownIt-Anchor" href="#方式二"></a> 方式二：</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 查询所有用户信息为map集合</span></span><br><span class="line"><span class="comment">* <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">* 将表中的数据以map集合的方式查询，一条数据对应一个map；若有多条数据，就会产生多个map集合，并</span></span><br><span class="line"><span class="comment">且最终要以一个map的方式返回数据，此时需要通过<span class="doctag">@MapKey</span>注解设置map集合的键，值是每条数据所对应的</span></span><br><span class="line"><span class="comment">map集合</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@MapKey(&quot;id&quot;)</span></span><br><span class="line">Map&lt;String, Object&gt; <span class="title function_">getAllUserToMap</span><span class="params">()</span>;</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--Map&lt;String, Object&gt; getAllUserToMap();--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getAllUserToMap&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;map&quot;</span>&gt;</span></span><br><span class="line">select * from t_user</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">结果：</span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">1=&#123;password=123456, sex=男, id=1, age=23, username=admin&#125;,</span></span><br><span class="line"><span class="comment">2=&#123;password=123456, sex=男, id=2, age=23, username=张三&#125;,</span></span><br><span class="line"><span class="comment">3=&#123;password=123456, sex=男, id=3, age=23, username=张三&#125;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br></pre></td></tr></table></figure><h2 id="七-特殊-sql-的执行"><a class="markdownIt-Anchor" href="#七-特殊-sql-的执行"></a> 七、特殊 SQL 的执行</h2><h3 id="1-模糊查询"><a class="markdownIt-Anchor" href="#1-模糊查询"></a> 1、模糊查询</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 测试模糊查询</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> mohu</span></span><br><span class="line"><span class="comment">* <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">List&lt;User&gt; <span class="title function_">testMohu</span><span class="params">(<span class="meta">@Param(&quot;mohu&quot;)</span> String mohu)</span>;</span><br><span class="line">&lt;!--List&lt;User&gt; <span class="title function_">testMohu</span><span class="params">(<span class="meta">@Param(&quot;mohu&quot;)</span> String mohu)</span>;--&gt;</span><br><span class="line">&lt;select id=<span class="string">&quot;testMohu&quot;</span> resultType=<span class="string">&quot;User&quot;</span>&gt;</span><br><span class="line">&lt;!--select * from t_user where username like <span class="string">&#x27;%$&#123;mohu&#125;%&#x27;</span>--&gt;</span><br><span class="line">&lt;!--select * from t_user where username like <span class="title function_">concat</span><span class="params">(<span class="string">&#x27;%&#x27;</span>,#&#123;mohu&#125;,<span class="string">&#x27;%&#x27;</span>)</span>--&gt;</span><br><span class="line">select * from t_user where username like <span class="string">&quot;%&quot;</span>#&#123;mohu&#125;<span class="string">&quot;%&quot;</span></span><br><span class="line">&lt;/select&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="2-批量删除"><a class="markdownIt-Anchor" href="#2-批量删除"></a> 2、批量删除</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line">* 批量删除</span><br><span class="line">* @param ids</span><br><span class="line">* @return</span><br><span class="line">*/</span><br><span class="line">int deleteMore(@Param(&quot;ids&quot;) String ids);</span><br><span class="line"><span class="comment">&lt;!--int deleteMore(@Param(&quot;ids&quot;) String ids);--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">&quot;deleteMore&quot;</span>&gt;</span></span><br><span class="line">delete from t_user where id in ($&#123;ids&#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="3-动态设置表名"><a class="markdownIt-Anchor" href="#3-动态设置表名"></a> 3、动态设置表名</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 动态设置表名，查询所有的用户信息</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> tableName</span></span><br><span class="line"><span class="comment">* <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">List&lt;User&gt; <span class="title function_">getAllUser</span><span class="params">(<span class="meta">@Param(&quot;tableName&quot;)</span> String tableName)</span>;</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--List&lt;User&gt; getAllUser(@Param(&quot;tableName&quot;) String tableName);--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getAllUser&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">select * from $&#123;tableName&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="4-添加功能获取自增的主键"><a class="markdownIt-Anchor" href="#4-添加功能获取自增的主键"></a> 4、添加功能获取自增的主键</h3><blockquote><p>t_clazz(clazz_id,clazz_name)</p><p>t_student(student_id,student_name,clazz_id)</p><p>1、添加班级信息</p><p>2、获取新添加的班级的 id</p><p>3、为班级分配学生，即将某学的班级 id 修改为新添加的班级的 id</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 添加用户信息</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> user</span></span><br><span class="line"><span class="comment">* <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">* useGeneratedKeys：设置使用自增的主键</span></span><br><span class="line"><span class="comment">* keyProperty：因为增删改有统一的返回值是受影响的行数，因此只能将获取的自增的主键放在传输的参</span></span><br><span class="line"><span class="comment">数user对象的某个属性中</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">insertUser</span><span class="params">(User user)</span>;</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--int insertUser(User user);--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;insertUser&quot;</span> <span class="attr">useGeneratedKeys</span>=<span class="string">&quot;true&quot;</span> <span class="attr">keyProperty</span>=<span class="string">&quot;id&quot;</span>&gt;</span></span><br><span class="line">insert into t_user values(null,#&#123;username&#125;,#&#123;password&#125;,#&#123;age&#125;,#&#123;sex&#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="八-自定义映射-resultmap"><a class="markdownIt-Anchor" href="#八-自定义映射-resultmap"></a> 八、自定义映射 resultMap</h2><h3 id="1-resultmap-处理字段和属性的映射关系"><a class="markdownIt-Anchor" href="#1-resultmap-处理字段和属性的映射关系"></a> 1、resultMap 处理字段和属性的映射关系</h3><blockquote><p>若字段名和实体类中的属性名不一致，则可以通过 resultMap 设置自定义映射</p></blockquote><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">resultMap：设置自定义映射</span></span><br><span class="line"><span class="comment">属性：</span></span><br><span class="line"><span class="comment">id：表示自定义映射的唯一标识</span></span><br><span class="line"><span class="comment">type：查询的数据要映射的实体类的类型</span></span><br><span class="line"><span class="comment">子标签：</span></span><br><span class="line"><span class="comment">id：设置主键的映射关系</span></span><br><span class="line"><span class="comment">result：设置普通字段的映射关系</span></span><br><span class="line"><span class="comment">association：设置多对一的映射关系</span></span><br><span class="line"><span class="comment">collection：设置一对多的映射关系</span></span><br><span class="line"><span class="comment">属性：</span></span><br><span class="line"><span class="comment">property：设置映射关系中实体类中的属性名</span></span><br><span class="line"><span class="comment">column：设置映射关系中表中的字段名</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;userMap&quot;</span> <span class="attr">type</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;userName&quot;</span> <span class="attr">column</span>=<span class="string">&quot;user_name&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;password&quot;</span> <span class="attr">column</span>=<span class="string">&quot;password&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;age&quot;</span> <span class="attr">column</span>=<span class="string">&quot;age&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;sex&quot;</span> <span class="attr">column</span>=<span class="string">&quot;sex&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--List&lt;User&gt; testMohu(@Param(&quot;mohu&quot;) String mohu);--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;testMohu&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;userMap&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--select * from t_user where username like &#x27;%$&#123;mohu&#125;%&#x27;--&gt;</span></span><br><span class="line">select id,user_name,password,age,sex from t_user where user_name like</span><br><span class="line">concat(&#x27;%&#x27;,#&#123;mohu&#125;,&#x27;%&#x27;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>若字段名和实体类中的属性名不一致，但是字段名符合数据库的规则（使用*），实体类中的属性 名符合 Java 的规则（使用驼峰） *</p><p>此时也可通过以下两种方式处理字段名和实体类中的属性的映射关系</p><p>a&gt;可以通过为字段起别名的方式，保证和实体类中的属性名保持一致</p><p>b&gt;可以在 MyBatis 的核心配置文件中设置一个全局配置信息 mapUnderscoreToCamelCase，可 以在查询表中数据时，自动将_类型的字段名转换为驼峰</p><p>例如：字段名 user_name，设置了 mapUnderscoreToCamelCase，此时字段名就会转换为 userName</p></blockquote><h3 id="2-多对一映射处理"><a class="markdownIt-Anchor" href="#2-多对一映射处理"></a> 2、多对一映射处理</h3><blockquote><p>查询员工信息以及员工所对应的部门信息</p></blockquote><h4 id="a级联方式处理映射关系"><a class="markdownIt-Anchor" href="#a级联方式处理映射关系"></a> a&gt;级联方式处理映射关系</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;empDeptMap&quot;</span> <span class="attr">type</span>=<span class="string">&quot;Emp&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">&quot;eid&quot;</span> <span class="attr">property</span>=<span class="string">&quot;eid&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;ename&quot;</span> <span class="attr">property</span>=<span class="string">&quot;ename&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;age&quot;</span> <span class="attr">property</span>=<span class="string">&quot;age&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;sex&quot;</span> <span class="attr">property</span>=<span class="string">&quot;sex&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;did&quot;</span> <span class="attr">property</span>=<span class="string">&quot;dept.did&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;dname&quot;</span> <span class="attr">property</span>=<span class="string">&quot;dept.dname&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--Emp getEmpAndDeptByEid(@Param(&quot;eid&quot;) int eid);--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getEmpAndDeptByEid&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;empDeptMap&quot;</span>&gt;</span></span><br><span class="line">select emp.*,dept.* from t_emp emp left join t_dept dept on emp.did =</span><br><span class="line">dept.did where emp.eid = #&#123;eid&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="b使用-association-处理映射关系"><a class="markdownIt-Anchor" href="#b使用-association-处理映射关系"></a> b&gt;使用 association 处理映射关系</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;empDeptMap&quot;</span> <span class="attr">type</span>=<span class="string">&quot;Emp&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">&quot;eid&quot;</span> <span class="attr">property</span>=<span class="string">&quot;eid&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;ename&quot;</span> <span class="attr">property</span>=<span class="string">&quot;ename&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;age&quot;</span> <span class="attr">property</span>=<span class="string">&quot;age&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;sex&quot;</span> <span class="attr">property</span>=<span class="string">&quot;sex&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">&quot;dept&quot;</span> <span class="attr">javaType</span>=<span class="string">&quot;Dept&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">&quot;did&quot;</span> <span class="attr">property</span>=<span class="string">&quot;did&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;dname&quot;</span> <span class="attr">property</span>=<span class="string">&quot;dname&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">association</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--Emp getEmpAndDeptByEid(@Param(&quot;eid&quot;) int eid);--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getEmpAndDeptByEid&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;empDeptMap&quot;</span>&gt;</span></span><br><span class="line">select emp.*,dept.* from t_emp emp left join t_dept dept on emp.did =</span><br><span class="line">dept.did where emp.eid = #&#123;eid&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="c分步查询"><a class="markdownIt-Anchor" href="#c分步查询"></a> c&gt;分步查询</h4><h5 id="1查询员工信息"><a class="markdownIt-Anchor" href="#1查询员工信息"></a> 1）查询员工信息</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 通过分步查询查询员工信息</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> eid</span></span><br><span class="line"><span class="comment">* <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">Emp <span class="title function_">getEmpByStep</span><span class="params">(<span class="meta">@Param(&quot;eid&quot;)</span> <span class="type">int</span> eid)</span>;</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;empDeptStepMap&quot;</span> <span class="attr">type</span>=<span class="string">&quot;Emp&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">&quot;eid&quot;</span> <span class="attr">property</span>=<span class="string">&quot;eid&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;ename&quot;</span> <span class="attr">property</span>=<span class="string">&quot;ename&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;age&quot;</span> <span class="attr">property</span>=<span class="string">&quot;age&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;sex&quot;</span> <span class="attr">property</span>=<span class="string">&quot;sex&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">select：设置分步查询，查询某个属性的值的sql的标识（namespace.sqlId）</span></span><br><span class="line"><span class="comment">column：将sql以及查询结果中的某个字段设置为分步查询的条件</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">&quot;dept&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">select</span>=<span class="string">&quot;com.atguigu.MyBatis.mapper.DeptMapper.getEmpDeptByStep&quot;</span> <span class="attr">column</span>=<span class="string">&quot;did&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">association</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--Emp getEmpByStep(@Param(&quot;eid&quot;) int eid);--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getEmpByStep&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;empDeptStepMap&quot;</span>&gt;</span></span><br><span class="line">select * from t_emp where eid = #&#123;eid&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><h5 id="2根据员工所对应的部门-id-查询部门信息"><a class="markdownIt-Anchor" href="#2根据员工所对应的部门-id-查询部门信息"></a> 2）根据员工所对应的部门 id 查询部门信息</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 分步查询的第二步：根据员工所对应的did查询部门信息</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> did</span></span><br><span class="line"><span class="comment">* <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">Dept <span class="title function_">getEmpDeptByStep</span><span class="params">(<span class="meta">@Param(&quot;did&quot;)</span> <span class="type">int</span> did)</span>;</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--Dept getEmpDeptByStep(@Param(&quot;did&quot;) int did);--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getEmpDeptByStep&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;Dept&quot;</span>&gt;</span></span><br><span class="line">select * from t_dept where did = #&#123;did&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="3-一对多映射处理"><a class="markdownIt-Anchor" href="#3-一对多映射处理"></a> 3、一对多映射处理</h3><h4 id="acollection"><a class="markdownIt-Anchor" href="#acollection"></a> a&gt;collection</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line">* 根据部门id查新部门以及部门中的员工信息</span><br><span class="line">* @param did</span><br><span class="line">* @return</span><br><span class="line">*/</span><br><span class="line">Dept getDeptEmpByDid(@Param(&quot;did&quot;) int did);</span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;deptEmpMap&quot;</span> <span class="attr">type</span>=<span class="string">&quot;Dept&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;did&quot;</span> <span class="attr">column</span>=<span class="string">&quot;did&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;dname&quot;</span> <span class="attr">column</span>=<span class="string">&quot;dname&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">ofType：设置collection标签所处理的集合属性中存储数据的类型</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">&quot;emps&quot;</span> <span class="attr">ofType</span>=<span class="string">&quot;Emp&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;eid&quot;</span> <span class="attr">column</span>=<span class="string">&quot;eid&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;ename&quot;</span> <span class="attr">column</span>=<span class="string">&quot;ename&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;age&quot;</span> <span class="attr">column</span>=<span class="string">&quot;age&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;sex&quot;</span> <span class="attr">column</span>=<span class="string">&quot;sex&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">collection</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--Dept getDeptEmpByDid(@Param(&quot;did&quot;) int did);--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getDeptEmpByDid&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;deptEmpMap&quot;</span>&gt;</span></span><br><span class="line">select dept.*,emp.* from t_dept dept left join t_emp emp on dept.did =</span><br><span class="line">emp.did where dept.did = #&#123;did&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="b分步查询"><a class="markdownIt-Anchor" href="#b分步查询"></a> b&gt;分步查询</h4><h5 id="1查询部门信息"><a class="markdownIt-Anchor" href="#1查询部门信息"></a> 1）查询部门信息</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line">* 分步查询部门和部门中的员工</span><br><span class="line">* @param did</span><br><span class="line">* @return</span><br><span class="line">*/</span><br><span class="line">Dept getDeptByStep(@Param(&quot;did&quot;) int did);</span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;deptEmpStep&quot;</span> <span class="attr">type</span>=<span class="string">&quot;Dept&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;did&quot;</span> <span class="attr">column</span>=<span class="string">&quot;did&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;dname&quot;</span> <span class="attr">column</span>=<span class="string">&quot;dname&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">&quot;emps&quot;</span> <span class="attr">fetchType</span>=<span class="string">&quot;eager&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">select</span>=<span class="string">&quot;com.atguigu.MyBatis.mapper.EmpMapper.getEmpListByDid&quot;</span> <span class="attr">column</span>=<span class="string">&quot;did&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">collection</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--Dept getDeptByStep(@Param(&quot;did&quot;) int did);--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getDeptByStep&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;deptEmpStep&quot;</span>&gt;</span></span><br><span class="line">select * from t_dept where did = #&#123;did&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><h5 id="2根据部门-id-查询部门中的所有员工"><a class="markdownIt-Anchor" href="#2根据部门-id-查询部门中的所有员工"></a> 2）根据部门 id 查询部门中的所有员工</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 根据部门id查询员工信息</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> did</span></span><br><span class="line"><span class="comment">* <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">List&lt;Emp&gt; <span class="title function_">getEmpListByDid</span><span class="params">(<span class="meta">@Param(&quot;did&quot;)</span> <span class="type">int</span> did)</span>;</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--List&lt;Emp&gt; getEmpListByDid(@Param(&quot;did&quot;) int did);--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getEmpListByDid&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;Emp&quot;</span>&gt;</span></span><br><span class="line">select * from t_emp where did = #&#123;did&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>分步查询的优点：可以实现延迟加载，但是必须在核心配置文件中设置全局配置信息：</p><p>lazyLoadingEnabled：延迟加载的全局开关。当开启时，所有关联对象都会延迟加载</p><p>aggressiveLazyLoading：当开启时，任何方法的调用都会加载该对象的所有属性。 否则，每个 属性会按需加载 此时就可以实现按需加载，获取的数据是什么，就只会执行相应的 sql。此时可通过 association 和 collection 中的 fetchType 属性设置当前的分步查询是否使用延迟加载，fetchType=“lazy(延迟加 载)|eager(立即加载)”</p></blockquote><h2 id="九-动态-sql"><a class="markdownIt-Anchor" href="#九-动态-sql"></a> 九、动态 SQL</h2><blockquote><p>Mybatis 框架的动态 SQL 技术是一种根据特定条件动态拼装 SQL 语句的功能，它存在的意义是为了解决 拼接 SQL 语句字符串时的痛点问题。</p></blockquote><h3 id="1-if"><a class="markdownIt-Anchor" href="#1-if"></a> 1、if</h3><blockquote><p>if 标签可通过 test 属性的表达式进行判断，若表达式的结果为 true，则标签中的内容会执行；反之标签中 的内容不会执行</p></blockquote><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--List&lt;Emp&gt; getEmpListByMoreTJ(Emp emp);--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getEmpListByMoreTJ&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;Emp&quot;</span>&gt;</span></span><br><span class="line">select * from t_emp where 1=1</span><br><span class="line"><span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;ename != &#x27;&#x27; and ename != null&quot;</span>&gt;</span></span><br><span class="line">and ename = #&#123;ename&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;age != &#x27;&#x27; and age != null&quot;</span>&gt;</span></span><br><span class="line">and age = #&#123;age&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;sex != &#x27;&#x27; and sex != null&quot;</span>&gt;</span></span><br><span class="line">and sex = #&#123;sex&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="2-where"><a class="markdownIt-Anchor" href="#2-where"></a> 2、where</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getEmpListByMoreTJ2&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;Emp&quot;</span>&gt;</span></span><br><span class="line">select * from t_emp</span><br><span class="line"><span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;ename != &#x27;&#x27; and ename != null&quot;</span>&gt;</span></span><br><span class="line">ename = #&#123;ename&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;age != &#x27;&#x27; and age != null&quot;</span>&gt;</span></span><br><span class="line">and age = #&#123;age&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;sex != &#x27;&#x27; and sex != null&quot;</span>&gt;</span></span><br><span class="line">and sex = #&#123;sex&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>where 和 if 一般结合使用：</p><p>a&gt;若 where 标签中的 if 条件都不满足，则 where 标签没有任何功能，即不会添加 where 关键字</p><p>b&gt;若 where 标签中的 if 条件满足，则 where 标签会自动添加 where 关键字，并将条件最前方多余的 and 去掉</p><p>注意：where 标签不能去掉条件最后多余的 and</p></blockquote><h3 id="3-trim"><a class="markdownIt-Anchor" href="#3-trim"></a> 3、trim</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getEmpListByMoreTJ&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;Emp&quot;</span>&gt;</span></span><br><span class="line">select * from t_emp</span><br><span class="line"><span class="tag">&lt;<span class="name">trim</span> <span class="attr">prefix</span>=<span class="string">&quot;where&quot;</span> <span class="attr">suffixOverrides</span>=<span class="string">&quot;and&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;ename != &#x27;&#x27; and ename != null&quot;</span>&gt;</span></span><br><span class="line">ename = #&#123;ename&#125; and</span><br><span class="line"><span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;age != &#x27;&#x27; and age != null&quot;</span>&gt;</span></span><br><span class="line">age = #&#123;age&#125; and</span><br><span class="line"><span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;sex != &#x27;&#x27; and sex != null&quot;</span>&gt;</span></span><br><span class="line">    sex = #&#123;sex&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">trim</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>trim 用于去掉或添加标签中的内容</p><p>常用属性：</p><p>prefix：在 trim 标签中的内容的前面添加某些内容</p><p>prefixOverrides：在 trim 标签中的内容的前面去掉某些内容 suffix：在 trim 标签中的内容的后面添加某些内容</p><p>suffixOverrides：在 trim 标签中的内容的后面去掉某些内容</p></blockquote><h3 id="4-choose-when-otherwise"><a class="markdownIt-Anchor" href="#4-choose-when-otherwise"></a> 4、choose、when、otherwise</h3><p>choose、when、otherwise 相当于 if…else if…else</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--List&lt;Emp&gt; getEmpListByChoose(Emp emp);--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getEmpListByChoose&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;Emp&quot;</span>&gt;</span></span><br><span class="line">select <span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">&quot;empColumns&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">include</span>&gt;</span> from t_emp</span><br><span class="line"><span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">choose</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">&quot;ename != &#x27;&#x27; and ename != null&quot;</span>&gt;</span></span><br><span class="line">ename = #&#123;ename&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">when</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">&quot;age != &#x27;&#x27; and age != null&quot;</span>&gt;</span></span><br><span class="line">age = #&#123;age&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">when</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">&quot;sex != &#x27;&#x27; and sex != null&quot;</span>&gt;</span></span><br><span class="line">sex = #&#123;sex&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">when</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">&quot;email != &#x27;&#x27; and email != null&quot;</span>&gt;</span></span><br><span class="line">email = #&#123;email&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">when</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">choose</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="5-foreach"><a class="markdownIt-Anchor" href="#5-foreach"></a> 5、foreach</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--int insertMoreEmp(List&lt;Emp&gt; emps);--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;insertMoreEmp&quot;</span>&gt;</span></span><br><span class="line">insert into t_emp values</span><br><span class="line"><span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">&quot;emps&quot;</span> <span class="attr">item</span>=<span class="string">&quot;emp&quot;</span> <span class="attr">separator</span>=<span class="string">&quot;,&quot;</span>&gt;</span></span><br><span class="line">(null,#&#123;emp.ename&#125;,#&#123;emp.age&#125;,#&#123;emp.sex&#125;,#&#123;emp.email&#125;,null)</span><br><span class="line"><span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--int deleteMoreByArray(int[] eids);--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">&quot;deleteMoreByArray&quot;</span>&gt;</span></span><br><span class="line">delete from t_emp where</span><br><span class="line"><span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">&quot;eids&quot;</span> <span class="attr">item</span>=<span class="string">&quot;eid&quot;</span> <span class="attr">separator</span>=<span class="string">&quot;or&quot;</span>&gt;</span></span><br><span class="line">eid = #&#123;eid&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--int deleteMoreByArray(int[] eids);--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">&quot;deleteMoreByArray&quot;</span>&gt;</span></span><br><span class="line">delete from t_emp where eid in</span><br><span class="line"><span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">&quot;eids&quot;</span> <span class="attr">item</span>=<span class="string">&quot;eid&quot;</span> <span class="attr">separator</span>=<span class="string">&quot;,&quot;</span> <span class="attr">open</span>=<span class="string">&quot;(&quot;</span> <span class="attr">close</span>=<span class="string">&quot;)&quot;</span>&gt;</span></span><br><span class="line">#&#123;eid&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>属性：</p><p>collection：设置要循环的数组或集合</p><p>item：表示集合或数组中的每一个数据</p><p>separator：设置循环体之间的分隔符</p><p>open：设置 foreach 标签中的内容的开始符</p><p>close：设置 foreach 标签中的内容的结束符</p></blockquote><h3 id="6-sql-片段"><a class="markdownIt-Anchor" href="#6-sql-片段"></a> 6、SQL 片段</h3><p>sql 片段，可以记录一段公共 sql 片段，在使用的地方通过 include 标签进行引入</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">sql</span> <span class="attr">id</span>=<span class="string">&quot;empColumns&quot;</span>&gt;</span></span><br><span class="line">eid,ename,age,sex,did</span><br><span class="line"><span class="tag">&lt;/<span class="name">sql</span>&gt;</span></span><br><span class="line">select <span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">&quot;empColumns&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">include</span>&gt;</span> from t_emp</span><br></pre></td></tr></table></figure><h2 id="十-mybatis-的缓存"><a class="markdownIt-Anchor" href="#十-mybatis-的缓存"></a> 十、MyBatis 的缓存</h2><h3 id="mybatis-的一级缓存"><a class="markdownIt-Anchor" href="#mybatis-的一级缓存"></a> MyBatis 的一级缓存</h3><blockquote><p>一级缓存是 SqlSession 级别的，通过同一个 SqlSession 查询的数据会被缓存，下次查询相同的数据，就 会从缓存中直接获取，不会从数据库重新访问</p><p>使一级缓存失效的四种情况：</p><ol><li>不同的 SqlSession 对应不同的一级缓存</li><li>同一个 SqlSession 但是查询条件不同</li><li>同一个 SqlSession 两次查询期间执行了任何一次增删改操作</li><li>同一个 SqlSession 两次查询期间手动清空了缓存</li></ol></blockquote><h3 id="mybatis-的二级缓存"><a class="markdownIt-Anchor" href="#mybatis-的二级缓存"></a> MyBatis 的二级缓存</h3><blockquote><p>二级缓存是 SqlSessionFactory 级别，通过同一个 SqlSessionFactory 创建的 SqlSession 查询的结果会被缓存；此后若再次执行相同的查询语句，结果就会从缓存中获取</p><p>二级缓存开启的条件：</p><p>a&gt;在核心配置文件中，设置全局配置属性 cacheEnabled=“true”，默认为 true，不需要设置</p><p>b&gt;在映射文件中设置标签</p><p>c&gt;二级缓存必须在 SqlSession 关闭或提交之后有效</p><p>d&gt;查询的数据所转换的实体类类型必须实现序列化的接口</p><p>使二级缓存失效的情况： 两次查询之间执行了任意的增删改，会使一级和二级缓存同时失效</p></blockquote><h3 id="二级缓存的相关配置"><a class="markdownIt-Anchor" href="#二级缓存的相关配置"></a> 二级缓存的相关配置</h3><blockquote><p>在 mapper 配置文件中添加的 cache 标签可以设置一些属性：</p><ol><li>eviction 属性：缓存回收策略 LRU（Least Recently Used） – 最近最少使用的：移除最长时间不被使用的对象。 FIFO（First in First out） – 先进先出：按对象进入缓存的顺序来移除它们。 SOFT – 软引用：移除基于垃圾回收器状态和软引用规则的对象。 WEAK – 弱引用：更积极地移除基于垃圾收集器状态和弱引用规则的对象。 默认的是 LRU。</li><li>flushInterval 属性：刷新间隔，单位毫秒 默认情况是不设置，也就是没有刷新间隔，缓存仅仅调用语句时刷新</li><li>size 属性：引用数目，正整数 代表缓存最多可以存储多少个对象，太大容易导致内存溢出</li><li>readOnly 属性：只读，true/false</li><li>true：只读缓存；会给所有调用者返回缓存对象的相同实例。因此这些对象不能被修改。这提供了 很重要的性能优势。</li><li>false：读写缓存；会返回缓存对象的拷贝（通过序列化）。这会慢一些，但是安全，因此默认是 false。</li></ol></blockquote><h3 id="mybatis-缓存查询的顺序"><a class="markdownIt-Anchor" href="#mybatis-缓存查询的顺序"></a> MyBatis 缓存查询的顺序</h3><ol><li>先查询二级缓存，因为二级缓存中可能会有其他程序已经查出来的数据，可以拿来直接使用。</li><li>如果二级缓存没有命中，再查询一级缓存</li><li>如果一级缓存也没有命中，则查询数据库</li><li>SqlSession 关闭之后，一级缓存中的数据会写入二级缓存</li></ol><h3 id="整合第三方缓存-ehcache"><a class="markdownIt-Anchor" href="#整合第三方缓存-ehcache"></a> 整合第三方缓存 EHCache</h3><ul><li>添加依赖</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Mybatis EHCache整合包 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.caches<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-ehcache<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- slf4j日志门面的一个具体实现 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>ch.qos.logback<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>logback-classic<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>各 jar 包功能</li></ul><table><thead><tr><th>jar 包名称</th><th>作用</th></tr></thead><tbody><tr><td>mybatis-ehcache</td><td>Mybatis 和 EHCache 的整合包</td></tr><tr><td>ehcache</td><td>EHCache 核心包</td></tr><tr><td>slf4j-api</td><td>SLF4J 日志门面包</td></tr><tr><td>logback-classic</td><td>支持 SLF4J 门面接口的一个具体实现</td></tr></tbody></table><ul><li>创建 EHCache 的配置文件 ehcache.xml</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;</span><br><span class="line">&lt;ehcache xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class="line">xsi:noNamespaceSchemaLocation=&quot;../config/ehcache.xsd&quot;&gt;</span><br><span class="line">&lt;!-- 磁盘保存路径 --&gt;</span><br><span class="line">&lt;diskStore path=&quot;D:\atguigu\ehcache&quot;/&gt;</span><br><span class="line">&lt;defaultCache</span><br><span class="line">maxElementsInMemory=&quot;1000&quot;</span><br><span class="line">maxElementsOnDisk=&quot;10000000&quot;</span><br><span class="line">eternal=&quot;false&quot;</span><br><span class="line">overflowToDisk=&quot;true&quot;</span><br><span class="line">timeToIdleSeconds=&quot;120&quot;</span><br><span class="line">timeToLiveSeconds=&quot;120&quot;</span><br><span class="line">diskExpiryThreadIntervalSeconds=&quot;120&quot;</span><br><span class="line">memoryStoreEvictionPolicy=&quot;LRU&quot;&gt;</span><br><span class="line">&lt;/defaultCache&gt;</span><br><span class="line">&lt;/ehcache&gt;</span><br></pre></td></tr></table></figure><ul><li>设置二级缓存的类型</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">cache</span> <span class="attr">type</span>=<span class="string">&quot;org.mybatis.caches.ehcache.EhcacheCache&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure><ul><li>加入 logback 日志</li></ul><p>存在 SLF4J 时，作为简易日志的 log4j 将失效，此时我们需要借助 SLF4J 的具体实现 logback 来打印日志。 创建 logback 的配置文件 logback.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span> <span class="attr">debug</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 指定日志输出的位置 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">&quot;STDOUT&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.ConsoleAppender&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">encoder</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 日志输出的格式 --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 按照顺序分别是：时间、日志级别、线程名称、打印日志的类、日志主体内容、换行 -</span></span><br><span class="line"><span class="comment">-&gt;</span></span><br><span class="line"><span class="comment">&lt;pattern&gt;[%d&#123;HH:mm:ss.SSS&#125;] [%-5level] [%thread] [%logger]</span></span><br><span class="line"><span class="comment">[%msg]%n&lt;/pattern&gt;</span></span><br><span class="line"><span class="comment">&lt;/encoder&gt;</span></span><br><span class="line"><span class="comment">&lt;/appender&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 设置全局日志级别。日志级别按顺序分别是：DEBUG、INFO、WARN、ERROR --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 指定任何一个日志级别都只打印当前级别和后面级别的日志。 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">root</span> <span class="attr">level</span>=<span class="string">&quot;DEBUG&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 指定打印日志的appender，这里通过“STDOUT”引用了前面配置的appender --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;STDOUT&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 根据特殊需求指定局部日志级别 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">logger</span> <span class="attr">name</span>=<span class="string">&quot;com.atguigu.crowd.mapper&quot;</span> <span class="attr">level</span>=<span class="string">&quot;DEBUG&quot;</span>/&gt;</span></span><br><span class="line">&lt;/configuration</span><br></pre></td></tr></table></figure><ul><li>EHCache 配置文件说明</li></ul><table><thead><tr><th>属性名</th><th>是 否 必 须</th><th>作用</th></tr></thead><tbody><tr><td>maxElementsInMemory</td><td>是</td><td>在内存中缓存的 element 的最大数目</td></tr><tr><td>maxElementsOnDisk</td><td>是</td><td>在磁盘上缓存的 element 的最大数目，若是 0 表示无 穷大</td></tr><tr><td>eternal</td><td>是</td><td>设定缓存的 elements 是否永远不过期。 如果为 true，则缓存的数据始终有效， 如果为 false 那么还 要根据 timeToIdleSeconds、timeToLiveSeconds 判断</td></tr><tr><td>overflowToDisk</td><td>是</td><td>设定当内存缓存溢出的时候是否将过期的 element 缓存到磁盘上</td></tr><tr><td>timeToIdleSeconds</td><td>否</td><td>当缓存在 EhCache 中的数据前后两次访问的时间超 过 timeToIdleSeconds 的属性取值时， 这些数据便 会删除，默认值是 0,也就是可闲置时间无穷大</td></tr><tr><td>diskSpoolBufferSizeMB</td><td>否</td><td>DiskStore(磁盘缓存)的缓存区大小。默认是 30MB。每个 Cache 都应该有自己的一个缓冲区</td></tr><tr><td>diskPersistent</td><td>否</td><td>在 VM 重启的时候是否启用磁盘保存 EhCache 中的数 据，默认是 false。</td></tr><tr><td>diskExpiryThreadIntervalSeconds</td><td>否</td><td>磁盘缓存的清理线程运行间隔，默认是 120 秒。每 个 120s， 相应的线程会进行一次 EhCache 中数据的 清理工作</td></tr><tr><td>memoryStoreEvictionPolicy</td><td>否</td><td>当内存缓存达到最大，有新的 element 加入的时 候， 移除缓存中 element 的策略。 默认是 LRU（最 近最少使用），可选的有 LFU（最不常使用）和 FIFO（先进先出）</td></tr></tbody></table><h2 id="十一-mybatis-的逆向工程"><a class="markdownIt-Anchor" href="#十一-mybatis-的逆向工程"></a> 十一、MyBatis 的逆向工程</h2><ul><li><p>正向工程：先创建 Java 实体类，由框架负责根据实体类生成数据库表。Hibernate 是支持正向工程 的。</p></li><li><p>逆向工程：先创建数据库表，由框架负责根据数据库表，反向生成如下资源：</p><ul><li>Java 实体类</li><li>Mapper 接口</li><li>Mapper 映射文件</li></ul></li></ul><h3 id="创建逆向工程的步骤"><a class="markdownIt-Anchor" href="#创建逆向工程的步骤"></a> 创建逆向工程的步骤</h3><h4 id="添加依赖和插件"><a class="markdownIt-Anchor" href="#添加依赖和插件"></a> 添加依赖和插件</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 依赖MyBatis核心包 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.7<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 控制Maven在构建过程中相关配置 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 构建过程中用到的插件 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 具体插件，逆向工程的操作是以构建过程中插件形式出现的 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.generator<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-generator-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 插件的依赖 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 逆向工程的核心依赖 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.generator<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-generator-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 数据库连接池 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.mchange<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>c3p0<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>0.9.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- MySQL驱动 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.8<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="创建-mybatis-的核心配置文件"><a class="markdownIt-Anchor" href="#创建-mybatis-的核心配置文件"></a> 创建 MyBatis 的核心配置文件</h4><h4 id="创建逆向工程的配置文件"><a class="markdownIt-Anchor" href="#创建逆向工程的配置文件"></a> 创建逆向工程的配置文件</h4><blockquote><p>文件名必须是：generatorConfig.xml</p></blockquote><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">generatorConfiguration</span></span></span><br><span class="line"><span class="meta"><span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD MyBatis Generator Configuration 1.0//EN&quot;</span></span></span><br><span class="line"><span class="meta"><span class="string">&quot;http://mybatis.org/dtd/mybatis-generator-config_1_0.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">generatorConfiguration</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">targetRuntime: 执行生成的逆向工程的版本</span></span><br><span class="line"><span class="comment">MyBatis3Simple: 生成基本的CRUD（清新简洁版）</span></span><br><span class="line"><span class="comment">MyBatis3: 生成带条件的CRUD（奢华尊享版）</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context</span> <span class="attr">id</span>=<span class="string">&quot;DB2Tables&quot;</span> <span class="attr">targetRuntime</span>=<span class="string">&quot;MyBatis3Simple&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 数据库的连接信息 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">jdbcConnection</span> <span class="attr">driverClass</span>=<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">connectionURL</span>=<span class="string">&quot;jdbc:mysql://localhost:3306/mybatis&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">userId</span>=<span class="string">&quot;root&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">password</span>=<span class="string">&quot;123456&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">jdbcConnection</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- javaBean的生成策略--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">javaModelGenerator</span> <span class="attr">targetPackage</span>=<span class="string">&quot;com.atguigu.mybatis.bean&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">targetProject</span>=<span class="string">&quot;.\src\main\java&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;enableSubPackages&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;trimStrings&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">javaModelGenerator</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- SQL映射文件的生成策略 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">sqlMapGenerator</span> <span class="attr">targetPackage</span>=<span class="string">&quot;com.atguigu.mybatis.mapper&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">targetProject</span>=<span class="string">&quot;.\src\main\resources&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;enableSubPackages&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">sqlMapGenerator</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- Mapper接口的生成策略 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">javaClientGenerator</span> <span class="attr">type</span>=<span class="string">&quot;XMLMAPPER&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">targetPackage</span>=<span class="string">&quot;com.atguigu.mybatis.mapper&quot;</span> <span class="attr">targetProject</span>=<span class="string">&quot;.\src\main\java&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;enableSubPackages&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">javaClientGenerator</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 逆向分析的表 --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- tableName设置为*号，可以对应所有表，此时不写domainObjectName --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- domainObjectName属性指定生成出来的实体类的类名 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">tableName</span>=<span class="string">&quot;t_emp&quot;</span> <span class="attr">domainObjectName</span>=<span class="string">&quot;Emp&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">tableName</span>=<span class="string">&quot;t_dept&quot;</span> <span class="attr">domainObjectName</span>=<span class="string">&quot;Dept&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">context</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">generatorConfiguration</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="执行-mbg-插件的-generate-目标"><a class="markdownIt-Anchor" href="#执行-mbg-插件的-generate-目标"></a> 执行 MBG 插件的 generate 目标</h4><p><img src="https://lc-gluttony.s3.amazonaws.com/aLy6jTEsBgHJ/nvgz4dicqzr3J37ESAxnSLhKfv2NHMFt/QQ%E6%88%AA%E5%9B%BE20220309154235.png" alt="Mybatis" /></p><h3 id="qbc-查询"><a class="markdownIt-Anchor" href="#qbc-查询"></a> QBC 查询</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testMBG</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line"><span class="type">InputStream</span> <span class="variable">is</span> <span class="operator">=</span> Resources.getResourceAsStream(<span class="string">&quot;mybatis-config.xml&quot;</span>);</span><br><span class="line"><span class="type">SqlSession</span> <span class="variable">sqlSession</span> <span class="operator">=</span> <span class="keyword">new</span></span><br><span class="line"><span class="title class_">SqlSessionFactoryBuilder</span>().build(is).openSession(<span class="literal">true</span>);</span><br><span class="line"><span class="type">EmpMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> sqlSession.getMapper(EmpMapper.class);</span><br><span class="line"><span class="type">EmpExample</span> <span class="variable">empExample</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">EmpExample</span>();</span><br><span class="line"><span class="comment">//创建条件对象，通过andXXX方法为SQL添加查询添加，每个条件之间是and关系</span></span><br><span class="line">empExample.createCriteria().andEnameLike(<span class="string">&quot;a&quot;</span>).andAgeGreaterThan(<span class="number">20</span>).andDidIsNot</span><br><span class="line"><span class="title function_">Null</span><span class="params">()</span>;</span><br><span class="line"><span class="comment">//将之前添加的条件通过or拼接其他条件</span></span><br><span class="line">empExample.or().andSexEqualTo(<span class="string">&quot;男&quot;</span>);</span><br><span class="line">List&lt;Emp&gt; list = mapper.selectByExample(empExample);</span><br><span class="line"><span class="keyword">for</span> (Emp emp : list) &#123;</span><br><span class="line">System.out.println(emp);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 编程笔记 </category>
          
          <category> Java </category>
          
          <category> Mybatis </category>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> Mybatis </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>bufferfly主题--文档修改</title>
      <link href="/posts/d811784c/"/>
      <url>/posts/d811784c/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="抱歉, 这个密码看着不太对, 请再试试." data-whm="抱歉, 这个文章不能被校验, 不过您还是能看看解密后的内容.">  <script id="hbeData" type="hbeData" data-hmacdigest="b56e8cd02a62b9ed88167d2f9bbf05b7c0882f9304c3229ecc4bc865159e83bc">c2a6eab85bdb988c04f79315e004caa4134f78b2cd2f052f0250e74a2e700c7560539bb842bed69a43d6a64afb18f78977a8c52be5305c6f3f0b14e2996481626fd77cf4d1a232827117b7fd8e2696d9ad1a56dcaafce18bb246a824cdcc25ef1978bc09b5930bff8c6fe27ec9d9ebfa08692f528858a9e3c7a5c24c20bd64e0a26fe8bc44deb5075b9d63e3081d6a40b87da50a5090a812a7a9d27b12c851d163e5acebd86b0e3e7119fc3265d1cc55197bd261d1d4cdcb72db25e7b6d6f3a88e80542462680c6f43a8631ed35f582634b89ed6b174dc63ba925a9e846949b44746a074842ceaac30b61c62de3cffbaeed2196c7987963d62635a6dfeab81cbfe917845ef4c42eefa8cafb09e95593c41200386bcb9151e949bd4fd02fb191d9333055fb9b67c66ed20bf79c5649914db3dc7e913d29d0f1aef05a20cc188b0229841afe135e3a37929881e0100f0de9f38e89af0614a896c24512f367b15ccc359c2f618fb6cf8e62ccb9b9c5f523d371af40ffa7be9edf9452284ccb4aa69fbfe0eaf7a694cf606025e142c0be29dab39e663558c714ca239f2d195a1e15a5df3d1803645f6722fe940fedb4f3ddb29d0def94ba79533f216101e665ec520d6635565a4a7f5461c24402fbc08901916c824838054df963fff802a58cfb7bead857a1bd8fdfda8eae509fe7736c2f77e5564377a76566304fc1e8ddffc05ce83df0f1034926edf31e916375c27ddb7a8f75280547049da8b6cab7f2f8f6aaa8dedc78143ca14ed8211bec292028ca79914feea7f5bb4a3ed502f39a235027da65cf3a7ae66c8bcc3bd64db02ec66e8627243430e33e6013bf8bb78a7c850941de0664b48801c4ef45fa3044326bb9059479c052516973f5552a1d1b1628eb8b31c87b9bc8b0a498099cd66c0a47c9f9cf37b310afbc1942d795050f85016f5c11589b78ca6aa0a681178ee0e2dbc31143fcf3ba517ac4efeed2bc4c1308641ef23fe49013bab0d46babee03eb5ab4690fc7b8493472a7b3002fb10a2cc4e084a8a62cdbe5439048a9d837df86f96463122612c6c35fd10c25c37b95a745041a4303f76b07af085a47bb775ceba484e1b1413a64f6b5b3b1e708892fe52d48b653e88b0d19c526f65dc04b8f835e1a3f305b27b9f62639bf17c5d4a4d545c98b910d9e6cd625d6332c6f3542e16bff386720faf976fffac58f132514b64f935f96ec9f40c92872660b35510cd68f3455f01c98ca67bf64a55de89b2f2dde981c3678390e1a20789ca12354a8868a933dea54a811ab84dbc9f0bd773c139076026a3d69198b58129ec9e37e949382ed4b4798a0ce5d37c74876e7ecb85fda8f3c3df5639dae5e7b6d32045a1b08ad3c9c8b57ef9adf9df2e4a4b2a55f1bf713613589166d1ea2de60901181938ef214f97002ce2de81766b8b11feb822687c12578e9613f3d88a27414da28774c8e32a23f8c1c86504d16f00f36c16daf3c95f2cfb451eaa53d9410a9a60f96edc43c9e4ca31cf16352ff0de2ab0b63c8c72786bd433215ba000a6cb81edf245d58a4686d7132972b32350b5f7edc37e993e9a597801c6572c88d7e9884512b4ef5229e653813626f8624f733496173a54bd109ef0fc9f20bce16e8711398743ef679a876012820feb72d1e168c1be520736aad6a7ebc4101a3d62e1e27120c08082302c89ed0af0bf256be715ecad1b6c9a2a45c7549520f6f991c999911993262e04529bb49f6f757b756ffb9ddec88e347d1acefdbca069d286882edbe7e3607c7476faea86130db1ee1b56b51816263accc5f6907fb0cffc1568dbd7c4327c6288ce453a1dabf633e380fb22b736f3310336ac9296a64e1da34e816cd3e991e3b57e0df8d7257d498974c432a660f69ec98cc97a07bca7ff170b6053acd322153dfbb3f8a6aa6761fc2e266b8f0885a0afb61970e47e6a0890e8d04174051ea42c637860bbc9b50ba07c26f49658ab81c412e3086351164b20d380371e76daed9497e934ca38d9596fa5c0d03c530b180cad3419068904e80ca1c6f7089ac6ae04c4bd1ebcbd5bbb9055bca9fc138718ebabbc4d713487a7e568bc6a31b22b39ece01412a618236ded35aaf7788bffd11f4bc3cee8519dacd7e1afb6f2703c5278d10b1d747f47bff7b1ed4b113fa28343b2a19a0a6a15e1696c709155f5f691679ab0a4efee19678e169d147b16904fb337f6bbcb88e76402ea9b76fd2434a47e2e64c62340637b9ef049fbeb236cceebd896f6ef69aaebf5c26c5b068404b7c06832ab1b75d979aca7cb1ad43babce0b8be723e071b763d949a4e74315dba982ab9c35ef174b62a720a969709cc172d18bad5a72dcaa29777fdb44e89f9a933828cc0c817fdf7ce6d81b0ab55a1f75a5af19737a093cf54b581212d46f7a3ca8c21dc4185bbb9156950ffdfc63e2d7c36170e91c40f9ebee74eb0f8924d80305d5e94081147d3b86ed8c4168e64d6a197d11cf1c6349a6082ee57b23186108c9ff4be9ed0c8694909970f567749f3419d90f61f460c428ae8fe206c942e62e0bf292b0b5005a605a15e1a0129be79215c069b6475806224110867491f23ff5a5c189f7ccae953e0c7739c90db2f2e01c3d43a5913148008449d34492d0791c7375080450ce2b6d8f0f4d9ee4ac5e19a1db74da5a907b41eccbd247c9698f304fcf85025de882d8750e216c58fbc567ec35e9655bc091447c8957179e5bef3c422dec07278c955ce83b6ec69c6ab7cf71e8ac809b20eb84d927c04caafb29744b71f5b6f46ad9db1ad8b5df9eba3a9dcdba6169833263ef609dd252ca4a7c6a0d7c52236e9dea552741cb9ecf0a8d9c955b897a412c7d284783c7b59b4d8b9dd8d959304e3f9a231ab57ecbab393c382889a0ae01fc2e0c5387baae2ea7aa4db97b4de42762a275ccaaee0c52ecdab390d8c6da5bc62c35dc659318475e4082148e5881d981604fa6e64c354c84d7c795f3f6f05c6289f279bdf67e15218d280f8b72327fb37a78eb7d5b9d8c8d834aa914787338f40941686d7386f5a3cb96bca100c9385e5de1e3b4602947c4c9aa8077e2ff1de0dbde36170207f4b86ae6feea50055c146acaae305490a27f46ac404d5daeba9344ab9c7848b7ae05601cb9953964eeeeaf9bb7958663ce8d5d5991b120e781b211e01226f1c73556787952f9af186387ef2b426f176855b0a97004a131a0a5b1c7102e9beed8ce8b0f194c89e9b1d39a8f8ee6d64520afc58f35b1760c6c13595e81119c76379085e59a6a3d38dea715bfb0ee9ef2c0ae1f207862e829c6873367b8020d9293f105369376d78004b2e2750a1f977d243bcb534a46fbe04ac4970e934d472c65544dbbcbf266dfd2a461a3c168a8e9cc2dfc46d4ab8e4ce0d4513d131dafbbf31292694de800744322757a7e051436b379ddcbd006eb0759a81f13803adf4881c149a04cabb62a0b1b83f9a8c284d980d40d4c6c7a6997ef23bec9f25fc1d33b4d05aac4c074338077ce0a8355e773fb39628e135660262a1d4aaa67c933d6424b09e921bbe519407f091e7ac9289b32d34f878cc1712ecdac25a8cef03ab2095067cd5dc6c5ceec04cfa403a90914010c6f56e034a01e7378b2556d367850d3a7740c71dd98a7deec4a9bc4b3c0e0df17f6e8a9134e583025fddb9dc4e93757518129107216922af075fcafe4de286476f1340c5a1307b948a66afe04722db7b5ac832ee9933626ad744c8fdcaa1acfd685d620534a780bc5569e8ac08ed9c60ba01a726f2dd8fac2b015640102c809286ec96e0c3c5ddb1bd22a37317525fc3e6d5eb2b0ada55066afe45709cda9490cf55a3fa0efc4ff4bc9bf5ecc6cced9ba204118deadb4388f0f5dd2730d02e4678abd9603ecfd23938b3110021ca1d8bef85429facae041be10babc955b6b9b38a5845919affba7cfaf60250610fd1f5861f8bf8fd927a0a1b45b77efc6834baacfad2a7c0c299ca7331a70be88e71fcf7ded224375e9b0d2e6b86831e3b26b2f58d85baa07ec6690c974533ad2f66ef95ab6efd225eb6cd627d13d8cb4d90478adae8a8a6a6a751437220db8e1ae51b8e986e006be4c05882110ae89c1b699995803b27297bcbb3c999e14d97262ddb5cb5c29abae30a4bb3b16d30099fb29571d8f8399761ef42cc13c71f8b632fef0e3fe3c47b295fa87599810e783812e23b37751acb030fd42e0f7a9d9cac876ea1b038aa843de7d55bcbadca1922a78fe960308a5d1098197edd3f1853536d90958cf612e36275a8612eb4a54d32ff7a48d1aa02713f65f5dc378842ff9209e78768e0dc694cedc967e4d22430fb63e209ca772bfd273b00ca4eee88790be37533df6f976ee801a4e84eda03413b858fce259737fa60f5af5d3b5183db0c6e19f586786d007dfaca8dc8466432c8ac371707e6033d61a64b22c61a830b41c6306c0d84fa401c2eebd48d463387f84b85f18dda1c864922b251bec0f4b9edf879b985c01968e7c993a0ec3a07e7ca772eea013646b2b352b2b8734cdd42f4bf2b3140ddcde49bfe37ecba7ae6acbe89c34683fb3f114fa518819b04e0cc752b26404032566e97db9d2a7529e9b5095591b67b4f9ef132686565d2aca433ea2b21f82fb63ef1da7fbe521a028f783e0071c24ad35ae4335de5f7c4b050cd692dab84e3f81ef9b0e0f2c555020680efe2cb847a6667c12b973b2ab3205117a4d1c62e2099eb2313af250add21a78eb8aa33d1f1969a37f978c6f1bf7f16293fa86c0c3e8ef569d38be1690fbf9c4aadd8529e9eb9022a554584c0e4e05356a5dbc6a7ee58242bdc3fd8e4d4451e2bff89e921404362e75481b257653072a4d44e2cc8ce364ae762489d149e18336df534b1539baee1ce65b470cc9b52a21aa67d7ab155736c3b957ca3b4563532371428ba4f10c26e162bb95e9c185446cd80042a52a0a37aa4468881d3660ec965e0abd0ab29bbd4f5f66cad2f986139fa82d1391bdebe2cba8cd72ba8675107ea5d1fe4e028452f90a5b6b88be8e11574e29bd00da1682cf5d14ddae9f3485415f25299caea4c220ccc9edee4252e5f0bd68a06a072928ec3b112073df598f17317bbb789dd4fce409326371f156a737fa3e0a527308ebf97e999da7988239f7c5d5931d9a97f7d89196e206de10fede143ae70c2fd3acdb1d5b2554e5d95b7fcb4d138911bbbaaabe9f8284a028a7e4a8c1f42bc0506863d96d978fdc7dd9cc289efcfd9f78d042e4f54c53ed6ebd7c2f392b9107d67156447667f38e94acc8c088b2d65660f197a8d0e6c64dd9a69b7558e80cf57bd6a9379d19a8d1ff0c0c947ffe86585a8bd57691324f2ab52ba853f18006c469d00e0c24c72b779a90ec5dd43ed1cd126af7f1b35090398d50da7321830325146113920f053371c941019ea1d538a09415554c3b0afc3c5668532b8b6c4a66950a1c0f6a59abc99f758b8ea95e7a510c57daa37102c63237db975a195a401f6a8498b257db53c03967b127a8429c81c325718c3fbf1c8570078ebcabe5f4fa9d545f248c5734774e35ea43dc32ccda3d27547b9f71b7d11e5054f33e33ccf2716f30138a2003443640954755978ff4b7907d4d4bd800a0b294c8e4788bac1dd2d9c9ef2bfba5b601b5847dd5f65a70effc5a5b05aef510e7e12991f5f157513aef004ccd272d8949b606e210afe8a1df2c5f1d175bc69f17015014bf31c3b9d11463c1d7aad85a62577e2c7ba6cdb9526d4f5b87b7f5a5223368526c051d222673d2451d280503a205cde74a00239bf229ec5ae2586f45871edab8fe9ba1eb724841a007e568714265e4e11f27375be5daf41c07764efde5a3ccf0c2b1c19d244f6fa690ba317531a45f905ca7860196c25ba24c6d9e2e99cb7249291fc106f8457be7cfc28c151c3a541275b61a5caf268b53b932a758ac48ff21efc1a987a3b729612477060ba6b93677c00214c44b53c7d0cc343e7c443f14ae1b34fb9c6a6f2cbeec1e61a99b66f75b98f7b96d2344672a7f9776edc85a16a0e22349bb551f163bbff8a33fa2e99ad5ad79d1e85c83ac47e78b5d4de3123c9446c3d61cc59343abd97d1671454079961f594f8a9a0a597242551ceb9880435824612ef9ca56d709471eeb55043395936372aa96ecf5c50333d2edf44662dfed35a36ba08b4bfc296831f582c56aa305d7602e0a8c306acb7b14991a056239ce31663c11da0977b9a6036a7f62d3265f186ced46b76228a8b0f78d21b48260aad9126fe39ba2593144d7ea48ac0844604e751ab0b7153f2bc59923b5778471d87f73eef4733ef50049dce292adc82cc5955e2bd9a890184649a1eca1474355642d9cc1a18a9c206be2e0c39564e5cba1ec9aec08f32a1b47ac4c731b2cd8bf7b7270143d66ee90e08cbc799e28e1d8f3316f785605250e3de80d2b6a10820628e69970063cad4898af0aea07884fe348632a0c3e4399cf0ff79215ec4d68a40ccf24ef615ca1c5e268f04d4754e8e04332f2f58566e799380715468c562309fb8f8cabb2434b14e5a4473c747e9fc3cc30abf367b011359cde611d1ba6206e91a01386f4d7fd9257f8c602c0bedaa89cc1488af2f715f1ba62fd90c3c1e6a3b0e168f3396c893ef0b20182b4e93f0aaa67e3e867333098f5831c4bc02d492b9741bed3fdc2c5017bbe066b920599426222f44879d8cddaf230fbb042879e0e3e6597b4724a9847bebfd1af7bf0fc9c1e87f5e35bd50d9accf80306c226e548f04267fbda99107ea6494fbdcf0b52f125b6784f151f72f2810fe6adebe0cf822cbb1dd8540c28967840ff202760c8f4a0b1fd1605d4d312b121562a0dce0f65b6dbf381cd7fc7ee2515dd6a127785535363ef5225064ee6624f0f0d8a2cfa4a4f93cc157bd810b5781aa060251a2f53a4a3da5b4fb64834644002deb99c2a0a4399846118f02e48903b5ac20b3fafcafcead5d0ff19bbc2d1fbb6c5968af5b03c3449f9d60af4400c3c01d41c686634b7011c409e6954adea2f452e420e0104508ceb1a2f6efdc3b1981981c40ed6504051ff47e94b3b06b6b066d5bd09df938ea7b652904c5d176bc240e307fb98f27dc11e41339dc25242fd502d3e86d7e405f68b4c9f8373c4f292173c6c1b3ec80e99f59b86ebfdda45381021109702b14123a8003d7b5fef6b9079cdb3829ff83c066bfba58e24a91739383cad0ef9e1231c7e9fb52753164ec416adb185e886f7e2d115ea89d20f5941dd3b59cb5f91353b56cf13e8af9946ce04c658eada2b4454e704c7b63ea80f82a26b30d3d23307ab2f19ff931a77f650c783afa95aa2ffe82eb1df30a58f8a461afcf678822c052a37ac65e5e61266e4caaf7ae85eb0fcb205a3156a7bd0b88468a004139572754e1607e23ddb37cc4e6ea8a8be0fc184ae922f53771e5e178549e4bacfd2fdbe83f4c6e6544566c7f03ff5e0a38799f0e6bf3e7b452a725d7fa823910644a240873f4f9297e1768c96a1093ee9d58550242bf3e40eaa07bf06618fbaea6d2b349d73af0644b5e43565513ef2b9c5e0b3d87e4209a8f9e7b2cfb873240a127851213bdcb82bc56dc8109c0ec88ed9fdd456f26de5e53b86dbac7af4319db0e3007d9ccc483da285217deae43dc1ef4e198c0bff33438b5666a10f8e2940e59cc7edc1affdcd76778a48cf48f1099325e30a8a4fae5f905f9213ab8b0d9b1fbeee75fdf366419e4201baa1c335673f74fa339fc2b8d144d86effd42ac2bb0f8ad320b8fe328014d1bfcef47afaa7508f940ce5b8534439cba176e452cf3581426c2eb6616e25e51f810998e8a23e618c270a9d583f57f40203e06cd339ca2d33c99538d46ffb5d06f93169d8d5c50a1d41d9f364e5f8437776b416f0283c0fba8def376c2e564b01dda8cf87aae251ba0f45488d7e1a2ab214115e880227c6070062e02c43cdc76d5f7d30f2cfad3191a9eae502a2c52aea16183f0683249db9cc6d2c5278099c27f635fd4cc4864f97d3525c4199fac9bb1bb41711459dc0de7dbff0adb1c52261766c7509221a694d1810fd0f68c589b58700a65722458442f61ae415752663863e680573b7dc6223e69f6eb158ae65a9f25fc7fdb8f289199bd6e6410214162bf393d0e5e11b4ef1f6777083ac02f65fb52b1c1cca2548c4df955b2f7baa0487a6a57e7c977eaa90363153cf9b23edff62f2bee35236f021e353d858e492c14ac42ffae8a278185640515a67fad084e26ad89895910e1a3ca3585d5f89d99826a89208b0a7f47098ff05a0b28b2d362e17376bd0ff4c80f72e9dcba5f6a25e1cde38e0e8b1600669006020f870c3b8ecd28b4d9b52f44e263cc70b443a32ee8ccf9f71e52a838f43592d990e12ca16e7bc50d838418660fb204553902d31bdb5ccab2809fcfa8c8309be162aad3ed442fc43002227a1da15029be18dd07e1ac71d69c5e3b4081f2d3e52c119ac76ba593c294e788e97ef09d673173d1efd0b3f7c5bb119b56d63f540e0a998313f97816078ea9e58156172a83149ae3dde26e2e2c42a50f36d85183e540dea3e16c44860cab62ab0dccbadf8ae46eed7048d733cb8de2bb4eda800dac55ac5f902636d4a140ac52c548b1f98166e491c9802baca91fd3d49d85a065ff9a4aa2b23b73ae5ea17aac967445940c4103b5497f983c8cab2f9512490dc89acdf3a2c0731153b67f63223b6e02f6f0d97a2d1f911df7a75dcfadc7db2bbe26cdb885ec366b6f7824fc7093c4c2f54e3d754346a75320f84eb0f5849903728b3e3c1cb20090899c40bccfdcc8fe6b6ad595f0feeb5d3abf7f5aca18cc4c5d84fdeedd9638ca785344b59c690ba597940221197afef6603c66071fd13fa5e39be6dc0623550691e94fab0c130c5cab91324dfca4b008673e1b0ae93c7f24a4a54c11b5cb99ff5916689bde15fcca893726e29a51ee4d2a7811de389e7173382e768a2890982d0b13d2a082861b5b0fa9562561e127c3e41152ca63b8c1eb1e5843270c286d8b46923e2c140e30f227ccb16bff30942a5f06ec440dfe71f77f94b94625c0fd540b35891f48c34ab05a3cc7ebf48c46f64d13dd4cba8cd9919a8b696e7b59d70b3296dc1dbb8d708c7b5156d19e2533eccc06d6fbcc534d2483705bc1e516c437c880e3a8f7c318f3e3e3192fd3154d3f9355e84d70edc7b2de567f63fa1af9f45c6e441f4a92f6ed895001ab6def1b792eba536a12d5baa3ca7d6abdf3bd52125874929d6b8d1c54848ce1a3196e77763a3c308e6941b2fa8158ba0da6d3a55acebe83fd9b4f74b3202de2f4aba0f27128b35165ea7c9bc98802d4a6865071500d09b1f6829535ac8002c3312d07a941770424a8dd52b93415b9bf6d8550a23a7893d249f892285a5c352cab4a1d49c3bd176ea7b29e7d834e043b5168e956bbfa53caf5e9d6ca9e2df694c70cc23a0d8aa0ae38be562b910c96de1fc1728945549c431f7b865d44d06d8a950ce240c90e51f910815853f79ef6d324af83ca001fc7cd66d03bbc6a7148dc3925f70e328832b772b4dfee679e68580b0d1869f2786b0d5aa4f1318905b168929678ab1d331d055f926959257f2a27ff3275428168faf6783bcd5e27451deba0cfe2e07b1104fa5a8e446848f81f5cac7207734b86242ec284aecd7538425bb695dd81a75d26df287a7b7f048124fded2e554c84a503ed2e0493d3dcac991c429b5b57fa72d90e50e719a2b7e73040c80936582b04d209b8cdfe1397f7a54638468e8f0fa87eeb956a3b49fa0cb1600379780ea8113e2ed623d6290051dcc8d7744d6347c5d33c7b9f7620cf728a20889ec43cf4c07e330da8cce164ed2f14385e3bffe432e2a395cc3693b22fd1a7b52796c0c2f66c1ab5f5b0932333c42338daec950ba5d119b60e340ebdc403896b8a024e72a26f6296f5a2d65096cf2126b3fb5b9b17f37107cf2cb54c6ffc6b06e427bcfae8762e7b10b8954bdf56cd8c1765fa965a73c4dfd3596f1146539823194628204d2f6ef8250869edc1206a0ec2f416a01c53c5d6b58088d370f7e5b956f78e0ee7fa21eadb71a796748e62787a7bac5cd04cdfdb8ca7c2395a4f3d22a4398e88aeaa969f6b7ae179340eb1fd5133a4a7c0ace784c6e0cde88c86623fd1b477274199fab83072418a90b3d4b2729027e703b947ee6d0faa5dc1971acc55e65d1d9db8d0fa323f6df071556d1d39aed152256fef712745ccebeac8819bb00ec3adcd8cdc8fc2d8a30289391fdbbbd6cea45627ecdb3bd2345f563a9a8b0fad0f602d821962abb01ceb68b7fa0cf1eebdd8102093bd00297a8b5f64a1b8f8f9008f5ec35672bf2cf544cb511d5bfd8b66463b6d291cb50984270506935871ce132dc4fea25cb6f8c0340e5b5a21c3d38ab9fd064bdecdd07239b1cae9e774db42f6a3a737b6bdf9ea47c776850e5f99860f37039ff514ff107ea661183281134b0332baa3ec9d98b2a434bb41d96879bfbe2790255ce7d74cc45591a4c2b7a83f70e0dc185048d1a0ec0b0f44d8534f8d6110ce8e120209ffe0aa646630c559915179d64e59bdc263bd25d9a99fc40fcd6d0780de507f75ea2242ab008f5b24faec33e0af529cb8265ac0478d5860444f8e6540d45de42b5a265a0705ef7223f00e79d09141962583f4e77e4ef44398561009652977fa294e33a05089d38648c602c048af07c95242e1f439b3db839f35e3a47091dae4dc318dc2d05a28ce7ae4ced24de4c39aa6e26d23a8552f57b14fb7e6d7342cabefb98ba6acc5f31d654fe2e3e8717e442708863c3202bda67727a378cfe6889efd6525b1f195f6fc9696bb75ddff4f5d2d7b07d595a0f0dd6657d10430309994912e5fcc94bb6348b604e7e7074ad1e5743d33e0d247ae236620aac95f44c379997985dabc8a1d6523b9bb5b11a6fa5bfcccc730a3252e8ce36768b6bba94bd78d8de71900529186e2853b941f79bab89693efa3e7c0c43b6379ac25278f1dd0a6e6accc4912772130bc01a4ebad77333a26304516227f7adc7b9e7ee8e1a94582bbc15cc9f33b880fd35345e621bd6e834bb5bcab0385ef54eae18320f3a4876c1fc6240dbc2776594acb3b3ab91fea528520e03b19d1682020ee30129074e33c2d77969dd551804982085c7f7a9794f3c4b03957a64e0372b43a93e918dd275b3b66af460699460e1b0d5593c5692d915d781081b32480a7d6bc3aa950465807c77a601055094c97a2b43fdaa35832e857795fa9820d016e2ce887aff8cf30326416309fe894b26c19ff7c052a9f33d25a0b6525858d05bba490c52f6b99a3dadd1ed96dbfd7f1ba1fded3391e851b0dab3f93f74354b88c4fc20604be6539347b1ce231c62d85f7349f34933c9aecc7af997aad5c868e4b43b73b97de58240cba95daa6b1523a78057709e69dd3a1706757aaa8f4f11ddc1f9e24c2fd3b2c8cc2feaec28fc9a8c859aade02987bf47ae9e4addd13ff30f247e36cfe79ca72ed36d24b0f39324a9d12dc312d5f7d518f5dad8ee5444a49bddc6c18e9c629a56dc3b2655ea2b1e290a115469dd2cdf55c8a1489aa2744fcad6005494db86ed4d62f46725a40c737aabc4d7a9f03f9088e396a934fa6593bcb2d44658c9b89b1f1f0360f6caff2b0a0453c0c288b8ee4f32e965aebf1bb9527414cce35274be87a7094dd0e8bd3533d33efb64043393b765f40234bc80d24329c3883a70e7aa0e6c9b3bc5b428767a6e4c8d36774304a4dcd1630278e7bfc259ca2594204c50f40eb8ad77e04fc2787b815f234d1b5c044d43155783968e9cfd012e5a8ef62506afdb931628cdb5f7daac6e98fa74cb210aa3b81936f36183f7fc2009c06b1da3c05fa0b7c8ac76a7df75b88a666f0ceaca376a68f434417b6989b251cb4e32e39d87236e5a068617b519a347858a629b9868503c5193483a866fb6cc18569d5476a22794bc7568d5353ffab31a3560b853857fe8de9650a9944f1722c1204c68f6c0548643d1cedfdb06748ecadc9f4f7f5a6db7bdf1ebec5db2d97214ddc87a5f891ef7206402ec1a175f4a97fa3d3bb9f6c0bd10d66d00f6b790df7e6f3de3138e2415e5f44dde2ce6936336862c35686e470a6393684ccec2c8e24a68dd1daa7f896bfee220bfb17396f11f3a319f67f0b6095a30ed35a8302afa5c73cbeefb226fce57637f8b380f553a482ee862362617d5e2ce4386cec2a0223c28a29c20aafeb1892eed6bb227b39db2687f93422fd1942393cbc95b96156f7feaf7920aca1d85ed5c11ccaeaae2279f32f84c36401098b8c30697e2d909217fd102aba14dc10f6834b6096ec8a416535286ac2016c6f68cda98c000370f0ecb0cecf13652d5b2195433432aef80d080f2fd6fb99338aca5a316fb850fdd9873cbb7a7c6d9e1db436ad9634b2f0dbb69ee9b8a5314d9616e1e1bda0003fce5fa625a44e129d90904ba7c9ba474fbdb43192ff2f2ee4ae1c0ca984c74c48214742773c620d3efa543f8ef8940215ba37012e6eae431a920e5eed0dd0c4f1c07d4ed01fce26ca034a8f56148bcbadb09e0044b0b9a952623304dfb9151cf1a5c4880da1790c951f4a5b03a15012df4276e0cb84b48546a5429defda081e03008c8d58530eee408dc7cc3f0eca04036ba56dec8263593a376f46b80849f3e21753c0646612b31f37caae377b7b732b6342fa8310beb286c7c412bcb5b461809a7289acfcb6c2bfbea11978971d465b871e1ade300c9e58f873f739d90d4ecb5232c6b33601d0aa0d863f138b3eea8179a0390061aced47d5c36dd1434f998259c4ec1723b1b68ed427d466f46815f553beb370dbac92f1a90406e0860aae204d79f7425496a052a994ca70347f034331f5b6537026145c79303d9ed9d433ccae35dd6c5d4ab1ac64d7af2a49b2ac6b8b2ae22831357b606af3e87265cd90aa0fe9bef6ca44fd8c0d8c3cabe0916fc7e44c11b244dabecd1744f918fb5649a598d6f95c2152711e0cd27cb3a965794b2a850989eaee942fd659164633bb5288313346fda92e5268529c942f53be304c281cc7c4b1b78381cf11783f9e89d6f8339fea3ae9419a8a7cbf154b1d8bed4269b575b2e70dc41ff4c6327d06cbfdc09b9c4873145807f4b65cc5f05424676d990c50b5a801f08b700e7fa54a5fcaf8abca7eebb598f03bf733a15f4239250122e3eb97710c15676adf56787b5595a59fc54195930bc88ea28819ed5401955c97932e11395a678f85f87ff9cb5eac6be4d9a7363fa98cecf148cc009c4c7356609b9c302bfdaf60cf727824781df32464a79614b9702e9a85fea436c8e05f3395d260b4f5050e86ded20bae5784bb69b9b597a211fa22335c885e18892e1397930962c1e2a276cdcbb15db3d7548d5f60be252495e2f71e8c234ad898beb2f50afe50a880a7fbedab4f197450433e9328fb7ed9fb75ceb5060e69abc51dfb23cf97888323a17338d7c2912acd7eddb2c0288eca68ada8e1a90d47f191ed81f7b9e770e0ebd773894b92eedddba3cb2d9a351a712d2b51b5a925d9f45a11539cb1579770fedf41566f53a5ba598f200c5b6be9913ee44f7fb62e75cac5f7273a6c6679d920f3a8d60ca7227d8926cd267157ee9a8ae3694f5df736d66c10c8422615f662beaf0f56c402187febf7cf46cec5e6959d2184f06b0bd4b8a9f309c739b71126d674d49cccac75e91b826c89f017f4b055ef1c3877a0ca7bb958a0b530f5862ffa473f7cbfdcbf48b9488abf93ab20355827350c8c0f94ae7424c3d1b787a3bc3bc5c6db6e8b904ddf91a7ecf55cea863a24ab9f16237fb9f7df614229e0001ea5b255bef429915c3c6d3f9846fab6938e923cdab381f423d0636ef871479eca25ea77367aab928a666f1032a3d3bec6ab99179ff32323abc10e3d0d3a9ccc4a6c26c53def41f773c858a87b0b25e829f4e5ea8b078a41e1bce17a5eaf3c473e73a5f74ce2341f535e1f2a391071fc7bd1a308b6d910b2a217a1c1f264500c678b659d1f31933afc25ac322bb8bb4bf14a982720c53cb230991b0a34a7f1cdbc9d6ee0975cff83d1f4a22f2d9272e8dcdcd3f09029f9d604c8513ab73f02c1ad2162ddffa6ecb3b4242bad668d4241b48789bf337aced835dabae0ea25153ae04a41a68de7d93c86d4bc52a2fc4a9c639e797eb975cc9dd8ef7cf2bc70e5a57a88df41027d0efe672966cbdd13a68ab88cedf9814c4fee161b7bb5c0ffb12a8f20127458bacae0be9b1f035c40ff7ee6aed68e15697bd4385118c3aadfc8e2304dd2245a97b81c219ba828e9a7da722dbcfa33c6e738a0dcb035cb016cc32c72813a72784e32309220eb0ef1f0b9a27cb3006f1dd1718b0d775c4a87dac90e591e1640df7498e0029a2d453b4a1c9a48f9ec13af787790886a01099888b7bbe59305ba81c12b3c3357f724ec10989f2e2f47ea3cd784ddfdf358ea2caeeac4f5d2cae8a26b3d2450bc4c1c42da993d5f645c3707de41302531f9e768ad4dca17bf1af96eb341d8768fa8f17ac8777d82899bec8ce94ca2446376ec936a21a6df2e488089e15babaed43dfcbbaec189a1f7aedd484426377271d0898b545c1ca6917b032fa9caf4b020c2476d1fb40e4e395044fca7bb26a650789851f3a08e0fed3d71ce02b0fe5631847fe763e6a93861178e7252583950c0e8dec8fa99aa72ddf90d492861d3c4e5647ef294eff19cef405d3d183b837723b0966cc7d044df870a0f1811ba83185b68ad625b8e32563ea121bb7e9cad2a52ce11e751e12a7cd44745730e17f7cf359f4bda9a4abaf7e9d830754817a80b68718e888a8576d1c8478e5ce2856a7cc451f2e66d0723a93c6c029c3340b4ba1cf5841d5f6ff04a32d7c201bbf978002a91569d96e84d51f7eb86da4b53fd83a11c39911c991824786c8101045254e42d183af373aeb921b5849763be0e5f7c8833b931426cbdba0a6c892bf8a61774c668376f5a040cf7d2278d0699b9e6444065052d7667c787e8ab9318f2c1e439db6253e160540c1f3f9d09c6e58fb300aa65ad21ababfe971583ac0b8aeeb112273e710efc5ce2012a6f28e084c9f4c709c5fe5f668fd84366d0e4f560ee558fc2a3b91e1d777686eb6486918a81dda2f0f8506584232e9667b32cf8a9a288492cea357562803d2337868cfc33908384cc0e1ef5f8c3143acb1fb6189784429479f4e420aa8c6b8fc9be4ca9ed21aa8c6f53a83c0bf998e29fb4024c5bc1ab9425fe77784f50f9e7bb2f8537fa29f4af49c5116a68b588bfb4e4d1437cb66455cc90f028282d4b4ab85ea43695d909cbb1028defd85478b17da63fa3e11c5d9a25cdc36186752a2376be328efc96a82f131f902c90b8ef80bdcd0b95b439810222ac2465e6ac24c73e36408e69d5147c9daf829a1d05fb30107220928fe7375e9fcc0c5abe23c08beb057aea1e835dd1684aa948445114e4ed2eff42065ff49b230f7ce1edf3c4fdf1e45153d776c4eb2e6912e39e322a985f370ebf894d1cf7ea4a954eeb186c9869d19616fcbeadd94f6e0ccbf0d78f6cc527874366f2d0b913589f9c31226d754b7ed51acce1f9f77db7f8717407bec6046973d7c1d11a61cb2a006fabacb6aa6383400a0d75e27f86da22408e1b12744cd5f6343dd100d1448d447da477e037cfe67a3c85d0cede216cb2f6bd7787ed65f6539a91dd6a14b2cc00e15b1fc503bd1e60f59872fab5e7d1f048148d1cf65e71641c613508c885164b38a26e8660cd54460558bc1623709a226a909c9568c32a68671d4b60e1da696922f259865db8a2a2aba816ec228ecae592ea21f75f073328e5c8e0c88e97df82697f70ca5a0639c9ab057cf357a4b9857910b8126f746668a697bde3944abf0ff9b6b0a45527e4eb777d0bfce5d3a18757cfc5ab5dc474c81195b7a0c4f83250226b104347cd0c01fe7019bf279b085b20cf8bf64ecc820c7292a4a8b24b837a010efede890dc97e5850fd5b8881adb14644bb1cabcfd8102ef8b947359c15dfe55c5335e55d784bbea5b889bf0c34f20795b629648200fd467d919ed6877c3d98ee2b6879bb7319fdb548f03985e0afb0f1fba38e360d1f36c2d9acea0812e13f71e65a3d8586286a98e5b401c27f761901026eaf46278321e19370a0693daafa36e6305eb0510fba1272f077fa4623d74018623e49a84268978734e456309353a303774973e83ed45f17fc1603856c360736dca6956090afe3c32aa343103f5bdf95b1175770800bf4afca991c28f68dae0d42518d2807bb550b2fd2f1985e446af532efb0fa5ccb7130e26982780addd4a585bf3fce0c57e571a96412543178f2e2642c7d466a08e27cc50a2f6b06c0678435ba2662b9906f97a970d14f7a3323944ed89d5877bfcdbceca75febd9671863f261d7d3057be3b8c5ab434975988a852f85d56ea84908bb727f5856ac51e9f2b6dd61871706dd36fa2fe6f8b23f9ef5a683e9582bf4226e0c13d25fd33f602ba423413c61a4f8c89540567e170d2222f8782799830acd753f0f1ebc646fdcd075134f14e80d753eb21e31f35e2e05f83e0ba5b13b996021a25d24c02fcb763a64404b853e30053e7c7d82f4f7a2c71dff4ad3647e3200036e033073cd6219f2f9f945c5a467da4291507a4ce8e35956d0463ebf7a8fd32488a8798999c4338e3f1d1050b95c333eee1aeac58800cb303183d0ae7419d3b9bb8d4e9bf9bba50271b049973e23a5ffc967af9d74c4b6edc5f28ab445ae8141468daebd91c8c48960dd3e24a3e53c3a11eef66d64bc6c92ef2067f8ee43359544731e72a9551b67edd58dcfb70b0eab2b2c5d33399d3dfd260b2f3eecc7b2e14b74bccc6f6160e2a3e0007b36ed93ffde5f0e05ad0b9c4f9c0ca93ae008dc044b55857ba00daa8e083e3c7bb34ac6fed511f58a411268a851d9c9228205d4756d0fe423222a1db50e5a97b2ca23b06fd3a60970548c76e919bdce2b4cc0c66b098279e074de2753c9bba84617b405ba380ef91cdbd43ba939f942c733fc813a8b9fc88c1e2dc7ab7c29e70a581253176b6b199a174c28b742caee5294b468e38b1634b1efc5d4b1486e5c670937aa0e2b36b6ad90e8c9a14ae9e77db34f6e8477f590357208f1c7a66226481d7ab32885303266723cf4c7dca4eda3f36c188b2df4af4ea6b943aaab00e44e91130de0160ee0706a21f07acdec3f10d5014333564188753998b3855eec820ca149ed7c88432a104b75cb113bcd8d809500d98b1f7002e46482aa06564ca27000e67d31c2a6d0aa45eff554452909db314344700e0a6a713ab86b7d41b2268f243b8f2dbd83cc4627f1260de641bdada5f760a8e3a7a436e596876b6ef317e6ab348914f773becd5dec85ffe34c2ddca71bd734b9ea29a9817ae8d45c8eb0a19bfa66ef1541cc90cb0dd32d1873d4c3bd7ee81d073416e95abac6e42f2713d89e62f73e3fbd9c83c6520b63303960b2f794ecc29f22821f9b7bb8ccb69b0b0887b607d7246c94b46ba3286f3cc7a37dcb9368c5f1b9fd2da0ca146cc6d4c9b58b4ce22143785448dc0e5b4d75c7be56a87f7c89e05c8e32553f83763a231b8eaa32edab1f41ec076098041271e2b6e8c89b4b25827451e35edda7cf39909462a0905ad4ca4f5f2f4383f76bae3d186ef3c1b60585f410ddb0c571a476f1b3b80204e6bb30482bfcfcb83076d01d6bd6bf4346443dae73d6d2be88a36b27a175ca82b96656d0c190c20f6c18d32ee5bb0f05f272d84ffbddd9e0fdef544175b443fc32e79b3b37d3e1d8b8d2db77acb849b36bdb80b651f4ce288571dda11e5be5668c45faf320f16503bb08534c5f908222547952ba966f5e7d920e1e862c8b03b3f9d2621b337f8b413b4d714ecc7b4b806df19367c8c64cc0fb7f61b489e68e2ff41ce0932bd3dc059d8e6b9da382dc3006952770dda86b1b0703b3e1a2680d46ad9828fd26299b983a6dd5e5c73bccb94e5760ce67fe8097a0cdbc7942690ff3fd269747be5a62ba8dfbb71dab142f1fa31626778227005dc3502b830b3fdaf9fec75f5850756bd81c419d6e3b6205e4e2b274230e057953a66b021cfaee2530006a732e6899bfa2abd81834e4129e9ae3deedfb123027b0f65a1a2d11230ea80474b7bc054844c95c992fb3a9e0481b8a5d9598500f28f9044cdec4e52a6847ed2b6a2e95645b984dd2c74640fc9dbe7246b258dd96588b2d0e2ffbe9cac851992cde51d1769f3c679dac83aa196d2827fb1b22aa47e31841e80edff5a0b464122e17bfbc5ddcb0c8b8b936331964c5397c089dca5ea32e1556d62bb0f8be9801b98218d0beda7f15c97884c99fc5782112093f587420dc5334625c7bcaf0fb8d5caeedf7e0500d4568e2d1ad13b280f30621a569f3221eb49ec8790a89871e21e6bb3ba29d9a4a4fed30654f39e3fe19aa7889a6a147d8b64b7f09406f389a752b581ea926a3b235660a2c2975e0dfc4ac7b0446cb8694126940b94061009f05c13f9f1efca154f1a74ca42c134354d3523f73a480c0528bdb79acf1b1c4178310881fdf4a3645b820df3273b83d960f5825f631a26d46393742e154acfc4c45eb6900269355f9c1c63d90d2d371aee3ed202adb543bdb6260b87b858551a45e432b604bf9206d1731d4332b232c9350f022f550f520e07988ba177c2de22b006b4ee50fc8dca5af00943fdab51c7559289d13cd2338276ab120755026eb5025317c8ca7dfaa59759043f099c52a0c8c1cb2a98dcd68bdf3c2c5c1f8ad40dcef61693b86adfb0879d7e50bcce3bb19d6cc25d0696474790d9ca3a021d9498073b506b76168f2163a4e7b83052a4866a737cb208844d9f11ddd49482245d942a7bb20b0daba44b5eaec837a4baaba1ade92d528b6dd5d611d7f5048bfda6ae694a0074a090c105842d88515ae63535e1671d5213f1e5b9be9e1134a14d228aa34c6192fcf427d3fe0ad169ea72789aed6ef1a74a0dddc94c0312aae0311c573c5785343460d0cde33edd67b8f970f8aac176db8597ee99e5d909e70d113980d78d7bde1c03d64ff5145a8ffb60fdff638374364860b333a419b06a2b6a4d2d7651c4b04351a3d6316a5f5022a7a3546d198490e7c109efb5bd006870d4df38be421e91ae6888d3ecacda4f768eb578492129fd0fb3f5a143d9e5e97e31c540bfd2b35df294c665557cacee29a70b306e35c97246ee5673b125490dba0181174e772f0f00b44d644935bea6e08f16e8f732d4d2ff380888da43acc6e621da6404bf4458b233ab6b13e1dd71fc3bc705535c130c2e87830df5f9e0f4c28173b441c2a5e11fec78f6dffadd7fd9a476a7913f80a2ecd54efc2064b2d4f8ab83a992d73f648aa270341c5146a7b1fc8e7cd73077873df7c4e8196356cf2e3c7b3e2591c4e35ab970336759871c93aae43de78302f2adad9d5e1b5d2afcec98d2d1cbaa79d72dc94f80ba0035bcb2e45f34391fd1ea2749c16e1e0f33ae838df67e3f4c82b8ec1bac14379f7e2603bc633db9364343dd26dd3bcaa7fb733c211a925975cae2e7b0007b541b4edddaf046aacbfce1839ae2edc08aff9562e6cb69e72d68fa66e53dba8ef1e187428ed8f70dc8193b584665ab77f54a76b7e7b910e96742d4cad08e4fa8ea3bd480914b7a0f9dd52b86ca35f6cce0444ec6ee5af62aa95e865cdad9106a9454804f8e64bcf0f788a0675956d185daf5b17411a09151707385798f2213cca34dc566c1d3ff0f70ec52df12bf3d7048c85210d4eecbd22fa847babe55a219767ba15ca0fac4bd2b8db499c31dfea5d92fe5ea5f11d3a031aa2fe4856923a02c01bbfc2ec5256c6a91f34f2da1f3dc3ced9eb73d590b7ed7626d5a4831aaf5f1ec93f5a15a2335b2c066409d488e151d509ac8df79af68ae3587146ef22a2049808e800de8431e7fce89d0d9a365cade3e5c2d7ee8009513ea366aeed8df3d6c83b848454eef38f5796a9d1314f2d0ab7d39fd7609c87f8cdf5f2105ec41d2ca7a2446e93a41e4fc252956469169f7ce4b92961a226edd11414fc18dc6a6db020d91f4d9395abb3147ea4ebff9d2311e07128cf5cd6d24150d6f547a7dd7153b4b6959cb59ff4dcd75010d728443da883d28b4a3f6577f75e96e4be72ba726ab4f93492cdeae98dd5a3bf93e29b11b1f492ff78e145c9a1a6efcc19e9d2a80fcf2c4ca41b0af7d25d028308a820d8d21c6fc2d97c2bd4a1ded9597177fa7788c6de371e84daf071a9fbeec69f0dea006d4bd629915ea36fe83a3995b9e50602f4502f35d79b9c6bb45572a2d15cad756239425703d69557129c15815ee1c72f410ec80c0af1417d8e68052871175ac1c29caa27a835cc9c3b8df15baac055e58f808f17e967af8b9b8d1915502271c9599d1e8f2bcd336b1f9479279352722246e4d6b84807e48873e63032df27393e7ff482f764d053dd99f43689daf1756bf5fc3d3b074ddcd653c7f89003901e2b2a2edfec84cc73d6eadfca4e0515b65ea9de12c6c5be39bb3eef0c4c939ad863b70cd3aaf1924ebb7ae37fa762deabd70e2d1e150b4c1a7c7e3e8c25ec85cd1930bfce18cdf20ef5f9524cff33d22f1ee12630e28847b8d2bb546cc921d57dee3a2464370c6697e7f63efccc961bd401fb29642cab44a81bbfcfe12b31b3d6df1890138a6db4af055a2275eea4669f9896845400373477a41a2026ce42fad866d65412637052b6607a82fc58c45a84a3da3eab96bdb6e90695dfd5423dcf75c3363935cf89d206fd836ca901908aac021a022adb479ab9ece02caaa7d7584acbf149dbca4e1a5292f850ccc26809d37c61a27faa7aaff0cbe7e47083825778135ca273d2f163a3bd0787d5a4dbc8671c15305bef354f5bf8bf1f0fa0fe6db5e1e15ac3691c9aa81cfa9e7d4cd8acf577798b41be231b69f7d43def58a16757eb17e8111c26cd4395f3ac27b8b097a69dc4a45a5f0730298fa966c24e2e1bf52de631fb5ba08a1d2d659a3cf6b683c803d4643c8aee324f719be0d57c889f8d2040b0eb958b914dc3abb63d43c9d6da69c5086c1188a13800781b91950346ab533cde06a47bd0a3c743075005453436dbf597cbc2542b8a766e78a493283f68804972ca7a1706e0dbb17e081e9e6e3393f1afa25a380c0b37e2a2e34bdef2024ec0d0c88e14f139d2bd912e20d1bf77f89e73ae2c6f9072572683695ca259e5b580db9c19224d321640630e024660efce30fb67334b4ce92eabc5a79efcdc3eaf85cb60f04f1765473b4f9f42c3b7a277479447d3ca5304fd238385ff4053d52932b29fb51075ec8e4193be0e5188bf6c785cd72806ed880f59245e0907f5281ef40796dc34e4305e244a33fbcd5b78d2737786bc75590942f1e36547804b642c33c52baf9a81942eecdb0bfd5e6b7c80b3bb2587b9600f7a4c242c13c511e70132685efa8e727cd3ff0be4bd2ded3bc1ad6f1c4bf6e346bd14ab4ec61cc5df8ea91f30ece90907c31fa2b1c4f4f156a60105624771ba05cfd4ba5589ee10af1581b1cdb29feea71cac3c9c99e3d1deae0ef7fff13db86111b30bb7a492a15049c740cb2384f89e458ac31a92356f44886cdcf4bb40ca99acd7f2737a9746e85511d0e482862fb1874b6f20dfa8591183d44a2efb9df5aac15fe094816553734ef15b016d546c55233b1fb8645b58af06197fc2aabfc2ca81340b0c504ee5f00d0ffe54a27e115fd212b605b71274a20fb7fc3df2b63a77a6e73c4285038a7ec5cf814d461ee4e324681400cb82fe71f86e75826a51e1fe4e265137bfaa80074d918a12bb2c64ea80a5cdf98d560bb84a26ada9c17b365c4a45356ba499eeb2e45c88e9a0c79e87e1a153149123ec0a267c15bb4644725cff390535ff1ee921dace5b1224da9d37214352bf8a0440336eff837dbfd65c3c04780aa9f56bdeb766c97342d1dfead5135c8891384f49111a89e2109c596e9344307eb1b7c57fb809b2855a8d5c1ef55f73318ea51095331afee9c5c1dfcebc985c2d2400e93519662d92a94ffb63764b3e57d8065008240b6810f66ae0525b512d36e94db02d286110a61a73a2bd21de2e11afbf101976e03619c6b77aba2573d15ae5168d374fabb3e9a5b31041fad8ff3fb5d88783988f84008c31e449ff118dfb0710cd8d1db7c689f5d86edfe05634216e7c92a0f467dc9a6063dccc78ceb35895c9a9395e5d23d0a9d5c9697e6067778aeaef2bffd7d463226afb5f57cc8ce7135f137d969df826e251d1459431daf9d201c0d7c6ab8a47b0f67fa900059a63a4d7df38d75a130fa082f5885460ba99eff82c77eb660e16f41bb62758ebdbf68346af3aeb0459e45d0e3f03b478abbb7f472eba9962fe2b29569d5a2669a9a491eb0a9c3d3b287e22bbe2f81588aaf761cb3e3b283f6533c8a83fa5e179135592e9dedf731fe8bf8e4b15c1b0dee625b844ed8f955c6a1a140455da0ce1a156c079c1d1d6a225bb439355f63555d777fc0b9a9207ac24ca7a3b76f393f616a86063c6bdfbd4fe2234ed7370c7d7322135867fbe49dbfbcb441be0ca2f95dcbe3f2662673c9d06792d341698a211833c118779be53ce019aa92aeba9acf86fa5374d0acf679abf0720f815d357c86741758a400e5662e871b31c1fb786e8fa3cfe66b33ab8d5f4692119b23795e41d0900131b1c98d79bcefcfc3074e5ad7efedef15580a1a68de2700eabab8a190fc2b7cc9dc59e1153bb9d2cbbb0d88b7709243c8410575f2741d98e4b50048e9157314746059bc61853e546c17a314b10a7f2b5b2948b6cc3df87759045b904ac0f0b80bcf983d270eab84df7e3765f028c9edd5281c9ef9e0269d45d11c0a92795c53bd52646925eec7947cc968c283cf20fd1f0279289e41fdfecfbeb552648a1d14c06fddee92378ea5a8efd5d7f3030841b8880c77db2012a6d7082a7d092a808f157834ef1718e251123dd4faae2894dec436b37e3cadc8eca931ec5a946c2bdec63c8ddd8ac4f7051203eeb7e82197fbee24f40cb9ed0b44959f337192f7ef24bf8d25c9dbadc16bd2db63fa8b909ebf40700cfccb27720ef627f88549ab3e1ae8ea0274bb71648c4ce1b6a23e40e6c61c363ff28cb7a3b0f2902f1c8f214310fc6fa59468bad53a10530350d88e54cd4c6bd76b83f494255f481474d1aaa51e9c125b2153873ed84b3ab7b598ea37caf8ab73cce111a827ff38c3e1ba958bab3e87b0480f29a9040caf5b17cb0840a230f93157529c8eb4ae96336703d58a615ce763dcd8c56df4edcb81d0a422ce51d8a2eb341cbb56dd62784396cac2325e79d1141e981b67ee4bbcc56bccf36410e64f9985b894bf004ac33c4a092d9bcce420c7414e3f4c3b14060956168a12f69a3a01c97b5141547f6b62f83e1821d86d0f97cb8d1a32dace842e7aa4f4b834bcb3d737c36b8f12d8b5172dbadaf1e9d02a6f3bc151e9606bd86d8415272b08f564aff67549d3cfc6e5db2a2d413cc7de79d628fc0a2cc46c0c184d2e272be8bf531fc6bfb0c787ae98466175fa81597505346b50f7302f84784589fa5827d41ca2dfbc671404bfc5e5641c16c0852722995ce0e94e39be50d201071687b463208d51653176406f63e06aa9417643a89ab662781b236df58b6a9cdfbf54caf80e0fcd3f0d257972f1c61d08e9768555e5081dadb63c7e37425540a93473d07d54c52c0880469b20b69bd22430f9d32bdbf299df3c9ce81f2c47fc58a6f82cb96ff9d9273339c31298cda39baaf595a7931df7615149ab05f0bf8a27480c859f8daa4a21658c2ce6502f8e243a7e33ede8c19bb95f0bfa7e3ea59c8b39aa03f6edea6b56d72c5d5bd28bb32186705ed868960350d4ad49f7dd29ead38aa340b52d41970e4dc4f178597baf572e59b643f3e7ea951bbb526f4c4f55e607a1c4c4e1537d5990017558f3863613eb636c56a505e492dfb7892a18bc44599017d879416ab67b98ec4d1b67ba3eadc7d4e10f785e64bdf872dc31fae0ad5f2906713b1868b9ae9264bee73313d872a39cc955394dc967230c138bd062b8df84b36cdaa69c534431224d321a67c3b711c5a0833cbcd94bd1fbd75d3b592ae832aae7a1d921aba0b1df2fcb2eb70d9a3b9e75d8fd53ecab153fedb490a74b8e13f2567991121954c3d85afca7f99fd404ac9683b91e4bbd096745e68a07c732ee026c8ca98f98ec4643ff879b49aedf46eb66bb798adadcf0a02ebf656225f91df0f62cccbc1313b5cceadab6ee3bc8a42a9201e8a6313a51f50a9f0926eb68a6c7b8911c10c2e25f528a1440dd4ce1800aa32003008dd3e64c7cccb19ae7d318d5ef84324dfd6b22ea39473fafc4a90808fef41dee8465f93cb1fa6b0842b5b2b726cde9d73e6b1a1db4924a4e207cf86355fd4e7e02059fc2a009389608dc9c81f0d307e6113abebec1145bd2e3cd47b03c16e7985e8d8c8bf3ce51d6edf8f7da33feff92c3a4fa72c909dadbb633374fbf51386cac7553a457c7807d2336c5b490e3310cacc858d5bfbc513406ac5ef557258afcea4c3f8fb558d3dc004ca7ee11467b67afb28d7e173421a2800dd58beb66a21bbb517b4826bc9c75ef1442abc5dd75fc2fe680390e45acd058392cc317c050f4780c521d9a992fba2f413ac7557bdd437ca11226fd5a3d91416266c05e60fd8b6b7553214e55c2cf8824c7107fd2561f068ef78571f61c872d69ab5ccd0e86745bf609bbe34664c2a38d74facafc49da1958f26c269261ec7c9cd61f634913b5e043c7c753226fe8fd38df64fd42a12217e8b46789f9da789a469322911fa68c9e877fb813940ab89b9cf52af66f2f3312400a87143fe727f7b8f9618320bf2cd54c7b956a4d79ea1cd622242c37a6c89b4642cf837a0168d46ace58d06d331f4c6702403bb128267a5e5de1f156e3420a977829b4981d2c5c35ecaeb0d369f92b4715112ec769bf26fb1d232fb97ec84a347a6d4fa71b080d137425f2a97c24d07e4187db8bcdf98e9c95c08cc621402123d5a5c2c8e45d7b88d581d19d3c52613dd854cbe4b1c316cf5b69074a7f618349fec541a5a08b52615e8fd3b878b91ce4db69c651aeba2bc02814b7ce3cdc3f323e4d706d2d954ffaab91c6bf45d12aaabde05050df572e9bc797614bc2c4cec4178f5edc79d7d4f44d2dd21c993a1cb4a386d519c99a089bce4d0a9815cf30bc541225c8b8a5fa158cb420ed7afdb8a229140d3ce8b229976da16e10aab1e6f1a6309fd63df7750fd84f5e603af75d362c7ff6c85d6587b9d418b17dc54eed88d820ab0902aacc6d1cb19cbc60e7e6266d8afbf6c6af0a8c23848814b4ecff93d5dac43f5b7fa8c9e878011e63d02b49060aa9ddcee515cf430f6fc100cf09f3775baa75a4d0fc03272b4c16e06020fe456027d92d089d62f56dea934eccc644865d59e35e2be41b25241d86d8f1a18c5936f94bddd213a296e70bac6225921899a28565869e0d0f1a498e96c06331b8789dee4e7c5c88c3e9f44751da992d5e1364c41847fedd776fd31c1f9fa061dbb21ab805b64e8df2abb2570ab9d45071437a75693e3526ac6adaa156f18ca043bd07f7b3517855c875840ddb08a56198b3ac94e49910ad1b67f675c4fa63f6612b0863f94e267445d62bf4deacec53a888afe101ecffc5f172bcb639584d050458010531ec6dacdee27b1a69c91b75f6ec491c9357d1f0658ad095704ddf20ecca12ccc769d59dcbe47b998ef3a316885b2b7ab4ead20f57fefd94b0774710111cf8774d70d179e6fe82da7133eff9d69756d99a6a709113788c30106f7646e393dcd34e57f9d46fa54da5c1a0ece1e6da2ecaffde5a267ebf0d482eaffa22088473473d32097c9f61189d54f24e148b5b7e005ad3be3ce4a4e20a3acca9fc41cc9347c64f82177eb2d0d4b5653b6ed7398002cdab1bc8ad9227923f3340adc62b3896553dc946fb2a808678ada92323c201a2a0e6052b22619ee64acca86e5ff9b07f8672827da3f2199a1264a7d0728bc4e887509e715b2e28f4f5ac6e49b68d0bd849427dec3546720ef97949fe3c58ef200613998de18debc55fe0c362d3dfe26ba463c3ed7239cb32318b4c9c8dcb1f35fe5fa61179d129107a892dbdba2d5485b9a0a930ec59c18533e265b4672c9b276cb102d45b9327367c3fcb4a7f31ea1157dbfd485718c86abe0c9becfaef1d97a5746faf57c80e0bcc668acfc459d3a8c5d7375d8f7979908fe14462b51930a76b027e814e830bdf5eb0f4e864514879e3d8b7c77a1e98bf3f10287bf1c345e20faa2dfdcafcf84d72fe101a7a10f9f4ee80463164e1e955868ce57c293ed6d8a25535a91f0556fbc11a765a38bd3373dd4d8f7fe137edc564b28732728b0b6f8c7e43a4c9980ec4befb1e0a3b585c97d67e73a3369e6971a338780b5a51a5fe9857800d26d160c06c063dbe822eb134c13b7c7e4ae7ff791173703755892db79a3529fc2ef96b2c47d0373800f36246ad0bff7bb5230b7b1028dfd9d098e8f7cabe4f04027d080d5e7e792a6ea632f8ec375d0fdd9995d0536510f453c1aa4d28426033901460cc0f0611269874d3658e942323114798d2740d08945c8a4c7bdd2aa1db948c7db223b6b9ac71ad8dc2d029c440bb4776bc5c3b0162427c025f9ae9a3d9053184b6e6591d8554f86a33dc3e16768c333db0a737092a0440f800e1c88449cbc3767925d74da4a4645935e0efa167e54f5268d6add58f2772110802a052c4a3bdf17928e1b0f84a512fc0dc1342cea934ac7ddc74c71587c4f5af5ec14e9d26016239054552ee23ecc9d38c6c1d9213fb4d69aadbe0e2b9d74aee74a663d7daddeed3ace332b981c66ccb338f4bf3ab9626bb096b83d4aabc06764c7999ccfb13a25ba015ade582dde377194e66b83a3ffb596c0bee53f42dd83f647f41dc5a773c2bcbfc60374ef32c6347e7eb7691ed9a6810a37c30512b1922c9a77284b914a3111c1383853582279e0265976ff1add5bc5dacb94ec87caf0f261e85a4bb69da0d3b72b3e92063e597e4eb465fc4667f5fb8121b4bf415986f635271ee733dab21e05449fd55f35e5a61a662558e48ac1d38739c0c95283420e645a053c6f0fd335b5b63d4cc3a20b02d94a1e33af108cb7cd51b0146c4a2203d139db92be463036fa48866578cfc7059fc00dd65a78a2bf2f5031ecb78bc4ecb623be44b99bcde1497299a96a391e831f0556ba22ea348a0f252ef65fd30c2cc1ca4dca724d9d63487ed8c38625a36216da0e1f31694a9c2da615f1e1a9e6226fbf2d8e18ab971c91ea18db7783da1f19484f4c4726b3354444ca20a2aebd5db251e87e637db39f7d5609eacb75bcf7023dd35f327d516626bf9ba742efd45b36eb170c3eda5d9256b5c14c4e97977e03fe322d89f59d87aeba2690ede01c74842e410cf07144ac5058a2be68ed5ba6ead1866a870ff262aebf5f94dc28b6fb23abe70078e780478ee9f5a30233c63cbeeef2be0114eb7bf47e43f2210a032a97faba001e58086a615a7f8579e0046dc08e723b5e0e5358116fce0f6636498bfff01885cb61911d5796564aea85ffd3414f97326b8dbed4c6ed34fd4c2cf29d23a55bf15b2290e1ce001ec0d2cd5a3cca073ee178902ac119490cbb78fe767437efac127621404cdc686ee0d716e2777c579a38481769dc56d048bc424bc67abeea1233d56017ede9304b973e5f94b5a271a3c9a216e10190e40f303ce4124596e32ffc46547a5f5436fdeb13722e568b59f85ba64745e9e73a0ccbb7b254ff20eac67573e20a9af93673daec3d421bfe8df5ba5ce4bedc51b941dc318dce278086d4cb9cad582952edbebc9b8ec6a3867096e5ae70d4d02305853f0e894e1f05dc9f2fe1edd71efb51e6aefe4a6cda62039b5034aa858780ed2e5dfaec07fcfc1efa1c7d1b94c8d3defdc60a7bcfc8e7a86ea958778c2cfaf1bb86f7ac5f402b0c9448808c8607dc042cda206e6d845bb4620bfc90aff4ff37b47f1417b1f36871c45eba91f5bbcbccb8cbb06a0cf82071d1bf6e62690582cd1746a55972d7a036edaa7210a7791267b13aa0321ab423014bfdfce2d744169e35d0c5402463ec514c9a99730661146d0685eee7d9e62adda6e4edf371d30438dfd591b0a3312b6681cfb23c4e7e1caee90a759c62c8770f634a8f6c89645c2e9d05898986d2ee1897169fee4833b93974f1c57d36879f1bdcad25a78855ca33fc9c5be4b202486fda7754c31c856434c447db54a86366b762f2213a49284a42c24adc35aa2127701209fc4158c854a002fe248fcb2388093ed12f9046c9f327cad858b42f1469ea8a8196f928b2dbe9dc497b0296415d8669a3f238989f494f29b8c689b26798ad3575ba83e0fe5c7145415b57726556dc49cfa60c42881ddf31d3dce31a95335e34a9d77bd2c5adeda9ea59bfa0e71b55e53fbe3c0cf3b40796afe9a8e4b2b01e14c1d7f4db6d8ff7bec90766be53da53b10ea13d54fba6af6a54652ff95a357048184bcef0657624ab4bff65e90d8e2bcee951441ea59ed8c9f8e084f18a31be26a387676e12b70cc63b33e808bda18debe03b08afeb92cffadf8a9ebcf1dfed6810dc59e7ded511baf01c939a9e8e32f4ba63e13b3c5407d2236d926e95466cdf4b980a60d7ee5ca6c96cb87cdd814e8bf1ba0d0d89662496bbd2856928b5e36ad00b601874fdd0acbd628cfa352c61e5a39343905c286f44d308be9adcc57ee6d5be2fbfdd9f0fff999736ead406139b96dd138926ab767f6d708abe2e62274ac46214ce35b515daac871130b00487911267e687fe4f711e205b0a29efe4c975ef823d28f809859a4f8f82eb138ee73ecd48940db417a20dd469224e433ba6a2a1c7c5c07a4c96a1daad47f200ddde19c71786b629a87155856f248954a644a2de3131dfad69607ed3904ab0a195b2352c4459ee894eccd6aa3d58a69cee07b04e941c38d42a621ba66bd6a6f0786803204ebdd9958d7b4cdf1d7a2db7a4ec3233fa37cba1c81f4e3140bde6b69a788c056ca638fa36be2540a1121879b8ded16fec5858330f921f3f0030b6c1ac19f3489027d42b6fa2e2fd2012eb7353815d17169c032a85cc7317d8569a46395727bb5e7ebe0ca07ce0e62a47b134f661998bc60554bb605c1ed5975b8b6c63b15dcd9100e90e9bc0073903923fae28e3f78ec3b80f038254513f85440d3918de3d5ff8d45cf71b8ed6ba932358f76a27fac74eb612751f10f80cf8ef2350a519e8b63856123f24fd08a7f9acfe87d9a9df7f7e39f09f97112f78e6f9506f8803ac4755caf6c47bf11fe7e18ebca4f05e4261c6b859aea234a9a22be414ca0c5895e51180495195168d0e229455884f7080301e865f2ec30e61c3295214a59c8aa657b39a65b2ac26148db88c4405d65c93dc87452f554bea2a280271154b4a7b5bb58e1ae739423368779ff69d4ec4e83f1f9df6eb75c68dc6138f5ee4c8988fa00f2d91407fbceb868d227debe891b9442837aa9d6f1b093cae01438c8efddcd8de6187fee2350262d09dce0853b46758ba55f2c6b904dce99df54725ffbf41a6c7bf56249b7489a400e1bb12540be8591fb9921606003093008063ee8f9533b0b4fb9f4088b1e3685261d6e417a194cfb493eaa53b81e3ddb21c8a914114bc3b3c12e71e06eae803c6da881f200c68d683b5e875f26936acd5b45955237052bd0247295f46f2461ab97cdda6ae03618efc3dea94d5aa1e17a643a14b2e5be310118c9e621a575d7dd6291629241ceaef54d127da8c74f3f2448511f370f25ca42671943fdadd9094f66e6274c3888d156e9865871edf943c5a1313e81c78624494b0de242c79a9d4fb3562d99b122a857862bd7e0986f65ec96447464b9d860daacddd7d244453b5313022ccb0f56a94f1c3e7a024473a4c5c75591e6eb09a2b8d9424e4044e6a00b8fa6047cee257c8fbfed7b727ed88ad7fc24384099a51bf27ec84d9f808beeccaa48cdc6c97c8776b5b300e998a814ec527a1d7bf71b5207d1dc2cf3e7196585eb1a363519c0604899f37ebc59b071a678439c211a943b70e33a38b2b0ba22bf48530db8a39929e98452b4f8479a4fa56fdd45f67e8ea534d82b8a9aedc95beac240678d08826ce9dade4e89abcb5a13da1ea5b03c9789c8a054d072ad92fa0783f53d0617b625d7027dd4cc820c294c0abd68ec43b87dd4b00d979e27a3bc2848b22be7fc9925ee6f5309f23da73df9497626105a9d30351bc8a7bc574e4ac15f0024bb2589dda4527b6d94ed4ec5033386a7750954a4807e43a53943c6e983af9294536a491eb9d63278cf0f15574147804c8005b0591d0fcf7c6d03e07a8f99e01ffb46da10dc1502f1bdf4ac8b501af59c03e584bbc6b4b2eb7bf94b0b24027c540997542c9138a5a842fd0f42fdbf1495e334e8a1531135725df7eb72aac91bd08daec3bc37836ff5953371036439b42d1f4a3924e5bdb7e7046b04008741da999c60e89d76cbef5cd1bac49d0e36cb128786520d7e39d9f21f13f4b8f1ff9e73a5867cb52b7b4af32400414bb2cb009a239c82a6889c4c7d519b6ed36d04a7000dba2020b52873810aba812cadf6d72be6099658dc691e043400e0b3ba8ce1711e0fc8b79f6ed7c0ba7a692306dff26bb85b601d13bcabced52e56529672d8e44d770276f101c1f6febd65b65ad097db94cfc75a4ad9472521d3c4cdfd93ff692baaed20ac141645d600a8f55bd0ed2e763d877a690f20df2e2fb97fbc5f1ea35e92605918bf3873958455cf586acdbdaffd7a6f2c109e5d6dd33df9d7e293767fccff97b1dc13975207331cf82ed3ae8ac741833b82c4bf68683a3bdb2ab79a1ac184cd90cc916802bd16294ee031e7759890a6ab0d054b0471352fb23ccd7abd02d545c4740524808e99e8e30789e6b5f427d8cf79cb0b1e0178d6e6b25f2d90a71509ee9568e471d7164d460ef616eb802f77ec822e7c7cee02aecaae85968e621f4a816cb04bfc492a527c55289e6165fe14bc972206159c4c7b025681da204d35cac8aed15b9ebb7ef1eec83b433c6499d7bb484099d06d38e24a02c6e2ecb73055cd7f812788214ad28529a2db72716b016eafc94a707ecf8723300ffd58823aa267ab6f10913169582f64f2d422d3316e0e0e2d30b42954d52abbe94aa6d0828b151009a13e52f5dc31f1d834864ce4db32ed16667bd94a29a782e5b1b1365524da5bd7e3eda1a1299c65ca847c349b1d748a1d01cd2e4059bb35fe936e0e6ae51c0a7b51ae75bdba8bab15672594119d64901cba1bfd2891e13570b123149d715747cf00c0c90344efd9637d649182957c4db317dbd8e78491d24ae51ca36c5fb7fb9f14d59e71e9a1f6b1ecf59431153a61d8d9801e5422e4c7b486cc7e2ffdc3edefbffaa83691418f42082c76bfbb832eb2cf25b76046665b3c2836ffa409a8a2990d6bac1d475efe15767e50aa9fe0ae02797fd004d9248791913d49bb6fcc7f61d41fe9b2dd273dd41ce8732111425c7403cc89b7a9ecdaa835b3b1543da033761c2992cf452cc7a39a015f4b1d033e0257ad9e0d3f6cf22751d680e778bb7ba81d17d56b23c88d6131da60a664bc008013e8ee5c50bf76eb3292729bdd32470150dc417ca240bbc03ad7e7d6c50349a9bf95cf7c1f95c14d9ce54cba7f0caa94e6aa8344cf41c24d045fac40de5a4cd571220b9596be5a4ebac9664760a64397ef393e3cf2ea3007a376a2cd56e6be5bfb0e2354cba0c24e0bbbdb6d39849805bf7b8e58f64a54c627c3ad92cc1b2cac6c49723070c19b94e6ea2f0a5a7a60216814fec15318df1a</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-surge">      <input class="hbe hbe-input-field hbe-input-field-surge" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-surge" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-surge" data-content="您好, 这里需要密码.">您好, 这里需要密码.</span>      </label>      <svg class="hbe hbe-graphic hbe-graphic-surge" width="300%" height="100%" viewBox="0 0 1200 60" preserveAspectRatio="none">        <path d="M1200,9c0,0-305.005,0-401.001,0C733,9,675.327,4.969,598,4.969C514.994,4.969,449.336,9,400.333,9C299.666,9,0,9,0,9v43c0,0,299.666,0,400.333,0c49.002,0,114.66,3.484,197.667,3.484c77.327,0,135-3.484,200.999-3.484C894.995,52,1200,52,1200,52V9z"></path>      </svg>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> bufferfly修改 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> bufferfly </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Spring学习笔记</title>
      <link href="/posts/b3b6ba72/"/>
      <url>/posts/b3b6ba72/</url>
      
        <content type="html"><![CDATA[<h2 id="简介"><a class="markdownIt-Anchor" href="#简介"></a> 简介</h2><ul><li>Spring:春天—&gt;给软件行业带来了春天!</li><li>2002,首次推出了 Spring 框架的雄性:interface21 框架!</li><li>Spring 框架即以 interface21 框架为基础，经过重新设计，并不断丰富其内涵，于 2004 年 3 月 24 日发布了 1.0 正式版</li><li>Rod Johnson Spring Framework 创始人，著名作者，很难想象 Rod Johnson 的学历，真的让好多人大吃一惊，他是悉尼大学的博士，然而他的专业不是计算机，而是音乐学</li><li>Spring 理念：使现有的技术更加容易使用，本事是一个大杂烩，整合了现有的技术框架</li><li>SSH：Struct2 + Spring + Hibernate</li><li>SSM：SpringMVC + Spring + Mybatis</li></ul><blockquote><p>官网：<a href="https://spring.io/">https://spring.io/</a></p><p>Spring Framework 5.3.12 API：<a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/">https://docs.spring.io/spring-framework/docs/current/javadoc-api/</a></p><p>Version 5.3.12：<a href="https://docs.spring.io/spring-framework/docs/current/reference/html/core.html#spring-core">https://docs.spring.io/spring-framework/docs/current/reference/html/core.html#spring-core</a></p><p>官方下载地址：<a href="https://repo.spring.io/ui/native/release/org/springframework/spring/">https://repo.spring.io/ui/native/release/org/springframework/spring/</a></p></blockquote><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.springframework/spring-webmvc --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-webmvc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.3.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.springframework/spring-webmvc --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-jdbk<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.3.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="优点"><a class="markdownIt-Anchor" href="#优点"></a> 优点</h3><ul><li>Spring 是一个开源的免费的框架（容器）！</li><li>Spring 是一个轻量级的、非入侵式的框架！</li><li>控制反转（IOC），面向切面编程（AOP）</li><li>支持事务的处理，对框架的整合的支持 r</li></ul><blockquote><p>总结：开源免费容器，轻量级非侵入式，控制反转，面向切面，支持事务，支持框架整合</p><p>Spring 就是一个轻量级的控制反转（IOC）和面向切面编程（AOP）的框架！</p></blockquote><h3 id="组成"><a class="markdownIt-Anchor" href="#组成"></a> 组成</h3><img src="https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fimage1.bubuko.com%2Finfo%2F202007%2F20200710143347205636.png&refer=http%3A%2F%2Fimage1.bubuko.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1638027623&t=c284620445aa14250fc677ec14eebed7" alt="img" style="zoom: 80%;" /><h3 id="拓展"><a class="markdownIt-Anchor" href="#拓展"></a> 拓展</h3><p>在 Spring 的官网有这个介绍：现代化的 Java 开发！也就是基于 Spring 的开发</p><img src="https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fimage1.bubuko.com%2Finfo%2F202004%2F20200402092531603379.png&refer=http%3A%2F%2Fimage1.bubuko.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1638027821&t=a4d423dd8e882c9fe6336a6ee832b6ab" alt="img" style="zoom:150%;" /><ul><li>Spring Boot<ul><li>一个快速开发的脚手架</li><li>基于 SpringBoot 可以快速的开发单个微服务</li><li>约定大于配置</li></ul></li><li>Spring Cloud<ul><li>SpringCloud 是基于 SpringBoot 实现的</li></ul></li></ul><p>因为现在大多数公司都在使用 SpringBoot 进行快速开发，学习 SpringBoot 的前提，需要完全掌握 Spring 及 SpringMVC！承上启下的作用!</p><p>弊端：发展了太久之后，违背了原来的理念，配置十分繁琐，人称：“配置地狱”</p><h2 id="ioc-理论推导"><a class="markdownIt-Anchor" href="#ioc-理论推导"></a> IOC 理论推导</h2><p>传统的调用</p><ol><li><h3 id="userdao-接口"><a class="markdownIt-Anchor" href="#userdao-接口"></a> UserDao 接口</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> dao;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserDao</span> &#123;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">getUser</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><h3 id="userdaoimpl-实现类"><a class="markdownIt-Anchor" href="#userdaoimpl-实现类"></a> UserDaoImpl 实现类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> dao;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserDaoImpl</span> <span class="keyword">implements</span> <span class="title class_">UserDao</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">getUser</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;默认获取用户数据&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><h3 id="userservice-业务接口"><a class="markdownIt-Anchor" href="#userservice-业务接口"></a> UserService 业务接口</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> Service;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">getUser</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><h3 id="userserviceimpl-业务实现类"><a class="markdownIt-Anchor" href="#userserviceimpl-业务实现类"></a> UserServiceImpl 业务实现类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> Service;</span><br><span class="line"><span class="keyword">import</span> dao.UserDao;</span><br><span class="line"><span class="keyword">import</span> dao.UserDaoImpl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">UserService</span>&#123;</span><br><span class="line">    <span class="type">UserDao</span> <span class="variable">userDao</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UserDaoImpl</span>();</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">getUser</span><span class="params">()</span>&#123;</span><br><span class="line">        userDao.getUser();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><h3 id="测试"><a class="markdownIt-Anchor" href="#测试"></a> 测试</h3></li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> holle0;</span><br><span class="line"><span class="keyword">import</span> Service.UserService;</span><br><span class="line"><span class="keyword">import</span> Service.UserServiceImpl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyTest0</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">// 用户实际调用的是业务层，dao层他们不需要接触</span></span><br><span class="line">        <span class="type">UserService</span> <span class="variable">userService</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UserServiceImpl</span>();</span><br><span class="line">        userService.getUser();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在我们之前的业务中，用户的需求可能会影响我们原来的代码，我们需要根据用户的需求去修改原代码！如果程序代码量十分大，修改一次的成本代价十分昂贵！</p><p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9naXRlZS5jb20vd29fYmVsbC9QaWN0dXJlQmVkL3Jhdy9tYXN0ZXIvaW1hZ2UvaW1hZ2UtMjAyMDA4MDExMjI3NDI1ODEucG5n?x-oss-process=image/format,png" alt="image-20200801122742581" /></p><p>改良：我们使用一个 Set 接口实现。已经发生了革命性的变化！</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//在Service层的实现类(UserServiceImpl)增加一个Set()方法</span></span><br><span class="line"><span class="comment">//利用set动态实现值的注入！</span></span><br><span class="line"><span class="keyword">private</span> UserDao userDao;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUserDao</span><span class="params">(UserDao userDao)</span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.userDao = userDao;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>set() 方法实际上是动态改变了 UserDao userDao 的 初始化部分（<strong>new UserDaoImpl()</strong>）</p><p>测试中加上</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">((UserServiceImpl)userService).setUserDao(<span class="keyword">new</span> <span class="title class_">UserDaoImpl</span>());</span><br></pre></td></tr></table></figure><ul><li>之前，程序是主动创建对象！控制权在程序猿手上！</li><li>使用了 Set 注入后，程序不再具有主动性，而是变成了被动的接受对象！</li></ul><p>本质上解决了问题，程序员不用再去管理对象的创建</p><p>系统的耦合性大大降低，可以更专注在业务的实现上</p><p>这是 IOC（控制反转）的原型，反转(理解)：主动权交给了用户</p><p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9naXRlZS5jb20vd29fYmVsbC9QaWN0dXJlQmVkL3Jhdy9tYXN0ZXIvaW1hZ2UvaW1hZ2UtMjAyMDA4MDExMjI4MDU3NjkucG5n?x-oss-process=image/format,png" alt="image-20200801122805769" /></p><h3 id="ioc-本质"><a class="markdownIt-Anchor" href="#ioc-本质"></a> IOC 本质</h3><p><strong>控制反转 IOC(Inversion of Control),是一种设计思想,ID(依赖注入)是实现 IOC 的一种方法</strong></p><p><strong>控制反转是一种通过描述(XML 或注解)并通过第三方去生产获取特定对象的方式,在 Spring 中实现控制反转的是 IOC 容器,其实方法是依赖注入</strong></p><p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9naXRlZS5jb20vd29fYmVsbC9QaWN0dXJlQmVkL3Jhdy9tYXN0ZXIvaW1hZ2UvaW1hZ2UtMjAyMDA4MDExMjM1MTg5NzQucG5n?x-oss-process=image/format,png" alt="image-20200801123518974" /></p><p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9naXRlZS5jb20vd29fYmVsbC9QaWN0dXJlQmVkL3Jhdy9tYXN0ZXIvaW1hZ2UvMjAyMDA4MDExMjMyMzUucG5n?x-oss-process=image/format,png" alt="img" /></p><p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9naXRlZS5jb20vd29fYmVsbC9QaWN0dXJlQmVkL3Jhdy9tYXN0ZXIvaW1hZ2UvaW1hZ2UtMjAyMDA4MDExMjMzNDgyMDcucG5n?x-oss-process=image/format,png" alt="image-20200801123348207" /></p><p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9naXRlZS5jb20vd29fYmVsbC9QaWN0dXJlQmVkL3Jhdy9tYXN0ZXIvaW1hZ2UvaW1hZ2UtMjAyMDA4MDExMjM0NTA4OTcucG5n?x-oss-process=image/format,png" alt="image-20200801123450897" /></p><h3 id="hellospring"><a class="markdownIt-Anchor" href="#hellospring"></a> HelloSpring</h3><p>在父模块中导入 jar 包</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.springframework/spring-webmvc --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-webmvc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.2.7.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>pojo 的 Hello.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Hello</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String str;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getStr</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> str;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setStr</span><span class="params">(String str)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.str = str;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Holle [str=&quot;</span> + str + <span class="string">&quot;]&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在 resource 里面的 xml 配置</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">                           https://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--在Spring中创建对象，在Spring这些都称为bean</span></span><br><span class="line"><span class="comment">     类型 变量名 = new 类型();</span></span><br><span class="line"><span class="comment">     Holle holle = new Holle();</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">     bean = 对象(holle)</span></span><br><span class="line"><span class="comment">     id = 变量名(holle)</span></span><br><span class="line"><span class="comment">     class = new的对象(new Holle();)</span></span><br><span class="line"><span class="comment">     property 相当于给对象中的属性设值,让str=&quot;Spring&quot;</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;hello&quot;</span> <span class="attr">class</span>=<span class="string">&quot;pojo.Hello&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;str&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Spring&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><p>测试类 MyTest</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> holle1;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pojo.Hello;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">//获取Spring的上下文对象</span></span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;beans.xml&quot;</span>);</span><br><span class="line">        <span class="comment">//我们的对象下能在都在spring·中管理了，我们要使用，直接取出来就可以了</span></span><br><span class="line">        <span class="type">Hello</span> <span class="variable">holle</span> <span class="operator">=</span> (Hello) context.getBean(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">        System.out.println(holle.toString());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>核心用 set 注入，所以必须要有下面的 se()方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Hello类</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setStr</span><span class="params">(String str)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.str = str;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>思考：</strong></p><p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9naXRlZS5jb20vd29fYmVsbC9QaWN0dXJlQmVkL3Jhdy9tYXN0ZXIvaW1hZ2UvaW1hZ2UtMjAyMDA4MDExNjUxNTYyNTkucG5n?x-oss-process=image/format,png" alt="image-20200801165156259" /></p><p>IOC：对象由 Spring 来创建，管理，装配！</p><blockquote><p>现实中的理解:<br />原来这套程序是：你写好菜单买好菜，客人来了自己把菜炒好招待，就相当于你请人吃饭<br />现在这套程序是：你告诉楼下餐厅，你要哪些菜，客人来的时候，餐厅把做好的你需要的菜送上来<br />IoC：炒菜这件事，不再由你自己来做，而是委托给了第三方__餐厅来做</p><p>此时的区别就是，如果我还需要做其他的菜，我不需要自己搞菜谱买材料再做好，而是告诉餐厅，我要什么菜，什么时候要，你做好送来</p></blockquote><p>在前面第一个 module 试试引入 Spring</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">                           https://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userDaomSql&quot;</span> <span class="attr">class</span>=<span class="string">&quot;dao.UserDaoMysqlImpl&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userServiceImpl&quot;</span> <span class="attr">class</span>=<span class="string">&quot;service.UserServiceImp&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--ref引用spring中已经创建很好的对象--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--value是一个具体的值,基本数据类型--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;userDao&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;userDaomSql&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>第一个 module 改良后测试</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> holle0;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"><span class="keyword">import</span> service.UserServiceImpl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyTest0</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;beans.xml&quot;</span>);</span><br><span class="line">        <span class="type">UserServiceImpl</span> <span class="variable">userServiceImpl</span> <span class="operator">=</span> (UserServiceImpl) context.getBean(<span class="string">&quot;userServiceImpl&quot;</span>);</span><br><span class="line">        userServiceImpl.getUser();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>总结：</strong></p><p>所有的类都要装配的 beans.xml 里面；</p><p>所有的 bean 都要通过容器去取；</p><p>容器里面取得的 bean，拿出来就是一个对象，用对象调用方法即可；</p><p>控制:传统应用程序的对象是有程序本身控制创建的,使用 Spring 后,对象是由 Spring 来创建的</p><p>反转:程序本身不创建对象,而变成被动的接受对手</p><p>依赖注入:就是利 Set 方法来实现注入的</p><p>IOC 是一中编程思想,由主动的编程变成被动的接受</p><h3 id="ioc-创建对象的方式"><a class="markdownIt-Anchor" href="#ioc-创建对象的方式"></a> IOC 创建对象的方式</h3><ol><li><h5 id="下标赋值"><a class="markdownIt-Anchor" href="#下标赋值"></a> 下标赋值</h5><p>index 指的是有参构造中参数的下标，下标从 0 开始;</p></li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">                           https://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;user&quot;</span> <span class="attr">class</span>=<span class="string">&quot;pojo.User&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">&quot;0&quot;</span> <span class="attr">value</span>=<span class="string">&quot;chen&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><ol start="2"><li><h5 id="类型赋值-不建议使用"><a class="markdownIt-Anchor" href="#类型赋值-不建议使用"></a> 类型赋值 （不建议使用）</h5></li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">&lt;!--    有参构造 2.通过类型创建,不建议使用 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;user&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.hgm.pojo.User&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">type</span>=<span class="string">&quot;java.lang.String&quot;</span><span class="attr">value</span>=<span class="string">&quot;黄帅哥&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><ol start="3"><li><h5 id="直接通过参数名掌握"><a class="markdownIt-Anchor" href="#直接通过参数名掌握"></a> 直接通过参数名（掌握）</h5></li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">&lt;!--   3.直接通过参数名来设置--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;user&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.hgm.pojo.User&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;黄帅哥&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 比如参数名是name，则有name=&quot;具体值&quot; --&gt;</span></span><br></pre></td></tr></table></figure><p>注册 bean 之后就对象的初始化了（<strong>类似 new 类名()</strong>）</p><p>name 方式还需要无参构造和 set 方法,index 和 type 只需要有参构造</p><p>就算是 new 两个对象，也是只有一个实例（<strong>单例模式：全局唯一</strong>）</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> (User) context.getBean(<span class="string">&quot;user&quot;</span>);</span><br><span class="line"><span class="type">User</span> <span class="variable">user2</span> <span class="operator">=</span> (User) context.getBean(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">system.out.println(user == user2)<span class="comment">//结果为true</span></span><br></pre></td></tr></table></figure><p>总结：在配置文件加载的过程中，容器(&lt; bean&gt;)中管理的对象就已经初始化了</p><h2 id="spring-配置"><a class="markdownIt-Anchor" href="#spring-配置"></a> Spring 配置</h2><h3 id="别名"><a class="markdownIt-Anchor" href="#别名"></a> 别名</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;user&quot;</span> <span class="attr">class</span>=<span class="string">&quot;pojo.User&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;chen&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">alias</span> <span class="attr">name</span>=<span class="string">&quot;user&quot;</span> <span class="attr">alias</span>=<span class="string">&quot;userLove&quot;</span>/&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 使用时</span></span><br><span class="line"><span class="comment">User user2 = (User) context.getBean(&quot;userLove&quot;);</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="bean-配置"><a class="markdownIt-Anchor" href="#bean-配置"></a> Bean 配置</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--id：bean的唯一标识符，也就是相当于我们学的对象名</span></span><br><span class="line"><span class="comment">class：bean对象所对应的会限定名：包名+类型</span></span><br><span class="line"><span class="comment">name：也是别名，而且name可以同时取多个别名 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;user&quot;</span> <span class="attr">class</span>=<span class="string">&quot;pojo.User&quot;</span> <span class="attr">name</span>=<span class="string">&quot;u1 u2,u3;u4&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;chen&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 使用时</span></span><br><span class="line"><span class="comment">User user2 = (User) context.getBean(&quot;u1&quot;);</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="import"><a class="markdownIt-Anchor" href="#import"></a> import</h3><p>这个 import，一般用于团队开发使用，他可以将多个配置文件，导入合并为一个</p><p>假设，现在项目中有多个人开发，这三个人复制不同的类开发，不同的类需要注册在不同的 bean 中，我们可以利<br />用 import 将所有人的 beans.xml 合并为一个总的！</p><ul><li>张三(beans.xm1)</li><li>李四(beans2.xm1)</li><li>王五(beans3.xm1)</li><li>applicationContext.xml</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">import</span> <span class="attr">resource</span>=<span class="string">&quot;beans.xm1&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">import</span> <span class="attr">resource</span>=<span class="string">&quot;beans2.xml&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">import</span> <span class="attr">resource</span>=<span class="string">&quot;beans3.xm1&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure><p><strong>使用的时候，直接使用总的配置就可以了</strong></p><p>弹幕评论：</p><p>按照在总的 xml 中的导入顺序来进行创建，后导入的会重写先导入的，最终实例化的对象会是后导入 xml 中的那个</p><h2 id="依赖注入"><a class="markdownIt-Anchor" href="#依赖注入"></a> 依赖注入</h2><h3 id="构造器注入"><a class="markdownIt-Anchor" href="#构造器注入"></a> 构造器注入</h3><p>第四点有提到</p><h3 id="set-方式注入重点"><a class="markdownIt-Anchor" href="#set-方式注入重点"></a> set 方式注入【重点】</h3><p>依赖注入：set 注入！</p><ul><li>依赖：bean 对象的创建依赖于容器</li><li>注入：bean 对象中的所有属性，由容器来注入</li></ul><p>【环境搭建】</p><ol><li><p>复杂类型</p><p>Address 类</p></li><li><p>真实测试对象</p><p>Student 类</p></li><li><p>beans.xml</p></li><li><p>测试</p><p>MyTest3</p></li></ol><p>Student 类</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="meta">@Get</span></span><br><span class="line"><span class="meta">@Set</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Student</span> &#123;</span><br><span class="line">    <span class="comment">//别忘了写get和set方法（用lombok注解也行）</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Address address;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String[] books;</span><br><span class="line">    <span class="keyword">private</span> List&lt;String&gt; hobbies;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Map&lt;String, String&gt; card;</span><br><span class="line">    <span class="keyword">private</span> Set&lt;String&gt; game;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Properties infor;</span><br><span class="line">    <span class="keyword">private</span> String wife;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Student&#123;&quot;</span> +<span class="string">&quot;\n&quot;</span>+</span><br><span class="line">            <span class="string">&quot;name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +<span class="string">&quot;\n&quot;</span>+</span><br><span class="line">            <span class="string">&quot;, address=&quot;</span> + address.toString() +<span class="string">&quot;\n&quot;</span>+</span><br><span class="line">            <span class="string">&quot;, books=&quot;</span> + Arrays.toString(books) +<span class="string">&quot;\n&quot;</span>+</span><br><span class="line">            <span class="string">&quot;, hobbies=&quot;</span> + hobbies +<span class="string">&quot;\n&quot;</span>+</span><br><span class="line">            <span class="string">&quot;, card=&quot;</span> + card +<span class="string">&quot;\n&quot;</span>+</span><br><span class="line">            <span class="string">&quot;, game=&quot;</span> + game +<span class="string">&quot;\n&quot;</span>+</span><br><span class="line">            <span class="string">&quot;, infor=&quot;</span> + infor +<span class="string">&quot;\n&quot;</span>+</span><br><span class="line">            <span class="string">&quot;, wife=&#x27;&quot;</span> + wife + <span class="string">&#x27;\&#x27;&#x27;</span> +<span class="string">&quot;\n&quot;</span>+</span><br><span class="line">            <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Address 类</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Address</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String address;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getAddress</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAddress</span><span class="params">(String address)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.address = address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Address&#123;&quot;</span> +</span><br><span class="line">            <span class="string">&quot;address=&#x27;&quot;</span> + address + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">            <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>beans.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">                           https://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;address&quot;</span> <span class="attr">class</span>=<span class="string">&quot;pojo.Address&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;address&quot;</span> <span class="attr">value</span>=<span class="string">&quot;address你好&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;student&quot;</span> <span class="attr">class</span>=<span class="string">&quot;pojo.Student&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--第一种，普通值注入 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;name你好&quot;</span> /&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--第二种，ref注入 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;address&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;address&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--数组注入 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;books&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">array</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>三国<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>西游<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>水浒<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">array</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--list列表注入 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;hobbies&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>唱<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>跳<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>rap<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>篮球<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--map键值对注入 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;card&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">map</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;root&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">map</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--set(可去重)注入 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;game&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>wangzhe<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>lol<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>galname<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--空指针null注入 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;wife&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">null</span>&gt;</span><span class="tag">&lt;/<span class="name">null</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--properties常量注入 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;infor&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">props</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;id&quot;</span>&gt;</span>20200802<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;name&quot;</span>&gt;</span>cbh<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">props</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><p>MyTest3</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"><span class="keyword">import</span> pojo.Student;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyTest3</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;beans.xml&quot;</span>);</span><br><span class="line">        <span class="type">Student</span> <span class="variable">stu</span> <span class="operator">=</span> (Student) context.getBean(<span class="string">&quot;student&quot;</span>);</span><br><span class="line">        System.out.println(stu.toString());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="拓展注入"><a class="markdownIt-Anchor" href="#拓展注入"></a> 拓展注入</h3><p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9naXRlZS5jb20vd29fYmVsbC9QaWN0dXJlQmVkL3Jhdy9tYXN0ZXIvaW1hZ2UvaW1hZ2UtMjAyMDA4MDIxNDI3MTcyMTYucG5n?x-oss-process=image/format,png" alt="image-20200802142717216" /></p><p>pojo 增加 User 类</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> id;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">User</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">User</span><span class="params">(String name, <span class="type">int</span> id)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>();</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        <span class="built_in">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getId</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setId</span><span class="params">(<span class="type">int</span> id)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;User [name=&quot;</span> + name + <span class="string">&quot;, id=&quot;</span> + id + <span class="string">&quot;]&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>注意： beans 里面加上这下面两行</p><p>使用 p 和 c 命名空间需要导入 xml 约束</p><p>xmlns:p=“<a href="http://www.springframework.org/schema/p%E2%80%9D">http://www.springframework.org/schema/p”</a><br />xmlns:c=“<a href="http://www.springframework.org/schema/c%E2%80%9D">http://www.springframework.org/schema/c”</a></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:p</span>=<span class="string">&quot;http://www.springframework.org/schema/p&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:c</span>=<span class="string">&quot;http://www.springframework.org/schema/c&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">                           https://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--p命名空间注入/set注入，可以直接注入属性的值-》property--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;user&quot;</span> <span class="attr">class</span>=<span class="string">&quot;pojo.User&quot;</span> <span class="attr">p:name</span>=<span class="string">&quot;cxk&quot;</span> <span class="attr">p:id</span>=<span class="string">&quot;20&quot;</span> &gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--c命名空间，通过构造器注入，需要写入有参和无参构造方法-》construct-args--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;user2&quot;</span> <span class="attr">class</span>=<span class="string">&quot;pojo.User&quot;</span> <span class="attr">c:name</span>=<span class="string">&quot;cbh&quot;</span> <span class="attr">c:id</span>=<span class="string">&quot;22&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><p>测试</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;beans.xml&quot;</span>);</span><br><span class="line"><span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> context.getBean(<span class="string">&quot;user&quot;</span>,User.class);<span class="comment">//确定class对象，就不用再强转了</span></span><br><span class="line">System.out.println(user.toString());</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="bean-作用域"><a class="markdownIt-Anchor" href="#bean-作用域"></a> Bean 作用域</h3><p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9naXRlZS5jb20vd29fYmVsbC9QaWN0dXJlQmVkL3Jhdy9tYXN0ZXIvaW1hZ2UvaW1hZ2UtMjAyMDA4MDIxNDM0MDExNjUucG5n?x-oss-process=image/format,png" alt="image-20200802143401165" /></p><p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9naXRlZS5jb20vd29fYmVsbC9QaWN0dXJlQmVkL3Jhdy9tYXN0ZXIvaW1hZ2UvaW1hZ2UtMjAyMDA4MDIxNDMzNDI1ODYucG5n?x-oss-process=image/format,png" alt="image-20200802143342586" /></p><ol><li>单例模式（默认）</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;user2&quot;</span> <span class="attr">class</span>=<span class="string">&quot;pojo.User&quot;</span> <span class="attr">c:name</span>=<span class="string">&quot;cxk&quot;</span> <span class="attr">c:age</span>=<span class="string">&quot;19&quot;</span> <span class="attr">scope</span>=<span class="string">&quot;singleton&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9naXRlZS5jb20vd29fYmVsbC9QaWN0dXJlQmVkL3Jhdy9tYXN0ZXIvaW1hZ2UvaW1hZ2UtMjAyMDA4MDIxNDM4MDIwMDUucG5n?x-oss-process=image/format,png" alt="" /></p><p>弹幕评论：单例模式是把对象放在 pool 中，需要再取出来，使用的都是同一个对象实例</p><ol start="2"><li>原型模式: 每次从容器中 get 的时候，都产生一个新对象！</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;user2&quot;</span> <span class="attr">class</span>=<span class="string">&quot;pojo.User&quot;</span> <span class="attr">c:name</span>=<span class="string">&quot;cxk&quot;</span> <span class="attr">c:age</span>=<span class="string">&quot;19&quot;</span> <span class="attr">scope</span>=<span class="string">&quot;prototype&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><ol start="3"><li>其余的 request、session、application 这些只能在 web 开放中使用!</li></ol><h2 id="bean-的自动装配"><a class="markdownIt-Anchor" href="#bean-的自动装配"></a> Bean 的自动装配</h2><ul><li>自动装配是 Spring 满足 bean 依赖的一种方式</li><li>Spring 会在上下文自动寻找，并自动给 bean 装配属性</li></ul><p>在 Spring 中有三种装配的方式</p><ol><li><p>在 xml 中显示配置</p></li><li><p>在 java 中显示配置</p></li><li><p>隐式的自动装配 bean 【重要】</p></li><li><p>环境搭建：一个人有两个宠物</p></li><li><p>byType 自动装配：byType 会自动查找，和自己对象 set 方法参数的类型相同的 bean</p><p>保证所有的 class 唯一(类为全局唯一)</p></li><li><p>byName 自动装配：byName 会自动查找，和自己对象 set 对应的值对应的 id</p><p>保证所有 id 唯一，并且和 set 注入的值一致</p></li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context:annotation-config</span>/&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 找不到id和多个相同class --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;cat&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.hgm.pojo.Cat&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dog&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.hgm.pojo.Dog&quot;</span>/&gt;</span></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">Bean自动装配</span></span><br><span class="line"><span class="comment">byName:会自动在容器上下文中查找,和自己对象set方法后面的值对应的bean id,</span></span><br><span class="line"><span class="comment">需要保证所有bean的id唯一,并且这个bean需要和自动注入的属性的set方法的值一致</span></span><br><span class="line"><span class="comment">byType:会自动在容器上下文中查找,和自己对象属性相同的bean,</span></span><br><span class="line"><span class="comment">需要保证所有bean的class唯一,并且这个bean需要和自动注入的属性的类型值一致</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;people&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.hgm.pojo.People&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;黄帅哥&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="测试自动装配"><a class="markdownIt-Anchor" href="#测试自动装配"></a> 测试：自动装配</h3><p>pojo 的 Cat 类</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Cat</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">shut</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;miao&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>pojo 的 Dog 类</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Dog</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">shut</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;wow&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>pojo 的 People 类</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> pojo;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">People</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Cat cat;</span><br><span class="line">    <span class="keyword">private</span> Dog dog;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Cat <span class="title function_">getCat</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> cat;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setCat</span><span class="params">(Cat cat)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.cat = cat;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Dog <span class="title function_">getDog</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> dog;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setDog</span><span class="params">(Dog dog)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.dog = dog;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;People&#123;&quot;</span> +</span><br><span class="line">            <span class="string">&quot;cat=&quot;</span> + cat +</span><br><span class="line">            <span class="string">&quot;, dog=&quot;</span> + dog +</span><br><span class="line">            <span class="string">&quot;, name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">            <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>xml 配置 -&gt; byType 自动装配</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">                           https://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;cat&quot;</span> <span class="attr">class</span>=<span class="string">&quot;pojo.Cat&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dog&quot;</span> <span class="attr">class</span>=<span class="string">&quot;pojo.Dog&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--byType会在容器自动查找，和自己对象属性相同的bean</span></span><br><span class="line"><span class="comment">  例如，Dog dog; 那么就会查找pojo的Dog类，再进行自动装配</span></span><br><span class="line"><span class="comment"> --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;people&quot;</span> <span class="attr">class</span>=<span class="string">&quot;pojo.People&quot;</span> <span class="attr">autowire</span>=<span class="string">&quot;byType&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;cbh&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><p>xml 配置 -&gt; byName 自动装配</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;cat&quot;</span> <span class="attr">class</span>=<span class="string">&quot;pojo.Cat&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dog&quot;</span> <span class="attr">class</span>=<span class="string">&quot;pojo.Dog&quot;</span>/&gt;</span></span><br><span class="line"><span class="comment">&lt;!--byname会在容器自动查找，和自己对象set方法的set后面的值对应的id</span></span><br><span class="line"><span class="comment">  例如:setDog()，取set后面的字符作为id，则要id = dog 才可以进行自动装配</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;people&quot;</span> <span class="attr">class</span>=<span class="string">&quot;pojo.People&quot;</span> <span class="attr">autowire</span>=<span class="string">&quot;byName&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;cbh&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>弹幕评论：byName 只能取到小写，大写取不到</p><p>​ 小结:</p><ul><li><h6 id="byname-的时候需要保证所有-bean-的-id-唯一并且这个-bean-需要和自动注入的属性的-set-方法的值一致"><a class="markdownIt-Anchor" href="#byname-的时候需要保证所有-bean-的-id-唯一并且这个-bean-需要和自动注入的属性的-set-方法的值一致"></a> byname 的时候,需要保证所有 bean 的 id 唯一,并且这个 bean 需要和自动注入的属性的 set 方法的值一致</h6></li><li><h6 id="bytype-的时候需要保证所有-bean-的-class-唯一并且这个-bean-需要和自动注入的属性的类型值一致"><a class="markdownIt-Anchor" href="#bytype-的时候需要保证所有-bean-的-class-唯一并且这个-bean-需要和自动注入的属性的类型值一致"></a> ByType 的时候,需要保证所有 bean 的 class 唯一,并且这个 bean 需要和自动注入的属性的类型值一致</h6></li></ul><h3 id="使用注解实现自动装配"><a class="markdownIt-Anchor" href="#使用注解实现自动装配"></a> 使用注解实现自动装配</h3><p>jdk1.5 支持的注解,Spring2.5 就支持注解了!</p><p>The introduction of annotation-based configuration raised the question of whether this approach is “better” than XML.（翻译：基于注释的配置的引入提出了一个问题，即这种方法是否比 XML“更好”）</p><ol><li>导入 context 约束</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1. xmlns:context=&quot;http://www.springframework.org/schema/context&quot;</span><br></pre></td></tr></table></figure><ol start="2"><li>配置注解的支持：&lt; context:annotation-config/&gt;</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">        https://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">        http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="string"><span class="tag">        https://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:annotation-config</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="auotwired"><a class="markdownIt-Anchor" href="#auotwired"></a> @<strong>Auotwired</strong></h4><p><strong>默认是 byType 方式，如果匹配不上，就会 byName</strong></p><p>直接在属性上使用即可! 也可以在 set 方式上使用</p><p>使用 Auotwired 我们可以不用编写 Set 方法了,前提是你这个自动导入装配的属性在 IOC (Spring) 容器中存在,且符合名字 Byname</p><p><strong>科普: @Nullable 字段标记了这个注解,说明这个字段可以为 null</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">People</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> Cat cat;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> Dog dog;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>@Nullable 字段标记了这个注解，说明该字段可以为空</p><p>public name(@Nullable String name){</p><p>}</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//源码</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Autowired &#123;</span><br><span class="line"><span class="type">boolean</span> <span class="title function_">required</span><span class="params">()</span> <span class="keyword">default</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>如果定义了 Autowire 的 require 属性为 false，说明这个对象可以为 null，否则不允许为空（false 表示找不到装配，不抛出异常）</p><h4 id="autowiredqualifier"><a class="markdownIt-Anchor" href="#autowiredqualifier"></a> @Autowired+@Qualifier</h4><p><strong>@Autowired 不能唯一装配时，需要@Autowired+@Qualifier</strong></p><p>如果@Autowired 自动装配的环境比较复杂,自动装配无法通过一个注解[@Autowired]完成的时候,我们可以使用@Qualifier(value = “xx”)去配置@Autowired 的使用,指定一个唯一的 bean 对象注入!</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">People</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> Cat cat;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="meta">@Qualifier(value = &quot;dog&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Dog dog;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>弹幕评论：</p><p>如果 xml 文件中同一个对象被多个 bean 使用，Autowired 无法按类型找到，可以用@Qualifier 指定 id 查找</p><h4 id="resource"><a class="markdownIt-Anchor" href="#resource"></a> @<strong>Resource</strong></h4><p><strong>默认是 byName 方式，如果匹配不上，就会 byType</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">People</span> &#123;</span><br><span class="line">    Resource(name=<span class="string">&quot;cat&quot;</span>)</span><br><span class="line">    <span class="keyword">private</span> Cat cat;</span><br><span class="line">    Resource(name=<span class="string">&quot;dog&quot;</span>)</span><br><span class="line">    <span class="keyword">private</span> Dog dog;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>弹幕评论：</p><p>Autowired 是 byType，@Autowired+@Qualifier = byType || byName</p><p>Autowired 是先 byteType,如果唯一則注入，否则 byName 查找。resource 是先 byname,不符合再继续 byType</p><h4 id="resource-和auotwired-的区别"><a class="markdownIt-Anchor" href="#resource-和auotwired-的区别"></a> @Resource 和@Auotwired 的区别:</h4><ul><li>都是用来自动装配的,都可以放在属性字段上</li><li>@Auotwired 是通过 Byname 的方式实现,而且必须要求这个对象存在**[常用]**</li><li>@Resource 默认是通过 byname 的方式实现,如果找不到名字,则通过 byType 实现,如果两个都找不到的情况下就报错!</li><li>执行顺序不同:@Auotwired 通过 byType 的方式实现.@Resource 默认是通过 byname 的方式实现,</li></ul><h2 id="使用注解开发"><a class="markdownIt-Anchor" href="#使用注解开发"></a> 使用注解开发</h2><p><strong>在 spring4 之后,要使用注解开发,必须保证 aop 的包导入了</strong></p><p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9naXRlZS5jb20vd29fYmVsbC9QaWN0dXJlQmVkL3Jhdy9tYXN0ZXIvaW1hZ2UvaW1hZ2UtMjAyMDA4MDIyMDE5MjQ0OTAucG5n?x-oss-process=image/format,png" alt="image-20200802201924490" /></p><p><strong>使用注解需要导入 context 约束,增加注解的支持</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">        https://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">        http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="string"><span class="tag">        https://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:annotation-config</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="bean"><a class="markdownIt-Anchor" href="#bean"></a> bean</h3><p>弹幕评论：<br />有了&lt; context:component-scan&gt;，另一个&lt; context:annotation-config/&gt;标签可以移除掉，因为已经被包含进去了。</p><p>所以:</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">       http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">       http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="string"><span class="tag">       https://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--指定扫描包下的注解--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.ms&quot;</span>/&gt;</span></span><br><span class="line"><span class="comment">&lt;!--    &amp;lt;!&amp;ndash;开启注解支持&amp;ndash;&amp;gt;--&gt;</span>    这里就可以注释掉了</span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="属性如何注入-value"><a class="markdownIt-Anchor" href="#属性如何注入-value"></a> 属性如何注入 @Value</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//等价于    &lt;bean id=&quot;user&quot; class=&quot;com.hgm.pojo.User&quot;/&gt;      Component:组件</span></span><br><span class="line"><span class="meta">@Component</span>  <span class="comment">//注册bean用Component代替了</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> String name;    <span class="comment">//相当于        &lt;property name=&quot;name&quot; value=&quot;SerMs&quot;/&gt;</span></span><br><span class="line">    <span class="meta">@Value(&quot;SerMs&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="衍生的注解"><a class="markdownIt-Anchor" href="#衍生的注解"></a> 衍生的注解</h3><p>在类里面使用了注解就说明这个类被 Spring 托管了，也就是成为 Spring 的组件了</p><p>@Component 有几个衍生注解，会按照 web 开发中，mvc 架构中分层。</p><ol><li>@Component 有几个衍生注解，我们在 web 开发中，会按照 MVC 三层架构分层！</li><li>dao 层【@Repository】 （dao 层我们都会用 Repository 来注解）</li><li>service 层【@Service】（service 层我们都会用 Serivce 来注解）</li><li>Controller 层【@Controller】</li></ol><p>这四个功能都是一样的，都是代表将某个类注册到 Spring 中，装配 Bean</p><h3 id="自动装配"><a class="markdownIt-Anchor" href="#自动装配"></a> 自动装配</h3><ul><li><p>@Auotwierd：自动装配通过类型、名字</p></li><li><p>如果 Auotwierd 不能唯一自动装配上属性，则需要通过@Qualifier(value=“xxx”)</p></li></ul><ul><li>@Nullable：字段标记了这个注解，说明这个字段可以为 null</li><li>@Resource：自动装配通过名字，类型</li></ul><h3 id="作用域scope"><a class="markdownIt-Anchor" href="#作用域scope"></a> 作用域@scope</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//原型模式prototype，单例模式singleton</span></span><br><span class="line"><span class="comment">//scope(&quot;prototype&quot;)相当于&lt;bean scope=&quot;prototype&quot;&gt;&lt;/bean&gt;</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@scope(&quot;prototype&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//相当于&lt;property name=&quot;name&quot; value=&quot;kuangshen&quot;/&gt;</span></span><br><span class="line">    <span class="meta">@value(&quot;kuangshen&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//也可以放在set方法上面</span></span><br><span class="line">    <span class="meta">@value(&quot;kuangshen&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="小结"><a class="markdownIt-Anchor" href="#小结"></a> 小结</h3><p><strong>xml 与注解：</strong></p><ul><li>xml 更加万能，使用宇任何场合，维护更加方便</li><li>注解 不是自己类使用不了，维护相对复杂！</li></ul><p><strong>xml 与注解最佳实践：</strong></p><ul><li><p>xml 用来管理 bean</p></li><li><p>注解只负责属性的注入</p></li><li><p>我们在使用的过程中，只需要注意一个问题，必须让注解生效，就需要开启注解的支持</p></li><li><pre class="highlight"><code class="xml"><span class="hljs-comment">&lt;!--指定要扫描的包,这个包下的注解才会生效--&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">context:component-scan</span> <span class="hljs-attr">base-package</span>=<span class="hljs-string">"com.hgm"</span>/&gt;</span><span class="hljs-comment">&lt;!--注解驱动--&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">context:annotation-config</span>/&gt;</span><span class="hljs-comment"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### 注解说明</span><br><span class="line"></span><br><span class="line">- @Auotwierd：自动装配通过类型、名字</span><br><span class="line"></span><br><span class="line">  - 如果 Auotwierd 不能唯一自动装配上属性，则需要通过@Qualifier(value=&quot;xxx&quot;)</span><br><span class="line"></span><br><span class="line">- @Nullable：字段标记了这个注解，说明这个字段可以为 null</span><br><span class="line"></span><br><span class="line">- @Resource：自动装配通过名字，类型</span><br><span class="line"></span><br><span class="line">- @Component：组件，放在类上，说明这个类被 Spring 管理了，就是 bean</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">## 使用 Java 的方式配置 Spring</span><br><span class="line"></span><br><span class="line">我们现在要完全不使用 Spring 的 xml 配置了，全权交给 Java 来做~</span><br><span class="line"></span><br><span class="line">JavaConfig 是 Spring 的一个子项目，在 Spring4 之后他成为了一个核心功能</span><br><span class="line"></span><br><span class="line">![](https://imgconvert.csdnimg.cn/aHR0cHM6Ly9naXRlZS5jb20vd29fYmVsbC9QaWN0dXJlQmVkL3Jhdy9tYXN0ZXIvaW1hZ2UvaW1hZ2UtMjAyMDA4MDIyMTU3NTI4NjgucG5n?x-oss-process=image/format,png)</span><br><span class="line"></span><br><span class="line">**实体类：pojo 的 User.java**</span><br><span class="line"></span><br><span class="line">```java</span><br><span class="line">//这里这个注解的意思,就是说明这个类被Spring接管了,注册到了容器中</span><br><span class="line">@component</span><br><span class="line">public class User &#123;</span><br><span class="line">    private String name;</span><br><span class="line"></span><br><span class="line">    public String getName() &#123;</span><br><span class="line">    return name;</span><br><span class="line">    &#125;</span><br><span class="line">    //属性注入值</span><br><span class="line">    @value(&quot;QINJIANG&#x27;)</span><br><span class="line">    public void setName(String name) &#123;</span><br><span class="line">    this.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    @Override</span><br><span class="line">    public String toString() &#123;</span><br><span class="line">        return &quot;user&#123;&quot; +</span><br><span class="line">        &quot;name=&#x27;&quot; + name + &#x27;\&#x27;&#x27;+</span><br><span class="line">        &#x27;&#125;&#x27;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></span></code></pre></li></ul><p>弹幕评论：要么使用@Bean，要么使用@Component 和 ComponentScan，两种效果一样</p><p><strong>配置文件</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.kuang.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.kuang.pojo.User;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">// @Configuration本质上也是一个Controller，也会被spring托管，注册到容器中</span></span><br><span class="line"><span class="comment">// @Configuration表示这是一个配置类，和之前的beans.xml的功能一样的</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ComponentScan(&quot;com.kuang.pojo&quot;)</span>        <span class="comment">// @ComponentScan表示组件的扫描</span></span><br><span class="line"><span class="meta">@Import(MyConfig1.class)</span>                 <span class="comment">// 通过import导入其他的配置类</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyConfig</span> &#123;</span><br><span class="line">    <span class="comment">// @Bean 表示注册一个bean</span></span><br><span class="line">    <span class="comment">// 方法的名字即是bean中的id</span></span><br><span class="line">    <span class="comment">// 方法的返回值就是bean中的class</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> User <span class="title function_">getUser</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">User</span>();      <span class="comment">// return就是返回要注入到bean中的对象</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>弹幕评论：ComponentScan、@Component(&quot;pojo”) 这两个注解配合使用</p><p><strong>测试类</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.kuang.config.MyConfig;</span><br><span class="line"><span class="keyword">import</span> com.kuang.pojo.User;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.AnnotationConfigApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyTest</span> &#123;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">// 如果使用了java配置类的方式来注册bean，</span></span><br><span class="line">        <span class="comment">// 只能通过AnnotationConfig上下文来获取容器，通过配置类的class对象加载！</span></span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AnnotationConfigApplicationContext</span>(MyConfig.class);</span><br><span class="line">        <span class="comment">// 获取通过配置类中的方法getUser方法来获得的User对象</span></span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> (User) context.getBean(<span class="string">&quot;getUser&quot;</span>);</span><br><span class="line">        System.out.println(user.toString());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>这种纯 Java 的配置方式，在 SpringBoot 中随处可见</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br></pre></td></tr></table></figure><p>这里这个注解的意思就是说明这个类被 Spring 接管了，注册到了容器中</p><p>@Configuration 本质上还是一个@Component，代表这个一个配置类和 bean.xml 一样</p><p>@ComponentScan(“com.kuang.pojo”) // @ComponentScan 表示组件的扫描 @Import(MyConfig1.class) // 通过 import 导入其他的配置类</p><p><strong>会创建两个相同对象问题的说明：</strong></p><p><strong>弹幕总结 - -&gt; @Bean 是相当于&lt; bean&gt;标签创建的对象，而我们之前学的@Component 是通过 spring 自动创建的这个被注解声明的对象，所以这里相当于有两个 User 对象被创建了。一个是 bean 标签创建的（@Bean），一个是通过扫描然后使用@Component，spring 自动创建的 User 对象，所以这里去掉@Bean 这些东西，然后开启扫描。之后在 User 头上用@Component 即可达到 spring 自动创建 User 对象了</strong></p><hr /><h2 id="代理模式aop"><a class="markdownIt-Anchor" href="#代理模式aop"></a> 代理模式（AOP）</h2><p>为什么要学代理模式？</p><p>因为这个就是 SpringAOP 的底层！【SpringAOP 和 SpringMVC】</p><p>代理模式的分类：</p><ul><li>静态代理</li><li>动态代理</li></ul><p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9naXRlZS5jb20vd29fYmVsbC9QaWN0dXJlQmVkL3Jhdy9tYXN0ZXIvaW1hZ2UvaW1hZ2UtMjAyMDA4MDMxMDE0Mjc4NDYucG5n?x-oss-process=image/format,png" alt="image-20200803101427846" /></p><h3 id="静态代理"><a class="markdownIt-Anchor" href="#静态代理"></a> 静态代理</h3><p><strong>角色分析</strong>：</p><ul><li>抽象角色：一般会使用接口或者抽象类来解决</li><li>真实角色：被代理角色</li><li>代理角色：代理真实角色，代理真实角色后，我们一般会做一些附属操作</li><li>客户：使用代理角色来进行一些操作 .</li></ul><p>代码步骤：</p><ol><li><p>rent 接口</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.kuang.Daili;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Rent</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">rent</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>真实角色(Client 租户)</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.kuang.Daili;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Client</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        Host host=<span class="keyword">new</span> <span class="title class_">Host</span>();</span><br><span class="line">        <span class="comment">//host.rent();</span></span><br><span class="line">        Proxy proxy=<span class="keyword">new</span> <span class="title class_">Proxy</span>(host);</span><br><span class="line"></span><br><span class="line">        proxy.rent();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>proxy 代理角色</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.kuang.Daili;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Proxy</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Host host;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Proxy</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Proxy</span><span class="params">(Host host)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.host=host;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">rent</span><span class="params">()</span>&#123;</span><br><span class="line">        seeHouse();</span><br><span class="line"></span><br><span class="line">        host.rent();</span><br><span class="line">        hetong();</span><br><span class="line">        fare();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">seeHouse</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;中介带你看房&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">fare</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;收中介费!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">hetong</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;签租领合同&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>客户端访问代理角色</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Client</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;        <span class="comment">//房东要租房子</span></span><br><span class="line">        <span class="type">Host</span> <span class="variable">host</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Host</span>();        <span class="comment">//代理,中介帮房东租房子,但是代理角色会加一些附属操作</span></span><br><span class="line">        <span class="type">Proxy</span> <span class="variable">proxy</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Proxy</span>(host);        <span class="comment">//你不用面对房东,直接找中介租房即可</span></span><br><span class="line">        proxy.rent();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><p>分析：在这个过程中，你直接接触的就是中介，就如同现实生活中的样子，你看不到房东，但是你依旧租到了房东的房子通过代理，这就是所谓的代理模式，程序源自于生活，所以学编程的人，一般能够更加抽象的看待生活中发生的事情。</p><h5 id="代理模式的好处"><a class="markdownIt-Anchor" href="#代理模式的好处"></a> 代理模式的好处：</h5><ul><li>可以使真实角色的操作更加纯粹，不用去关注一些公共业务</li><li>公共业务就交给了代理角色，实现了业务的分工</li><li>公共业务发生扩展的时候，方便集中管理</li></ul><h5 id="缺点"><a class="markdownIt-Anchor" href="#缺点"></a> 缺点：</h5><ul><li>一个真实角色就会产生一个代理角色，代码量会翻倍，开发效率会变低</li><li>类多了 , 多了代理类 , 工作量变大了 . 开发效率降低 .</li></ul><h3 id="静态代理的再理解"><a class="markdownIt-Anchor" href="#静态代理的再理解"></a> **静态代理的再理解 **</h3><ol><li><p>创建一个抽象角色，比如咋们平时做的用户业务，抽象起来就是增删改查！</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//抽象角色：增删改查业务</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">add</span><span class="params">()</span>;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">delete</span><span class="params">()</span>;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">update</span><span class="params">()</span>;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">query</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>我们需要一个真实对象来完成这些增删改查操作</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//真实对象，完成增删改查操作的人</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;增加了一个用户&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">delete</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;删除了一个用户&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;更新了一个用户&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">query</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;查询了一个用户&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>需求来了，现在我们需要增加一个日志功能，怎么实现！</p><ul><li><p>思路 1 ：在实现类上增加代码 【麻烦！】</p></li><li><p>思路 2：使用代理来做，能够不改变原来的业务情况下，实现此功能就是最好的了！</p></li></ul></li><li><p>设置一个代理类来处理日志！代理角色</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//代理角色，在这里面增加日志的实现</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserServiceProxy</span> <span class="keyword">implements</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> UserServiceImpl userService;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUserService</span><span class="params">(UserServiceImpl userService)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.userService = userService;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">()</span> &#123;</span><br><span class="line">        log(<span class="string">&quot;add&quot;</span>);</span><br><span class="line">        userService.add();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">delete</span><span class="params">()</span> &#123;</span><br><span class="line">        log(<span class="string">&quot;delete&quot;</span>);</span><br><span class="line">        userService.delete();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">()</span> &#123;</span><br><span class="line">        log(<span class="string">&quot;update&quot;</span>);</span><br><span class="line">        userService.update();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">query</span><span class="params">()</span> &#123;</span><br><span class="line">        log(<span class="string">&quot;query&quot;</span>);</span><br><span class="line">        userService.query();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">log</span><span class="params">(String msg)</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;执行了&quot;</span>+msg+<span class="string">&quot;方法&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>OK，到了现在代理模式大家应该都没有什么问题了，重点大家需要理解其中的思想；我们在不改变原来的代码的情况下，实现了对原有功能的增强，这是 AOP 中最核心的思想</p></li></ol><p><strong>AOP 横向开发</strong></p><p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9naXRlZS5jb20vd29fYmVsbC9QaWN0dXJlQmVkL3Jhdy9tYXN0ZXIvaW1hZ2UvaW1hZ2UtMjAyMDA4MDMxMTE1Mzk2MjEucG5n?x-oss-process=image/format,png" alt="image-20200803111539621" /></p><p><strong>我们想要静态代理的好处，又不想要静态代理的缺点，所以 , 就有了动态代理</strong></p><h3 id="动态代理"><a class="markdownIt-Anchor" href="#动态代理"></a> 动态代理</h3><ul><li>动态代理和静态代理角色一样</li><li>动态代理的代理类是动态生成的,不是我们直接写好的</li><li>动态代理分为两大类:基于接口的动态代理,基于类的动态代理<ul><li>基于接口—JDK 动态代理</li><li>基于类:cglib</li><li>java 字节码实现 ： Javassist</li></ul></li></ul><p>需要了解两个类：Proxy，InvocationHandler</p><p>【InvocationHandler：调用处理程序】</p><p><img src="https://img-blog.csdnimg.cn/20210201202822371.png" alt="img" /></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Object <span class="title function_">invoke</span><span class="params">(Object proxy, 方法 method, Object[] args)</span>；</span><br><span class="line"><span class="comment">//参数</span></span><br><span class="line"><span class="comment">//proxy - 调用该方法的代理实例</span></span><br><span class="line"><span class="comment">//method -所述方法对应于调用代理实例上的接口方法的实例。方法对象的声明类将是该方法声明的接口，它可以是代理类继承该方法的代理接口的超级接口。</span></span><br><span class="line"><span class="comment">//args -包含的方法调用传递代理实例的参数值的对象的阵列，或null如果接口方法没有参数。原始类型的参数包含在适当的原始包装器类的实例中，例如java.lang.Integer或java.lang.Boolean 。.</span></span><br></pre></td></tr></table></figure><p>实例：</p><p>接口 Host.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//接口</span></span><br><span class="line"><span class="keyword">package</span> pojo2;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Host</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">rent</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>接口 Host 实现类 HostMaster.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//接口实现类</span></span><br><span class="line"><span class="keyword">package</span> pojo2;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HostMaster</span> <span class="keyword">implements</span> <span class="title class_">Host</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">rent</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;房东要租房子&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>代理角色的处理程序类 ProxyInvocationHandler.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> pojo2;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationHandler;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Proxy;</span><br><span class="line"></span><br><span class="line"><span class="comment">///用这个类，自动生成代理</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ProxyInvocationHandler</span> <span class="keyword">implements</span> <span class="title class_">InvocationHandler</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Foo f =(Foo) Proxy.NewProxyInstance(Foo. Class.GetClassLoader(),</span></span><br><span class="line">    <span class="comment">// new Class&lt;?&gt;[] &#123; Foo.Class &#125;,</span></span><br><span class="line">    <span class="comment">// handler);</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 被代理的接口</span></span><br><span class="line">    <span class="keyword">public</span> HostMaster hostMaster ;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setHostMaster</span><span class="params">(HostMaster hostMaster)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.hostMaster = hostMaster;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 得到生成的代理类</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">getProxy</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// newProxyInstance() -&gt; 生成代理对象，就不用再写具体的代理类了</span></span><br><span class="line">        <span class="comment">// this.getClass().getClassLoader() -&gt; 找到加载类的位置</span></span><br><span class="line">        <span class="comment">// hostMaster.getClass().getInterfaces() -&gt; 代理的具体接口</span></span><br><span class="line">        <span class="comment">// this -&gt; 代表了接口InvocationHandler的实现类ProxyInvocationHandler</span></span><br><span class="line">        <span class="keyword">return</span> Proxy.newProxyInstance(<span class="built_in">this</span>.getClass().getClassLoader(), hostMaster.getClass().getInterfaces(), <span class="built_in">this</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 处理代理实例并返回结果</span></span><br><span class="line">        <span class="keyword">public</span> Object <span class="title function_">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">            seeHouse();</span><br><span class="line">            <span class="comment">// 动态代理的本质，就是使用反射机制实现的</span></span><br><span class="line">            <span class="comment">// invoke()执行它真正要执行的方法</span></span><br><span class="line">            <span class="type">Object</span> <span class="variable">result</span> <span class="operator">=</span> method.invoke(hostMaster, args);</span><br><span class="line">            fee();</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">seeHouse</span><span class="params">()</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;看房子&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">fee</span><span class="params">()</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;收中介费&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>用户类 My2.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> holle4_proxy;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pojo2.Host;</span><br><span class="line"><span class="keyword">import</span> pojo2.Host2;</span><br><span class="line"><span class="keyword">import</span> pojo2.HostMaster;</span><br><span class="line"><span class="keyword">import</span> pojo2.ProxyInvocationHandler;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">My2</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//真实角色</span></span><br><span class="line">        <span class="type">HostMaster</span> <span class="variable">hostMaster</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HostMaster</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//代理角色，现在没有；用代理角色的处理程序来实现Host接口的调用</span></span><br><span class="line">        <span class="type">ProxyInvocationHandler</span> <span class="variable">pih</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ProxyInvocationHandler</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//pih -&gt; HostMaster接口类 -&gt; Host接口</span></span><br><span class="line">        pih.setHostMaster(hostMaster);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//获取newProxyInstance动态生成代理类</span></span><br><span class="line">        <span class="type">Host</span> <span class="variable">proxy</span> <span class="operator">=</span> (Host) pih.getProxy();</span><br><span class="line"></span><br><span class="line">        proxy.rent();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>弹幕评论：<br />什么时候调用 invoke 方法的?<br />代理实例调用方法时 invoke 方法就会被调用，可以 debug 试试</p><p>改为<strong>万能代理类</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">///用这个类，自动生代理</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ProxyInvocationHandler</span> <span class="keyword">implements</span> <span class="title class_">InvocationHandler</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Foo f =(Foo) Proxy.NewProxyInstance(Foo. Class.GetClassLoader(),</span></span><br><span class="line">    <span class="comment">// new Class&lt;?&gt;[] &#123; Foo.Class &#125;,</span></span><br><span class="line">    <span class="comment">// handler);</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 被代理的接口</span></span><br><span class="line">    <span class="keyword">public</span> Object target;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setTarget</span><span class="params">(Object target)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.target = target;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 得到生成的代理类 -&gt; 固定的代码</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">getProxy</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// newProxyInstance() -&gt; 生成代理对象，就不用再写具体的代理类了</span></span><br><span class="line">        <span class="comment">// this.getClass().getClassLoader() -&gt; 找到加载类的位置</span></span><br><span class="line">        <span class="comment">// hostMaster.getClass().getInterfaces() -&gt; 代理的具体接口</span></span><br><span class="line">        <span class="comment">// this -&gt; 代表了接口InvocationHandler的实现类ProxyInvocationHandler</span></span><br><span class="line">        <span class="keyword">return</span> Proxy.newProxyInstance(<span class="built_in">this</span>.getClass().getClassLoader(),</span><br><span class="line">                                      target.getClass().getInterfaces(), <span class="built_in">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 处理代理实例并返回结果</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">        <span class="comment">//前置通知</span></span><br><span class="line">        pre();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//打印日志,通过反射的方式</span></span><br><span class="line">        log(method.getName());</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 动态代理的本质，就是使用反射机制实现的</span></span><br><span class="line">        <span class="comment">// invoke()执行它真正要执行的方法</span></span><br><span class="line">        <span class="type">Object</span> <span class="variable">result</span> <span class="operator">=</span> method.invoke(target, args);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//后置通知</span></span><br><span class="line">        post();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">pre</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;[前置通知]&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">post</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;[后置通知]&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//日志打印</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">log</span><span class="params">(String msg)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;[Debug]执行了&quot;</span> + msg + <span class="string">&quot;方法&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>测试类：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Client</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">//真实角色</span></span><br><span class="line">        <span class="type">UserServiceImpl</span> <span class="variable">userService</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UserServiceImpl</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//代理角色,不存在</span></span><br><span class="line">        <span class="type">ProxyInvocationHandler</span> <span class="variable">proxyInvocationHandler</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ProxyInvocationHandler</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//设置要代理的对象</span></span><br><span class="line">        proxyInvocationHandler.setTarget(userService);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//动态生产代理类</span></span><br><span class="line">        <span class="type">UserService</span> <span class="variable">proxy</span> <span class="operator">=</span> (UserService) proxyInvocationHandler.getProxy();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//执行业务操作</span></span><br><span class="line">        proxy.add();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>动态代理的好处:</p><ul><li>可以使真实角色的操作更加纯粹，不用去关注一些公共的业务</li><li>公共也就交给代理角色！实现了业务的分工</li><li>公共业务发生扩展的时候，方便集中管理</li><li>一个动态代理类代理的是一个接口，一般就是对应的一类业务</li><li>一个动态代理类可以代理多个类，只要是实现了同一个接口即可</li></ul><h2 id="aop"><a class="markdownIt-Anchor" href="#aop"></a> AOP</h2><hr /><h3 id="什么是-aop"><a class="markdownIt-Anchor" href="#什么是-aop"></a> 什么是 AOP</h3><p>AOP 意为:面向切面编程，通过预编译方式和运行期动态代理实现程序功能的统一维护的一种技术，AOP 是 OOP 的延续，是软件开发中的一个热点，也是 String 框架中的一个重要内容，是函数式编程的一种衍生范型，利用 AOP 可以对业务逻辑的各个部分进行隔离，从而使得业务逻辑各部分之间的耦合度降低，提高程序的可重用性，同时提高了开发效率。</p><p><img src="https://s1.ax1x.com/2020/08/28/dIUZkV.png" alt="dIUZkV.png" /></p><h3 id="术语"><a class="markdownIt-Anchor" href="#术语"></a> 术语:</h3><ol><li>Aspect:切面,表示增强的功能,就是一推代码,完成某一个功能,非业务功能,常见的切面功能有日志,事务,统计信息,参数检查,权限验证</li><li>JoinPoint:链接点,连接业务方法和切面的位置,就某类中的业务的方法</li><li>目标对象:给哪个类的方法增加功能,这个类就是目标对象</li></ol><h3 id="切面有关的三要素"><a class="markdownIt-Anchor" href="#切面有关的三要素"></a> 切面有关的三要素:</h3><ol><li>切面的功能代码,切面干什么</li><li>切面的执行位置,使用 Pointcut 表示切面执行的位置</li><li>切面的执行时间,使用 Advice 表示时间,在目标方法之前,还是目标方法之后</li></ol><h3 id="aop-在-spring-中的使用"><a class="markdownIt-Anchor" href="#aop-在-spring-中的使用"></a> AOP 在 Spring 中的使用</h3><p>提供声明式事务，允许用户自定义切面</p><ul><li>横切关注点：跨越应用程序多个模块的方法或功能。即是，与我们业务逻辑无关的，但是我们需要关注的部分，就是横切关注点。如日志，安全，缓存，事务等等…</li><li>切面(Aspect)：横切关注点 被模块化的特殊对象。即，它是一个类。（Log 类）</li><li>通知(Advice)：切面必须要完成的工作。即，它是类中的一个方法。（Log 类中的方法）</li><li>目标(Target)：被通知对象。（生成的代理类)</li><li>代理(Proxy)：向目标对象应用通知之后创建的对象。（生成的代理类）</li><li>切入点(PointCut)：切面通知执行的”地点”的定义。（最后两点：在哪个地方执行，比如：method.invoke()）</li><li>连接点(JointPoint)：与切入点匹配的执行点。</li></ul><p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9naXRlZS5jb20vd29fYmVsbC9QaWN0dXJlQmVkL3Jhdy9tYXN0ZXIvaW1hZ2UvaW1hZ2UtMjAyMDA4MDMxNTQwNDM5MDkucG5n?x-oss-process=image/format,png" alt="image-20200803154043909" /></p><p>SpringAOP 中，通过 Advice 定义横切逻辑，Spring 中支持 5 种类型的 Advice:</p><p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9naXRlZS5jb20vd29fYmVsbC9QaWN0dXJlQmVkL3Jhdy9tYXN0ZXIvaW1hZ2UvaW1hZ2UtMjAyMDA4MDMxMzU5Mzc0MzUucG5n?x-oss-process=image/format,png" alt="image-20200803135937435" /></p><p><strong>即 AOP 在不改变原有代码的情况下，去增加新的功能。</strong>（代理）</p><h3 id="使用-spring-实现-aop重点"><a class="markdownIt-Anchor" href="#使用-spring-实现-aop重点"></a> 使用 Spring 实现 AOP【重点】</h3><ul><li>使用 AOP 织入，需要导入一个依赖包！</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.aspectj/aspectjweaver --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.aspectj<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>aspectjweaver<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.9.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="方法一使用原生-spring-接口"><a class="markdownIt-Anchor" href="#方法一使用原生-spring-接口"></a> 方法一：使用原生 spring 接口</h4><p>springAPI 接口实现</p><p>需要先导入 aop 约束</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:aop</span>=<span class="string">&quot;http://www.springframework.org/schema/aop&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">https://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="string"><span class="tag">https://www.springframework.org/schema/aop/spring-aop.xsd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>创建 applicationContext.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:aop</span>=<span class="string">&quot;http://www.springframework.org/schema/aop&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">                           https://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">                           http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="string"><span class="tag">                           https://www.springframework.org/schema/aop/spring-aop.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--注册bean--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userservice&quot;</span> <span class="attr">class</span>=<span class="string">&quot;service.UserServiceImpl&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;log&quot;</span> <span class="attr">class</span>=<span class="string">&quot;log.Log&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;afterLog&quot;</span> <span class="attr">class</span>=<span class="string">&quot;log.AfterLog&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--方式一，使用原生Spring API接口--&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--配置aop,还需要导入aop约束--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--切入点：expression:表达式，execution（要执行的位置）--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">id</span>=<span class="string">&quot;pointcut&quot;</span> <span class="attr">expression</span>=<span class="string">&quot;execution(* service.UserServiceImpl.*(..))&quot;</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--UserServiceImpl.*(..) -》 UserServiceImpl类下的所以方法(参数)--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--执行环绕增加--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">&quot;log&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;pointcut&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">&quot;afterLog&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;pointcut&quot;</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 环绕,在id=&quot;pointcut&quot;的前后切入 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>execution(返回类型，类名，方法名(参数))<code>-&gt;</code>execution(_ com.service._,*(…))</p><p>UserService.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> service;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">()</span> ;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">delete</span><span class="params">()</span> ;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">query</span><span class="params">()</span> ;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>UserService 的实现类 UserServiceImp.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;add增&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">delete</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;delete删&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;update改&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">query</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;query查&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>前置 Log.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> log;</span><br><span class="line"><span class="keyword">import</span> org.springframework.aop.MethodBeforeAdvice;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Log</span> <span class="keyword">implements</span> <span class="title class_">MethodBeforeAdvice</span> &#123;</span><br><span class="line">    <span class="comment">//method：要执行的目标对象的方法</span></span><br><span class="line">    <span class="comment">//args：参数</span></span><br><span class="line">    <span class="comment">//target：目标对象</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">before</span><span class="params">(Method method, Object[] args, Object target)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">        System.out.println(target.getClass().getName()+<span class="string">&quot;的&quot;</span>+method.getName()+<span class="string">&quot;被执行了&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>后置 AfterLog.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> log;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">import</span> org.springframework.aop.AfterReturningAdvice;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AfterLog</span> <span class="keyword">implements</span> <span class="title class_">AfterReturningAdvice</span> &#123;</span><br><span class="line">    <span class="comment">//returnVaule: 返回值</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterReturning</span><span class="params">(Object returnValue, Method method, Object[] args, Object target)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;执行了&quot;</span>+method.getName()+<span class="string">&quot;方法，返回值是&quot;</span>+returnValue);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>测试类 MyTest5</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"><span class="keyword">import</span> service.UserService;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyTest5</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line">        <span class="comment">//注意:动态代理代理的是接口</span></span><br><span class="line">        <span class="type">UserService</span> <span class="variable">userService</span> <span class="operator">=</span> (UserService) context.getBean(<span class="string">&quot;userservice&quot;</span>);</span><br><span class="line">        userService.add();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="方法二自定义类实现-aop"><a class="markdownIt-Anchor" href="#方法二自定义类实现-aop"></a> 方法二：自定义类实现 AOP</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:aop</span>=<span class="string">&quot;http://www.springframework.org/schema/aop&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">                           https://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">                           http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="string"><span class="tag">                           https://www.springframework.org/schema/aop/spring-aop.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--注册bean--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userservice&quot;</span> <span class="attr">class</span>=<span class="string">&quot;service.UserServiceImpl&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;log&quot;</span> <span class="attr">class</span>=<span class="string">&quot;log.Log&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;afterLog&quot;</span> <span class="attr">class</span>=<span class="string">&quot;log.AfterLog&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 方式二，自定义 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;diy&quot;</span> <span class="attr">class</span>=<span class="string">&quot;diy.DiyPointcut&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--自定义切面--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:aspect</span> <span class="attr">ref</span>=<span class="string">&quot;diy&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--切入点--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">id</span>=<span class="string">&quot;point&quot;</span> <span class="attr">expression</span>=<span class="string">&quot;execution(* service.UserServiceImpl.*(..))&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">aop:before</span> <span class="attr">method</span>=<span class="string">&quot;before&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;point&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">aop:after</span> <span class="attr">method</span>=<span class="string">&quot;after&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;point&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">aop:aspect</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> diy;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DiyPointcut</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">before</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;插入到前面&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">after</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;插入到后面&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//测试</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyTest5</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line">        <span class="comment">//注意:动态代理代理的是接口</span></span><br><span class="line">        <span class="type">UserService</span> <span class="variable">userService</span> <span class="operator">=</span> (UserService) context.getBean(<span class="string">&quot;userservice&quot;</span>);</span><br><span class="line">        userService.add();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="方法三使用注解实现"><a class="markdownIt-Anchor" href="#方法三使用注解实现"></a> 方法三：使用注解实现</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.kuang.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.ProceedingJoinPoint;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.After;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Around;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Aspect;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Before;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AnnotationPointcut</span> &#123;</span><br><span class="line">    <span class="meta">@Before(&quot;execution(* com.kuang.service.UserServiceImpl.*(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">before</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;---------方法执行前---------&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@After(&quot;execution(* com.kuang.service.UserServiceImpl.*(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">after</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;---------方法执行后---------&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Around(&quot;execution(* com.kuang.service.UserServiceImpl.*(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">around</span><span class="params">(ProceedingJoinPoint jp)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;环绕前&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;签名:&quot;</span>+jp.getSignature());</span><br><span class="line">        <span class="comment">//执行目标方法proceed</span></span><br><span class="line">        <span class="type">Object</span> <span class="variable">proceed</span> <span class="operator">=</span> jp.proceed();</span><br><span class="line">        System.out.println(<span class="string">&quot;环绕后&quot;</span>);</span><br><span class="line">        System.out.println(proceed);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>第二步：在 Spring 配置文件中，注册 bean，并增加支持注解的配置</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--第三种方式:注解实现--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;annotationPointcut&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.kuang.config.AnnotationPointcut&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">aop:aspectj-autoproxy</span>/&gt;</span></span><br></pre></td></tr></table></figure><p>测试</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyTest5</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line">        <span class="comment">//注意:动态代理代理的是接口</span></span><br><span class="line">        <span class="type">UserService</span> <span class="variable">userService</span> <span class="operator">=</span> (UserService) context.getBean(<span class="string">&quot;userservice&quot;</span>);</span><br><span class="line">        userService.add();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>输出结果：<br /><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9naXRlZS5jb20vd29fYmVsbC9QaWN0dXJlQmVkL3Jhdy9tYXN0ZXIvaW1hZ2UvaW1hZ2UtMjAyMDA4MDMxNzU2NDIwNjQucG5n?x-oss-process=image/format,png" alt="image-20200803175642064" /></p><p>aop:aspectj-autoproxy：说明</p><p>通过 aop 命名空间的&lt;aop:aspectj-autoproxy /&gt;声明自动为 spring 容器中那些配置@aspectJ 切面的 bean 创建代理，织入切面。当然，spring 在内部依旧采用 AnnotationAwareAspectJAutoProxyCreator 进行自动代理的创建工作，但具体实现的细节已经被&lt;aop:aspectj-autoproxy /&gt;隐藏起来了</p><p>&lt;aop:aspectj-autoproxy /&gt;有一个 proxy-target-class 属性，默认为 false，表示使用 jdk 动态代理织入增强，当配为&lt;aop:aspectj-autoproxy poxy-target-class=“true”/&gt;时，表示使用 CGLib 动态代理技术织入增强。不过即使 proxy-target-class 设置为 false，如果目标类没有声明接口，则 spring 将自动使用 CGLib 动态代理。</p><h3 id="aop-的技术实现框架"><a class="markdownIt-Anchor" href="#aop-的技术实现框架"></a> aop 的技术实现框架:</h3><ol><li>spring:Spring 在内部实现了 aop 的规范,能做了 aop 的工作<ol><li>我们项目开发中很少使用 Spring 的 aop 实现,因为 spring 的 aop 比较笨重</li></ol></li><li>AspectJ:一个开源的专门处理 Aop 的框架,Spring 框架中集成了 aspectj 框架,通过 spring 就能使用 aspectj 的功能<ol><li>使用 xml 的配置文件:配置全局事务</li><li>使用注解,我们在项目中要做 aop 功能,一般都用注解,aspectj 有五个注解</li></ol></li></ol>]]></content>
      
      
      <categories>
          
          <category> Spring </category>
          
          <category> 编程笔记 </category>
          
          <category> Java </category>
          
          <category> Spring5笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Spring </tag>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
